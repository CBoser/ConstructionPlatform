(()=>{(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[983],{88399:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.App {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: lightgrey;
  min-height: 100vh;
  align-items: center;
}

body {
  margin: 0;
  font-family: 'acumin-pro', -apple-system, BlinkMacSystemFont, 'Segoe UI',
    'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans',
    'Helvetica Neue', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  width: 100vw;
  height: 100vh;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}

.modal-custom-class .MuiPaper-root .MuiButton-containedError {
  color: var(--light-error-dark) !important;
}

.modal-custom-class .MuiPaper-root .MuiButton-containedError:hover {
  background-color: var(--todo-header-background);
}
`,""]);const M=te},75927:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.turbo .b-grid-panel-body {
  padding: 0 !important;
  margin: 0 !important;
}

#crews-bryntum-osr {
  min-height: 0 !important;
}

#crews-bryntum-accountadmin {
  min-height: 0 !important;
}

#crews-bryntum-sub {
  min-height: 0 !important;
}

#crews-bryntum-companycrew {
  min-height: 0 !important;
}

.user-name-flex-container {
  display: flex;
  width: 266px;
  justify-content: space-between;
  align-items: center;
}

.user-name-content {
  flex-grow: 1;
}

.user-name-delete-content {
  margin-left: 10px;
}

.delete-user-btn {
  font-size: 24px;
  width: 9.67px;
  height: 10.27px;
  color: var(--light-error-dark);
  border: none;
  outline: none;
  cursor: pointer;
  transform: rotate(-45deg);
  background: transparent;
  padding: 0 16px;
}

.b-grid-header-children {
  height: 2.6rem;
}

.b-grid-header.b-grid-header-parent {
  border-inline-end: none !important;
}

.b-last-parent > .b-grid-header-text {
  border-inline-end: 1px solid #c2c1c1 !important;
}

.b-collapsible:has(.b-icon-collapse-left) > .b-grid-header-text {
  background-color: rgb(207, 228, 255);
}

.b-collapsible:has(.b-icon-collapse-left) > .b-grid-header-children {
  background-color: rgba(207, 228, 255, 0.5);
}

.bryntum-column-background {
  background-color: rgba(207, 228, 255, 0.5) !important;
}

.b-force-read-only {
  pointer-events: none;
}

[data-id^='group-header'] {
  background-color: #dedede !important;
}

.b-checkbox > .b-field-inner input[type='checkbox'] + .b-checkbox-label:before {
  border-color: rgb(55, 55, 55) !important;
}

[data-id^='group-header'] .bryntum-column-background {
  color: rgb(55, 55, 55) !important;
}

.packs-items:last-child {
  margin-bottom: 85px;
}
`,""]);const M=te},22119:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.container {
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1;
}
.frame {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  box-shadow: 0px 16px 16px 0px rgba(0, 0, 0, 0.25);
}
.video-frame {
  display: flex;
  padding: 36px;
  flex-direction: column;
  justify-content: space-between;
  align-items: center;
  align-self: stretch;
  border-radius: 4px 0px 0px 4px;
  background: #333;
  box-shadow: 0px 4px 4px 0px rgba(0, 0, 0, 0.25);
  max-width: 451px;
}
.video-container {
  display: flex;
  padding-bottom: 16px;
  flex-direction: column;
  align-items: flex-start;
  gap: 15px;
  max-width: 379px;
}
.video-text {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  align-self: stretch;
  color: #fff;
  font-feature-settings: 'clig' off, 'liga' off;
  font-family: 'acumin-pro';
  color: #fff;
}
.video-text-header {
  font-size: 16px;
  font-weight: bold;
  font-weight: 700;
  line-height: 100%;
}
.video-text-content {
  font-size: 12px;
  font-style: normal;
  font-weight: 400;
  line-height: normal;
}
.video-text-list {
  margin-left: 8px;
}
.form-frame {
  display: flex;
  padding: 36px;
  flex-direction: column;
  align-items: center;
  gap: 40px;
  align-self: stretch;
  border-radius: 0px 4px 4px 0px;
  background: #fff;
  box-shadow: 0px 4px 4px 0px rgba(0, 0, 0, 0.25);
  max-width: 257px;
}
.logo {
  display: flex;
  width: 240px;
  height: 63px;
  padding: 12px;
  justify-content: center;
  align-items: center;
  gap: 7.787px;
}
.input {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 16px;
  align-self: stretch;
}
.input-label {
  color: #000;
  text-align: center;
  font-family: 'acumin-pro';
  font-size: 14px;
  font-style: normal;
  font-weight: 700;
  line-height: normal;
}
.input-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  align-self: stretch;
}
.email {
  display: flex;
  padding: 8px;
  align-items: center;
  align-self: stretch;
  color: #818181;
  font-family: 'acumin-pro';
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 24px; /* 171.429% */
}
.submit {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 16px;
  align-self: stretch;
}
.legal {
  color: #000;
  text-align: center;
  font-family: 'acumin-pro';
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: normal;
}
.link {
  color: #2b70c7;
  font-family: 'acumin-pro';
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: normal;
}
.submit-button {
  display: flex;
  padding: 10px 16px 11px 16px;
  justify-content: center;
  align-items: center;
  gap: 10px;
  border-radius: 4px;
  background: #2b70c7;
  color: #fff;
  text-align: center;
  font-family: 'acumin-pro';
  font-size: 14px;
  font-style: normal;
  font-weight: 600;
  line-height: 120%;
  box-shadow: 0px 0px 0px;
  border-width: 0px;
  width: 100%;
}
.submit-button:disabled {
  opacity: 30%;
}
@media only screen and (max-width: 768px) {
  .video-frame {
    max-width: 329px;
  }
  .form-frame {
    max-width: 329px;
  }
}
@media only screen and (max-width: 480px) {
  .video-frame {
    display: none;
  }
}
`,""]);const M=te},21951:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.schedule-templates-grid,
.schedule-templates-gantt,
.schedule-templates-create {
  padding: 10px;
}
.schedule-template-outer {
  width: 100%;
  background-color: white;
  border-radius: 8px;
  min-width: 400px;
  height: 100%;
}
.schedule-templates-grid .b-grid-panel-body,
.schedule-templates-gantt .b-grid-panel-body {
  margin: 0;
}

.schedule-template-delete {
  color: red !important;
  padding: 0 !important;
}

.schedule-template-button {
  font-size: 14px !important;
  padding-top: 8px;
  margin: 10px !important;
}

.schedule-template-button:hover {
  color: orange;
}

.disable-download-button {
  pointer-events: none;
  color: lightgrey;
}

.schedule-template-button-edit {
  width: 60px !important;
  margin: 8px !important;
}

.schedule-template-button-edit:after {
  content: 'Edit';
  padding-left: 5px;
  display: inline-block;
  padding: 0 20px;
  color: #3281e6;
  font-size: 13px;
}

.schedule-template-button-edit:before {
  display: none;
}

.schedule-templates-grid .b-grid-header-container {
  box-shadow: none;
  border: none !important;
}

.schedule-templates-grid .b-grid-header {
  border: none !important;
}
.schedule-templates-grid .b-grid-headers {
  border: none !important;
}
.schedule-templates-grid .b-grid-cell {
  border: none !important;
  justify-content: center;
}
.schedule-templates-grid .b-grid-row {
  height: 40px;
  border: none !important;
}
.schedule-templates-grid .b-grid-row :nth-child(1) {
  justify-content: left;
}

.schedule-templates-grid .b-grid-header-text-content {
  text-align: center;
}

.schedule-templates-grid .temp-name-column .b-grid-header-text-content {
  text-align: left;
}

.no-template-message {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

.no-template-message h3 {
  font-size: 36px;
  letter-spacing: 2px;
  margin-bottom: 15px;
}

.no-template-message span {
  font-size: 20px;
}

.no-template-message h3,
.no-template-message span {
  color: #cdcbcb;
  font-weight: 600;
  letter-spacing: 0;
  margin: 0;
}

.schedule-templates-grid .b-empty-text {
  height: 400px;
  background-color: transparent !important;
}

.schedule-templates-gantt .grid-action-field .b-grid-header-text-content {
  text-align: right;
  margin-right: 2px;
}

.schedule-templates-gantt {
  height: 97%;
}

.schedule-templates-gantt .b-grid-header.grid-name-field,
.schedule-templates-gantt .b-grid-cell.b-name-cell {
  border-inline-end: none !important;
}

.schedule-templates-gantt .b-sch-header-text.b-sticky-header {
  color: black;
  padding-left: 400px !important;
}

.schedule-templates-gantt .b-grid-cell[data-column='name'] {
  white-space: normal;
}

.create-template-form-area {
  padding-top: 15px;
}
`,""]);const M=te},61965:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.schedule-templates-gantt
  .b-gantt-project-line-canvas
  .b-sch-timerange.b-gantt-project-line.b-sch-line {
  display: none;
}

.b-sch-header-row .b-sch-header-timeaxis-cell.b-last {
  justify-content: left;
}

.schedule-templates-gantt .bryntum-gantt-updated .b-grid-cell.b-name-cell {
  border-inline-end: 1px solid #b0b0b7 !important;
}

.schedule-templates-gantt .b-grid-header.gantt-header-name-field {
  border-inline-end: none !important;
  border: none;
}

.schedule-templates-gantt .b-grid-header.grid-name-field {
  border-inline-end: none !important;
  border: none;
}

.schedule-templates-gantt .b-grid-cell.b-action-cell .b-action-ct {
  margin-left: 30px;
}

.schedule-templates-gantt .b-grid-cell.b-action-cell {
  justify-content: end;
}

.template-action-area {
  display: inline-flex;
  align-items: end;
  padding-bottom: 20px;
}

.edit-template-name-field {
  flex-grow: 1;
  width: 500px;
}

.edit-template-name-field fieldset {
  border: 1px solid rgba(0, 0, 0, 0.23);
  border-radius: 4px;
  background-color: transparent;
}

.template-buttons-area {
  display: inline-flex;
}

@media screen and (max-width: 1200px) {
  .edit-template-name-field {
    width: 100%;
  }
}

@media screen and (max-width: 900px) {
  .template-action-area {
    flex-direction: column;
  }
  .template-buttons-area {
    margin-top: 10px;
  }
}
`,""]);const M=te},55591:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.b-messagedialog-confirm.b-popup header.b-messagedialog-header {
  padding: 25px;
  background-color: var(--bfs-primary-gray);
  font-size: 24px;
  font-weight: bold;
  width: 500px;
  max-width: 500px;
  font-family: acumin-pro;
}

.b-messagedialog-confirm.b-popup
  .b-panel-content.b-messagedialog-content
  .b-widget.b-messagedialog-message {
  padding: 0 10px;
  color: var(--common-black-100-p);
  font-size: 16px;
  font-family: acumin-pro;
}

.b-messagedialog-confirm.b-popup .b-bottom-toolbar .b-toolbar-content.b-hbox {
  justify-content: space-between !important;
}

.b-messagedialog-confirm.b-popup
  .b-bottom-toolbar
  .b-toolbar-content.b-hbox
  .b-messagedialog-cancelbutton {
  font-family: acumin-pro;
  min-width: 64px;
  border-radius: 4px;
  transition: background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
    box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
    border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
    color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
  box-shadow: none;
  color: var(--light-primary-contrast);
  font-stretch: normal;
  font-style: normal;
  letter-spacing: 0.46px;
  line-height: 1.75;
  font-weight: 600;
  background-color: var(--light-secondary-main);
  font-size: 14px;
  padding: 13px 12px;
  height: 40px;
  line-height: 1 !important;
  text-transform: capitalize !important;
}

.b-messagedialog-confirm.b-popup
  .b-bottom-toolbar
  .b-toolbar-content.b-hbox
  .b-messagedialog-okbutton {
  background-color: transparent !important;
  color: var(--light-error-dark) !important;
  box-shadow: none !important;
  padding-right: 0 !important;
}

.bullet-style .b-icon-tree-leaf:before,
.bullet-style .b-cal-event-icon,
.bullet-style.b-selected .b-cal-event-icon,
.bullet-style.b-selected .b-cal-event,
.bullet-style .b-cal-event:hover,
.bullet-style.b-active
  .b-cal-event-bar-container
  .b-cal-event-wrap:not(.b-allday)
  .b-cal-event,
.b-cal-event-bar-container .bullet-style:not(.b-allday) .b-cal-event,
.bullet-style.b-selected
  .b-cal-event-bar-container
  .b-cal-event-wrap:not(.b-allday)
  .b-cal-event {
  color: var(--todo-pill-bullet) !important;
}

.b-action-item.grid-updated-edit,
.b-action-item.grid-updated-add {
  padding: 10px;
  background-color: #d1d0d0;
  border-radius: 4px;
  color: #606263;
  cursor: pointer;
  width: 28px;

  height: 30px;

  border: none;

  box-shadow: none;

  align-items: center;

  display: flex !important;

  visibility: hidden;

  justify-content: center !important;

  margin-right: 10px;

  font-size: 10px;
}

.b-grid-row:hover .b-action-item.grid-updated-edit,
.b-grid-row:hover .b-action-item.grid-updated-add {
  visibility: visible;
}

.b-tree-parent-row:hover .b-action-item.grid-updated-edit {
  visibility: hidden;
}

.bryntum-grid-updated .b-grid-cell.b-action-cell {
  justify-content: flex-end !important;
  padding: 0 !important;
}

.b-action-item.grid-updated-edit:hover,
.b-action-item.grid-updated-add:hover {
  color: #606263;

  transform: none;
}

.bryntum-gantt-updated .b-grid-header.grid-name-field,
.bryntum-gantt-updated .b-grid-cell.b-name-cell,
.bryntum-grid-updated .b-grid-header.grid-name-field,
.bryntum-grid-updated .b-grid-cell.b-name-cell {
  border-inline-end: none !important;
}

.bryntum-gantt-updated .b-sch-label {
    transform: translateY(-7px);
}

.bryntum-gantt-updated .b-tree-cell .b-tree-icon,
.bryntum-grid-updated .b-tree-cell .b-tree-icon {
  color: #64b5f6 !important;
}

.b-grid-header.gantt-header-name-field {
  border-inline-end: none !important;
  border: none;
}

header.b-messagedialog-header .b-popup-header {
  color: #fff !important;
}

.b-messagedialog-header .b-header-title {
  color: #fff !important;
}

.b-timeaxis.b-horizontaltimeaxis .b-sch-header-row {
  margin-left: 8px !important;
}

.b-calendar-body-wrap .b-toolbar.b-dock-top .b-html.b-last-visible-child {
  font-family: 'Roboto', sans-serif !important;
}

.addnewPhase {
  text-transform: capitalize !important;
  border-radius: 5px !important;
}

.newTaskBtn {
  padding: 10px;
  border-radius: 5px;
  background-color: #d1d0d0;
  margin-right: 20px;
  border: none;
}

.b-action-item.b-fa-plus.add-new-task-button {
  width: 120px;
  padding: 15px 10px 17px;
}

.grid-action-field .b-grid-header-text-content {
  text-align: right;
  margin-right: 2px;
}

.b-fa-ellipsis-v.b-fa.task-menu-button {
  background-color: transparent;
  font-size: 17px;
  margin-right: 0;
}

.add-new-task-button:after {
  content: 'Add new task';
  padding-left: 5px;
  font-size: 13px;
}

.b-blue.addnewPhase:hover,
.b-tool.add-new-task-button:hover {
  opacity: 1;
}

.bryntum-gantt-updated .add-new-task-button {
  margin-right: 3px;
}

.bryntum-gantt-updated .b-grid-cell.b-action-cell {
  flex-direction: row-reverse;
}

.custom_taskMenu {
  z-index: 1;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}

.custom_taskMenu .list_wrap {
  padding-left: 0;
  width: 130px;
  z-index: 10;
  background-color: #fff;
  position: relative;
  transition: opacity 0.2s;
  box-shadow: 0 3px 6px rgba(0, 0, 0, 0.12), 0 3px 6px rgba(0, 0, 0, 0.24);
}

.custom_taskMenu .menu_list {
  flex-shrink: 0;
  padding: 0.8em;
  color: #4f5964;
  cursor: pointer;
  transition: background-color 0.2s, color 0.2s;
  border-top: 1px dotted rgba(224, 224, 231, 0.8);
  font-size: 1em;
  min-width: 7em;
  display: flex;
  align-items: center;
  padding-right: 0;
}

.custom_taskMenu .menu_list svg {
  font-size: 20px;
  margin-right: 10px;
}

.custom_taskMenu .menu_list:hover {
  outline: none;
  background-color: rgba(254, 172, 49, 0.3);
  color: #4f5964;
}

.disable-add-phase {
  opacity: 0.7;
}

.b-grid-empty .b-grid-subgrid .b-empty-text {
  text-align: center;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: auto;
  font-size: 30px;
  letter-spacing: 1px;
  font-weight: 700;
  color: #cbcbcb !important;
}

.custom-popup-menus .b-panel-content {
  flex-direction: column;
}

.custom-popup-menus .b-panel-content button.b-widget {
  border: none;
  background: #fff;
  justify-content: flex-start;
}

.custom-popup-menus .b-panel-content button.b-widget:hover {
  background-color: rgba(254, 172, 49, 0.3);
  color: #4f5964;
}

.custom-popup-menus .b-panel-content.b-popup-content {
  padding: 0;
}

.b-panel-header .b-header-title {
  font-size: 1em !important;
}
`,""]);const M=te},13629:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.bldr-popup-header {
  padding: 20px;
  background-color: var(--bfs-primary-gray);
}

.bldr-popup-header h2 {
  margin: 0;
  font-weight: 500;
  color: var(--light-warning-contrast);
}

.ReactModal__Overlay {
  z-index: 100;
  background-color: rgba(0, 0, 0, 0.4) !important;
}

.close-wrap {
  cursor: pointer;
  padding: 3px;
}

.close-wrap svg {
  color: var(--light-warning-contrast);
}

.bldr-popup-tabs {
  padding: 20px;
  color: var(--light-warning-grey-black) !important;
}

.bldr-popup-tabs-header {
  border-bottom: 1px solid var(--light-warning-grey);
  font-size: 15px !important;
  width: 100%;
  padding-left: 0;
  display: flex;
  margin: 0 0 40px;
}

.bldr-main-modal .MuiModal-backdrop {
  background-color: transparent !important;
}

.bldr-popup-tabs-header li {
  list-style: none;
  padding: 12px 15px 7px 15px;
  font-size: 12px;
  color: var(--light-text-primary) !important;
  cursor: pointer;
  letter-spacing: 1px;
}

.bldr-popup-tabs-header .active {
  background-color: var(--light-warning-contrast) !important;
  color: var(--light-text-primary) !important;
  border-bottom: 1px solid var(--light-warning-dark-grey) !important;
}

.bldr-popup-tabs-header .Mui-selected {
  background-color: var(--light-warning-white-border) !important;
  color: var(--light-text-primary) !important;
  border-bottom: 1px solid var(--bfs-primary-gray) !important;
  z-index: 1 !important;
}

.bldr-main-modal {
  z-index: 1300;
}

.bldr-main-modal .MuiPaper-elevation {
  background-color: var(--graythorne-grays-gray-1);
}

.bldr-main-modal .bldr-form-input {
  padding: 18px;
  display: flex;
  flex: 1 1 100%;
  width: 100%;
  align-items: center;
  background-color: var(--light-warning-contrast);
  font-family: 'acumin-pro' !important;
  border-radius: 5px;
  min-width: 0;
  position: relative;
  border: 1px solid var(--light-warning-white);
  font-size: 15px;
  color: var(--light-warning-black-shade) !important;
}

.bldr-main-modal .bldr-form-input option {
  padding: 15px !important;
}

.bldr-main-modal .bldr-form-label {
  padding-top: 18px;
  text-align: right;
  flex: 0 0 7em;
  padding-right: 10px;
  text-transform: uppercase;
  color: var(--light-warning-black-shade);
  font-size: 15px !important;
}

.bldr-main-modal .label-disabled,
.bldr-main-modal .input-disabled {
  color: var(--light-warning-dark-grey);
}

.checkBoxLabel {
  color: var(--light-warning-black-shade);
  font-size: 15px !important;
  text-transform: uppercase;
  padding-right: 10px;
  min-width: 150px;
  display: inline-block;
}

.checkbox-wrap {
  margin-bottom: 15px;
}

.bldr-main-modal .bldr-form-group {
  display: flex;
  margin-bottom: 15px;
}

.bldr-main-modal .bldr-form-input:focus {
  outline: none;
  border-color: var(--bfs-primary-gray);
}

.bldr-popup-footer {
  padding: 20px;
  padding-top: 0;
  text-align: right;
  position: absolute;
  bottom: 0;
  top: unset;
  left: 0;
  right: 0;
}

.bldr-popup-footer .bldr-action-cancel {
  padding: 13px 12px;
  margin-right: 10px;
  min-width: 110px;
  font-size: 14px;
  font-weight: 600;
  background-color: var(--light-secondary-main);
  letter-spacing: 0.46px;
  transition: 0.5s;
  color: var(--light-warning-contrast);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  text-transform: uppercase;
}

.bldr-popup-footer .bldr-action-cancel:hover {
  background-color: var(--graythorne-grays-gray-4);
}

.bldr-popup-footer .bldr-action-save {
  padding: 13px 12px;
  margin-right: 10px;
  font-size: 14px;
  min-width: 110px;
  font-weight: 600;
  background-color: var(--light-info-main);
  letter-spacing: 0.46px;
  transition: 0.5s;
  color: var(--light-warning-contrast);
  border-radius: 4px;
  border: none;
  cursor: pointer;
  text-transform: uppercase;
}

.bldr-popup-footer .bldr-action-save:hover {
  background-color: var(--light-primary-dark);
}

.bldr-form-group select {
  display: inline-block;
}

.bldr-form-group .custom-option {
  background-color: var(--light-warning-contrast) !important;
  padding: 30px;
  display: inline-block;
  color: var(--light-warning-border);
  line-height: 2;
}

.bldr-form-group .custom-option:hover {
  background-color: var(--light-warning-white-border) !important;
}

.bldr-form-group select option:nth-child(1) {
  display: none;
}

.bldr-form-group .bldr-form-date {
  background-color: var(--light-warning-contrast);
  color: var(--light-warning-black-shade) !important;
}

.bldr-form-group .bldr-form-date:focus {
  outline: none;
}

.bldr-popup-error {
  margin-top: 5px;
  color: red;
  font-size: 14px;
  display: block;
  text-align: left;
  padding-bottom: 10px;
  padding-left: 6%;
}

.bldr-form-group input[type='number']::-webkit-inner-spin-button,
.bldr-form-group input[type='number']::-webkit-outer-spin-button {
  -webkit-appearance: textfield;
  -moz-appearance: textfield;
  appearance: textfield;
}

/* Date popup styling change */
.MuiCalendarPicker-root .MuiButtonBase-root.Mui-selected {
  background-color: var(--bfs-primary-gray) !important;
  color: var(--light-warning-contrast) !important;
}

.MuiPickersCalendarHeader-root {
  background-color: var(--bfs-leght-gray-light) !important;
  margin: 0 !important;
  padding: 15px;
  font-size: 12px;
  font-weight: 700;
}

.bldr-form-group .bldr-form-date > div {
  color: var(--light-warning-border) !important;
}

.bldr-form-group
  .bldr-form-date
  > div.Mui-focused
  .MuiOutlinedInput-notchedOutline {
  border: 1px solid var(--bfs-primary-gray) !important;
  border-width: 1px !important;
  border-radius: 5px !important;
}

.bldr-form-group .bldr-form-date > div:hover .MuiOutlinedInput-notchedOutline {
  border-color: var(--light-warning-white) !important;
}

.bldr-main-modal {
  font-family: 'acumin-pro' !important;
}

@media only screen and (max-width: 767px) {
  .bldr-main-modal {
    width: 100%;
    top: 0;
    left: 0;
    transform: none;
    min-height: auto;
    height: 100%;
  }

  .bldr-main-modal .bldr-form-input {
    padding: 12px;
  }
}

.checkBox {
  display: inline-block !important;
}

.disable-tab {
  display: none !important;
}

.disable-current-tab {
  pointer-events: none;
  position: relative;
  color: var(--datagrid-cell-grey);
}

.bldr-popup-todo-footer .button-wrap {
  display: flex;
  justify-content: space-between;
}

.bldr-popup-todo-footer .bldr-popup-error {
  padding-bottom: 20px;
}

.bldr-popup-todo-footer .bldr-action-delete {
  font-weight: 600;
  border: none;
  font-size: 14px;
  background-color: var(--light-error-dark);
  border-radius: 4px;
  transition: 0.5s;
  font-size: 14px;
  padding: 13px 12px;
  min-width: 120px;
  color: var(--light-warning-contrast);
  border: none;
  margin-right: 10px;
  cursor: pointer;
  text-transform: uppercase;
}

.bldr-popup-todo-footer .bldr-action-unschedule {
  font-size: 14px;
  background-color: var(--light-warning-grey);
  min-width: 120px;
  color: var(--light-warning-contrast);
  padding: 13px 12px;
  margin-right: 10px;
  font-size: 14px;
  font-weight: 600;
  letter-spacing: 0.46px;
  transition: 0.5s;
  border-radius: 4px;
  border: none;
  cursor: pointer;
  text-transform: uppercase;
}

.bldr-action-delete:disabled {
  opacity: 0.6 !important;
  cursor: not-allowed !important;
}

.bldr-action-unschedule:disabled {
  opacity: 0.6 !important;
  cursor: not-allowed !important;
}

.bldr-main-modal .custom-popup-select-wrap {
  display: flex;
}

.bldr-main-modal .custom-popup-label {
  display: inline-block;
  padding-top: 18px;
  text-align: right;
  flex: 0 0 7em;
  padding-right: 10px;
  text-transform: uppercase;
  color: var(--light-warning-black-shade);
  font-size: 15px !important;
  padding-left: 0;
}

.bldr-main-modal .custom-popup-select.Mui-focused {
  border: 1px solid var(--common-black-100-p);
}

.bldr-main-modal .custom-popup-select.Mui-focused > fieldset {
  border: none;
}

.bldr-main-modal .custom-popup-select:hover fieldset {
  border-color: var(--light-warning-white) !important;
}

.bldr-main-modal .custom-popup-select-wrap .MuiOutlinedInput-notchedOutline {
  border-color: var(--light-warning-white);
}

.bldr-main-modal .custom-popup-select > svg {
  width: 1.3em;
  height: 1.3em;
  color: var(--light-warning-grey-svg);
}

.bldr-main-modal .custom-popup-select {
  display: inline-block;
  margin-bottom: 15px;
  display: flex;
  flex: 1 1 100%;
  width: 100%;
  align-items: center;
  background-color: var(--light-warning-contrast);
  border-radius: 5px;
  min-width: 0;
  position: relative;
  border: 1px solid var(--light-warning-white);
  font-weight: 500;
  font-size: 15px;
  color: var(--light-warning-black-shade);
}

.bldr-form-group .bldr-form-date .MuiOutlinedInput-root > div > button > svg {
  color: var(--light-warning-grey-svg);
}

.bldr-form-group .bldr-form-date-start-date .MuiIconButton-root svg {
  display: none;
}

.bldr-form-group .bldr-form-date-start-date .MuiIconButton-root {
  color: #b0b1b2;
  font-size: 0.9em;
  cursor: pointer;
  flex: 0 0 auto;
  align-items: center;
}

.bldr-form-group .bldr-form-date-start-date .MuiIconButton-root:hover {
  background-color: transparent !important;
}

.bldr-form-group .bldr-form-date-start-date .MuiIconButton-root::after {
  content: '\\f133';
  font-style: normal;
  font-variant: normal;
  font-weight: normal;
  line-height: 1;
  font-family: 'Font Awesome 6 Free', FontAwesome6Free;
  font-weight: 900;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  font-size: 1.3em;
}
`,""]);const M=te},51926:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.sidepanel {
  width: 350px;
  position: fixed;
  top: 62px;
  right: 0;
  bottom: 0;
  left: unset;
  height: 100%;
  background: #fff;
  z-index: 101;
  transition: transform 225ms cubic-bezier(0, 0, 0.2, 1) 0ms;
  box-shadow: -4px 4px 4px 0 rgba(0, 0, 0, 0.25);
}

.sidepanel-status {
  font-weight: bold;
  font-size: 14px;
  padding: 0;
}

.todo-checkbox-and-label {
  display: flex;
  align-items: flex-start;
  flex-basis: 50%;
}

.todo-content {
  display: flex;
  border-bottom: 1px solid rgba(190, 190, 197);
  justify-content: space-between;
  align-items: center;
}

.open-left-wrap {
  position: fixed;
  width: calc(100% - 350px);
  top: 62px;
  left: 0;
  bottom: 0;
  right: unset;
  background: transparent;
  z-index: 10;
}

.sidepanel-tab {
  height: 30px;
  width: 140px;
  text-align: center;
  transform: rotate(-90deg);
  background: #fff;
  position: absolute;
  top: calc(50% - 50px);
  border-top-left-radius: 4px;
  border-top-right-radius: 4px;
  left: -84px;
  cursor: pointer;
  box-shadow: -3px -6px 6px rgba(0, 0, 0, 0.25);
  display: flex;
  justify-content: space-evenly;
  align-items: center;
}

.sidepanel-tab span {
  display: inline-block;
}

.sidepanel-input {
  font-size: 14px;
  padding: 10px;
  border: none;
}

.sidepanel-input-label {
  width: 120px;
  font-size: 14px;
  padding: 10px;
  word-wrap: break-word;
  display: inline-block;
}

.sidepanel-input-open-state {
  width: 190px;
}

.sidepanel-input:focus {
  outline: none;
  font-size: 14px;
  border: 1px solid #b6b6b6;
  border-radius: 5px;
  padding: 10px;
}

.open-panel {
  transition: right 0.5s ease-in-out;
}

.close-panel {
  right: -350px;
  transition: 0.5s;
}

.sidepanel-inner-top {
  padding: 15px;
  align-items: center;
  font-weight: bold;
  justify-content: space-between;
  background-color: rgba(236, 237, 239);
  font-size: 18px;
  color: #000;
  cursor: pointer;
  align-items: left;
  display: flex;
  border-bottom: 1px solid rgba(190, 190, 197);
  border-top-right-radius: 10px;
  border-top-left-radius: 10px;
}

.sidepanel-inner-content {
  padding: 15px;
  border-bottom-right-radius: 10px;
  border-bottom-left-radius: 10px;
}

.sidepanel-inner {
  margin: 20px;
  overflow: auto;
  margin-bottom: 40px;
  border: solid rgba(190, 190, 197);
  border-width: 1px;
  border-radius: 10px;
}

.sidepanel-inner-content .MuiButtonBase-root {
  width: 100px;
}

.sidepanel-inner-content .MuiAccordionSummary-expandIconWrapper > svg {
  color: #3281e2;
}

.sidepanel-inner .MuiPaper-elevation {
  box-shadow: none !important;
}

.sidepanel-inner .MuiButtonBase-root {
  padding: 0 !important;
  height: 28px !important;
  min-height: 28px !important;
}

.sidepanel-inner .MuiAccordionDetails-root {
  padding: 0px 10px 0px 10px !important;
}

.sidepanel-error {
  color: red;
  font-size: 14px;
  display: block;
  text-align: left;
}

@media screen and (min-width: 768px) {
  .sidepanel {
    top: 80px;
    width: 500px;
  }

  .close-panel {
    right: -500px;
  }

  .sidepanel-input-label {
    width: 180px;
  }

  .sidepanel-input-open-state {
    width: 290px;
  }

  .open-left-wrap {
    width: calc(100% - 500px);
  }
}

@media screen and (min-width: 1536px) {
  .sidepanel {
    top: 111px;
    width: 600px;
  }

  .close-panel {
    right: -600px;
  }

  .sidepanel-input-label {
    width: 250px;
  }

  .sidepanel-input-open-state {
    width: 375px;
  }

  .open-left-wrap {
    width: calc(100% - 600px);
  }
}

.resources_tab .b-grid-panel-body {
  min-height: 200px;
}

.bldr-popup-action-wrap-left {
  display: flex;
}

.bldr-plus-icon-popup {
  padding: 8px;
  background: #e1e6dc;
}

.bldr-plus-icon-popup:hover {
  background: #b9ddaf;
}

.bldr-trash-icon-popup {
  padding: 8px;
  background: #e8dddc;
}

.bldr-trash-icon-popup:hover {
  background: #e2a8ac;
}
`,""]);const M=te},32784:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`/* Chrome, Safari, Edge, Opera */
input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Firefox */
input[type='number'] {
  -moz-appearance: textfield;
}

/*.MuiList-root li {*/
/*  margin: 5px !important;*/
/*}*/

.b-grid-cell {
  font-size: 0.85em;
  font-style: normal;
}

.grid-phase-cell {
  border-right: none !important;
}

.b-grid-header-text {
  font-size: 0.85em;
  color: #000;
  font-style: normal;
}

.b-sch-header-timeaxis-cell {
  font-size: 0.75em !important;
}

.b-cal-event-desc,
.b-list-item {
  font-size: 0.8em !important;
}

.b-toolbar .b-toolbar-content {
  overflow: hidden;
  padding: 0.5em;
  gap: 0 !important;
}

.my-editor {
  width: 200px;
}

.b-calendar-day-header {
  color: #4f5964;
}

.b-button.b-icon {
  color: #4f5964 !important;
}

.b-gridbase:not(.b-animating) .b-grid-row:not(.b-grid-row-updating) * {
  display: flex;
}

.b-cal-agenda
  .b-cal-event-bar-container
  .b-cal-event-wrap:not(.b-solid-bar).b-selected
  .b-cal-event
  .b-cal-event-body {
  color: #606060 !important;
}

.addTask-button {
  background-color: #d1d0d0;
  border-radius: 4px;
  color: #606263;
  cursor: pointer;
  width: 28px;
  height: 30px;
  border: none;
  box-shadow: none;
  align-items: center;
  display: flex !important;
  justify-content: center !important;
  margin-left: 5px;
}

.editTask-button {
  background-color: #d1d0d0;
  border-radius: 4px;
  color: white;
  cursor: pointer;
  width: 28px;
  height: 30px;
  border: none;
  box-shadow: none;
  align-items: center;
  display: flex !important;
  justify-content: center !important;
}

.parent-div {
  align-items: center;
  border: none;
}

.parent-div .child2-div {
  position: absolute;
  right: 0;
}

.b-tree-cell-inner .b-tree-cell-value {
  position: relative;
}

.bryntum-grid-wrap .b-grid-headers .b-grid-header.grid-phase-cell,
.bryntum-grid-wrap .b-grid-subgrid .b-grid-row .b-grid-cell.b-tree-cell {
  border-right: none;
  border-inline-end: none !important;
}

.edit-parent .edit-wrap {
  position: absolute;
  right: 0;
}

.b-react-portal-container {
  width: 100%;
  position: relative;
}

.edit-parent {
  position: relative;
  display: flex;
  width: 100%;
  align-items: center;
}

.b-fa {
  cursor: pointer;
}

.b-tree-leaf-cell {
  position: relative;
}

.edit-parent {
  display: flex;
}

.edit-parent .edit-wrap {
  visibility: hidden;
}

.b-grid-row:hover .edit-wrap {
  visibility: visible;
}

.css-wgwye8 .css-pcc8aa {
  display: none;
}

.b-grid-panel-body {
  margin: 15px 10px 15px 15px;
}

@media only screen and (max-width: 767px) {
  .b-grid-panel-body {
    max-height: calc(100vh - 191px);
  }
}

.csv-disable {
  pointer-events: none;
  border-left: 0 !important;
  border-color: #dadbde !important;
}

.csv-disable span {
  color: #aaa !important;
}

.csv_link_export span {
  color: #000 !important;
}

.b-buttongroup .b-disabled {
  color: #aaa !important;
  text-transform: uppercase;
}

.csv_link_export:hover {
  background-color: #cfcfd3 !important;
}

@media only screen and (max-width: 1280px) and (min-width: 1000px) {
  .csv-disable,
  .csv_link_export {
    padding: 6px 10px !important;
  }
}

@media only screen and (max-width: 500px) {
  .csv-disable,
  .csv_link_export {
    right: 71px !important;
  }
}

.MuiSnackbar-root {
  z-index: 100000 !important;
}

.b-tree-parent-row,
.parentGroupForGantt {
  background-color: #eee;
}

.b-tree-parent-row .b-grid-cell,
.b-tree-parent-row .b-tree-cell-inner .b-icon,
.b-tree-parent-row .b-tree-cell-inner .b-tree-cell-value,
.parentGroupForGantt .b-grid-cell,
.parentGroupForGantt .b-tree-cell-inner .b-icon,
.parentGroupForGantt .b-tree-cell-inner .b-tree-cell-value {
  color: #000;
  font-weight: 500;
}

.b-sticky-headers .b-timeaxis {
  margin-left: -9px !important;
}

.bryntum-grid-wrap .b-check-cell {
  min-width: 60px !important;
}

.bryntum-grid-wrap .b-tree-parent-row .b-number-cell,
.bryntum-grid-wrap .b-tree-parent-row .b-date-cell {
  pointer-events: none;
}

@media only screen and (max-width: 820px) {
  .bryntum-grid-wrap .name-header-grid,
  .bryntum-grid-wrap .b-tree-parent-cell,
  .bryntum-grid-wrap .b-tree-leaf-cell {
    min-width: 400px !important;
    border: none !important;
  }
}

.b-sch-event-content {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: space-around;
  font-size: 1.1em;
  padding: 0.5em 0;
  width: 100% !important;
}

.delivered-icon {
  height: 26px;
  flex-grow: 0;
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: center;
  gap: 8px;
  padding: 8px;
  border-radius: 5px;
  background-color: #3183fe;
  color: #fff;
  font-size: medium;
}

.icon-cls {
  width: min-content !important;
  height: 30px !important;
  top: 3px !important;
}

.b-cal-event {
  height: fit-content !important;
}

.b-sch-dependency {
  stroke-width: 3 !important;
}

.b-checkbox-label {
  font-size: 0.8em !important;
}

.b-checkbox-label::before {
  font-size: 0.8em !important;
}

.b-resourcefilter {
  max-width: 40vh;
}

.project-level-schedule .b-resourcefilter li:nth-child(2) {
  display: none !important;
}

.b-dayview-day-container .b-event-header {
  display: none !important;
}

.task-cls {
  display: flex !important;
  top: 30px !important;
  position: absolute !important;
}

.working-day {
  display: flex;
  color: #000000;
  padding: 1px 0.2em 0.1em 0.2em;
  max-height: 1.8em;
  align-items: center;
  justify-content: center;
}

.non-working-day {
  display: flex;
  color: #d9d9d9;
  padding: 1px 0.2em 0.1em 0.2em;
  max-height: 1.8em;
  align-items: center;
  justify-content: center;
}

.fontsize .b-field-inner .b-checkbox-label::before {
  background-color: #27ca37 !important;
  border: 'none' !important;
  color: white !important;
}

.bullet-style .b-icon-tree-leaf:before,
.bullet-style .b-cal-event-icon,
.bullet-style.b-selected .b-cal-event-icon,
.bullet-style.b-selected .b-cal-event,
.bullet-style .b-cal-event:hover,
.bullet-style.b-active
  .b-cal-event-bar-container
  .b-cal-event-wrap:not(.b-allday)
  .b-cal-event,
.b-cal-event-bar-container .bullet-style:not(.b-allday) .b-cal-event,
.bullet-style.b-selected
  .b-cal-event-bar-container
  .b-cal-event-wrap:not(.b-allday)
  .b-cal-event {
  color: var(--todo-pill-bullet) !important;
}

.b-sch-color-none.b-gantt-task-wrap > .b-gantt-task.bullet-style {
  border-color: var(--todo-pill-bullet) !important;
}

.b-dayview-day-container
  .b-calendar-cell
  .bullet-style
  .b-cal-event
  > div
  > div
  > div {
  color: #606060;
}

.bullet-style.b-selected .b-cal-event-icon,
.b-cal-event-bar-container
  .bullet-style:not(.b-solid-bar).b-active
  .b-cal-event
  .b-cal-event-icon {
  color: #fff !important;
}

.b-dayview-day-container .b-calendar-cell .bullet-style .b-cal-event {
  background-color: var(--todo-pill-bullet) !important;
}

/* Gantt default popup styling */
.b-taskeditor.b-gantttaskeditor {
  border-radius: 4px !important;
  font-family: 'acumin-pro' !important;
  box-shadow: 0px 11px 15px -7px rgba(0, 0, 0, 0.2),
    0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12) !important;
}

.b-taskeditor.b-gantttaskeditor .b-raised.b-blue {
  padding: 13px 12px;
  font-size: 14px;
  font-weight: 600;
  background-color: var(--light-info-main);
  letter-spacing: 0.46px;
  transition: 0.5s;
  color: #fff;
  border-radius: 4px;
  border: none;
  cursor: pointer;
}

.b-taskeditor.b-gantttaskeditor .b-raised.b-blue:hover {
  background-color: var(--light-primary-dark);
}

.b-taskeditor.b-gantttaskeditor
  .b-bottom-toolbar
  .b-button.b-text:nth-child(2) {
  padding: 13px 12px;
  margin-right: 10px;
  font-size: 14px;
  font-weight: 600;
  background-color: var(--light-secondary-main);
  letter-spacing: 0.46px;
  transition: 0.5s;
  color: #fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.b-taskeditor.b-gantttaskeditor .b-general-tab .b-widget.b-textfield label,
.b-taskeditor.b-gantttaskeditor .b-general-tab .b-widget.b-numberfield label {
  width: 20% !important;
  position: static;
  text-align: end;
  font-size: 0.9em !important;
  text-transform: uppercase;
  color: #4f5964 !important;
  font-size: 15px !important;
}

.b-taskeditor.b-gantttaskeditor
  .b-general-tab
  .b-widget.b-textfield
  .b-field-inner,
.b-taskeditor.b-gantttaskeditor
  .b-general-tab
  .b-widget.b-numberfield
  .b-field-inner {
  width: 82%;
  flex: none;
  position: static;
  border-radius: 5px;
  border: 1px solid var(--light-warning-white);
}

.b-taskeditor.b-gantttaskeditor
  .b-general-tab
  .b-textfield.b-contains-focus
  .b-field-inner,
.b-taskeditor.b-gantttaskeditor
  .b-general-tab
  .b-numberfield.b-contains-focus
  .b-field-inner {
  border-color: #000;
}

.b-taskeditor.b-gantttaskeditor .b-general-tab .b-widget.b-numberfield,
.b-taskeditor.b-gantttaskeditor .b-general-tab .b-widget.b-textfield {
  margin-top: 5px;
}

.b-taskeditor.b-gantttaskeditor
  .b-general-tab
  .b-widget.b-textfield
  .b-field-inner::before,
.b-taskeditor.b-gantttaskeditor
  .b-general-tab
  .b-widget.b-numberfield
  .b-field-inner::before {
  background-color: transparent;
}

.b-taskeditor.b-gantttaskeditor
  .b-general-tab
  .b-widget.b-textfield
  .b-field-inner
  > input,
.b-taskeditor.b-gantttaskeditor
  .b-general-tab
  .b-widget.b-numberfield
  .b-field-inner
  > input {
  padding: 18px !important;
  font-weight: 400;
  font-size: 15px;
  color: #4f5964;
}

.b-popup-header.b-gantttaskeditor-header {
  font-family: 'acumin-pro' !important;
  background-color: var(--bfs-primary-gray);
  font-family: 'acumin-pro';
  font-weight: 500;
  color: #fff;
  font-size: 1.5rem;
  padding: 15px 20px;
  border-bottom: none !important;
}

.b-gantttaskeditor-content,
.b-box-center .b-bottom-toolbar {
  background-color: var(--graythorne-grays-gray-1) !important;
  font-family: 'acumin-pro' !important;
  padding: 20px 0 0 !important;
}

.b-gantttaskeditor-content .b-card-container-panel .b-tabpanel-body {
  background-color: var(--graythorne-grays-gray-1) !important;
  font-family: 'acumin-pro' !important;
  padding: 30px 20px 0 !important;
}

.b-gantttaskeditor-content .b-toolbar.b-tabbar.b-dock-top {
  border-bottom: none !important;
}

.b-box-center .b-bottom-toolbar {
  padding-top: 40px;
}

.b-top-toolbar .b-tabpanel-tabs {
  padding: 0 20px !important;
  border-bottom: 1px solid #aaa;
  background-color: var(--graythorne-grays-gray-1);
  font-family: 'acumin-pro' !important;
}

.b-top-toolbar .b-tabpanel-tabs .b-tabpanel-tab {
  padding: 12px;
  background-color: var(--graythorne-grays-gray-1);
  letter-spacing: 1px;
  color: var(--light-warning-grey-black);
}

.b-top-toolbar .b-tabpanel-tabs .b-tabpanel-tab.b-active {
  background-color: var(--light-info-contrast);
  background-color: var(--light-info-contrast) !important;
  color: var(--light-warning-grey-black) !important;
  border-bottom: 1px solid var(--light-warning-dark-grey) !important;
}

.b-datepicker .b-calendar-weekdays,
.b-datepicker .b-calendar-weekdays,
.b-datepicker .b-toolbar.b-dock-top {
  background-color: var(--bfs-leght-gray-light) !important;
}

.b-datepicker
  .b-calendar-cell.b-selected-date:not(.b-in-range)
  > .b-datepicker-cell-inner {
  background-color: var(--bfs-primary-gray) !important;
  border-color: var(--bfs-primary-gray) !important;
}

.b-datepicker .b-field,
.b-datepicker-title {
  color: var(--common-black-100-p) !important;
}

.b-datefield.b-open .b-widget.b-fieldtrigger {
  color: var(--light-warning-grey-svg) !important;
}

.b-datepicker
  .b-calendar-cell:not(.b-disabled-date, .b-selected-date)
  > .b-datepicker-cell-inner:hover {
  background-color: rgba(0, 0, 0, 0.04) !important;
}

.b-gantttaskeditor-content .b-advancedtab .b-pickerfield.b-resize-monitored {
  display: none;
}

.b-gantttaskeditor-content .b-successorstab .b-toolbar-content .b-add-button,
.b-gantttaskeditor-content .b-predecessorstab .b-toolbar-content .b-add-button {
  color: green !important;
  background-color: var(--light-info-contrast) !important;
}

.b-gantttaskeditor-content .b-advancedtab .b-last-visible-child {
  margin-top: 0 !important;
}

.b-gantttaskeditor-content .b-successorstab .b-toolbar-content .b-remove-button,
.b-gantttaskeditor-content
  .b-predecessorstab
  .b-toolbar-content
  .b-remove-button {
  color: red !important;
  background-color: var(--light-info-contrast) !important;
}

.b-grid-body-wrap .b-grid-subgrid .b-tree-cell-inner {
  word-break: break-word !important;
}

.b-gantttaskeditor
  .b-content-element.b-generaltab
  > .b-pickerfield.b-field.b-half-width,
.b-gantttaskeditor .b-content-element > .b-field.b-half-width {
  flex: 0 0 100% !important;
}

.b-popup.b-messagedialog header.b-messagedialog-header {
  border-bottom: none;
}

.b-popup.b-messagedialog .b-messagedialog-body-wrap .b-messagedialog-content {
  background: #ebe8e6;
}

.b-popup.b-dependencyeditor.b-header-dock-top .b-dependencyeditor-header {
  font-family: 'acumin-pro' !important;
  background-color: var(--bfs-primary-gray);
  font-family: 'acumin-pro';
  font-weight: 500;
  color: #fff;
  font-size: 1rem;
  padding: 15px 20px;
  border-bottom: none !important;
}

.b-popup.b-dependencyeditor.b-header-dock-top .b-widget.b-button {
  padding: 13px 12px;
  margin-right: 10px;
  font-size: 14px;
  font-weight: 600;
  background-color: var(--light-secondary-main);
  letter-spacing: 0.46px;
  transition: 0.5s;
  color: #fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.b-popup.b-dependencyeditor.b-header-dock-top .b-gray.b-box-item {
  background-color: var(--light-secondary-main);
}

.b-popup.b-dependencyeditor.b-header-dock-top .b-green.b-box-item {
  background-color: var(--light-info-main);
}

.b-popup.b-dependencyeditor.b-header-dock-top .b-gray.b-last-visible-child {
  background: transparent;
  border: 1px solid #bbb;
  color: #bbb;
}

.b-popup.b-dependencyeditor.b-header-dock-top {
  box-shadow: 0px 11px 15px -7px rgba(0, 0, 0, 0.2),
    0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12) !important;
}

.b-popup.b-dependencyeditor.b-header-dock-top .b-dock-bottom.b-bottom-toolbar {
  margin-top: 20px;
}

.b-popup.b-dependencyeditor.b-header-dock-top .b-textfield .b-label {
  position: static !important;
  text-transform: uppercase !important;
}

.b-popup.b-dependencyeditor.b-header-dock-top
  .b-textfield.b-contains-focus
  .b-field-inner {
  background-color: #fff;
  border-color: #ccc;
}

.b-gantttaskeditor-content .b-successorstab .b-toolbar-content .b-add-button,
.b-gantttaskeditor-content .b-predecessorstab .b-toolbar-content .b-add-button {
  color: green !important;
  background-color: var(--light-info-contrast) !important;
}

.b-gantttaskeditor-content .b-successorstab .b-toolbar-content .b-remove-button,
.b-gantttaskeditor-content
  .b-predecessorstab
  .b-toolbar-content
  .b-remove-button {
  color: red !important;
  background-color: var(--light-info-contrast) !important;
}

/* ------------------------ */

.budgeting-bfs-row {
  background-color: var(--bfs-primary-true-white) !important;
  color: var(--common-black-100-p) !important;
}

.handsontable thead th {
  background-color: var(--bfs-leght-gray-header) !important;
}

.budgeting-other-row {
  background-color: var(--bfs-secondary-support-gray-light) !important;
  align-items: center;
  color: var(--common-black-100-p) !important;
}

.budgeting-row {
  display: flex !important;
  align-items: center !important;
}

.hot-header {
  font-weight: bold;
}

.handsontable table td.htInvalid {
  background-color: var(--bfs-primary-true-white) !important;
}

.b-grid-row.pavel {
  background-color: #eeeeee;
}

.b-grid-header {
  border-inline-end: 1px solid #c2c1c1 !important;
}

.b-grid-cell {
  border-inline-end: 1px solid #c2c1c1 !important;
}

.b-grid-row {
  border-bottom: 1px solid #c2c1c1 !important;
  border-inline-start: 1px solid #c2c1c1 !important;
}

.b-grid-headers {
  border-bottom: 1px solid #c2c1c1 !important;
  border-top: 1px solid #c2c1c1 !important;
  border-inline-start: 1px solid #c2c1c1 !important;
}

.b-slidetoggle .b-slidetoggle-label,
:not(.b-fieldset-has-label) > .b-checkbox .b-checkbox-label {
  font-size: 0.5em;
}

.b-checkbox-selection {
  background-color: white !important;
  width: 4.7em !important;
}

.coming-soon-budget {
  width: 930px;
  height: 532px;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  gap: 24px;
  margin: auto;
  padding: 48px 0;
}

.coming-soon-heading {
  font-size: 22px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  color: var(--light-text-primary);
}

.coming-soon-title {
  font-size: 20px;
  font-weight: normal;
  font-stretch: normal;
  font-style: normal;
  line-height: 1;
  letter-spacing: normal;
  color: var(--light-text-primary);
}

.budget-action-links li {
  padding: 5px;
  display: inline-block;
  margin-right: 15px;
  font-weight: 700;
  color: #368eff;
  min-width: 80px;
}

.budget-action-links .qb-grey-link {
  color: #aaa;
}

.budget-action-links .qb-blue-link {
  cursor: pointer;
}
.bullet-style .b-cal-event {
  background-color: #ee7850 !important;
}

.b-cal-event-bar-container .bullet-style:not(.b-allday) .b-cal-event {
  background-color: transparent !important;
}

.applyTemplateLoader {
  position: absolute;
  width: 100%;
}

.grey-effect-box {
  opacity: 0.4;
}

.b-ganttbase.b-timelinebase .b-mask.b-delayed-show {
  opacity: 1;
}

.dialog-div .centered-loader {
  padding-top: 0 !important;
}

.b-list.b-resourcefilter.empty-list-project-level:before,
.b-list.b-resourcefilter.b-empty:before {
  content: 'No projects found.';
  display: block;
  display: inline-block;
  padding: 10px 0;
}
`,""]);const M=te},99973:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.navButton > a {
  display: flex;
  padding-top: 8px;
  padding-bottom: 8px;
  flex-direction: column;
  justify-content: center;
  align-items: flex-end;
  gap: 4px;
  text-align: right;
  font-feature-settings: 'clig' off, 'liga' off;
  font-family: acumin-pro;
  font-size: 12px;
  font-style: normal;
  font-weight: 400;
  line-height: normal;
  align-self: stretch;
}
.nav-disabled > a {
  pointer-events: none;
  color: #eae8e6;
}
.button-selected {
  background-color: #3281e6;
  color: white;
}
.button-selected > a {
  color: white;
}
.button-unselected {
  background: #fff;
  color: black;
}
.button-unselected:hover {
  background: #f2f2f2;
}
.button-unselected > a {
  color: black;
}
.icon {
  display: flex;
  height: 68px;
  width: 68px;
  border-radius: 8px;
  margin-bottom: 3px;
  justify-content: center;
  align-items: center;
  text-align: center;
}
.icon:hover {
  cursor: pointer;
}
.icon-unselected {
  border: 1px solid #ccc9c7;
  background: #fff;
}
.icon-unselected:hover {
  background: #368eff;
}
.icon-unselected:hover rect {
  fill: white;
}
.icon-unselected:hover path {
  fill: white;
}
.icon-selected {
  background: #cc0012;
  border: none;
}
.selected rect {
  fill: white;
}
.selected path {
  fill: white;
}
.icon-disabled {
  pointer-events: none;
  border: solid 1px var(--graythorne-grays-gray-2);
}
.disabled rect {
  fill: var(--graythorne-grays-gray-2);
}

.disabled path {
  fill: var(--graythorne-grays-gray-2);
}
a {
  text-decoration: none;
  text-align: center;
  color: black;
}
`,""]);const M=te},24581:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>Ae});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=m(34967),M=g()(ae());M.i(te.A),M.push([ze.id,`.App {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: lightgrey;
  align-items: center;
}

html,
body {
  height: 100%;
  width: 100%;
  overscroll-behavior-x: none;
}

#root {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
}

:root {
  --bfs-primary-medium-blue: #003087;
  --bfs-primary-accent-blue: #307fe2;
  --bfs-primary-true-white: #fff;
  --bfs-primary-gray: #333333;
  --bfs-primary-accent-blue: #307fe2;
  --bfs-primary-builders-blue: #00205b;
  --bfs-primary-bfs-red: #c8102e;
  --bfs-primary-true-black: #000;
  --bfs-secondary-support-gray-dark: #757b7b;
  --bfs-secondary-support-gray-medium: #a7aba9;
  --bfs-secondary-support-gray-light: #f1f0ef;
  --bfs-secondary-support-gray-very-light: #f1f0ef;
  --bfs-primary-true-black: #000;
  --bfs-secondary-support-blue-light: #d6e5f9;
  --bfs-secondary-support-blue-medium: #b3c1db;
  --bfs-secondary-support-blue-dark: #8090ad;
  --cal-color-black: #000;
  --bfs-primary-green: #25a122;
  --light-white: #fff;
  --light-black: #000;
  --bfs-11-22-teal: #18979f;
  --bfs-11-22-pack-background-blue: #2b70c7;
  --a-black: #000;
  --bfs-leght-gray-header: #dddad8;
  --bfs-leght-gray-light: #ddd;
  --todo-pill-bullet: #ee7850;
  --todo-header-background: #df67670a;
}

body {
  margin: 0;
  font-family: 'acumin-pro', -apple-system, BlinkMacSystemFont, 'Segoe UI',
    'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans',
    'Helvetica Neue', sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: #e5e5e5;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}

.pendo-resource-center-badge-notification-bubble {
  position: absolute !important;
  margin-top: 15px !important;
  margin-left: 5px !important;
  left: 10px !important;
  width: 16px !important;
  height: 16px !important;
  display: flex !important;
  font-size: 12px !important;
  font-weight: bold !important;
}

.pendo-notification-bubble-unread-count {
  line-height: 16px !important;
  position: relative !important;
  top: 0px !important;
  font-size: 10px !important;
}
`,""]);const Ae=M},65941:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.tT9AcqS55ibx6k7C1QhO {
  margin-bottom: .9rem;
  display: flex;
}

.BHZ5gANDVEqqlxnKsTJE {
  display: none;
}

.DKWgkJXGhqXnREjtpej1 {
  position: relative;
  padding-left: 30px;
  cursor: pointer;
  margin-right: 12px;
}

.ptdPecmsPTJuTaYTGVhp {
  position: absolute;
  top: 3px;
  left: 0;
  width: 1rem;
  height: 1rem;
  border: 1px solid var(--graythorne-grays-gray-3);
  background-color: #fff;
  transition: background-color 0.3s;
  display: inline-block;
  border-radius: 2px;
}

.BHZ5gANDVEqqlxnKsTJE:checked + .ptdPecmsPTJuTaYTGVhp::after {
  content: '';
  display: block;
  position: absolute;
  top: 1px;
  left: 5px;
  width: 4px;
  height: 9px;
  border: solid #229920;
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

@media screen and (min-width: 1200px) {
  .DKWgkJXGhqXnREjtpej1 {
    font-size: 0.71rem;
  }

  .ptdPecmsPTJuTaYTGVhp {
    top: 0;
  }
}

@media screen and (min-width: 1536px) {
  .DKWgkJXGhqXnREjtpej1 {
    font-size: 1rem;
  }

  .ptdPecmsPTJuTaYTGVhp {
    top: 3px;
  }
}

.BHZ5gANDVEqqlxnKsTJE:disabled {
  cursor: not-allowed;
}

.BHZ5gANDVEqqlxnKsTJE:disabled + .ptdPecmsPTJuTaYTGVhp {
  border: 1px solid #e0e0e0;
  background-color: white;
}

.BHZ5gANDVEqqlxnKsTJE:disabled:checked + .ptdPecmsPTJuTaYTGVhp::after {
  border-color: rgba(34, 153, 32, 0.3) !important;
}
.gV3HJbjHenNX3t1kJRL8 {
    background-color: var(--bfs-primary-true-white);
}

.ZOrE7XH7QgmYmniBei3Z {
  padding-top: .18rem;
  padding-right: 12px;
}`,""]),te.locals={checkboxContainer:"tT9AcqS55ibx6k7C1QhO",hiddenCheckbox:"BHZ5gANDVEqqlxnKsTJE",customCheckbox:"DKWgkJXGhqXnREjtpej1",styledCheckbox:"ptdPecmsPTJuTaYTGVhp","MuiDialogContent-root":"gV3HJbjHenNX3t1kJRL8",checkboxLabel:"ZOrE7XH7QgmYmniBei3Z"};const M=te},65258:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`.delivery-dialog-company .MuiDialog-paper {
  width: 734px;
  max-width: 900px !important;
}

.header-div {
  background-color: var(--graythorne-grays-gray-5);
  color: white;
  padding: 20px;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
}

.dialog-title {
  font-size: 28px;
  font-weight: bold;
}

.divider-div {
  width: 100%;
  background-color: #febe5e;
  height: 4px;
}

.close-button {
  height: 48px;
  width: 85px;
  flex-grow: 0;
  font-size: 16px;
  font-weight: normal;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.75;
  letter-spacing: 0.46px;
  color: #91919b;
}

.col-pack-name {
  width: 174px;
}

.col-project-name {
  width: 174px;
}

.col-delivery-id {
  text-align: center;
  width: 100px;
}

.col-delivery-photos {
  text-align: center;
  width: 60px;
  margin-left: 40px;
  display: inline-flex;
}

.col-view {
  text-align: center;
  color: #2b89f1;
  cursor: pointer;
  width: 162px;
}
`,""]);const M=te},34967:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(31601),ae=m.n(e),ce=m(76314),g=m.n(ce),te=g()(ae());te.push([ze.id,`:root {
  --chip-secondary-background: #f4f5f5;
  --chip-secondary-text: #3e4041;
  --chip-primary-background: #ecf3fc;
  --chip-primary-text: #1d6bcd;
  --chip-success-background: #edf5eb;
  --chip-success-text: #177802;
  --chip-warning-background: #fff2cc;
  --chip-warning-text: #93370d;
  --chip-error-background: #fae6e8;
  --chip-error-text: #a50722;
  --chip-info-background: #e9f5fb;
  --chip-info-text: #1273b8;
  --light-other-snackbar: #323232;
  --light-text-primary: rgba(0, 0, 0, 0.87);
  --light-text-secondary-shades-4-p: rgba(0, 0, 0, 0.04);
  --light-secondary-shades-4-p: rgba(0, 0, 0, 0.04);
  --light-text-secondary: rgba(0, 0, 0, 0.6);
  --light-text-disabled: rgba(0, 0, 0, 0.38);
  --light-text-secondary-shades-18-p: rgba(0, 0, 0, 0.18);
  --light-primary-main: #3281e6;
  --light-text-primary-shades-4-p: rgba(0, 0, 0, 0.04);
  --light-primary-shades-4-p: rgba(0, 0, 0, 0.04);
  --light-text-primary-shades-30-p: rgba(0, 0, 0, 0.3);
  --light-text-primary-shades-12-p: rgba(0, 0, 0, 0.12);
  --light-primary-dark: #2b70c7;
  --light-primary-light: #bfd4ee;
  --light-primary-contrast: #fff;
  --light-secondary-main: #818181;
  --light-secondary-dark: #555352;
  --light-secondary-light: #cccbcb;
  --light-secondary-contrast: #fff;
  --light-action-active-54-p: rgba(0, 0, 0, 0.54);
  --light-action-hover-4-p: rgba(0, 0, 0, 0.04);
  --light-action-disabled-26-p: rgba(0, 0, 0, 0.26);
  --light-action-selected-8-p: rgba(0, 0, 0, 0.08);
  --light-action-disabled-background-12-p: rgba(0, 0, 0, 0.12);
  --light-action-focus-12-p: rgba(0, 0, 0, 0.12);
  --light-action-shades-30-p: rgba(0, 0, 0, 0.3);
  --light-error-main: #e30014;
  --light-error-light: #f0b3b8;
  --light-error-dark: #cc0012;
  --light-error-contrast: #fff;
  --light-error-shades-4-p: rgba(211, 47, 47, 0.04);
  --light-error-shades-12-p: rgba(211, 47, 47, 0.12);
  --light-error-shades-30-p: rgba(211, 47, 47, 0.3);
  --light-error-shades-160-p: #d32f2f;
  --light-error-shades-190-p: #d32f2f;
  --light-error-shades-50-p: rgba(211, 47, 47, 0.5);
  --light-warning-main: #fea828;
  --light-warning-dark: #ec991e;
  --light-warning-contrast: #fff;
  --light-warning-grey: #aaa;
  --light-warning-grey-black: #212121;
  --light-warning-dark-grey: #bbb;
  --light-warning-grey-svg: #bdbdbd80;
  --light-warning-black-shade: #4f5964;
  --light-warning-border: #6f7781;
  --light-warning-white: #d0d1d2;
  --light-warning-white-border: #fff5e6;
  --light-warning-light: #f9e0bc;
  --light-warning-shades-4-p: rgba(237, 108, 2, 0.04);
  --light-warning-shades-12-p: rgba(237, 108, 2, 0.12);
  --light-warning-shades-30-p: rgba(237, 108, 2, 0.3);
  --light-warning-shades-50-p: rgba(237, 108, 2, 0.5);
  --light-warning-shades-160-p: #ed6c02;
  --light-warning-shades-190-p: #ed6c02;
  --light-info-main: #3281e6;
  --light-info-light: #bfd4ee;
  --light-info-dark: #2b70c7;
  --light-info-contrast: #fff;
  --light-info-shades-4-p: rgba(2, 136, 209, 0.04);
  --light-info-shades-12-p: rgba(2, 136, 209, 0.12);
  --light-info-shades-30-p: rgba(2, 136, 209, 0.3);
  --light-info-shades-160-p: #0288d1;
  --light-info-shades-50-p: rgba(2, 136, 209, 0.5);
  --light-info-shades-190-p: #0288d1;
  --light-success-dark: #25a122;
  --light-success-main: #2aba27;
  --light-success-contrast: #fff;
  --light-success-shades-4-p: rgba(46, 125, 50, 0.04);
  --light-success-light: #bee3bd;
  --light-success-shades-12-p: rgba(46, 125, 50, 0.12);
  --light-success-shades-30-p: rgba(46, 125, 50, 0.3);
  --light-success-shades-50-p: rgba(46, 125, 50, 0.5);
  --light-success-shades-160-p: #2e7d32;
  --light-success-shades-190-p: #2e7d32;
  --light-background-paper: #fff;
  --light-background-default: #fafafa;
  --light-other-divider: rgba(0, 0, 0, 0.12);
  --light-other-outlined-border-23-p: rgba(0, 0, 0, 0.23);
  --light-other-backdrop-overlay: rgba(0, 0, 0, 0.5);
  --light-other-filled-input-background: rgba(0, 0, 0, 0.06);
  --light-other-standard-input-line: rgba(0, 0, 0, 0.42);
  --light-other-rating-active: #ffb400;
  --common-black-100-p: #000;
  --common-white-30-p: rgba(255, 255, 255, 0.3);
  --common-white-100-p: #fff;
  --graythorne-grays-gray-1: #eae8e6;
  --graythorne-grays-gray-2: #ccc9c7;
  --graythorne-grays-gray-3: #979493;
  --graythorne-grays-gray-4: #555352;
  --graythorne-grays-gray-5: #2c2b2a;
  --graythorne-grays-gray-6: #000;
  --graythorne-greens-green-1: #2ecc2b;
  --graythorne-greens-green-2: #2aba27;
  --graythorne-greens-green-3: #25a122;
  --graythorne-greens-green-4: #1b7619;
  --graythorne-greens-green-5: #0f420e;
  --graythorne-greens-green-6: #082207;
  --graythorne-blues-blue-1: #368eff;
  --graythorne-blues-blue-2: #3281e6;
  --graythorne-blues-blue-3: #2b70c7;
  --graythorne-blues-blue-4: #205293;
  --graythorne-blues-blue-5: #122e52;
  --graythorne-blues-blue-6: #09182a;
  --graythorne-reds-red-1: #ff0017;
  --graythorne-reds-red-2: #ea0015;
  --graythorne-reds-red-3: #cc0012;
  --graythorne-reds-red-4: #97000d;
  --graythorne-reds-red-5: #550007;
  --graythorne-reds-red-6: #2c0004;
  --graythorne-yellows-yellow-1: #ffaf36;
  --graythorne-yellows-yellow-2: #ea9f31;
  --graythorne-yellows-yellow-3: #cc8a2a;
  --graythorne-yellows-yellow-4: #97661f;
  --graythorne-yellows-yellow-5: #553911;
  --graythorne-yellows-yellow-6: #2c1e09;
  --bfs-11-22-nav-background-gray: #333333;
  --bfs-11-22-nav-selected-gray: rgba(128, 128, 128.1);
  --bfs-11-22-nav-hovered-gray: rgba(64, 64, 64, 100);
  --bfs-brand-true-white: #fff;
  --bfs-11-22-body-background: #e5e5e5;
  --datagrid-header-background: #d9d9d9;
  --datagrid-header-border: #bfbfbf;
  --datagrid-cell-border: #ccc;
  --datagrid-cell-grey: #999797;
}
`,""]);const M=te},47705:(ze,xe,m)=>{"use strict";var e=m(74848),ae=m(5338);const ce=m.p+"b9a82fcb4254ece18dbed6969846dec9.svg";var g=m(11848);const te=(0,g.Ay)("img")`
  width: 150px;
  margin: 5px auto;

  ${t=>t.theme.breakpoints.up("xs")} {
    height: 55px;
  }
  ${t=>t.theme.breakpoints.up("lg")} {
    height: 70px;
    width: 200px;
  }
  ${t=>t.theme.breakpoints.up("xl")} {
    height: 100px;
    width: 290px;
  }
`,M=(0,g.Ay)("div")`
  display: flex;
  background-color: var(--bfs-primary-gray);
  justify-content: center;
  height: 62px;

  ${t=>t.theme.breakpoints.up("lg")} {
    height: 80px;
  }
  ${t=>t.theme.breakpoints.up("xl")} {
    height: 111px;
  }
`,Ae=()=>jsx(M,{"data-testid":"mybldr-logo-header",children:jsx(te,{alt:"MyBLDR Welcome logo","data-testid":"mybldr-welcome-logo",src:landingLogo})});var d=m(50318),se=m.n(d),Be=m(50779),_=m(42471),K=m(61224),H=m(2543),Se=m.n(H),ve=m(27558),ye=m(68864),Ce=m(71543);const Ke=m.p+"754c7aaa62d58dfc9907523637076c9b.svg",Je=(0,g.Ay)("div")(({theme:t,open:n})=>({fontFamily:"acumin-pro",position:"relative",width:n?"52rem":"0",height:"calc(100vh - 90px)",position:"fixed",zIndex:1,bottom:0,right:0,backgroundColor:"#fff",overflowX:"hidden",transition:t.transitions.create("width",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),boxShadow:"-10px 0 15px -5px rgba(0, 0, 0, 0.5)"})),jt=(0,g.Ay)("button")(({theme:t})=>({position:"absolute",top:"1rem",right:"1rem"})),wt=(0,g.Ay)("div")(({theme:t})=>({display:"flex",alignItems:"center",padding:"0rem 1.5rem",backgroundColor:"#fff",fontWeight:"400",lineHeight:"1.2",textAlign:"left",letterSpacing:"normal",margin:"2px",gap:"10px"})),Ft=(0,g.Ay)("img")({width:"24px",height:"auto"}),Ut=(0,g.Ay)("h3")(({theme:t})=>({fontSize:"24px",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0rem 1.5rem",backgroundColor:"#fff",fontWeight:"600",lineHeight:"1.2",textAlign:"left",letterSpacing:"normal"})),jn=(0,g.Ay)("p")(({theme:t})=>({padding:"1rem 1.5rem",backgroundColor:"#fff",fontWeight:"400",lineHeight:"1.5",textAlign:"left",letterSpacing:"normal"})),rn=(0,g.Ay)("h4")(({theme:t})=>({fontSize:"20px",padding:"0rem 1.5rem",backgroundColor:"#fff",fontWeight:"600",lineHeight:"1.2",textAlign:"left",letterSpacing:"normal",marginBottom:"0rem"})),Vt=(0,g.Ay)("div")({display:"flex",alignItems:"center",gap:"10px",marginTop:"1rem",marginBottom:"1rem",marginLeft:"1.5rem"}),$t=(0,g.Ay)(ve.A)({"&.Mui-checked":{color:"rgb(42, 186, 39)"}}),It=(0,g.Ay)("div")({display:"flex",alignItems:"center",marginBottom:"8px",margin:"0"}),Et=(0,g.Ay)("div")({display:"grid",gridTemplateColumns:"repeat(3, 1fr)",marginLeft:"2rem",gap:"-1rem"}),Bt=(0,g.Ay)(ye.A)({"& .MuiFormControlLabel-label":{marginBottom:"3px"}}),nn=(0,g.Ay)("button")({background:`url(${Ke}) no-repeat center center`,backgroundSize:"contain",width:"44px",height:"44px",border:"none",cursor:"pointer",position:"absolute",top:"15px",right:"25px",padding:0}),Yt=(0,g.Ay)(Ce.A)(({theme:t,color:n="#c8c8c8",height:s="1px",margin:o="1rem"})=>({backgroundColor:n,height:s,margin:o})),et=m.p+"cb5193e6ab905f79407bf8c77c820af9.svg",kt=m.p+"ac3fa2721785e65e3daf73ba55139271.svg",de=m.p+"126ac283432c5c93776b582bc2b28fe6.svg",Ie=m.p+"d8881df94e834f9306d91c9f980229f3.svg",_e=m.p+"4422378aa425c14abb2669d0f8a7e39d.svg",Ve=m.p+"60e0803091be4a7a43f99b80243fa417.svg",Gt=m.p+"bd65f886ec33201d4af99604bf169b4b.svg",wn={MATERIALS:et,DOCUMENTS:kt,CONFIGURE:de,CREWS:Ie,BUDGET:_e,SCHEDULE:Ve,BUILD:Gt},Kt=t=>(0,H.map)(t.split(" "),H.capitalize).join(" "),Fn=({permissions:t,selectedPermissions:n,onPermissionChange:s})=>(0,e.jsx)(Et,{children:t.filter(o=>o.display_name).map((o,r)=>(0,e.jsx)(Bt,{control:(0,e.jsx)($t,{checked:n.has(o.id),onChange:a=>s(o.id,a.target.checked),disabled:n.has(o.id)&&o.required_permission}),label:o.display_name},r))}),Re=({data:t,selectedPermissions:n,onPermissionChange:s})=>t?(0,e.jsx)("div",{style:{marginTop:"1.5rem"},children:Object.entries(t).map(([o,r])=>{const a=wn[o];return a&&(0,e.jsxs)(se().Fragment,{children:[(0,e.jsxs)(Vt,{children:[(0,e.jsx)(Ft,{src:a,alt:`${o} Icon`}),(0,e.jsx)("span",{style:{fontWeight:800},children:Kt(o)})]}),(0,e.jsx)(Yt,{color:"#c8c8c8",height:"1px",margin:"1rem"}),(0,e.jsx)(Fn,{permissions:r,selectedPermissions:n,onPermissionChange:s})]},o)})}):null,Ne=({initialSelectedPermissions:t,setInitialSelectedPermissions:n,isOpen:s,setIsOpen:o,tools:r,onRoleAdded:a,onRoleEdit:i,isEditOpen:l,setIsEditOpen:c,value:u,setValue:p,selectedRoleID:f})=>{const[h,b]=(0,d.useState)(new Set(t));let x=t.length>0;const v=(j,A)=>{const w=new Set(h);A?w.add(j):w.delete(j),b(w)},y=async()=>{if(x){o(!1),c(!1),await i(u,Array.from(h)),p(""),b(new Set([])),n([]),x=!1;return}else o(!1),await a(u,Array.from(h)),p(""),b(new Set(t))};return(0,d.useEffect)(()=>{b(new Set(t))},[t]),(0,e.jsxs)(Je,{open:s,children:[(0,e.jsx)(nn,{"data-testid":"flyout-close-button",onClick:()=>{o(!1),c(!1),n([]),b(new Set),p("")}}),(0,e.jsxs)(Ut,{"data-testid":"flyout-header",children:[" ",x?"Edit Role":"Create New Role"," "]}),(0,e.jsx)(jn,{"data-testid":"flyout-description",children:"Please enter a descriptive name for the role in the 'Role Title' field below. Then, customize the permissions by checking the appropriate boxes across various categories. When you're done, click 'Create Role' to finalize the setup."}),(0,e.jsx)(rn,{children:"Role Title"}),(0,e.jsx)(Be.A,{style:{marginLeft:"1.5rem",marginTop:"0.5rem",width:"300px"},children:(0,e.jsx)(_.A,{label:"e.g. Homebuyer","data-testid":"Role-input",value:u,onChange:j=>p(j.target.value),variant:"outlined",inputProps:{maxLength:25},error:u.length>=20,helperText:u.length>=20?"Max characters reached":" "})}),(0,e.jsx)(Yt,{color:"#7e7e7e",height:"3px",margin:"1.5rem"}),(0,e.jsx)(rn,{children:"Page Permissions"}),(0,e.jsx)(Re,{data:r,selectedPermissions:h,onPermissionChange:v}),(0,e.jsx)(Yt,{color:"#c8c8c8",height:"1px",margin:"1rem"}),(0,e.jsx)("div",{style:{display:"block",marginLeft:"auto",paddingBottom:"1.5rem",height:"2.5rem"},children:(0,e.jsx)(K.A,{style:{marginBottom:"5rem",position:"absolute",right:"1.5rem"},variant:"contained",color:"primary",onClick:y,"data-testid":"Role-button",children:x?"Save Role":"Create Role"})})]})},q=(0,g.Ay)("header")`
  background-color: #dedede;
  padding-right: 0.5rem;
  padding-left: 1.5rem;
  height: 50px;

  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
`,ie=(0,g.Ay)("header")`
  background-color: #dedede;
  padding-right: 0.5rem;
  padding-left: 0.5rem;
  height: 50px;
  line-height: 110%;
  font-weight: 700;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
`,ot=(0,g.Ay)("section")`
  background-color: #f0f0f0;
  padding-left: 2.5rem;
  padding-right: 1rem;
`,qe=(0,g.Ay)("thead")`
  & th {
    font-size: 14px;
    line-height: 1.71;
    letter-spacing: 0.17px;

    height: 3.5rem;
    font-weight: 500;
    width: 25%;
    color: var(--light-text-primary);
  }

  & th.email {
    width: 35%;
  }

  & th.phone,
  & th.perms {
    width: 20%;
  }
`,ft=(0,g.Ay)("section")`
  padding: 2rem;
  padding-left: 2.5rem;
  background-color: white;
`,Jt=(0,g.Ay)("table")`
  margin-bottom: 1.25rem;
  border-spacing: 0;
  width: 100%;

  & th,
  & td {
    border-bottom: 1px solid rgba(0, 0, 0, 0.12);
  }

  & td {
    height: 3.25rem;
    font-size: 14px;
    font-weight: normal;
    font-stretch: normal;
    font-style: normal;
    line-height: 1.43;
    letter-spacing: 0.17px;
  }
`,Ht=(0,g.Ay)("div")`
  width: 724px;
`,Cs=(0,g.Ay)(_.A)`
  padding: 9px 9px 9px 10px;
  && label {
    padding: 9px 9px 9px 10px;
  }
`,Ts=(0,g.Ay)("p")`
  font-weight: 300;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.2;
`,md=(0,g.Ay)("button")`
  background: #818181;
  color: white;
  padding: 5px 10px;
  border: none;
  margin-left: 10px;
  cursor: pointer;
  &:disabled {
    cursor: default;
    opacity: 0.5;
  }
`;var E=m(69067),it=m(73896),I=m(14073),ho=m(52848),Rn=m(15001);const op=(0,g.Ay)(E.A)`
  display: flex;
  width: 100%;
  justify-content: flex-end;
  padding-top: 1rem;
  gap: 0.5rem;
`,rp=(0,g.Ay)("div")`
  display: flex;
  width: 100%;
  padding-top: 1rem;
  gap: 1.25rem;

  button {
    flex-grow: 1;
  }
`,ap=(0,g.Ay)("div")({display:"flex",alignContent:"center",justifyContent:"center",textAlign:"center"}),ip=(0,g.Ay)("div")`
  display: flex;
`,hd=(0,g.Ay)("div")`
  display: flex;
  justify-content: center;
`,lp=(0,g.Ay)("div")({flexGrow:1}),dp=(0,g.Ay)(_.A)`
  // font-family: Roboto;
  font-size: 20px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.1;
  letter-spacing: 0.15px;
  text-align: center;

  & fieldset: {
    border: 'none';
  }
`,cp=(0,g.Ay)(it.A)`
  display: none;
`,Ge=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  justify-content: ${t=>t.justifyContent||"space-between"};
  align-items: ${t=>t.alignItems||"inherit"};
  margin-top: auto;
`,U=(0,g.Ay)("div")`
  display: flex;
  height: 100%;
  justify-content: center;
  align-items: center;
`,oe=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  justify-content: space-between;
`,fe=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
  padding: 0px 0px 15px 0px;
`,be=(0,g.Ay)("div")`
  display: flex;
  align-content: space-between;
  padding: 1rem 1rem 1.125rem 1rem;
  border: solid 1px #76767f;
  background-color: #fefbff;
  margin: 15px 0px 10px 0px;
  width: 80%;
`,Oe=(0,g.Ay)(I.A)`
  height: 2rem;
  flex-grow: 0;
  margin: 1.25rem 0;
  font-size: 1rem;
  font-weight: 300;
  font-stretch: normal;
  font-style: normal;
  line-height: 1;
  letter-spacing: normal;
  text-align: left;
`,tt=(0,g.Ay)("div")`
  width: ${({width:t})=>t};
`,cn=(0,g.Ay)(ho.A)`
  position: fixed;
  bottom: 60px;
  width: 25rem;
  z-index: 50;
  left: 50%;

  transform: translateX(-50%);
`,Bn=(0,g.Ay)(Rn.A)`
  text-decoration: none;
  margin: auto;
`,ya=({children:t,...n})=>(0,e.jsx)("div",{id:"contentWrapper",...n,children:t}),kn=(0,g.Ay)(ya)(({theme:t})=>({display:"flex",marginTop:t.header?.height,flexDirection:"column",flex:1,justifyContent:"flex-start",overflow:"auto"})),zy=()=>jsx(CrewInfoTag,{children:"Company Crew are trusted partners of the company. These members can access all projects and features within myBLDR, but they cannot place orders on Materials."}),Vy=()=>jsx(CrewInfoTag,{children:"Subs are added on a per project basis, and can only view or manage details for specific projects. They can view and edit those projects' Plans, Preview, and Schedule. They can only view those projects' Crew. They cannot view or edit anything on Materials or Budget."}),gd={value:"",dirty:!1},M6=({company:t,crewType:n,project:s,onAdd:o})=>{const[r,a]=useState(gd),[i,l]=useState(!1),[c,u]=useState([]),[p,f]=useState(!1),[h,b]=useState(void 0);useEffect(()=>{c.length&&!h?(b({...c[0]}),u(S=>S.slice(1)),f(!0)):c.length&&h&&p&&setTimeout(()=>{f(!1)},4e3)},[c,h,p]);const x=()=>{f(!1)},v=()=>{b(void 0)},y=(S,R,B)=>{u(T=>[...T,{title:S,message:R,severity:B,key:new Date().getTime()}])},j=(S,R)=>{const B=R?"Add user successful":"Add user failure";let T="";return R?T=n==="field"?`${s?.projectName} project was shared with ${S} email`:`${t?.name} company was shared with ${S} email`:T=n==="field"?`Unable to share ${s?.projectName} project with ${S} email`:`Unable to share ${t?.name} company with ${S} email`,T+=S>1?"s":"",{snackMessage:T,snackTitle:B}},A=!r.dirty||i&&r.dirty,w=S=>{const R=S.target.value;a({value:R,dirty:!0}),i&&l(!1)},P=async S=>{S.key==="Enter"&&await C()},C=async()=>{looksLikeMail(r.value)?(l(!1),k()):l(!0)},k=async()=>{if(o){const S=await o(r.value);if(S.usersAdded?.length>0){const{snackMessage:R,snackTitle:B}=j(S.usersAdded.length,!0);y(B,R,"success")}if(S.errors?.length>0){const{snackMessage:R,snackTitle:B}=j(S.errors.length,!1);y(B,R,"error")}a(gd)}};return jsxs(AddCrewSection,{children:[jsxs(Typography,{variant:"h6",children:["Add ",capitalize(n)," Crew to"," ",n==="company"?t?.name:s?.projectName+" project"]}),n==="company"?jsx(zy,{}):jsx(Vy,{}),jsxs(InputsBox,{children:[jsx(PaddedEmailInput,{id:`add-${n}-crew`,variant:"standard",label:i&&r.dirty?"Email invalid":"Email",value:r.value,onChange:w,onKeyDown:P,error:i,fullWidth:!0,inputProps:{"data-testid":"emails-input"}}),jsxs(ButtonFlexBox,{style:{justifyContent:"flex-start",gap:"1.25rem"},children:[jsx(Button,{sx:{width:300,border:"solid 1px rgba(128, 144, 173, 0.5)",color:"rgba(128, 144, 173)"},variant:"outlined",disabled:!r.value,onClick:()=>a(gd),children:"Cancel"}),jsx(Button,{sx:{width:300},variant:"contained",disabled:A,onClick:()=>C(),"data-testid":"add-users-button",children:"Add User"})]})]}),jsx(Snackbar,{open:p,autoHideDuration:2e3,onClose:x,TransitionProps:{onExited:v},anchorOrigin:{vertical:"bottom",horizontal:"center"},message:h?h.message:void 0,children:jsxs(Alert,{onClose:x,severity:h?.severity,children:[jsx(AlertTitle,{children:h?.title}),h?.message]})},h?h.key:void 0)]})};var we=m(45959),up=m(21447),pp=m(35406),go=m(2071),Ei=m(12390),Ro=m(8676);const $y=m.p+"bfcf9d90ed36d120283c6bd0d520356d.png",Hy=(0,Ro.A)(pp.A)({display:"flex",alignItems:"center",justifyContent:"center"}),Qy=(0,Ro.A)(E.A)({display:"flex",width:"100%",maxWidth:"900px",backgroundColor:"#fff",borderRadius:"8px",overflow:"hidden",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"}),Gy=(0,Ro.A)(E.A)({width:"40%",backgroundColor:"#333",color:"#fff",padding:"24px",display:"flex",flexDirection:"column"}),Ky=(0,Ro.A)(E.A)({width:"60%",padding:"24px 32px",backgroundColor:"#fff"}),Yy=(0,Ro.A)("form")({display:"flex",flexDirection:"column",gap:"16px"}),qy=(0,Ro.A)("img")({width:"100%",height:"auto",marginBottom:"24px",borderRadius:"4px"}),Xy=(0,Ro.A)(go.A)({"& .MuiSelect-select":{paddingTop:"16.5px",paddingBottom:"16.5px"}}),Jy=(0,Ro.A)(Ei.Ay)(({theme:t})=>({"label + &":{marginTop:t.spacing(3)},"& .MuiInputBase-input":{borderRadius:4,position:"relative",backgroundColor:t.palette.background?.paper,border:"1px solid #ced4da",fontSize:16,padding:"10px 26px 10px 12px",transition:t.transitions?.create(["border-color","box-shadow"]),"&:focus":{borderRadius:4,borderColor:"#80bdff",boxShadow:"0 0 0 0.2rem rgba(0,123,255,.25)"}}})),fd=({isOpen:t,submitCallback:n,closeModal:s,roles:o,setSelectedRole:r,currentRole:a,crewData:i})=>{const[l,c]=(0,d.useState)({firstName:"",lastName:"",email:"",phoneNumber:""}),[u,p]=(0,d.useState)(a),[f,h]=(0,d.useState)(!1),[b,x]=(0,d.useState)(void 0),[v,y]=(0,d.useState)(o),[j,A]=(0,d.useState)(!1),w=()=>{if(!o||o.length===0){y([]);return}const{subs:R,otherRoles:B}=o.reduce((T,W)=>(W.name===we.wy.Subs?T.subs=W:T.otherRoles.push(W),T),{subs:{},otherRoles:[]});y([...B,R])};(0,d.useEffect)(()=>{c(i||{firstName:"",lastName:"",email:"",phoneNumber:""})},[i,t]),(0,d.useEffect)(()=>{w()},[o]),(0,d.useEffect)(()=>{p(a),t||A(!1)},[a,t]);const P=R=>{const{name:B,value:T}=R.target;if(B==="role"){const W=o.find(N=>N.id===T);W?(W.name===we.wy.CompanyManager?A(!0):A(!1),p(W),r(W),console.log("Selected role set to:",W)):console.log("No matching role found")}else c(W=>({...W,[B]:T}));x(void 0)},C=()=>{c({firstName:"",lastName:"",email:"",phoneNumber:""}),p(null),x(void 0),A(!1),s()},k=async()=>{h(!0);try{u?(await n(l,u),c({firstName:"",lastName:"",email:"",phoneNumber:""}),p(null),x(void 0),A(!1)):x("Please select a valid role")}finally{h(!1)}},S=j||!i&&u?.name===we.wy.CompanyManager;return(0,e.jsx)(Hy,{open:t,onClose:s,children:(0,e.jsxs)(Qy,{children:[(0,e.jsxs)(Gy,{children:[(0,e.jsx)(qy,{src:$y,alt:"Crew Photo"}),i?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.A,{variant:"h5",gutterBottom:!0,children:"Editing Crew Members"}),(0,e.jsx)(I.A,{variant:"body2",paragraph:!0,children:"You are able to update contact information for existing crew members."}),(0,e.jsx)(I.A,{variant:"body2",paragraph:!0,children:"In addition, you can change their role by selecting a different option in the Role dropdown field. Note that if you change the user's role, their permissions will not change automatically."})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.A,{variant:"h5",gutterBottom:!0,children:"Inviting Crew Members"}),(0,e.jsx)(I.A,{variant:"body2",paragraph:!0,children:"Enter all contact information you have about the new crew member, and check to make sure you are selecting the correct role. Once the invite is sent, this user will receive an email to sign in. Their access will be based upon which role you have selected. You can always change their role by editing the user."})]}),(0,e.jsx)(I.A,{variant:"h6",gutterBottom:!0,children:"Questions? We're here to help!"}),(0,e.jsx)(I.A,{variant:"body2",paragraph:!0,children:"Our team is always available to assist you at every step of the way, and we are fully committed to providing you with excellent customer service."}),(0,e.jsx)(K.A,{variant:"contained",color:"secondary",fullWidth:!0,sx:{marginTop:"auto"},children:"Contact Support"})]}),(0,e.jsxs)(Ky,{children:[(0,e.jsx)(I.A,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center",marginBottom:"2rem"},children:i?"Edit Crew Member":"Invite New Crew Member"}),(0,e.jsxs)(Yy,{onSubmit:R=>{R.preventDefault(),k()},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1rem"},children:[(0,e.jsx)(I.A,{variant:"h6",children:"Crew Member Info"}),(0,e.jsx)(_.A,{name:"firstName",label:"First Name",value:l.firstName,onChange:P,required:!0,fullWidth:!0,inputProps:{"data-testid":"firstName"}}),(0,e.jsx)(_.A,{name:"lastName",label:"Last Name",value:l.lastName,onChange:P,required:!0,fullWidth:!0,inputProps:{"data-testid":"lastName"}}),(0,e.jsx)(_.A,{name:"email",label:"Email Address",value:l.email,onChange:P,disabled:!!i,fullWidth:!0,error:!!b,helperText:b,type:"email",inputProps:{"data-testid":"email"}}),(0,e.jsx)(_.A,{name:"phoneNumber",label:"Phone Number",value:l.phoneNumber,onChange:P,fullWidth:!0,type:"tel",inputProps:{"data-testid":"phoneNumber"}})]}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"h6",sx:{marginBottom:"1rem"},children:"Role"}),(0,e.jsxs)(Xy,{name:"role",value:u?.id||"",onChange:P,displayEmpty:!0,fullWidth:!0,input:(0,e.jsx)(Jy,{}),inputProps:{"data-testid":"role"},disabled:i?.role===we.wy.CompanyManager,children:[(0,e.jsx)(it.A,{value:"",disabled:!0,children:"Select a role"}),v&&v.map(R=>(0,e.jsx)(it.A,{value:R.id,children:R.name},R.id))]})]}),S&&(0,e.jsxs)(E.A,{sx:{display:"flex",gap:".5rem",alignItems:"center"},children:[(0,e.jsx)(up.A,{sx:{fontSize:"3.5rem",color:"var(--graythorne-greens-green-3)"}}),(0,e.jsx)(I.A,{variant:"body2",sx:{lineHeight:"1.2rem",fontSize:"1rem"},children:"Inviting a user as a Company Manager will register them as a BFS Registered User on your account."})]}),(0,e.jsxs)(E.A,{sx:{display:"flex",justifyContent:"space-between",marginTop:"2rem"},children:[(0,e.jsx)(K.A,{variant:"contained",color:"secondary",onClick:C,children:"Cancel"}),(0,e.jsx)(K.A,{variant:"contained",color:"primary",type:"submit",disabled:!l.email||!l.firstName||!l.lastName||!u||!!b||f,"data-testid":"sendInvite",children:i?"Save Edits":"Send Invite"})]})]})]})]})})},Zy=fd;var kr=m(95557),Rs=m(36632),Tr=m(54937),ut=m(32915),Fe=m(4004),On=m(36316),L=m(39055),$n=m(21281),D=m(28729),De=m(26142),xd=m(97223);function eb(){const t=document.querySelector("body");return t&&(t.style.overflowY="scroll"),()=>{t&&(t.style.overflowY="")}}function L6(t){return t.replace(/([A-Z])/g," $1").trim().toUpperCase()}const tb=t=>t.toLowerCase().replace(/ /g,"_"),F6=(t,n)=>`${t.toLowerCase()}_${n.action.toLowerCase().replace(/ /g,"_")}`;function B6(t){return t.reduce((n,{role:s,...o})=>{const r={role:s,...o};return n[s]=[...n[s]||[],r],n},{})}const yd=(t,n)=>n.find(o=>o.name===t)?.id,mp=(t,n)=>{const s=n.find(o=>o.id===t);return s?s.permission_ids:[]},hp=(t,n)=>{const s={[we.wy.CompanyManager]:1,[we.wy.CompanyCrew]:2,[we.wy.Subs]:4},o=i=>s[i]||3,r=o(t.data.role),a=o(n.data.role);return r<a?-1:r>a?1:t.data.role.localeCompare(n.data.role)};var _t=m(60162),nb=m(94654),sb=m(21320),Oo=m(58620),ob=m(17437),rb=m(25767),pt=m(11641),xs=m(37211),ab=m(7752),ib=m(18850),bd=m(75765),Mo=m(46255),Ss=m(17809);const ke={colors:{"text-primary":{value:"#17181A"},"text-secondary":{value:"#5D6062"},"border-tertiary":{value:"#E3E4E5"},"background-secondary":{value:"#F8F8F8"},"background-hover-primary":{value:"#E3E4E5"},"foreground-secondary":{value:"#555A66"},"light-other-snackbar":{value:"rgb(50, 50, 50)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb09105ee97d9585da0b",type:"Color"}}},"light-text-primary":{value:"rgba(0, 0, 0, 0.87)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf35968e1c57422f5b",type:"Color"}}},"light-text-secondary-shades-4p":{value:"rgba(0, 0, 0, 0.04)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb12ce4c198136dbfe94",type:"Color"}}},"light-text-secondary":{value:"rgba(0, 0, 0, 0.6)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf1e326915f3df486b",type:"Color"}}},"light-text-disabled":{value:"rgba(0, 0, 0, 0.38)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1253c38fb8938fe914",type:"Color"}}},"light-text-secondary-shades-18p":{value:"rgba(0, 0, 0, 0.18)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb12e468d682a480b477",type:"Color"}}},"light-primary-main":{value:"rgb(50, 129, 230)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf4ebd9e16f1e6d3cf",type:"Color"}}},"light-text-primary-shades-4p":{value:"rgba(0, 0, 0, 0.04)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb122c4d43837f931902",type:"Color"}}},"light-text-primary-shades-30p":{value:"rgba(0, 0, 0, 0.3)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1270e3f3b7c33a5355",type:"Color"}}},"light-text-primary-shades-12p":{value:"rgba(0, 0, 0, 0.12)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb12587217b912b0c7ae",type:"Color"}}},"light-primary-dark":{value:"rgb(37, 161, 34)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb125f7e6480eb996180",type:"Color"}}},"light-primary-light":{value:"rgb(190, 227, 189)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1266be6c7dc527d986",type:"Color"}}},"light-primary-contrast":{value:"rgb(255, 255, 255)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb12fa55aabaa0a33a9c",type:"Color"}}},"light-secondary-main":{value:"rgb(129, 129, 129)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1249a9247ead35eaa9",type:"Color"}}},"light-secondary-dark":{value:"rgb(85, 83, 82)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1203c15b811175fd9f",type:"Color"}}},"light-secondary-light":{value:"rgb(204, 203, 203)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf5e19bb140f65674c",type:"Color"}}},"light-secondary-contrast":{value:"rgb(255, 255, 255)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf23459413ad6bcb9b",type:"Color"}}},"light-action-active-54p":{value:"rgba(0, 0, 0, 0.54)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb121a052582d341410d",type:"Color"}}},"light-action-hover-4p":{value:"rgba(0, 0, 0, 0.04)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb128a76417f15ee5e0c",type:"Color"}}},"light-action-disabled-26p":{value:"rgba(0, 0, 0, 0.26)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb120327eb7e4d2eabc0",type:"Color"}}},"light-action-selected-8p":{value:"rgba(0, 0, 0, 0.08)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb12c2c164b9b0868087",type:"Color"}}},"light-action-disabled-background-12p":{value:"rgba(0, 0, 0, 0.12)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb12b464a0b81724a1fe",type:"Color"}}},"light-action-focus-12p":{value:"rgba(0, 0, 0, 0.12)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13f8187680e4332b70",type:"Color"}}},"light-action-shades-30p":{value:"rgba(0, 0, 0, 0.3)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13e977577e77222876",type:"Color"}}},"light-error-main":{value:"rgb(227, 0, 20)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf2ba3a1158257c5ea",type:"Color"}}},"light-error-light":{value:"rgb(240, 179, 184)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13e2703680d93340e7",type:"Color"}}},"light-error-dark":{value:"rgb(204, 0, 18)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13594f597e0d3edce5",type:"Color"}}},"light-error-contrast":{value:"rgb(255, 255, 255)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13f0acdbb8d0595a6a",type:"Color"}}},"light-error-shades-4p":{value:"rgba(211, 47, 47, 0.04)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb132fcf8981353b8184",type:"Color"}}},"light-error-shades-12p":{value:"rgba(211, 47, 47, 0.12)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13878c41b9d5cf6318",type:"Color"}}},"light-error-shades-30p":{value:"rgba(211, 47, 47, 0.3)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13d3b1428126a065ad",type:"Color"}}},"light-error-shades-160p":{value:"rgb(211, 47, 47)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1315593781b18f7006",type:"Color"}}},"light-error-shades-190p":{value:"rgb(211, 47, 47)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13cb7cab7fc472d34c",type:"Color"}}},"light-error-shades-50p":{value:"rgba(211, 47, 47, 0.5)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13ddfc8d7f7a312948",type:"Color"}}},"light-warning-main":{value:"rgb(254, 168, 40)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf79582215254169f7",type:"Color"}}},"light-warning-dark":{value:"rgb(236, 153, 30)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13656acbba1c09bfa5",type:"Color"}}},"light-warning-contrast":{value:"rgb(255, 255, 255)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13974e887e256d1057",type:"Color"}}},"light-warning-light":{value:"rgb(249, 224, 188)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13d674357f49e85e67",type:"Color"}}},"light-warning-shades-4p":{value:"rgba(237, 108, 2, 0.04)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb137ae4d88415236235",type:"Color"}}},"light-warning-shades-12p":{value:"rgba(237, 108, 2, 0.12)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1352ecb68305fbc4d9",type:"Color"}}},"light-warning-shades-30p":{value:"rgba(237, 108, 2, 0.3)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb137c611a80817221ca",type:"Color"}}},"light-warning-shades-50p":{value:"rgba(237, 108, 2, 0.5)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1346cf3bb852527df0",type:"Color"}}},"light-warning-shades-160p":{value:"rgb(237, 108, 2)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13be7265b9bb84f667",type:"Color"}}},"light-warning-shades-190p":{value:"rgb(237, 108, 2)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13a62c057c4b4faeb6",type:"Color"}}},"light-info-main":{value:"rgb(50, 129, 230)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13733c4f81a65f375d",type:"Color"}}},"light-info-light":{value:"rgb(191, 212, 238)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13d042a67ff4273337",type:"Color"}}},"light-info-dark":{value:"rgb(43, 112, 199)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf4f10ca164e82d628",type:"Color"}}},"light-info-contrast":{value:"rgb(255, 255, 255)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1334a95cb8deb1be93",type:"Color"}}},"light-info-shades-4p":{value:"rgba(2, 136, 209, 0.04)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13731cf87d6c5f4cdf",type:"Color"}}},"light-info-shades-12p":{value:"rgba(2, 136, 209, 0.12)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1319c4b3815efc0b20",type:"Color"}}},"light-info-shades-30p":{value:"rgba(2, 136, 209, 0.3)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13d024c4813deecc44",type:"Color"}}},"light-info-shades-160p":{value:"rgb(2, 136, 209)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb137b62fc7c5d5d07d6",type:"Color"}}},"light-info-shades-50p":{value:"rgba(2, 136, 209, 0.5)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13ea108e83f2001c4a",type:"Color"}}},"light-info-shades-190p":{value:"rgb(2, 136, 209)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13ed42d0b9803751c4",type:"Color"}}},"light-success-dark":{value:"rgb(37, 161, 34)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13caa14b81985fb505",type:"Color"}}},"light-success-main":{value:"rgb(42, 186, 39)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1389792b7fe6427326",type:"Color"}}},"light-success-contrast":{value:"rgb(255, 255, 255)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13e1816bb93a36a172",type:"Color"}}},"light-success-shades-4p":{value:"rgba(46, 125, 50, 0.04)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13d9a2f9b8590d4477",type:"Color"}}},"light-success-light":{value:"rgb(190, 227, 189)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13c537617fa1a06dc1",type:"Color"}}},"light-success-shades-12p":{value:"rgba(46, 125, 50, 0.12)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb137a9fe48148552be2",type:"Color"}}},"light-success-shades-30p":{value:"rgba(46, 125, 50, 0.3)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13b3ca937ecb600d8f",type:"Color"}}},"light-success-shades-50p":{value:"rgba(46, 125, 50, 0.5)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13a235fb818b3711ab",type:"Color"}}},"light-success-shades-160p":{value:"rgb(46, 125, 50)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13748dd3b9ed7350e7",type:"Color"}}},"light-success-shades-190p":{value:"rgb(46, 125, 50)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13f71f9180c4a8ea48",type:"Color"}}},"light-background-paper":{value:"rgb(255, 255, 255)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13dbb07d7e593b47f3",type:"Color"}}},"light-background-default":{value:"rgb(250, 250, 250)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1355a641b90576f50e",type:"Color"}}},"light-other-divider":{value:"rgba(0, 0, 0, 0.12)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13b469c58110d3bf94",type:"Color"}}},"light-other-outlined-border-23p":{value:"rgba(0, 0, 0, 0.23)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13d321e67c8f4f8693",type:"Color"}}},"light-other-backdrop-overlay":{value:"rgba(0, 0, 0, 0.5)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb136344ee82980d09cd",type:"Color"}}},"light-other-filled-input-background":{value:"rgba(0, 0, 0, 0.06)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13a5e8ad7d2a424cd5",type:"Color"}}},"light-other-standard-input-line":{value:"rgba(0, 0, 0, 0.42)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb137581d1b98c4159f9",type:"Color"}}},"light-other-rating-active":{value:"rgb(255, 180, 0)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13e468d682a480b47b",type:"Color"}}},"common-black-100p":{value:"rgb(0, 0, 0)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13105ee97d9585da1f",type:"Color"}}},"common-white-30p":{value:"rgba(255, 255, 255, 0.3)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb137f86ff83d0d7cf07",type:"Color"}}},"common-white-100p":{value:"rgb(255, 255, 255)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13d54d217f690f6498",type:"Color"}}},"graythorne-grays-gray-2":{value:"rgb(204, 201, 199)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1389581e81c18eedd9",type:"Color"}}},"graythorne-grays-gray-1":{value:"rgb(234, 232, 230)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb133d3459b9c917d1f0",type:"Color"}}},"graythorne-grays-gray-3":{value:"rgb(151, 148, 147)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1366be6c7dc527d98a",type:"Color"}}},"graythorne-grays-gray-5":{value:"rgb(44, 43, 42)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13957d92ba5a90d3b6",type:"Color"}}},"graythorne-grays-gray-4":{value:"rgb(85, 83, 82)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13042d00bac49c8c0c",type:"Color"}}},"graythorne-grays-gray-6":{value:"rgb(0, 0, 0)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13708feeb80140af17",type:"Color"}}},"graythorne-greens-green-2":{value:"rgb(42, 186, 39)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13a992ec7d1f3fff3d",type:"Color"}}},"graythorne-greens-green-1":{value:"rgb(46, 204, 43)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1391fc5683c3ad7538",type:"Color"}}},"graythorne-greens-green-3":{value:"rgb(37, 161, 34)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13d86060822e589d5e",type:"Color"}}},"graythorne-greens-green-5":{value:"rgb(15, 66, 14)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1389681480c87fc5d1",type:"Color"}}},"graythorne-greens-green-4":{value:"rgb(27, 118, 25)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1350354180178516a0",type:"Color"}}},"graythorne-greens-green-6":{value:"rgb(8, 34, 7)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13005809b82654018f",type:"Color"}}},"graythorne-blues-blue-2":{value:"rgb(50, 129, 230)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb131a052582d3414111",type:"Color"}}},"graythorne-blues-blue-1":{value:"rgb(54, 142, 255)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13b464a0b81724a202",type:"Color"}}},"graythorne-blues-blue-3":{value:"rgb(43, 112, 199)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb138a76417f15ee5e10",type:"Color"}}},"graythorne-blues-blue-4":{value:"rgb(32, 82, 147)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13993f0a817d65fdd9",type:"Color"}}},"graythorne-blues-blue-5":{value:"rgb(18, 46, 82)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13f8187680e4332b74",type:"Color"}}},"graythorne-blues-blue-6":{value:"rgb(9, 24, 42)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1345be6eb7e0a8689a",type:"Color"}}},"graythorne-reds-red-1":{value:"rgb(255, 0, 23)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13e977577e7722287a",type:"Color"}}},"graythorne-reds-red-2":{value:"rgb(234, 0, 21)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13878c41b9d5cf631c",type:"Color"}}},"graythorne-reds-red-3":{value:"rgb(204, 0, 18)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb1315593781b18f700a",type:"Color"}}},"graythorne-reds-red-5":{value:"rgb(85, 0, 7)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13676efeb8433546b9",type:"Color"}}},"graythorne-reds-red-4":{value:"rgb(151, 0, 13)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13656acbba1c09bfa9",type:"Color"}}},"graythorne-yellows-yellow-1":{value:"rgb(255, 175, 54)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13766e5d811b48b919",type:"Color"}}},"graythorne-reds-red-6":{value:"rgb(44, 0, 4)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13974e887e256d105b",type:"Color"}}},"graythorne-yellows-yellow-2":{value:"rgb(234, 159, 49)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb13bbfdd17ca71126f1",type:"Color"}}},"graythorne-yellows-yellow-3":{value:"rgb(204, 138, 42)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb7305a306b8ec3aba86",type:"Color"}}},"graythorne-yellows-yellow-5":{value:"rgb(85, 57, 17)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb7352ecb68305fbc546",type:"Color"}}},"graythorne-yellows-yellow-4":{value:"rgb(151, 102, 31)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb733a9bb37c562d4492",type:"Color"}}},"graythorne-yellows-yellow-6":{value:"rgb(44, 30, 9)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"6387cb73bbfdd17ca7112770",type:"Color"}}},"bfs-11-22-nav-background-gray":{value:"rgb(51, 51, 51)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"6377ebc967f5fa70dc143d98",type:"Color"}}},"bfs-11-22-nav-selected-gray":{value:"rgb(129, 129, 129)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"6377ebcc3477cb6d59bd2e95",type:"Color"}}},"bfs-brand-true-white":{value:"rgb(255, 255, 255)",metadata:{source:{styleguide:{id:"63445f11412cf1a90232c40b",name:"myBLDR.com",platform:"web"}},resource:{id:"638a427b91fc5683c3bdad12",type:"Color"}}},"bfs-11-22-body-background":{value:"rgb(229, 229, 229)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"6377ebcc29a9526dfa72fa0f",type:"Color"}}},"bfs-primary-builders-blue":{value:"rgb(0, 32, 91)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d9416f1e86e7b1e653e",type:"Color"}}},"bfs-primary-bfs-red":{value:"rgb(200, 16, 46)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d965abeafa5ef64de01",type:"Color"}}},"bfs-primary-medium-blue":{value:"rgb(0, 48, 135)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d97ddfbb16a6e40fba0",type:"Color"}}},"bfs-primary-accent-blue":{value:"rgb(48, 127, 226)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d9834e824a74522dc40",type:"Color"}}},"bfs-primary-true-white":{value:"rgb(255, 255, 255)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d98c07d4ba88e0aa96d",type:"Color"}}},"bfs-primary-true-black":{value:"rgb(0, 0, 0)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d9aa9ceef6a1fff6c0a",type:"Color"}}},"bfs-secondary-support-gray-dark":{value:"rgb(117, 123, 123)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d9b5abeafa5ef64de08",type:"Color"}}},"bfs-secondary-support-gray-medium":{value:"rgb(167, 171, 169)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d9b5493a16af2feb4ad",type:"Color"}}},"bfs-secondary-support-gray-light":{value:"rgb(208, 208, 206)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d9cbb6c476dd28f4b6b",type:"Color"}}},"bfs-secondary-support-blue-dark":{value:"rgb(128, 144, 173)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d9dd534276d53d5313d",type:"Color"}}},"bfs-secondary-support-blue-medium":{value:"rgb(179, 193, 219)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d9efd08d16edcf72d97",type:"Color"}}},"bfs-secondary-support-blue-light":{value:"rgb(214, 229, 249)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63447d9f007ca26f0ad6e66c",type:"Color"}}},"bfs-11-22-teal":{value:"rgb(24, 151, 159)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"6369435fcabd851d0d5d0b52",type:"Color"}}},"bfs-11-22-pack-background-blue":{value:"rgb(43, 112, 199)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf88dcfe177a2e5859",type:"Color"}}},"a-black":{value:"rgb(0, 0, 0)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbfcaba8d13b4731c39",type:"Color"}}},"light-white":{value:"rgb(255, 255, 255)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbfb71c5c17ffd82e0b",type:"Color"}}},"light-black":{value:"rgb(0, 0, 0)",metadata:{source:{project:{id:"63445ed04ef2eb6cd154a3a9",name:"myBLDR.com",platform:"web",linked_styleguide:{id:"63445f11412cf1a90232c40b"}}},resource:{id:"63853fbf62a48017363542bf",type:"Color"}}}},text_styles:{"typography-h5":{value:{font:{family:"acumin-pro",size:24,weight:700,stretch:1},line_height:24},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62fd4cef354c4127acefc2d9",type:"TextStyle"}}},"typography-body-1":{value:{font:{family:"acumin-pro",size:16,weight:400,stretch:1},line_height:16},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62fd4cef34580d2a1e37ae85",type:"TextStyle"}}},"typography-h2":{value:{font:{family:"acumin-pro",size:60,weight:700,stretch:1},line_height:72.00000286102295,letter_spacing:3},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b558df3f1babd710f7",type:"TextStyle"}}},"typography-h1":{value:{font:{family:"acumin-pro",size:96,weight:700,stretch:1},line_height:115.20000457763672,letter_spacing:4.8},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b5ac04e21e0d05f6b2",type:"TextStyle"}}},"components-avatar-initials":{value:{font:{family:"acumin-pro",size:20,weight:300,stretch:1},line_height:20,letter_spacing:.14},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b5b79e5414fe390e86",type:"TextStyle"}}},"typography-subtitle-1":{value:{font:{family:"acumin-pro",size:16,weight:300,stretch:1},line_height:28,letter_spacing:.15},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b5c518a419707836c0",type:"TextStyle"}}},"components-alert-title":{value:{font:{family:"acumin-pro",size:16,weight:300,stretch:1},line_height:24,letter_spacing:.15},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b52df1b31b7eb41bfd",type:"TextStyle"}}},"components-input-text":{value:{font:{family:"acumin-pro",size:16,weight:400,stretch:1},line_height:24,letter_spacing:.15},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b5499b5017e2a12d14",type:"TextStyle"}}},"typography-body-2":{value:{font:{family:"acumin-pro",size:14,weight:400,stretch:1},line_height:14},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62fd4cefcaea682cd0ed3ac2",type:"TextStyle"}}},"components-button-large":{value:{font:{family:"acumin-pro",size:16,weight:500,stretch:1},line_height:28,letter_spacing:.46},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62fd4cef32385525d77aa4b1",type:"TextStyle"}}},"typography-subtitle-2":{value:{font:{family:"acumin-pro",size:14,weight:300,stretch:1},line_height:21.980000734329224,letter_spacing:.1},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b56cd9b419eb384cc1",type:"TextStyle"}}},"components-button-medium":{value:{font:{family:"acumin-pro",size:14,weight:500,stretch:1},line_height:24,letter_spacing:.4},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b51b90321835cb1c40",type:"TextStyle"}}},"components-table-header":{value:{font:{family:"acumin-pro",size:14,weight:500,stretch:1},line_height:24,letter_spacing:.17},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b670c9281cb082b7d1",type:"TextStyle"}}},"components-menu-item-dense":{value:{font:{family:"acumin-pro",size:14,weight:400,stretch:1},line_height:24,letter_spacing:.17},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b675b58e1d442b4430",type:"TextStyle"}}},"components-bottom-navigation-active-label":{value:{font:{family:"acumin-pro",size:14,weight:400,stretch:1},line_height:23.239999532699585,letter_spacing:.4},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b69c4a5b1814d48d42",type:"TextStyle"}}},"components-button-small":{value:{font:{family:"acumin-pro",size:13,weight:300,stretch:1},line_height:22,letter_spacing:.46},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b6c75e5815160991b2",type:"TextStyle"}}},"components-list-subheader":{value:{font:{family:"acumin-pro",size:14,weight:500,stretch:1},line_height:48,letter_spacing:.1},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b627b6d217a36754ec",type:"TextStyle"}}},"components-chip":{value:{font:{family:"acumin-pro",size:13,weight:400,stretch:1},line_height:18,letter_spacing:.16},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b6637ae51b3b11c36b",type:"TextStyle"}}},"typography-overline":{value:{font:{family:"acumin-pro",size:12,weight:300,stretch:1},line_height:31.92000102996826,letter_spacing:1},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b6e886781aba00ffaa",type:"TextStyle"}}},"typography-caption":{value:{font:{family:"acumin-pro",size:12,weight:300,stretch:1},line_height:19.919999599456787,letter_spacing:.4},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b662de9d162d915b94",type:"TextStyle"}}},"components-input-label":{value:{font:{family:"acumin-pro",size:12,weight:300,stretch:1},line_height:12,letter_spacing:.15},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b68e5a411957d3782b",type:"TextStyle"}}},"components-badge-label":{value:{font:{family:"acumin-pro",size:12,weight:500,stretch:1},line_height:20,letter_spacing:.14},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b6464fc619c76c6da6",type:"TextStyle"}}},"components-tooltip":{value:{font:{family:"acumin-pro",size:10,weight:500,stretch:1},line_height:14},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b665bc8f16f91ae872",type:"TextStyle"}}},"components-helper-text":{value:{font:{family:"acumin-pro",size:12,weight:400,stretch:1},line_height:20,letter_spacing:.4},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdb8b6da069c18ffab2ad3",type:"TextStyle"}}},"typography-h4":{value:{font:{family:"acumin-pro",size:30,weight:700,stretch:1},line_height:30},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62fd4ceffd98ed2bf57696ff",type:"TextStyle"}}},"components-menu-item":{value:{font:{family:"acumin-pro",size:16,weight:400,stretch:1},line_height:24,letter_spacing:.15},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62bdc7c71af7331a1844db1b",type:"TextStyle"}}},"typography-h6":{value:{font:{family:"acumin-pro",size:18,weight:700,stretch:1},line_height:18},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62f290621a256c6b39c9f9e5",type:"TextStyle"}}},"typography-h3":{value:{font:{family:"acumin-pro",size:36,weight:700,stretch:1},line_height:36},metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"MyBLDR",platform:"base"}},resource:{id:"62fd4cef4706a6290bb431ed",type:"TextStyle"}}}},spacing:{"spacing-xxs":{value:4,metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"BLDR Base",platform:"base"}},resource:{id:"62b23df31940421ea4a7234e",type:"SpacingToken"},spacing_section:{id:"629a2c7b63c194127da273c4"}}},"spacing-xs":{value:8,metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"BLDR Base",platform:"base"}},resource:{id:"62b23df7963f051f63864d92",type:"SpacingToken"},spacing_section:{id:"629a2c7b63c194127da273c4"}}},"spacing-s":{value:12,metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"BLDR Base",platform:"base"}},resource:{id:"62b23df97425aa1d38727348",type:"SpacingToken"},spacing_section:{id:"629a2c7b63c194127da273c4"}}},"spacing-m":{value:16,metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"BLDR Base",platform:"base"}},resource:{id:"62b23dfa35838b20dcfb8c83",type:"SpacingToken"},spacing_section:{id:"629a2c7b63c194127da273c4"}}},"spacing-l":{value:20,metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"BLDR Base",platform:"base"}},resource:{id:"62b23dfcf402031e4d3493ff",type:"SpacingToken"},spacing_section:{id:"629a2c7b63c194127da273c4"}}},"spacing-xl":{value:24,metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"BLDR Base",platform:"base"}},resource:{id:"62b23dfda867bd21f5077101",type:"SpacingToken"},spacing_section:{id:"629a2c7b63c194127da273c4"}}},"spacing-xxl":{value:28,metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"BLDR Base",platform:"base"}},resource:{id:"62b23e048d9d341ab2040873",type:"SpacingToken"},spacing_section:{id:"629a2c7b63c194127da273c4"}}},"spacing-xxl-2":{value:32,metadata:{source:{styleguide:{id:"629a2c7b63c194127da273c2",name:"BLDR Base",platform:"base"}},resource:{id:"62b23e06bb3e011b6181641c",type:"SpacingToken"},spacing_section:{id:"629a2c7b63c194127da273c4"}}}}},ba=1154,lb=(0,ob.i7)`
  0% {
    transform: scale(0);
  }
  100% {
    transform: scale(1);
  }
`,db=(0,g.Ay)("div")`
  position: relative;
  display: flex;
  flex-direction: column;
  height: 100%;
`,cb={"& fieldset":{border:"1px solid rgba(0,0,0,0.23)",borderRadius:"4px",backgroundColor:"transparent"},flexGrow:1,height:"100%",width:"unset",margin:"0 0 0 0"},ub=(0,g.Ay)("div",{shouldForwardProp:t=>t!=="selected"})`
  border: ${t=>t.selected?"solid 1px var(--graythorne-blues-blue-3)":"solid 1px var(--light-secondary-light)"};

  border-right: 0;
  border-left: 0;
  background-color: ${t=>t.selected?"var(--graythorne-blues-blue-3)":"white"};

  color: ${t=>t.selected?"white":"black"};
  margin-bottom: 1.25rem;
  cursor: pointer;
  width: 100%;
  padding: 1rem;
  display: inline-flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 0px;
  && .MuiTouchRipple-child {
    background-color: var(--bfs-primary-medium-blue);
  }
  && .MuiTouchRipple-rippleVisible {
    animation-name: ${lb};
  }
`,pb=(0,g.Ay)("div")`
  flex-grow: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 75%;
`,N6=(0,g.Ay)("div",{shouldForwardProp:t=>t!=="selected"&&t!=="canEditProject"})`
  width: 3rem;
  height: 1.5rem;
  padding: 0.75rem 0;

  font-size: 16px;
  font-weight: 300;

  display: flex;
  align-items: center;
  justify-content: center;

  // borrowed from MUI because we can't nest buttons
  transition-property: background-color, box-shadow, border-color, color;
  transition-duration: 250ms, 250ms, 250ms, 250ms;

  color: ${({selected:t})=>t?"white":"var(--light-info-main)"};
  cursor: ${({canEditProject:t})=>t?"pointer":"not-allowed"};
  pointer-events: ${({canEditProject:t})=>t?"auto":"none"};

  &:hover {
    text-decoration: none;
    background-color: var(--light-info-shades-4-p);
  }
`,_6=(0,g.Ay)(Mo.A)`
  width: 1.5rem;
  height: 1.5rem;
`,U6=(0,g.Ay)(K.A)`
  width: 90px;
  height: 48px;
  position: absolute;
  top: 0.6rem;
  right: 1rem;
`,mb=(0,g.Ay)("ul")`
  list-style: none;
  padding: 0;
  margin-bottom: 0;
  margin-top: 0;

  & button:last-child {
    border-bottom: 0;
  }
`,W6=(0,g.Ay)("div")(({theme:t})=>({display:"flex",zIndex:50,height:t.header?.height,overflow:"hidden",position:"fixed",top:0,width:"100%"})),gp=(0,g.Ay)("img")`
  height: 100%;
  margin: 0;
`,z6=(0,g.Ay)("img")`
  width: 150px;
  margin: 5px auto;
  ${t=>t.theme.breakpoints.up("xs")} {
    height: 55px;
  }
  ${t=>t.theme.breakpoints.up("lg")} {
    height: 70px;
    width: 200px;
  }
  ${t=>t.theme.breakpoints.up("xl")} {
    height: 100px;
    width: 290px;
  }
`,V6=(0,g.Ay)("div")`
  display: flex;
  box-sizing: border-box;
  height: 100%;
`,$6=(0,g.Ay)("div")`
  font-size: 40px;
  width: 100%;
  letter-spacing: 2px;
  line-height: 32px;
  padding-left: 1rem;
`,H6=(0,g.Ay)("div")`
  display: block;

  ${t=>t.theme.breakpoints.down("lg")} {
    display: none;
  }
`,hb=(0,g.Ay)(rb.A)`
  display: flex;
  align-items: flex-start;
  height: 100%;
  width: 100%;
  position: sticky;
  background-color: transparent;
  gap: 4px;
`,Q6=(0,g.Ay)(pt.A)`
  height: 68px;
  width: 68px;
  border-radius: 0;
  padding: 11px 5px;
  margin: 9px 16px;
`,G6=(0,g.Ay)(pt.A)`
  border-radius: 4px;
  padding: 10px;
  position: absolute;
  top: 1rem;
  right: 1rem;
`,K6=(0,g.Ay)(Ss.A)`
  font-size: 28px;
  color: rgba(0, 0, 0, 0.54);
`,Y6=(0,g.Ay)("h4")`
  padding: 1rem;
  margin: 0;
  span {
    font-size: 16px;
    font-weight: 300;
    font-stretch: normal;
    font-style: normal;
    line-height: 1.2;
    letter-spacing: normal;
    text-align: left;
  }
`,fp=(0,g.Ay)(xs.A,{shouldForwardProp:t=>t!=="active"})`
  height: 74px;
  width: 100%;
  // width: 85px;
  padding: 14px 25px 14px;
  margin-bottom: 8px;

  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;

  cursor: pointer;

  background-color: ${t=>t.active?"var(--bfs-11-22-nav-selected-gray)":"inherit"};
  color: var(--bfs-primary-true-white);
  &:hover {
    background-color: ${t=>t.active?"var(--bfs-11-22-nav-selected-gray)":"var(--light-secondary-light)"};
  }
  &.Mui-disabled {
    cursor: not-allowed;
    pointer-events: all;
  }
`,gb=(0,g.Ay)("nav")`
  display: flex;
  height: 100%;
  align-items: center;
  position: absolute;
  margin-right: 12px;
  right: 0;
  ${t=>t.theme.breakpoints.up(ba)} {
    display: none;
  }
`,fb=(0,g.Ay)(K.A)`
  padding: 10px 11px;
  width: 95px;
  margin: auto;
  margin-top: 16px;
  margin-bottom: 50px;
  color: ${()=>ke.colors["light-error-main"].value};
  border-radius: 0;
`,q6=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 40%;
`,xb=(0,g.Ay)(I.A,{shouldForwardProp:t=>t!=="selected"})`
  margin: 0.625rem 0;
  variant: body1;
  text-align: left;

  ${({selected:t})=>t?"color: white;":""}
`,X6=(0,g.Ay)(I.A)`
  margin: 1.25rem 1rem;
`,va=(0,g.Ay)(I.A)`
  font-family: 'Roboto', sans-serif;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  text-align: left;
  line-height: 1;
  letter-spacing: normal;
  font-weight: 700;
  color: var(--light-text-primary);
  padding: 2px 0;
  font-size: 12px;
`,vd=(0,g.Ay)(ab.A)`
  gap: 4px;
  padding: 0px;
  min-width: 68px;
  width: 68px;
  height: 68px;
  justify-content: center;
  border-radius: 2px;

  &:disabled {
    cursor: not-allowed;
    pointer-events: all;
  }

  &.hovered {
    background-color: var(--bfs-11-22-nav-hovered-gray);
  }
`,yb=(0,g.Ay)(K.A)`
  gap: 4px;
  padding: 0px;
  min-width: 68px;
  width: 68px;
  height: 68px;
  justify-content: center;
  border-radius: 2px;

  &:disabled {
    cursor: not-allowed;
    pointer-events: all;
  }

  &.hovered {
    background-color: var(--bfs-11-22-nav-hovered-gray);
  }
`,bb=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  justify-content: start;
  align-items: start;
`,Pi=(0,g.Ay)("img")`
  height: 30px;
`,J6=(0,g.Ay)("div")`
  justify-content: center;
  align-items: center;
  padding: 1px 0 0;
  height: 50px;
  width: 70px;
  margin: auto;
  background-color: var(--bfs-11-22-nav-selected-gray);
  display: none;
  ${t=>t.theme.breakpoints.up("sm")} {
    display: flex;
  }
`,ja=(0,g.Ay)("a")`
  text-decoration: none;
  color: inherit;
`,xp=(0,g.Ay)(K.A)`
  padding: 10px 11px;
  width: 95px;
  margin-top: 16px;
  color: var(--bfs-primary-true-white);
  border-radius: 0;
`,vb=t=>({top:"90px",height:"calc(100% - 90px)",[t.breakpoints.up("sm")]:{width:"474px"},[t.breakpoints.up("xs")]:{width:"100%"}}),Z6=(0,g.Ay)("h1")`
  font-size: 20px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  text-align: left;
  color: var(--light-text-primary);
`,yp=(0,g.Ay)(ib.A)`
  display: flex;
  height: 100px;
  width: 100%;
  align-items: center;
  justify-content: space-between;
  padding: 16px 30px;
  box-sizing: border-box;
  border: none;
  border-bottom: solid 1px #c6c6c6;
  background-color: ${({selected:t})=>t?"var(--light-primary-main)":"#F1F1F1"};
`,jb=(0,g.Ay)("div")`
  padding: 12px;
  background-color: var(--bfs-primary-true-white);
  border-radius: 4px;
`,Ab=(0,g.Ay)("img")`
  height: 37px;
  display: block;
`,bp=(0,g.Ay)(bd.A)`
  color: #a6a6a6;
`,Cb=(0,g.Ay)("div")`
  overflow-y: auto;
  display: flex;
  flex: 1;
  flex-direction: column;
`,Sb=(0,g.Ay)("div")`
  width: 300px;
  height: 48px;
  flex-grow: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: stretch;
  padding: 12px;
  border-radius: 4px;
`,wb=(0,g.Ay)("div")`
  height: 24px;
  align-self: stretch;
  flex-grow: 0;
  font-family: acumin-pro;
  font-size: 20px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  text-align: left;
  color: ${({selected:t})=>t?"#fff":"#00000"};
`,eN=(0,g.Ay)("div")`
  flex-grow: 0;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: flex-start;
  gap: 8px;
  padding: 8px;
  border-radius: 2px;
  background-color: var(--bfs-primary-true-white);
`,tN=(0,g.Ay)("div")`
  align-self: stretch;
  flex-grow: 0;
  font-family: acumin-pro;
  font-size: 14px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  text-align: left;
  color: var(--light-text-primary);
`,nN=(0,g.Ay)("div")`
  margin-top: 90px;
`;var Pt=m(63183);const Eb=m.p+"450e2dbfd88daee41f2939f131de157f.svg",Pb=["https://mybldr.com","https://www.mybldr.com"],Ib=()=>Pb.includes(window.location.origin.toLowerCase())?"https://mybfs.bldr.com":"https://stg-mybfs.bldr.com",jd=(t="/")=>{const n=new URL(t,Ib());return n.searchParams.append("redirect","false"),n.toString()};var An=m(29433);const vp={20:An.v.ONLINE,30:An.v.TREND,5:An.v.AS400,80:An.v.SAPS4HANA,ONLINE:An.v.ONLINE,TREND:An.v.TREND,AS400:An.v.AS400,SAPS4HANA:An.v.SAPS4HANA},Aa=t=>{if(!(t.toUpperCase()in vp))throw new Error("Unable to parse ERP System");return vp[t.toUpperCase()]};var Ye=m(7609),je=m(18484),Ii=m(92990);const jp=t=>`usePersistedState.${t}`,fo=(t,{initialState:n,browserStorage:s=localStorage}={})=>{const o=(0,d.useMemo)(()=>{const i=jp(t);return{get:()=>{const l=s.getItem(i);try{return l?JSON.parse(l):null}catch{return null}},set:l=>{const c=JSON.stringify(l);c?s.setItem(i,c):s.removeItem(i)}}},[t,s]),[r,a]=(0,d.useState)(o.get()??n);return(0,d.useEffect)(()=>{o.set(r)},[o,r]),(0,d.useMemo)(()=>[r,a],[r,a])};var Nn=m(92039),Ze=m(9402),Lo=m(22923),Zo=m(48361),Pn=m(13561),Ca=m(4861),Sa=m(36269),Gs=(t=>(t.COMPANY_ERP_SYSTEM="company_erp_system",t.COMPANY_ERP_ID="company_erp_id",t.PROJECT_ID="project_id",t.QUOTE_ID="quote_id",t))(Gs||{});function wa(t,n){Ca.datadogLogs.setGlobalContextProperty(t,n),Sa.datadogRum.setGlobalContextProperty(t,n)}function Ea(t){Ca.datadogLogs.removeGlobalContextProperty(t),Sa.datadogRum.removeGlobalContextProperty(t)}const Di=(0,Lo.xP)({baseQuery:(0,Zo.S)({baseUrl:"/companies/"}),reducerPath:"company",endpoints:t=>({getCompany:t.query({query:n=>({url:n,method:"GET"}),transformResponse:n=>(0,Ze.bn)(n)}),getOrCreateCompany:t.mutation({query:n=>({url:"get_or_create_company",method:"POST",data:n})})})}),{useGetCompanyQuery:Db,useGetOrCreateCompanyMutation:Ad,useLazyGetCompanyQuery:kb}=Di,Tb=({children:t})=>{const n=(0,L.useParams)(),[s,o]=fo(Nn.Rh.mostRecentlySelectedCompany,{initialState:0}),{isLoggedIn:r}=(0,Pt.A)(),a=(0,Pn.wA)(),[i]=Ad(),[l]=kb(),c=Number(n.companyId)||s,{data:u=null,isFetching:p,refetch:f}=Db(c,{skip:!r});(0,d.useEffect)(()=>{u?.id&&o(Number(u.id))},[u]);const h=(0,d.useMemo)(()=>({company:u,companyLoading:p,fetchCompany:async(b,x)=>{const{data:v}=await l(b||c);v&&(v.id&&o(Number(v.id)),x&&await i({erp_number:v.accountNumber,erp_system:v.erpSystem}))}}),[u,c,p,f,a]);return(0,d.useEffect)(()=>{u?(wa(Gs.COMPANY_ERP_ID,u.accountNumber),wa(Gs.COMPANY_ERP_SYSTEM,u.erpSystem)):(Ea(Gs.COMPANY_ERP_ID),Ea(Gs.COMPANY_ERP_SYSTEM))},[u]),(0,e.jsx)(je.z.Provider,{value:h,children:t})},Ap=()=>{const{clearSelectedProject:t}=(0,De.B)(),{fetchCompany:n}=(0,je.P)(),{setSelectedCustomerView:s}=(0,Ii.A)(),[o]=Ad(),r=(0,L.useNavigate)();return async(i,l,c)=>{const u=await o({erp_number:i,erp_system:l});if("error"in u){console.error("Error switching company",u.error);return}await n(Number(u.data)),t(),s(c||null),r(`/companies/${u.data}/projects`)}};var ki=m(69149),Cn=m(82241),Dt=m(44675),qn=m(49799),_n=m(44090),Un=m(57873),Ti=m(81385),bt=m(73357);const Rb={width:"100%",maxWidth:360,bgcolor:"background.paper"},Cp=t=>t.split(" ").map(n=>n[0]).join("").substring(0,2).toUpperCase(),Sp=({name:t,erpNumber:n,erpSystem:s})=>(0,e.jsx)(Cn.A,{primary:t,secondary:`${n} \u2022 ${Aa(s)}`}),wp=({onCloseCompanySwitcher:t})=>{const{company:n}=(0,je.P)(),{companies:s}=(0,Ye.A)(),o=Ap(),r=(0,Dt.A)(),[a,i]=(0,d.useState)(null),l=async c=>{c.id!==n?.id&&(i(c.id),await o(c.erpNumber,Aa(c.erpSystem.toString())),i(null),t())};return(0,e.jsxs)(qn.A,{sx:Rb,children:[(0,e.jsxs)(_n.Ay,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:1,paddingY:.5},children:[(0,e.jsx)(Cn.A,{primary:(0,e.jsx)(I.A,{variant:"h6",children:"Accounts"})}),(0,e.jsx)(pt.A,{edge:"end","aria-label":"close",onClick:t,sx:{padding:"8px",marginRight:"4px"},children:(0,e.jsx)(Ss.A,{sx:{color:"#757575",marginRight:"4px"}})})]}),(0,e.jsx)(Ce.A,{}),(0,e.jsx)(_n.Ay,{children:(0,e.jsx)(Cn.A,{primary:"Currently Selected",primaryTypographyProps:{variant:"body2",color:r.palette.text.secondary}})}),n&&(0,e.jsx)(_n.Ay,{disablePadding:!0,children:(0,e.jsxs)(xs.A,{sx:{bgcolor:"#F5F5F5","&.Mui-selected":{bgcolor:"#F5F5F5"},"&.Mui-selected:hover":{bgcolor:"#EEEEEE"}},children:[(0,e.jsx)(Un.A,{sx:{minWidth:56},children:(0,e.jsx)(Ti.A,{sx:{bgcolor:"#EEEEEE",color:"text.secondary",borderRadius:"4px"},children:(0,e.jsx)(I.A,{variant:"body1",sx:{fontWeight:400},children:Cp(n.name)})})}),(0,e.jsx)(Sp,{name:n.name,erpNumber:n.accountNumber,erpSystem:n.erpSystem.toString()}),(0,e.jsx)(ki.A,{sx:{color:"#757575",marginRight:"4px"}})]})}),(0,e.jsx)(Ce.A,{}),(0,e.jsx)(_n.Ay,{children:(0,e.jsx)(Cn.A,{primary:"Other accounts",primaryTypographyProps:{variant:"body2",color:r.palette.text.secondary}})}),s?.filter(c=>c.id!==n?.id).map(c=>(0,e.jsx)(_n.Ay,{disablePadding:!0,children:(0,e.jsxs)(xs.A,{onClick:()=>l(c),disabled:a===c.id,children:[(0,e.jsx)(Un.A,{sx:{minWidth:56},children:(0,e.jsx)(Ti.A,{sx:{bgcolor:"#EEEEEE",color:"text.secondary",borderRadius:"4px"},children:(0,e.jsx)(I.A,{variant:"body1",sx:{fontWeight:400},children:Cp(c.name)})})}),(0,e.jsx)(Sp,{name:c.name,erpNumber:c.erpNumber,erpSystem:c.erpSystem.toString()}),a===c.id&&(0,e.jsx)(bt.A,{size:24})]})},c.id))]})},Ob=({project:t,isSupplier:n,renderNavLinks:s})=>{const{isFlagEnabled:o}=(0,ut.u)(),[r,a]=(0,d.useState)(!1),[i,l]=(0,d.useState)(!1),{onSignOut:c}=(0,Pt.A)(),u=()=>{a(!1),l(!1)},p=async()=>{u(),await c?.()},f=()=>{l(!1),a(!1)},[h,b]=(0,d.useState)(null),x=(0,L.useMatch)("/projects/:id/:route"),v=(0,L.useMatch)("/projects/:id/:route/:id"),y=(0,L.useMatch)("/select_customer");return(0,d.useEffect)(()=>{const j=v?.params?.route||x?.params?.route||y?.pathname&&"Customers"||null;b(j)},[v,x]),(0,e.jsxs)(gb,{"data-testid":"nav-drawer",children:[(0,e.jsx)(vd,{onClick:()=>a(!0),icon:(0,e.jsx)(nb.A,{fontSize:"large",sx:{color:"var(--bfs-primary-true-white)"}})}),(0,e.jsxs)(Oo.Ay,{anchor:"right",open:r,onClose:u,PaperProps:{sx:{width:{xs:"126px"},overflowX:"hidden",alignItems:"center",padding:"24px 28px",backgroundColor:"var(--bfs-11-22-nav-background-gray)"}},children:[s(!0,u),!o(D.SX.SUNSET_BFS)&&(0,e.jsxs)(fp,{sx:{paddingLeft:0,paddingRight:0,width:"115px"},onClick:j=>{window.location.href=jd()},children:[(0,e.jsx)(Pi,{src:Eb,alt:"myBFSBuilder"}),(0,e.jsxs)(I.A,{variant:"subtitle2",style:{margin:"8px 0 0 0",color:"var(--bfs-primary-true-white)",height:"14px"},children:["MyBFSBuilder",(0,e.jsx)(sb.A,{style:{transform:"translateY(4px)",width:"16px",height:"16px"}})]})]}),(0,e.jsx)(xp,{children:(0,e.jsx)(ja,{href:"/help",target:"_blank",children:"GET HELP"})}),(0,e.jsx)(xp,{onClick:()=>l(!0),children:"SWITCH ACCOUNT"}),(0,e.jsx)(fb,{onClick:p,children:"LOG OUT"})]}),(0,e.jsx)(Oo.Ay,{anchor:"right",open:i,onClose:f,PaperProps:{sx:{width:{xs:"360px",sm:"360px"},overflowX:"hidden",padding:"24px 28px",backgroundColor:"var(--bfs-primary-true-white)"}},children:(0,e.jsx)(wp,{onCloseCompanySwitcher:f})})]})};var Ep=m(64745),Mb=m(43314);const Pp=m.p+"6fc86fc6396656dce31b9f50a5d43148.svg",Lb=m.p+"dddfa8bfd6dcfdbdb18acb1be90615a2.svg",Fb=m.p+"0c10a19d1bd9f0afc383c067bf1ae0ef.svg",Bb=m.p+"e36c46dfcb3fb928862df8fba8f643bd.svg",Ip=m.p+"df6b27b63f130303c7a11fafe11b8ed4.svg",Nb=m.p+"5d7f66367ed5135b321da7d9b01fc6cb.svg",Dp=m.p+"a21f20dd8117a93fba74434112591dd6.svg",_b=m.p+"2fe571c945102b6a7080c5d068c1a907.svg",Ub=m.p+"cb89861baf76f3ee3e82f9282514068f.svg",Wb=m.p+"dce1482a0fc074f107180c2a45445d5b.svg",zb=m.p+"8d13ddbe25ff2c39dddf52afe440db88.svg",kp=m.p+"a98a71f74eccc0025815931b9b8e5045.svg",Vb=m.p+"a86817e666860d5eca3a254486fb2346.svg",$b=m.p+"ec2e01048cc8235ca0bc876def282026.svg",Hb=m.p+"0a68371d9efde8166e9d8ebf6e1d2b96.svg",Qb=m.p+"d925c5ec64154a2220fcec801276b5e1.svg";var Pa=(t=>(t[t.SVG=0]="SVG",t[t.MUISVG=1]="MUISVG",t[t.COMPONENT=2]="COMPONENT",t))(Pa||{});const Tp=[{url:"documents",label:"Documents",src:Pp,srcType:0,visible:!0,disabled:!1},{url:"configure",label:"Configure",src:Lb,srcType:0,visible:!0,disabled:!1},{url:"build",label:"Build",src:Fb,srcType:0,visible:!0,disabled:!1},{url:"materials",label:"Materials",src:Bb,SubsRestricted:!0,srcType:0,visible:!0,disabled:!1},{url:"schedule",label:"Schedule",src:Ip,srcType:0,visible:!0,disabled:!1},{url:"budget",label:"Budget",src:Nb,srcType:0,visible:!0,disabled:!1},{url:"crews",label:"Crews",src:Dp,srcType:0,visible:!0,disabled:!1}],sN=[{url:"select_customer",label:"Customers",src:(0,e.jsx)(Ep.A,{}),srcType:1,visible:!0,disabled:!1}],Rp=[{url:"dashboard",label:"Dashboard",src:_b,srcType:0,disabled:["builder"],visible:!0},{url:"select_customer",label:"Customers",src:Hb,srcType:0,disabled:!1,visible:["osr"]},{url:"bids",label:"Quotes",src:Qb,srcType:0,disabled:!1,visible:["osr"]},{url:"catalog",label:"Catalog",src:kp,srcType:0,disabled:!1,visible:["osr"]},{url:"reports",label:"Reports",src:(0,e.jsx)(Mb.A,{}),srcType:1,disabled:!1,visible:["osr"]}],Ia=[{url:"projects",label:"Projects",src:Vb,srcType:0,disabled:!1,visible:!0,linkAccountsEnabled:!0},{url:"orders",label:"Orders",src:Wb,srcType:0,disabled:!1,visible:!0},{url:"statements",label:"Statements",src:Ub,srcType:0,disabled:!1,visible:!0},{url:"catalog",label:"Catalog",src:kp,srcType:0,disabled:!1,visible:!0},{url:"specifications",label:"Specs",src:Pp,srcType:0,disabled:!1,visible:!0},{url:"schedule",label:"Schedule",src:Ip,srcType:0,disabled:!1,visible:!0},{url:"crews",label:"Crews",src:Dp,srcType:0,disabled:!1,visible:!0},{url:"profile",label:"Profile",src:zb,srcType:0,disabled:!1,visible:!0},{url:"digital_tools",label:"Digital Tools",src:$b,srcType:0,disabled:!1,visible:!0}],Op=m.p+"d4b4fdc91485ed2e1173ed30047162f9.svg",Mp="header-nav-grid",Gb=(0,g.Ay)("div")(({theme:t})=>({display:"flex",zIndex:50,height:t.header?.height,overflow:"hidden",position:"fixed",top:0,width:"100%"})),Kb=(0,g.Ay)("div")(({theme:t})=>({display:"flex",flexDirection:"column",zIndex:50,height:t.header?.height,overflow:"hidden",position:"fixed",top:0,width:"100%"})),Yb=(0,g.Ay)("div")`
  display: block;

  ${t=>t.theme.breakpoints.down(ba)} {
    display: none;
  }
`,Cd=({focusContainer:t,project:n,isSupplier:s=!1,renderNavLinks:o})=>{const r=(0,L.useNavigate)(),a=f=>{r(f,{replace:!0})},[i,l]=(0,d.useState)(0),{userHasPermission:c}=(0,Ye.A)();(0,d.useEffect)(()=>{const f=()=>{try{const b=window.pendo?.getActiveGuides();if(b){const x=b.filter(v=>!v.hasBeenSeen()&&v.isAnnouncement()&&!v.isExpired()&&!v.isBeforeStartTime()&&v.shouldBeAddedToResourceCenter()&&!v.outsideTimebox());l(x.length)}}catch{console.warn("Unable to check for active Pendo guides")}};f();const h=setInterval(f,3e3);return()=>clearInterval(h)},[]);const u=c({tool:"customers",action:"view",companyId:n?.companyId,projectId:n?.id}),p=()=>(0,e.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,e.jsx)(Ob,{project:n,isSupplier:s,renderNavLinks:o})});return(0,e.jsx)(Kb,{children:(0,e.jsxs)(Gb,{sx:{backgroundColor:"var(--bfs-11-22-nav-background-gray)",position:"fixed"},"data-testid":Mp,id:Mp,children:[(0,e.jsxs)("div",{style:{position:"relative",flex:0},children:[u===!0?(0,e.jsx)(gp,{src:Op,alt:"mybldr.com logo",onClick:()=>a("/bfs/select_customer")}):(0,e.jsx)(gp,{src:Op,alt:"mybldr.com logo"}),(0,e.jsx)(qb,{})]}),t,(0,e.jsxs)(Yb,{"data-testid":"navigation-grid",sx:{padding:"0px 16px 0px 16px",display:"flex",justifyContent:"space-between",alignSelf:"center",flexGrow:1},children:[(0,e.jsx)("div",{children:o(!1)}),(0,e.jsx)(Jb,{unreadGuidesCount:i})]}),(0,e.jsx)(p,{})]})})},qb=()=>{const{hostname:t}=window.location,s=t.toLowerCase()==="mybldr.com"?"":t.split(".")[0];return s?(0,e.jsx)(E.A,{sx:{position:"absolute",bottom:0,width:"100%",backgroundColor:"lightgray",textAlign:"center"},children:(0,e.jsx)(I.A,{textTransform:"capitalize",lineHeight:"20px",fontFamily:"Roboto",children:s})}):null};var Xb=m(80990),Lp=m.n(Xb),Fp=m(45423),er=m(11154),Hn=m(97190);const Bp=m.p+"52a07bda30eb70eca707248aa4276627.svg",Np=(t,n)=>{window.FS&&t?.externalB2cId&&window.FS("setIdentity",{uid:t?.externalB2cId,properties:{role:n,email:t?.email,displayName:t?.name,mybldrUserId:t?.id}})},Jb=({unreadGuidesCount:t})=>{const{isFlagEnabled:n}=(0,ut.u)(),{isLoggedIn:s,onSignOut:o,user:r}=(0,Pt.A)(),[a,i]=(0,d.useState)(null),[l,c]=(0,d.useState)(!1),{company:u}=(0,je.P)(),{companies:p}=(0,Ye.A)(),{userHighestRole:f,permissionsLoading:h}=(0,we.Sk)(),b=!!a,x=p&&p.length>1,v=(0,Dt.A)(),y=P=>{i(P.currentTarget)},j=()=>{i(null)};if((0,d.useEffect)(()=>{if(s&&r&&Lp()({app_id:"vn7jqq8v",user_id:r.id?.toString(),name:r.name,email:r.email,hide_default_launcher:!0}),window.pendoScriptHasRun&&s){const P={id:r?.email,email:r?.email,full_name:r?.name,mybldr_user_id:r?.id,role:f},C={id:u?.accountNumber,erp_system:u?.erpSystem,mybldr_company_id:u?.id,account_name:u?.name,market:u?.market};pendo.initialize({visitor:P,account:C}),pendo.updateOptions({visitor:P,account:C})}s&&r?.externalB2cId&&Np(r,f)},[r,s,u,h,f]),!s)return null;let A="";r?.name?A=r.name.split(" ")[0]:r?.email?A=r.email.split("@")[0]:A="Home Builder";const w={minWidth:"150px",display:"flex",justifyContent:"flex-start",alignItems:"center",backgroundColor:x?v.palette.grey[200]:"white",color:v.palette.grey[800],padding:"12px 16px",borderTop:"1px solid #E1E3E6"};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(vd,{sx:{maxWidth:"68px",position:"relative"},onClick:y,showLabel:!0,label:(0,e.jsx)(I.A,{sx:{maxWidth:{md:"44px",lg:"44px",xl:"68px"},whiteSpace:"nowrap",color:"var(--light-white)",overflow:"hidden",fontSize:"12px",fontFamily:"Roboto, acumin-pro",fontStyle:"normal",textOverflow:"ellipsis",textAlign:"center",lineHeight:"14px"},children:A}),icon:(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center"},children:(0,e.jsx)(E.A,{sx:{position:"relative"},children:(0,e.jsx)(er.A,{badgeContent:t>0&&n("UseCustomPendoBubble")?t:null,color:"primary",overlap:"circular",sx:{"& .MuiBadge-badge":{backgroundColor:"rgb(30, 84, 186)",color:"white",fontSize:"10px",fontWeight:"normal",minWidth:"unset",width:"16px",height:"16px"}},children:(0,e.jsx)(Pi,{src:Bp,alt:"account navigation icon"})})})}),onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)},className:l===!0?"hovered":""}),(0,e.jsxs)(Hn.A,{anchorEl:a,open:b,onClose:j,MenuListProps:{disablePadding:!0,sx:{backgroundColor:v.palette.grey[200]}},children:[x&&(0,e.jsx)(wp,{onCloseCompanySwitcher:j}),(0,e.jsx)(it.A,{sx:w,onClick:()=>{window.pendo?.isReady?.()||postMessage({status:"help-center-ticket"})},children:(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center",marginLeft:"30px"},children:n("UsePendoHelpCenterTarget")?(0,e.jsx)(ja,{href:void 0,target:"_blank",sx:{paddingLeft:"15px",marginLeft:"-15px"},children:"Resource Center"}):(0,e.jsx)(ja,{href:void 0,target:"_blank",children:"Get Help"})})}),(0,e.jsx)(it.A,{sx:w,onClick:()=>o?.(),children:(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(Fp.A,{sx:{marginRight:1}}),(0,e.jsx)(I.A,{variant:"inherit",children:"Logout"})]})})]})]})},Zb=({project:t,onSelect:n,selected:s,setEditingProject:o,testId:r,hasEditProjectPermission:a,linkedAccountsActive:i=!1})=>{const l=a,c=p=>{p.stopPropagation()},u=()=>{let p="";return s&&l&&(p="white"),!s&&l&&(p="var(--light-info-main)"),s&&!l&&(p="rgb(50, 129, 230)"),!s&&!l&&(p="rgba(50, 129, 230, .3)"),p};return(0,e.jsxs)(ub,{onClick:n,selected:s,"data-testid":r,children:[(0,e.jsxs)(pb,{children:[(0,e.jsxs)(va,{sx:{color:s?"var(--bfs-brand-true-white)":"var(--bfs-primary-true-black)"},children:[t?.projectName,(0,e.jsx)(E.A,{component:"span",sx:{fontWeight:"300",fontSize:"13px",marginLeft:".5rem"},children:`(${t?.projectExternalId})`})]}),t.isSubs&&(0,e.jsx)(xb,{selected:s,children:t.companyName}),!!t?.address?.streetOne&&(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(I.A,{variant:"body2",align:"left",sx:{color:s?"var(--bfs-secondary-support-gray-light)":"var(--bfs-secondary-support-gray-dark)",lineHeight:"15px",paddingBottom:"3px"},children:[t?.address?.streetOne,(0,e.jsx)("br",{}),t?.address?.city,t?.address?.state&&(0,e.jsxs)(e.Fragment,{children:[", ",t?.address?.state," "]}),t?.address.zip]})}),i&&(0,e.jsxs)(I.A,{sx:{fontSize:"14px",color:"#969696"},children:[t.accountNumber," ",t.erpSystem]})]}),(0,e.jsx)(K.A,{variant:"text",onMouseDown:c,disableRipple:!l,onClick:p=>{if(p.stopPropagation(),!l){p.preventDefault();return}o(t)},"data-testid":`edit-${r}`,sx:{padding:"1.5rem 1rem",width:"3rem",fontSize:"16px",marginRight:"25px",fontWeight:"300",transitionProperty:"background-color, box-shadow, border-color, color",transitionDuration:"250ms, 250ms, 250ms, 250ms",cursor:`${l?"pointer":"not-allowed"}`,color:u(),"&:hover":{backgroundColor:`${l?"var(--light-info-shades-4-p)":"transparent"}`}},children:"Edit"})]})};var _p=m(68125),Fo=m(83574),Ks=m(25239),Ri=m(1405),Ys=m(34012);const ev=(t,n,s)=>t.filter(o=>!(n&&!o.archived||!n&&o.archived)),tv={showArchivedProjects:!1,isAppEmbedded:!1,setShowArchivedProjects:t=>{}},Os=()=>(0,d.useContext)(Up),Up=(0,d.createContext)(tv),Wp=m.p+"327c914987b6095e4151f2a8e7b57c95.svg",nv=t=>({top:"90px",height:"calc(100% - 90px)"}),sv=(0,g.Ay)("div")`
  padding: 24px;
  min-width: 564px;
`,Da=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
`,xo=(0,g.Ay)("div")`
  font-size: 14px;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.2;
  letter-spacing: normal;
  color: var(--bfs-primary-true-black);
`,ka=(0,g.Ay)(xo)`
  font-size: 24px;
  font-weight: bold;
`,Oi=(0,g.Ay)(xo)`
  font-size: 16px;
  font-weight: bold;
  align-self: flex-start;
`,ov=(0,g.Ay)(xo)`
  max-width: 412px;
  font-size: 16px;
  font-weight: 400;
  line-height: 24px;
  text-align: left;
`,Mi=(0,g.Ay)("div")`
  padding-top: 16px;
  display: flex;
  flex-direction: column;
`,qs=(0,g.Ay)("div")`
  width: 100%;
  height: 1px;
  background-color: var(--bfs-secondary-support-gray-light);
  margin: 24px 0;
`,Ta=({open:t,closeDrawer:n,testId:s,children:o})=>(0,e.jsx)(Oo.Ay,{anchor:"right",open:t,variant:"temporary",onClose:()=>n(!1),"data-testid":s,PaperProps:{sx:nv},children:(0,e.jsx)(sv,{children:o})});var ss=m(32571),tr=m(46831),Rr=m(58763);const rv=(0,g.Ay)(tr.A)`
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 24px;
  padding: 0 24px;
  padding-right: 0;
  box-sizing: border-box;
  font-weight: bold;
  font-family: acumin-pro;
  color: var(--bfs-primary-true-white);
  letter-spacing: normal;
  line-height: normal;
  text-align: center;
  background-color: #333333;
  width: 100%;
  height: 74px;
`,av=(0,g.Ay)(Rr.A)`
  padding: ${t=>t.padding||"0 24px"};
  width: calc(100% - 48px);
  height: 80px;
`,Sd=(0,g.Ay)(K.A)`
  padding: 25px 5px;
  height: auto;
`,iv=(0,g.Ay)(Ss.A)`
  font-size: 24px;
  color: white;
`,lv=(0,g.Ay)("div")`
  display: flex;
  justify-content: space-between;
  width: 100%;
`,dv=(0,g.Ay)("div")`
  display: flex;
  justify-content: space-between;
  gap: 0.5rem;
`,cv=(0,g.Ay)("div")`
  display: flex;
  width: 35%;
  margin-top: 0;

  ${t=>t.theme.breakpoints.down("lg")} {
    display: none;
  }
`,uv=(0,g.Ay)("div")`
  display: flex;
  height: 100%;
`,pv=(0,g.Ay)("div")(({theme:t,isFullWidth:n})=>({display:"flex",flex:"1 0 0",flexDirection:"column",width:"100%",[t.breakpoints.up("lg")]:{width:n?"100%":"65%"}})),wd=(0,g.Ay)(K.A)`
  text-transform: capitalize !important;
`,Li=({onClose:t,onSubmit:n,onDelete:s,submitText:o="Save",cancelText:r="Cancel",deleteText:a="Delete",destructive:i,disabled:l,deleteDisabled:c,loading:u=!1,buttonAlignment:p})=>(0,e.jsxs)(lv,{sx:{...p&&{justifyContent:p,gap:"8px"}},children:[(0,e.jsx)("div",{children:t&&(0,e.jsx)(wd,{onClick:t,color:"secondary",variant:"contained","data-testid":"cancel",disabled:u,sx:{marginRight:s?"0":"auto"},children:r})}),(0,e.jsxs)(dv,{children:[s&&(0,e.jsx)(wd,{color:"error",onClick:s,variant:"text",disabled:c,children:a}),n&&(0,e.jsx)(wd,{disabled:l||u,onClick:n,variant:"contained","data-testid":"submit",sx:{marginLeft:s?"0":"auto",backgroundColor:i?"#E30014":"#3281E6",color:i?"white":"var(--light-primary-contrast)",":hover":{backgroundColor:i?"#CC0012":"#2B70C7",color:i?"white !important":"var(--light-primary-contrast)"},":disabled":{backgroundColor:i?"#E3001480":"",span:{color:i?"white":""}}},children:u?(0,e.jsx)(bt.A,{size:"1rem"}):o})]})]});var ws=m(36529);const Fi=(0,g.Ay)("div")`
  opacity: 0px;
  right: 0;
`,Ed=(0,g.Ay)("div")`
  padding-top: 24px;
`;var mv=m(65343),Ms=m(77037),nr=m(22477);const Qn=({open:t,onClose:n,onCancel:s,onSubmit:o,onDelete:r,title:a,submitText:i="Save",cancelText:l="Cancel",deleteText:c="Delete",destructive:u,disabled:p,deleteDisabled:f,children:h,testId:b,noFooter:x,loading:v=!1,hideCloseButton:y,customFooter:j,modalWidth:A,contentHeight:w,titleBackgroundColor:P,titleColor:C,closeButtonColor:k,dialogContentPadding:S,dialogActionsPadding:R,SideContent:B,hideBackdrop:T=!1,rootStyle:W,backdropStyle:N,footerButtonAlignment:O,roundedCorners:z=!1,titleStyles:Q={},flexrowStyle:re={},overRideDialogStyles:ue={},fullScreen:le})=>{const F=A||"500px";return(0,e.jsx)(Ms.A,{"data-testid":b,open:t,onClose:n,className:"modal-custom-class",hideBackdrop:T,PaperProps:{sx:{width:F,maxWidth:F,height:w||"auto",margin:"0",boxShadow:"0 4px 4px 0 #00000040;",overflow:"visible",borderRadius:z?"4px":0,backgroundColor:"var(--bfs-primary-true-white)"}},slotProps:{root:{style:W},backdrop:{style:N}},sx:ue,fullScreen:le,children:(0,e.jsxs)(uv,{style:{...re},children:[B&&(0,e.jsx)(cv,{children:(0,e.jsx)(B,{})}),(0,e.jsxs)(pv,{isFullWidth:!B,children:[(0,e.jsxs)(rv,{style:{backgroundColor:P||"",color:C,borderRadius:z?"4px 4px 0 0":void 0,...Q},children:[(0,e.jsx)("div",{children:a}),!y&&(0,e.jsx)(Sd,{onClick:()=>{s?s():n?.()},disabled:v,children:(0,e.jsx)(iv,{style:k?{color:k}:{}})})]}),(0,e.jsx)(nr.A,{style:{padding:S??"32px"},children:h}),!x&&(0,e.jsx)(av,{padding:R,children:j||(0,e.jsx)(Li,{submitText:i,cancelText:l,deleteText:c,destructive:u,disabled:p,deleteDisabled:f,onClose:n,onSubmit:o,onDelete:r,loading:v,buttonAlignment:O})})]})]})})};var qt=m(47839),Gn=m(86531);const zp=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  width: 100%;
  gap: 8px;
`,Vp=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  padding: 16px;
  border: #979493 1px dashed;
  border-radius: 4px;
`,$p=(0,g.Ay)(kn)`
  display: flex;
  flex-direction: column;
  flex: 1;
  box-sizing: border-box;
  overflow: hidden;
`,hv=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  flex-direction: row;
  overflow: hidden;
  padding: 24px;
  gap: 15px;

  @media screen and (max-width: 900px) {
    flex-direction: column;
    overflow-y: auto;
  }
`,gv=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: auto;

  @media screen and (max-width: 900px) {
    overflow: visible;
  }
`,fv=(0,g.Ay)("div")`
  display: flex;
  justify-content: space-between;
  align-items: 'center';
  align-self: 'stretch';
  flex-direction: 'row';
  padding-bottom: 24px;
`,xv=(0,g.Ay)("div")`
  display: grid;
  gap: 15px;
  grid-template-columns: repeat(auto-fill, minmax(362px, 1fr));
  grid-auto-rows: minmax(auto, 310px);
  flex: 1;
  justify-content: space-between;
`,yv=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  object-fit: cover;
  border-radius: 8px;
  background-color: white;
  overflow: hidden;
  cursor: pointer;
`,bv=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  overflow: hidden;
  justify-content: center;
  align-items: center;
`,vv=(0,g.Ay)("div")`
  min-height: 106px;
  box-sizing: border-box;
  width: 100%;
  background-color: #404040;
  padding: 12px 12px 16px 16px;
`,jv=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  align-items: center;
  padding: 8px 0;
`,Av=(0,g.Ay)(jv)`
  padding: 0 0 8px 0;
  flex-direction: column;
  gap: 4px;
  align-items: flex-start;
`,aN=(0,g.Ay)("div")`
  font-size: 16px;
  font-family: 'Roboto';
  font-weight: 600;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  color: var(--bfs-primary-true-white);
`,Cv=(0,g.Ay)("div")`
  font-size: 16px;
  font-weight: 600;
  font-style: normal;
  font-family: Roboto;
  line-height: 24px;
  color: var(--bfs-primary-true-white);
`,Sv=(0,g.Ay)("div")`
  font-size: 14px;
  font-weight: 400;
  font-style: normal;
  font-family: Roboto;
  line-height: 20px;
  color: #cdd0d1;
`,iN=(0,g.Ay)("div")`
  font-size: 16px;
  font-family: 'Roboto';
  font-weight: normal;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  color: var(--bfs-primary-true-white);
`,Hp=(0,g.Ay)("div")`
  flex-grow: 1;
  display: flex;
  flex-direction: row;
  gap: 8px;
  align-items: flex-end;
`,wv=(0,g.Ay)(pt.A)`
  color: var(--bfs-primary-true-white);
  padding: 0;
`,Ev=(0,g.Ay)("img")`
  width: ${t=>t.noPlans?"55px":"190px"};
`,Pv=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  align-items: center;
  height: 64px;
  background-color: #666;
`,Iv=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  background-color: var(--bfs-primary-true-black);
  height: 100%;
  width: 157px;
  align-items: center;
  justify-content: center;
  color: var(--bfs-primary-true-white);
  font-size: 16px;
  line-height: 1.5;
`,Dv=(0,g.Ay)(_.A)`
  background-color: var(--bfs-primary-true-white);
  border-radius: 4px;
  width: 220px;
  height: 40px;
  margin: 0 8px;

  & .MuiFormLabel-root {
    size: 14px;
    color: #a3a3a3;
  }
  & .MuiOutlinedInput-root {
    padding-left: 12px;
    padding-right: 12px;
  }
  & .MuiSvgIcon-root {
    width: 20px;
    height: 20px;
  }
`,kv=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  justify-content: center;
  align-items: center;
  height: 100%;
  color: var(--bfs-primary-true-white);
`,Qp=(0,g.Ay)(K.A)`
  color: white;
  text-align: center;
  text-decoration: none;
  cursor: pointer;
  min-width: 163px;
  height: 38px;
`,lN=(0,g.Ay)(it.A)`
  &:hover {
    background-color: var(--light-primary-dark);
    color: var(--bfs-primary-true-white);
  }
`,Tv=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  padding-bottom: 12px;
  justify-content: flex-start;
  gap: 4px;
`,Rv=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: flex-start;
  gap: 16px;
`,Ov=(0,g.Ay)("div")`
  font-size: 14px;
  font-family: Roboto;
  font-weight: 400;
  line-height: 20px;
  color: #ffffff;
`,Mv=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  padding-right: 12px;
`,Lv=(0,g.Ay)("div")`
  display: flex;
  height: 18px;
  gap: 2px;
  opacity: 0px;
  color: white;
  font-size: 10px;
  font-weight: 400;
  text-align: center;
  align-content: center;
`,Fv=(0,g.Ay)("div")`
  min-width: 50px;
  line-height: 14px;
  padding: 2px 4px 2px 4px;
  gap: 10px;
  border-radius: 2px;
  opacity: 0px;
  align-items: center;
  vertical-align: middle;
  background: #666666;
  font-size: 10px;
  font-weight: 400;
  font-family: 'Roboto';
  text-wrap: nowrap;
`,Bv=(0,g.Ay)(qt.A)`
  padding: 2px 4px 2px 4px;
  align-content: center;
  width: 20px;
`,Nv=(0,g.Ay)(Gn.A)`
  width: 351px;
  gap: 8px;
  border-radius: 4px;
  background: #ffffff;
  margin: 0 12px;
  padding: 0px;
`,_v=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: white;
  width: 450px;
  border-radius: 4px;
  height: fit-content;
  margin-left: auto;

  @media screen and (max-width: 900px) {
    width: 100%;
    order: -1;
  }
`,Uv=(0,g.Ay)(I.A)`
  font-size: 16px;
  line-height: 24px;
  font-family: 'Roboto';
  font-weight: 400;
  color: #5d6062;
`,Gp=({open:t,title:n,showWarning:s,warningText:o,message:r,currentProjectDetails:a,existingProjectDetails:i,acceptButtonText:l,submit:c,cancelButtonText:u,cancel:p,close:f})=>{const h=n.includes("Merge"),b=async()=>{c()},x=()=>{p()},v=()=>{f()};return(0,e.jsx)(Qn,{open:t,title:n,onCancel:x,onClose:v,onSubmit:b,cancelText:u,submitText:l,footerButtonAlignment:"flex-end",modalWidth:"600px",children:(0,e.jsxs)(e.Fragment,{children:[s&&(0,e.jsx)(Rs.A,{severity:"warning",children:o}),(0,e.jsx)(I.A,{style:{marginTop:"20px"},children:r}),(0,e.jsxs)("div",{style:{marginTop:"20px",display:"flex",gap:"16px"},children:[(0,e.jsxs)(zp,{children:[!h&&(0,e.jsx)(I.A,{style:{paddingLeft:"4px"},children:a.externalId?"Selected Project":"New Project"}),(0,e.jsxs)(Vp,{children:[(0,e.jsx)(va,{sx:{color:"var(--bfs-primary-true-black)"},children:a?.name}),!!a?.address?.streetOne&&(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(I.A,{variant:"body2",align:"left",sx:{color:"var(--bfs-secondary-support-gray-dark)",lineHeight:"15px",paddingBottom:"3px"},children:[a?.address?.streetOne,(0,e.jsx)("br",{}),a?.address?.city,a?.address?.state&&(0,e.jsxs)(e.Fragment,{children:[", ",a?.address?.state," "]}),a?.address.zip]})})]})]}),h&&(0,e.jsx)(mv.A,{fontSize:"medium"}),(0,e.jsxs)(zp,{children:[!h&&(0,e.jsx)(I.A,{style:{paddingLeft:"4px"},children:"Existing Project"}),(0,e.jsxs)(Vp,{style:{border:"#979493 1px solid"},children:[(0,e.jsx)(va,{sx:{color:"var(--bfs-primary-true-black)"},children:i?.name}),!!i?.address?.streetOne&&(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(I.A,{variant:"body2",align:"left",sx:{color:"var(--bfs-secondary-support-gray-dark)",lineHeight:"15px",paddingBottom:"3px"},children:[i?.address?.streetOne,(0,e.jsx)("br",{}),i?.address?.city,i?.address?.state&&(0,e.jsxs)(e.Fragment,{children:[", ",i?.address?.state," "]}),i?.address.zip]})})]})]})]})]})})};var Wv=m(16317);const zv=m.p+"92eb5cf10fe114c60c7c5b53212f36e8.svg",Vv=()=>(0,e.jsx)("img",{src:zv,style:{color:"#767676"}}),$v=m.p+"bf36840735cbe2ce80a45977241f6f52.svg",Hv=()=>(0,e.jsx)("img",{src:$v}),Qv=({isSelected:t,name:n,onUpdate:s,disabled:o=!1})=>(0,e.jsx)(ye.A,{id:n,control:(0,e.jsx)(ve.A,{onChange:s,checked:t,icon:(0,e.jsx)(Vv,{}),checkedIcon:(0,e.jsx)(Hv,{}),disabled:o}),label:n,labelPlacement:"end",value:n,sx:{fontWeight:400,fontSize:14}},n),Ls=(0,g.Ay)("div")`
  font-size: 16px;
  font-weight: 500;
  text-align: left;
`,Bo=(0,g.Ay)("div")`
  font-weight: 700;
  font-size: 16px;
`,Pd=(0,g.Ay)(_.A)`
  width: 399px;
  flex-grow: 1;
  margin: 0px;
`,yo=(0,g.Ay)("div")`
  flex-direction: row;
  display: flex;
  gap: 16px;
`,an=(0,g.Ay)("div")`
  flex-direction: column;
  display: flex;
  justify-content: space-evenly;
  align-self: flex-start;
  gap: 8px;
`,Id=(0,g.Ay)(_.A)`
  margin: 0px;
`,pN=null,Kp=(t,n)=>t.filter(s=>s.type===n).map(s=>s.name),Gv=t=>Kp(t,"CUSTOM"),Yp=t=>Kp(t,"SYSTEM");function Bi(){return(0,L.useLocation)().pathname.endsWith("/unmapped")}var Kv=(t=>(t.ALL="All Projects",t.UNMAPPED="Unmapped Projects",t))(Kv||{});function Yv(t){const n=Bi(),s=t?t.communityName:void 0;return n?"Unmapped Projects":s||"All Projects"}function qp(t){return/[a-z]/i.test(t.projectExternalId)}var Dd=m(43247);const qv=(0,Dd.Z)(),Xp="New Label",Xv=({existingLabels:t,selectedLabels:n=[],systemLabels:s=[],onSelectionChange:o,disabled:r=!1})=>{const a=se().useRef(null),[i,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!1),p=(0,d.useMemo)(()=>n.map(v=>({label:v,value:v})),[n]),f=(0,d.useMemo)(()=>{const v=new Set(t);return n.forEach(y=>v.add(y)),Array.from(v).map(y=>({label:y,value:y}))},[t,n]),h=(v,y)=>{const j=qv(v,y),{inputValue:A}=y,w=f.some(P=>P.value.toLocaleLowerCase()===A?.toLocaleLowerCase().trim());return A&&!w&&j.unshift({value:A,label:Xp}),j},b=v=>f.find(y=>y.value.toLowerCase()===v.toLowerCase())?.value??s.find(y=>y.toLowerCase()===v.toLowerCase()),x=v=>v.length>30?(u(!0),l(!1),!1):(u(!1),!0);return(0,e.jsx)(Gn.A,{multiple:!0,value:p,onChange:(v,y)=>{const j=y.map(A=>A.value);if(y.length>0&&y[y.length-1].label===Xp){const A=y[y.length-1].value.trim();if(!x(A))return;const w=b(A)??A;j.pop(),j.push(w)}u(!1),o(j)},open:i,onOpen:()=>l(!0),onClose:()=>l(!1),options:f,filterOptions:h,isOptionEqualToValue:(v,y)=>v.value===y.value,onKeyDown:v=>{const y=v.target.value.trim();if(["Enter",",",";"].includes(v.key)&&y){v.preventDefault();const j=b(y)??y;x(j)&&o([...n,j])}["Enter",",",";"].includes(v.key)&&!y&&(v.preventDefault(),l(!1))},disableClearable:!0,size:"small",selectOnFocus:!0,renderInput:v=>(0,e.jsx)(_.A,{...v,label:"",ref:a,error:c,helperText:c?"Label names need to be less than 30 characters.":void 0}),sx:{maxHeight:92,overflow:"auto",margin:"0 0 1.25rem 0",paddingBottom:"10px"},forcePopupIcon:!1,disabled:r})},Ni=(t,n)=>{const s=(0,Pn.wA)(),{data:o,isLoading:r,isFetching:a,error:i}=(0,ws.h)({companyId:t,hasLinkedAccount:n},{skip:!t}),l=(0,d.useMemo)(()=>[],[]);return{availableProjectLabels:o??l,isLoading:r,isFetching:a,error:i,refetch:()=>{s(ws.Nq.util.invalidateTags(["Labels"]))}}},kd=({onUpdateProjectLabels:t,selectedLabels:n,companyId:s,disabled:o=!1})=>{const{availableProjectLabels:r}=Ni(s,!1),a=h=>{h.target?.checked===!0?i(h.target.value):l(h.target.value)},i=h=>{if(!n.some(x=>x===h)){const x=[...n,h];t(x)}},l=h=>{const b=n.filter(x=>x!==h);t(b)},{defaultLabels:c,customLabels:u,selectedCustomLabels:p,selectedDefaultLabels:f}=(0,d.useMemo)(()=>{const h=Yp(r),b=Gv(r),x=new Set(h),v=n.filter(j=>!x.has(j)),y=n.filter(j=>x.has(j));return{defaultLabels:h,customLabels:b,selectedCustomLabels:v,selectedDefaultLabels:y}},[r,n]);return(0,e.jsxs)(an,{style:{width:"100%"},"data-testid":"project_labels",children:[(0,e.jsx)(Bo,{children:"Project Labels"}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:4},children:c.map(h=>(0,e.jsx)(Qv,{isSelected:n.some(b=>b.includes(h)),name:h,onUpdate:a,disabled:o},h))}),(0,e.jsx)("div",{children:(0,e.jsx)(Xv,{existingLabels:u,selectedLabels:p,systemLabels:c,onSelectionChange:h=>{const b=[...f,...h],x=Array.from(new Set(b));t(x)},disabled:o})})]})},_i=["AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];function mN(t){const n={name:"",abbreviation:""};if(t.length!==5)return n;const s=parseInt(t,10);if(s>=35e3&&s<=36999)n.abbreviation="AL",n.name="Alabama";else if(s>=99500&&s<=99999)n.abbreviation="AK",n.name="Alaska";else if(s>=85e3&&s<=86999)n.abbreviation="AZ",n.name="Arizona";else if(s>=71600&&s<=72999)n.abbreviation="AR",n.name="Arkansas";else if(s>=9e4&&s<=96699)n.abbreviation="CA",n.name="California";else if(s>=8e4&&s<=81999)n.abbreviation="CO",n.name="Colorado";else if(s>=6e3&&s<=6389||s>=6391&&s<=6999)n.abbreviation="CT",n.name="Connecticut";else if(s>=19700&&s<=19999)n.abbreviation="DE",n.name="Delaware";else if(s>=32e3&&s<=34999)n.abbreviation="FL",n.name="Florida";else if(s>=3e4&&s<=31999||s>=39800&&s<=39999)n.abbreviation="GA",n.name="Georgia";else if(s>=96700&&s<=96999)n.abbreviation="HI",n.name="Hawaii";else if(s>=83200&&s<=83999&&s!==83414)n.abbreviation="ID",n.name="Idaho";else if(s>=6e4&&s<=62999)n.abbreviation="IL",n.name="Illinois";else if(s>=46e3&&s<=47999)n.abbreviation="IN",n.name="Indiana";else if(s>=5e4&&s<=52999)n.abbreviation="IA",n.name="Iowa";else if(s>=66e3&&s<=67999)n.abbreviation="KS",n.name="Kansas";else if(s>=4e4&&s<=42999)n.abbreviation="KY",n.name="Kentucky";else if(s>=7e4&&s<=71599)n.abbreviation="LA",n.name="Louisiana";else if(s>=3900&&s<=4999)n.abbreviation="ME",n.name="Maine";else if(s>=20600&&s<=21999)n.abbreviation="MD",n.name="Maryland";else if(s>=1e3&&s<=2799||s===5501||s===5544)n.abbreviation="MA",n.name="Massachusetts";else if(s>=48e3&&s<=49999)n.abbreviation="MI",n.name="Michigan";else if(s>=55e3&&s<=56899)n.abbreviation="MN",n.name="Minnesota";else if(s>=38600&&s<=39999)n.abbreviation="MS",n.name="Mississippi";else if(s>=63e3&&s<=65999)n.abbreviation="MO",n.name="Missouri";else if(s>=59e3&&s<=59999)n.abbreviation="MT",n.name="Montana";else if(s>=27e3&&s<=28999)n.abbreviation="NC",n.name="North Carolina";else if(s>=58e3&&s<=58999)n.abbreviation="ND",n.name="North Dakota";else if(s>=68e3&&s<=69999)n.abbreviation="NE",n.name="Nebraska";else if(s>=88900&&s<=89999)n.abbreviation="NV",n.name="Nevada";else if(s>=3e3&&s<=3899)n.abbreviation="NH",n.name="New Hampshire";else if(s>=7e3&&s<=8999)n.abbreviation="NJ",n.name="New Jersey";else if(s>=87e3&&s<=88499)n.abbreviation="NM",n.name="New Mexico";else if(s>=1e4&&s<=14999||s===6390||s===501||s===544)n.abbreviation="NY",n.name="New York";else if(s>=43e3&&s<=45999)n.abbreviation="OH",n.name="Ohio";else if(s>=73e3&&s<=73199||s>=73400&&s<=74999)n.abbreviation="OK",n.name="Oklahoma";else if(s>=97e3&&s<=97999)n.abbreviation="OR",n.name="Oregon";else if(s>=15e3&&s<=19699)n.abbreviation="PA",n.name="Pennsylvania";else if(s>=300&&s<=999)n.abbreviation="PR",n.name="Puerto Rico";else if(s>=2800&&s<=2999)n.abbreviation="RI",n.name="Rhode Island";else if(s>=29e3&&s<=29999)n.abbreviation="SC",n.name="South Carolina";else if(s>=57e3&&s<=57999)n.abbreviation="SD",n.name="South Dakota";else if(s>=37e3&&s<=38599)n.abbreviation="TN",n.name="Tennessee";else if(s>=75e3&&s<=79999||s>=73301&&s<=73399||s>=88500&&s<=88599)n.abbreviation="TX",n.name="Texas";else if(s>=84e3&&s<=84999)n.abbreviation="UT",n.name="Utah";else if(s>=5e3&&s<=5999)n.abbreviation="VT",n.name="Vermont";else if(s>=20100&&s<=20199||s>=22e3&&s<=24699||s===20598)n.abbreviation="VA",n.name="Virginia";else if(s>=2e4&&s<=20099||s>=20200&&s<=20599||s>=56900&&s<=56999)n.abbreviation="DC",n.name="Washington DC";else if(s>=98e3&&s<=99499)n.abbreviation="WA",n.name="Washington";else if(s>=24700&&s<=26999)n.abbreviation="WV",n.name="West Virginia";else if(s>=53e3&&s<=54999)n.abbreviation="WI",n.name="Wisconsin";else if(s>=82e3&&s<=83199||s===83414)n.abbreviation="WY",n.name="Wyoming";else return n;return n}const Ui=({onChange:t,initialValue:n,disabled:s=!1,hasError:o,helperText:r})=>{const a=()=>s&&n?n:"ST",i=_i.map(l=>({label:l,value:l}));return(0,e.jsx)(Gn.A,{renderInput:l=>(0,e.jsx)(_.A,{...l,placeholder:a(),helperText:r,error:o?o("state"):!1}),"data-testid":"state-select",sx:{flex:1},options:i,onChange:(l,c)=>t(c?.value??""),defaultValue:i.find(l=>l.value===n),clearIcon:null,disableClearable:!0,isOptionEqualToValue:(l,c)=>l.value===c.value,disabled:s,autoHighlight:!0,autoSelect:!0})},Ra=(0,Lo.xP)({baseQuery:(0,Zo.S)({baseUrl:"/api"}),reducerPath:"communities",keepUnusedDataFor:1,tagTypes:["Communities"],endpoints:t=>({getCommunities:t.query({query:({companyId:n,hasLinkedAccount:s})=>({url:`/companies/${n}/community${s?"?linked=True":""}`}),transformResponse:n=>(0,Ze.bn)(n),providesTags:["Communities"]}),createCommunity:t.mutation({query:({companyId:n,communityData:s})=>({url:`/companies/${n}/community`,method:"POST",data:{communityData:s}}),transformResponse:n=>(0,Ze.bn)(n),invalidatesTags:["Communities"]}),updateCommunity:t.mutation({query:({companyId:n,communityData:s})=>({url:`/companies/${n}/community/${s.communityId}`,method:"PUT",data:{communityData:s}}),transformResponse:n=>(0,Ze.bn)(n),invalidatesTags:["Communities"]}),deleteCommunity:t.mutation({query:({companyId:n,communityId:s})=>({url:`/companies/${n}/community/${s}`,method:"DELETE"}),invalidatesTags:["Communities"]})})}),{useGetCommunitiesQuery:Jp,useCreateCommunityMutation:Zp,useUpdateCommunityMutation:Jv,useDeleteCommunityMutation:em}=Ra,Wi=t=>{const{company:n}=(0,je.P)(),s=(0,Pn.wA)(),{data:o,isLoading:r,isFetching:a,error:i}=Jp({companyId:n?.id,hasLinkedAccount:t},{skip:!n?.id}),l=(0,d.useMemo)(()=>[],[]);return{communities:o??l,isLoading:r,isFetching:a,error:i,refetch:()=>{s(Ra.util.invalidateTags(["Communities"]))}}},Td=({onUpdate:t,selectedCommunityId:n,disabled:s})=>{const{isActive:o}=(0,ss.F)(),{communities:r}=Wi(o),{isFlagEnabled:a}=(0,ut.u)(),i=(0,d.useMemo)(()=>r?.find(c=>c.communityId===n),[r,n]),l=c=>{const u=r.find(p=>p.communityId===parseInt(c.target.value));t(u?parseInt(c.target.value):null)};return!a(D.SX.COMMUNITIES)||r.length===0?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Bo,{children:"Community"}),(0,e.jsx)(yo,{children:(0,e.jsxs)(go.A,{id:"community",fullWidth:!0,value:i?.communityId.toString()??"",onChange:l,role:"list",variant:"outlined",MenuProps:{style:{maxHeight:400,minWidth:89}},style:{minWidth:89},disabled:s,children:[(0,e.jsx)(it.A,{value:"",children:"No community selected"},"unselected"),r.map(c=>(0,e.jsx)(it.A,{value:c.communityId,children:c.communityName},c.communityId))]})})]})};var ct=m(30583);const Zv=({formValues:t,updateForm:n,hasErrors:s,jobIdError:o})=>{const r={margin:"0 0 1.25rem 0",height:"3rem",paddingBottom:"10px"},{company:a}=(0,je.P)(),i=a?.erpSystem==="SAPS4HANA",{jobIdList:l}=(0,Ys.Y)({searchTerm:"",shouldRefetch:!1}),c=(0,d.useMemo)(()=>i?l.filter(j=>/^\d{9,16}$/.test(j)):l,[l,i]),{allRoles:u}=(0,we.Sk)(),{isFlagEnabled:p}=(0,ut.u)(),{isActive:f,defaultLinkedAccount:h}=(0,ss.F)(),b=f?h?.companyId:a?.id,x=(j,A)=>{n(j,A)},v=j=>s(j)?"This field is required":" ",y=()=>{const j=(0,Dt.A)().palette.error.main;return(0,e.jsx)(Ks.A,{position:"start",children:(0,e.jsx)(Wv.A,{sx:{color:j}})})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(an,{children:[(0,e.jsx)(Bo,{children:"Project Name"}),(0,e.jsx)(_.A,{autoFocus:!0,autoComplete:"off",margin:"normal",id:"projectName",fullWidth:!0,sx:r,variant:"outlined",required:!0,error:s("name"),helperText:v("name"),inputProps:{maxLength:50,"data-testid":"projectName"},InputProps:{startAdornment:s("name")?(0,e.jsx)(y,{}):null},onChange:j=>x("name",j.target.value),placeholder:"Enter project Name"})]}),(0,e.jsx)(an,{children:(0,e.jsx)(Td,{onUpdate:j=>x("communityId",j),selectedCommunityId:t.communityId??null})}),((0,ct.qE)(u)||(0,ct.gx)(u))&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(an,{children:[(0,e.jsx)(Bo,{children:"Job ID"}),(0,e.jsx)(Gn.A,{freeSolo:!0,disabled:(0,ct.gx)(u)&&!(0,ct.qE)(u),options:c,onChange:(j,A)=>{x("jobId",A?String(A):"")},onInputChange:(j,A)=>{x("jobId",A?String(A):"")},value:t.jobId||"",renderInput:j=>(0,e.jsx)(_.A,{...j,onBlur:A=>{const w=A.target.value.trim();x("jobId",w)},onKeyDown:A=>{A.key===" "&&i&&A.preventDefault()},onPaste:A=>{if(i){const w=(A.clipboardData||window.Clipboard).getData("text");/\s/.test(w)&&A.preventDefault();const P=w.replace(/\s+/g,"");x("jobId",P),j.inputProps&&j.inputProps.ref&&typeof j.inputProps.ref!="function"&&j.inputProps.ref.current&&(j.inputProps.ref.current.value=P)}},autoComplete:"off",margin:"normal",id:"jobId",fullWidth:!0,sx:r,variant:"outlined",error:o,helperText:i?"Job Id must be a numeric value between 9 and 16 characters":"Job Id can be up to 16 characters",FormHelperTextProps:{sx:{color:i?"text.secondary":"error.main"}},inputProps:{...j.inputProps,minLength:i?9:null,maxLength:16,"data-testid":"JobId"},InputProps:{...j.InputProps,startAdornment:o?(0,e.jsx)(y,{}):null},placeholder:i?"Job Id must be a numeric value between 9 and 16 characters":"Enter Job ID"})})]}),(0,e.jsx)(qs,{})]}),p(D.SX.PROJECT_SYSTEM_LABELS)&&(0,e.jsx)(an,{children:(0,e.jsx)(kd,{onUpdateProjectLabels:j=>x("labels",j),selectedLabels:t.labels?t.labels:[],companyId:b})}),(0,e.jsx)(qs,{}),(0,e.jsxs)(an,{children:[(0,e.jsx)(Bo,{children:"Location"}),(0,e.jsx)(yo,{children:(0,e.jsx)(an,{style:{width:"100%"},children:(0,e.jsx)(_.A,{margin:"normal",id:"street",autoComplete:"off",fullWidth:!0,sx:r,variant:"outlined",placeholder:"Street Address or Job Description",onChange:j=>x("street",j.target.value)})})}),(0,e.jsxs)(yo,{children:[(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"City"}),(0,e.jsx)(Pd,{margin:"normal",autoComplete:"off",id:"city",error:s("city"),helperText:v("city"),placeholder:"City",InputProps:{startAdornment:s("city")?(0,e.jsx)(y,{}):null},inputProps:{"data-testid":"city-input"},onChange:j=>x("city",j.target.value)})]}),(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"State"}),(0,e.jsx)(Ui,{onChange:j=>x("state",j),helperText:v("state"),hasError:()=>s("state")})]}),(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"Zip"}),(0,e.jsx)(Id,{margin:"normal",id:"zip",autoComplete:"off",variant:"outlined",error:s("zip"),helperText:v("zip"),InputProps:{startAdornment:s("zip")?(0,e.jsx)(y,{}):null},inputProps:{"data-testid":"zip-input"},placeholder:"Zip",onChange:j=>x("zip",j.target.value)})]})]})]})]})},Oa=m.p+"754c7aaa62d58dfc9907523637076c9b.svg",tm=({closeDrawer:t,quoteData:n})=>{const{isActive:s,defaultLinkedAccount:o}=(0,ss.F)(),{company:r}=(0,je.P)(),a=r?.erpSystem==="SAPS4HANA",i=s?o?.companyId:r?.id,[l,c]=(0,d.useState)(!1),u=!!n,[p,f]=(0,d.useState)({name:!1,streetOne:!1,city:!1,state:!1,zip:!1,jobId:!1}),{showSuccess:h,showError:b}=(0,Fe.d)(),x=(0,L.useNavigate)(),{selectProject:v}=(0,De.B)(),[y,j]=(0,ws.AQ)(),[A,w]=(0,d.useState)(!1),[P,C]=(0,d.useState)({id:"",externalId:"",name:"",address:{streetOne:"",city:"",state:"",zip:""}}),[k,S]=(0,d.useState)({id:"",externalId:"",name:"",address:{streetOne:"",city:"",state:"",zip:""}}),[R,B]=(0,ws.P3)(),[T,W]=(0,d.useState)({name:"",street:"",city:"",state:"",zip:"",companyId:r?.id,communityId:null,jobId:null}),[N,O]=(0,ws.SU)(),z=(0,d.useCallback)((G,Y)=>{W(he=>({...he,[G]:Y}))},[]),Q=G=>{let Y={};return u?Y={name:!G.name.trim(),city:!G.city?.trim(),state:!G.state?.trim(),zip:!G.zip?.trim()}:Y={name:!G.name.trim()},f({...p,...Y}),Object.values(Y).every(he=>!he)},re=G=>/^\d{9,16}$/.test(G),ue=()=>{let G=T.jobId;return a&&G!==""&&G!==null?(c(!re(G||"")),!re(G||"")):(c(!1),!1)},le=G=>{t(G)};(0,d.useEffect)(()=>{j.isSuccess&&(h({message:"Project created"}),le(!0))},[j.isSuccess]),(0,d.useEffect)(()=>{B.isError&&b({message:"Failed to check for duplicate project address. Please try again."})},[B.isError]),(0,d.useEffect)(()=>{j.error?.status===409?b({title:"Project cannot be created",message:"We're sorry! All project names must be unique. Please try creating your project again with a different name, and contact Customer Support if the problem persists or you feel it is in error."}):j.error&&b({message:"Failed to create project"})},[j.error]);const F=async()=>{const G=T.name,Y=T.street,he=T.city,ne=T.state,J=T.zip;C({id:"",externalId:"",name:G,address:{streetOne:Y,city:he,state:ne,zip:J}});try{const pe=await R({companyId:i,address:{streetOne:Y,city:he,state:ne,zip:J}}).unwrap();if(pe.counts.count===1){const Ee=pe.projects[0];return S({id:String(Ee.id),externalId:Ee.projectExternalId,name:Ee.projectName,address:{streetOne:Ee.address?.streetOne||"",city:Ee.address?.city||"",state:Ee.address?.state||"",zip:Ee.address?.zip||""}}),!0}else return!1}catch(pe){return console.log("failed to check for duplicate project address",pe),!1}},V=async(G=!0)=>{const Y=G&&T.street?.toLowerCase()!=="TBD"&&T.street?.trim()!=="";let he=!1;if(Y&&(he=await F()),he)w(!0);else{const ne={name:T.name,street:T.street,city:T.city,state:T.state,zip:T.zip,labels:T.labels,companyId:i,quoteData:n,communityId:T.communityId,jobId:T.jobId};if(!Q(ne)||ue())return;try{const pe=(await y(ne).unwrap()).projectId;x(`/projects/${pe}/documents`)}catch(J){console.error("project failed to update",J)}}},$=async()=>{if(n){const G={...n,destinationProjectId:k.externalId},Y={companyId:r?.id,name:k.name,quoteData:G};try{const ne=(await N(Y).unwrap()).projectId;x(`/projects/${ne}/documents`)}catch(he){console.error("project quote failed to update",he)}}else v(parseInt(k.id),k.externalId,G=>x(`/projects/${G}/documents`),G=>b({message:G}))},ee=G=>p[G],X=j.isLoading||B.isFetching||O.isLoading;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Gp,{open:A,title:"Existing Project",showWarning:!0,warningText:"This address is currently associated with an existing project.",message:"The address you have entered is currently associated with an existing project. Would you like to use the existing project or continue creating a new one?",currentProjectDetails:P,existingProjectDetails:k,acceptButtonText:"Use Existing Project",submit:()=>$(),cancelButtonText:"Create New Project",cancel:()=>w(!1),close:()=>V(!1)}),(0,e.jsxs)(Fi,{"data-testid":"manually-create-project-form",children:[!u&&(0,e.jsxs)(Da,{children:[(0,e.jsx)("div",{style:{flexDirection:"column",display:"flex",gap:8},children:(0,e.jsx)(ka,{children:"New Project Details"})}),(0,e.jsx)(pt.A,{onClick:()=>le(!1),children:(0,e.jsx)("img",{src:Oa,alt:"close"})})]}),(0,e.jsx)(Zv,{formValues:T,updateForm:z,hasErrors:ee,jobIdError:l}),(0,e.jsx)(Ed,{children:(0,e.jsx)(Li,{onClose:()=>le(!1),submitText:"Create Project",onSubmit:()=>V(),disabled:X,loading:X,buttonAlignment:"flex-end"})})]})]})},Rd=({open:t,closeDrawer:n,quoteData:s})=>(0,e.jsx)(Ta,{open:t,closeDrawer:()=>{},children:t?(0,e.jsx)(tm,{closeDrawer:n,quoteData:s}):null});var Od=m(87458),sr=m(29571),Or=m(97096),nt=m(66251);function ej(){async function t(r,a=1){const l=await nt.Ay.get("/budgeting/autocomplete_qb_customer/",{params:{page:a,forward:{company:r.id?.toString()}}});return!!l?.data?.pagination?.more?[...l.data.results,...await t(r,a+1)]:l.data.results}async function n(r,a=1){const i=`/budgeting/autocomplete_qb_configured_company/?page=${a}`,l=await nt.Ay.get(i),c=!!l?.data?.pagination?.more,u=!!l.data.results?.find(p=>p.id===r?.id?.toString());return c?u||await n(r,a+1):u}async function s(r){const a=`/budgeting/project/${r}/qb_customer_mappings`,i=await nt.Ay.get(a);return i.data.length>0?{customer_id:i.data[0].customer_id,id:i.data[0].customer_id,text:i.data[0].customer_name}:null}async function o(r,a,i){const l=`/budgeting/project/${r}/qb_customer_mappings`,c={projectId:r,projectName:a,customerId:i.id,customerName:i.text};return(await nt.Ay.post(l,c)).data}return{getCustomerList:t,hasQuickbooksIntegration:n,getQuickbooksCustomer:s,updateQuickbooksCustomer:o}}const tj=({onClose:t,project:n})=>{const{createProjectFromNullId:s}=(0,De.B)(),[o,r]=(0,d.useState)(""),[a,i]=(0,d.useState)(""),[l,c]=(0,d.useState)(""),[u,p]=(0,d.useState)(""),[f,h]=(0,d.useState)(""),[b,x]=(0,d.useState)(null),{jobIdList:v}=(0,Ys.Y)({searchTerm:"",shouldRefetch:!1}),{updateProject:y}=(0,Or.A)(),{refetch:j}=Ni(n?.companyId,!1),{company:A}=(0,je.P)(),w=A?.erpSystem==="SAPS4HANA",P=(0,d.useMemo)(()=>w?v.filter(Xe=>/^\d{9,16}$/.test(Xe)):v,[v,w]),[C,k]=(0,d.useState)(!1),{allRoles:S}=(0,we.Sk)(),{getCustomerList:R,getQuickbooksCustomer:B,updateQuickbooksCustomer:T,hasQuickbooksIntegration:W}=ej(),{isFlagEnabled:N}=(0,ut.u)(),O=N(D.SX.QUICK_BOOKS_PROJECT_EDIT),[z,Q]=(0,d.useState)([]),[re,ue]=(0,d.useState)(null),[le,F]=(0,d.useState)(!1),[V,$]=(0,d.useState)(!1),[ee,X]=(0,d.useState)(null),[G,Y]=(0,d.useState)(!1),[he,ne]=(0,d.useState)(!1),{userHasPermission:J,isUserPermissionsLoading:pe}=(0,Ye.A)(),[Ee,Te]=(0,d.useState)([]),[me,$e]=(0,d.useState)();(0,d.useEffect)(()=>{if(n&&n.id){X(n.id);return}async function Xe(){if(n&&!n.id&&s&&A?.id!==void 0){const dt=await s(A.id,n.projectExternalId,!1);X(dt.id??null)}}Xe()},[n,s]),(0,d.useEffect)(()=>{if(!A||!ee)return;async function Xe(){F(!0),Promise.all([R(A),B(ee),W(A)]).then(dt=>{const[Tn,In,Ct]=dt;Q(Tn),ue(In),$(Ct),F(!1)})}he&&O?Xe():F(!1)},[ee,A,he,O]);const gt=J({tool:D.w5.PROJECTS,action:D.a2.MAP_QUICKBOOKS_PROJECT,projectId:n?.id,companyId:A?.id});(0,d.useEffect)(()=>{!!n&&!!A&&!pe&&ne(gt)},[pe,n,A]);const Rt={margin:"0 0 1.25rem 0",height:"3rem"};(0,d.useLayoutEffect)(()=>{n&&(r(n.projectName),c(n.address?.city||""),h(n.address?.zip||""),p(n.address?.state||""),i(n.address?.streetOne||""),Te(n.labels||[]),$e(n.communityId||null),x(n.onlineJobId))},[s,n]);const rt=async()=>{!re||!ee||await T(ee,o,re)},Ue=async()=>{if(!ee||ge())return;Y(!0);const Xe={name:o,address:{street_one:a,city:l,state:u,zip:f},labels:Ee};n?.communityId!==me&&(Xe.communityId=me),n?.onlineJobId!==b&&(Xe.onlineJobId=b),Promise.all([y(ee,Xe),rt()]).then(()=>{Y(!1),t(!0),j()}).catch(()=>{Y(!1),t(!1),j()})},lt=()=>{if(n)return o?" ":"Project name is required"},ge=()=>w&&b!==n?.onlineJobId&&b!==null?(k(!We(b)),!We(b)):(k(!1),!1),We=Xe=>/^\d{9,16}$/.test(Xe),At=!!n&&!o,xn=he&&O&&V&&!le,on=he&&O&&le;return(0,e.jsxs)(Fi,{"data-testid":"edit-modal",children:[(0,e.jsxs)(Da,{children:[(0,e.jsx)(ka,{children:"Project Details"}),(0,e.jsx)(pt.A,{onClick:()=>t(),children:(0,e.jsx)("img",{src:Oa,alt:"close"})})]}),(0,e.jsxs)(tt,{width:"100%",children:[(0,e.jsxs)(an,{children:[(0,e.jsx)(Bo,{children:"Project Name"}),(0,e.jsx)(_.A,{autoFocus:!0,autoComplete:"off",margin:"normal",id:"project",label:"Project Name",fullWidth:!0,sx:Rt,variant:"outlined",onChange:Xe=>r(Xe.target.value),required:!0,error:At,helperText:lt(),value:o,inputProps:{maxLength:50}})]}),(0,e.jsx)(Td,{onUpdate:Xe=>$e(Xe),selectedCommunityId:me}),(0,e.jsxs)(an,{children:[(0,e.jsx)(Bo,{children:"Job ID"}),(0,e.jsx)(Gn.A,{freeSolo:!0,disabled:(0,ct.gx)(S)&&!(0,ct.qE)(S),options:P,onChange:(Xe,dt)=>x(dt?String(dt):null),onInputChange:(Xe,dt)=>x(dt?String(dt):null),value:b,renderInput:Xe=>(0,e.jsx)(_.A,{...Xe,id:"jobId",autoComplete:"off",margin:"normal",onBlur:dt=>{const Tn=dt.target.value.trim();x(Tn||null)},onKeyDown:dt=>{dt.key===" "&&w&&dt.preventDefault()},onPaste:dt=>{if(w){const Tn=(dt.clipboardData||window.Clipboard).getData("text");/\s/.test(Tn)&&dt.preventDefault();const In=Tn.replace(/\s+/g,"");x(In),Xe.inputProps&&Xe.inputProps.ref&&typeof Xe.inputProps.ref!="function"&&Xe.inputProps.ref.current&&(Xe.inputProps.ref.current.value=In)}},label:w?"Job Id must be a numeric value between 9 and 16 characters":"Enter Job ID",fullWidth:!0,sx:Rt,variant:"outlined",error:At||C,helperText:w?"Job Id must be a numeric value between 9 and 16 characters":"Job Id can be up to 16 characters",FormHelperTextProps:{sx:{color:w?"text.secondary":"error.main"}},inputProps:{...Xe.inputProps,minLength:w?9:null,maxLength:16}})})]}),(0,e.jsx)(qs,{}),N(D.SX.PROJECT_SYSTEM_LABELS)&&(0,e.jsx)(kd,{onUpdateProjectLabels:Te,selectedLabels:Ee,companyId:n?.companyId}),(0,e.jsx)(Bo,{children:"Location"}),(0,e.jsx)(yo,{children:(0,e.jsxs)(an,{style:{width:"100%"},children:[(0,e.jsx)(Ls,{children:"Street Address / Job Description"}),(0,e.jsx)(_.A,{margin:"normal",id:"address",autoComplete:"off",label:"Street Address / Location Description",fullWidth:!0,sx:Rt,variant:"outlined",onChange:Xe=>i(Xe.target.value),value:a})]})}),(0,e.jsxs)(yo,{children:[(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"City"}),(0,e.jsx)(Pd,{margin:"normal",id:"city",autoComplete:"off",label:"City",variant:"outlined",onChange:Xe=>c(Xe.target.value),value:l})]}),(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"State"}),(0,e.jsx)(Ui,{onChange:Xe=>p(Xe),initialValue:n?.address?.state})]}),(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"Zip"}),(0,e.jsx)(Id,{margin:"normal",id:"zip",autoComplete:"off",label:"Zip",variant:"outlined",onChange:Xe=>h(Xe.target.value),value:f})]})]}),on&&(0,e.jsx)("div",{style:{width:"100%",marginTop:"16px",padding:"0 4px"},children:(0,e.jsx)(Od.A,{})}),xn&&(0,e.jsxs)(Be.A,{fullWidth:!0,"data-testid":"quickbooks-mapping-select",children:[(0,e.jsx)(sr.A,{id:"quickbooksCustomer",children:"QuickBooks Project / Customer"}),(0,e.jsx)(go.A,{fullWidth:!0,labelId:"quickbooksCustomer",id:"quickbooksCustomer",value:re?.customer_id||"",variant:"standard",onChange:Xe=>ue(z.find(dt=>dt.customer_id===Xe.target.value)||null),MenuProps:{style:{maxHeight:250},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},children:z.map(Xe=>(0,e.jsx)(it.A,{value:Xe.customer_id,children:Xe.text},Xe.id))})]})]}),(0,e.jsx)(Ed,{children:(0,e.jsx)(Li,{onClose:G?()=>null:t,submitText:"Save Project Details",onSubmit:Ue,disabled:At||!ee,loading:G})})]})},nm=({open:t,closeDrawer:n,project:s})=>(0,e.jsx)(Ta,{open:t,closeDrawer:()=>{},children:t?(0,e.jsx)(tj,{onClose:n,project:s}):null}),gN=t=>{const n=new Date(t),s=new Date,r=new Date(s.getDate()+1).valueOf()-s.valueOf();return n.valueOf()-s.valueOf()<r?"Tomorrow":n.toLocaleDateString()},Md=(t,n,s,o)=>{if(typeof t.visible=="boolean")return t.visible;const r=(0,ct.EL)(n),a=n.has(we.wy.CompanyManager);return t.url==="orders"&&s===An.v.AS400?!1:!!(r&&t.visible.includes("osr")||o&&t.visible.includes("builder"))},Ma=(t,n)=>{if(typeof t.disabled=="boolean")return t.disabled;const s=(0,ct.EL)(n),o=n.has(we.wy.CompanyManager);return!!(s&&t.disabled.includes("osr")||o&&t.disabled.includes("builder"))},sm=(t,n)=>{let s,o=null,r=null;return t.includes("/companies/")?(s=Ia.find(i=>t.includes(i.url)),o="company",r=n.companyId):t.includes("/projects/")?(s=Tp.find(i=>t.includes(i.url)),o="project",r=n.projectId):t.includes("/bfs/")&&(s=Rp.find(i=>t.includes(i.url))),{tool:s?.label.toLowerCase(),content_type:o,object_id:r}},om=()=>{const{company:t}=(0,je.P)(),{companies:n}=(0,Ye.A)(),{isActive:s,defaultLinkedAccount:o}=(0,ss.F)(),r=(0,L.useLocation)(),a=(0,L.useParams)(),i=(0,d.useMemo)(()=>Ia.filter(c=>c.linkAccountsEnabled).map(c=>c.label.toLowerCase()),[]);return(0,d.useMemo)(()=>{const{tool:c}=sm(r.pathname,a),u=i.includes(c??"");return!s||!u?t?.name:n?.find(f=>f.id===o?.companyId)?.name??t?.name??""},[r.pathname,a,o,n,t,i,s])},nj=({closeFn:t,selectedProjectId:n,onProjectSelect:s})=>{const{canUseFocus:o,appFocus:r,switchFocus:a}=(0,On.ho)(),[i,l]=(0,d.useState)(""),[c,u]=(0,d.useState)(!1),[p,f]=(0,d.useState)(null),{showArchivedProjects:h,setShowArchivedProjects:b}=Os(),{company:x}=(0,je.P)(),{userHasPermission:v}=(0,Ye.A)(),y=(0,L.useNavigate)(),{allRoles:j}=(0,we.Sk)(),A=v({tool:D.w5.PROJECTS,action:D.a2.CREATE_PROJECT,companyId:x?.id,projectId:void 0}),w=v({tool:D.w5.PROJECTS,action:D.a2.EDIT_PROJECT,companyId:x?.id,projectId:+n}),{projectList:P,isLoading:C,isFetching:k,refetch:S}=(0,Ys.Y)({searchTerm:i,showErrorMessage:!0,shouldRefetch:i!=="",showArchived:h,shouldLink:!0}),{isActive:R,isLoading:B}=(0,ss.F)(),[T,W]=(0,d.useState)(P),N=C||k;(0,d.useEffect)(()=>{let V=[...P].filter(ee=>!!ee.archived===h);const $=V.findIndex(ee=>ee.projectExternalId===n);if($!==-1){const ee=V.splice($,1)[0];W([ee,...V])}else W(V)},[P,n,h]);const O=i.length>=3,z=O||h?ev(P,h):T,Q=({linkedAccountsActive:V=!1})=>(0,e.jsx)(mb,{role:"listbox",children:z.map($=>(0,e.jsx)(Zb,{project:$,selected:$.projectExternalId===n,onSelect:()=>{s($.id,$.projectExternalId,$?.companyId)},testId:`project-${$.projectExternalId}`,setEditingProject:f,hasEditProjectPermission:w,linkedAccountsActive:V},$.projectExternalId))}),re=()=>(0,e.jsx)(bt.A,{sx:{alignSelf:"center"},size:"25px",thickness:5}),ue=()=>{u(!0)},le=()=>{u(!1),t()},F=()=>{(0,ct.EL)(j)?a(_t.O.BFS):y(`/companies/${x?.id}/statements`)};return(0,e.jsxs)(db,{"data-testid":"project-drawer",children:[o(_t.O.BFS)&&(0,e.jsx)(rj,{isSelected:r===_t.O.BFS,onClick:()=>F()}),o(_t.O.BUILDER_TOOLS)&&(0,e.jsx)(aj,{isSelected:r===_t.O.BUILDER_TOOLS,onClick:()=>a(_t.O.BUILDER_TOOLS)}),(0,e.jsx)(oj,{searchValue:i,setSearchValue:l,triggerUploaderModal:ue,showArchived:h,setShowArchived:b,canCreateProjectPermission:A,canEditProjectPermission:w}),(0,e.jsxs)("div",{style:{borderTop:"solid 1px var(--light-secondary-light)",borderBottom:"solid 1px var(--light-secondary-light)",width:"100%",alignItems:"center",display:"flex",justifyContent:"center",padding:"1.25rem 0",flexDirection:"column",gap:"25px"},children:[(O||h)&&!N&&(0,e.jsxs)(I.A,{sx:{fontSize:"12px",fontWeight:"bold"},children:["Showing ",z.length," projects"]}),!O&&!(N||B)&&!h&&(0,e.jsx)(I.A,{sx:{fontSize:"12px",fontWeight:"bold"},children:"Top Projects"}),!O&&!N&&P.length===0&&(0,e.jsx)(I.A,{sx:{fontSize:"12px",fontWeight:"bold",maxWidth:"250px",textAlign:"center"},children:"You have no projects. Click the New Project button to get started."}),N&&(0,e.jsx)(re,{})]}),(0,e.jsx)(Cb,{children:!N&&(0,e.jsx)(Q,{linkedAccountsActive:R})}),(0,e.jsx)(nm,{project:p||null,open:p!==null,closeDrawer:V=>{V&&S(),f(null)}}),(0,e.jsx)(Rd,{open:c,closeDrawer:le})]})},sj=({onClick:t,disabled:n})=>(0,e.jsx)(K.A,{sx:{fontSize:"14px",padding:"10px 16px 11px 16px",textTransform:"none",height:"100%"},variant:"contained",size:"large",onClick:t,"data-testid":"add-project",disabled:n,children:"New Project"}),oj=({searchValue:t,setSearchValue:n,triggerUploaderModal:s,showArchived:o,setShowArchived:r,disabled:a,canCreateProjectPermission:i,canEditProjectPermission:l})=>{const[c,u]=(0,d.useState)(t??""),p=(0,d.useCallback)((0,H.debounce)(h=>{n(h)},500),[n]),f=h=>{u(h),p(h)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Ge,{style:{height:"44px",padding:"16px 16px 0px 16px",alignItems:"center",gap:"8px"},children:[(0,e.jsx)(sj,{onClick:s,disabled:!i}),(0,e.jsx)(_.A,{value:c,label:"Find a project",sx:cb,size:"small",disabled:a,InputProps:{sx:{backgroundColor:"white",flexGrow:1},endAdornment:(0,e.jsx)(Ks.A,{position:"end",children:t.length?(0,e.jsx)(Ss.A,{onClick:()=>f(""),sx:{cursor:"pointer"}}):(0,e.jsx)(_p.A,{})})},onChange:h=>f(h.target.value)})]}),(0,e.jsx)("div",{style:{paddingLeft:"17px"},children:(0,e.jsx)(ye.A,{sx:{paddingBottom:"16px"},control:(0,e.jsx)(Ri.A,{checked:o,onChange:h=>r(h.target.checked),name:"showArchived",color:"primary","data-testid":"show-archived-switch",sx:{"& .MuiSwitch-thumb":{border:"#808080 solid 0.5px"}}}),label:"Show Archived"})})]})},rj=({isSelected:t,onClick:n})=>(0,e.jsxs)(yp,{selected:t,onClick:n,"data-testid":"bfs-switch",sx:{backgroundColor:"#D9D9D9",borderBottom:"1px solid #CCCCCC"},children:[(0,e.jsx)(jb,{children:(0,e.jsx)(Ab,{src:Wp})}),(0,e.jsx)(bp,{children:(0,e.jsx)(Fo.A,{})})]}),aj=({isSelected:t,onClick:n})=>{const s=om();return(0,e.jsxs)(yp,{selected:t,onClick:n,"data-testid":"builder-tools-focus-switch",children:[(0,e.jsx)(Sb,{children:(0,e.jsx)(wb,{selected:t,children:s})}),(0,e.jsx)(bp,{children:(0,e.jsx)(Fo.A,{})})]})},ij=(0,g.Ay)("div")`
  display: flex;
`,lj=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  overflow: hidden;
  align-items: center;
  justify-content: center;
  padding: 0 8px;
  z-index: 1;
`,dj=(0,g.Ay)("div")`
  display: flex;
  z-index: 0;
  filter: drop-shadow(0px 0px 4px rgba(0, 0, 0, 0.4));
`,cj=(0,g.Ay)("div")`
  display: flex;
  height: 100%;
  flex-direction: column;
  justify-content: center;

  max-width: 168px;
  @media (max-width: 1154px) {
    max-width: 119px;
  }
`,fN=(0,g.Ay)("div")`
  display: flex;
  height: 100%;
  flex-direction: row;

  max-width: 107px;
  min-width: 151px;
  @media (max-width: 1154px) {
    max-width: 151px;
  }
`,rm=(0,g.Ay)(I.A)`
  justify-content: center;
  align-self: center;
  line-height: 130%;
  letter-spacing: normal;
  font-stretch: normal;
  overflow: hidden;
  white-space: wrap;
  text-overflow: ellipsis;
  font-weight: 700;
  font-size: 14px;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
`,Ld=(0,g.Ay)(I.A)`
  font-family: 'Roboto', sans-serif;
  line-height: 1;
  letter-spacing: normal;
  font-stretch: normal;
  overflow: hidden;
  white-space: wrap;
  text-overflow: ellipsis;
  font-weight: 300;
  font-size: 10px;
  padding-bottom: 3px;
`,uj=(0,g.Ay)("div")`
  flex-direction: row;
  flex-grow: 1;
  display: flex;
  overflow: hidden;
  white-space: wrap;
  text-overflow: ellipsis;
  justify-content: center;
  font-size: 12px;
  line-height: 1.2;
  padding: 0 0 2px;
  cursor: pointer;
  z-index: 1;

  max-width: 107px;
  min-width: 151px;
  @media (max-width: 1156px) {
    max-width: 151px;
  }
`,pj=(0,g.Ay)("img")`
  height: 47px;
  width: 147px;
  padding: 0 16px 0 16px;

  @media (max-width: ${ba}px) {
    height: auto;
    width: 147px;
    padding: 0;
  }
`,zi=(0,g.Ay)("div")`
  display: flex;
  z-index: 1;
  &:hover {
    cursor: pointer;
  }

  @media (max-width: ${ba}px) {
    max-width: 180px;
  }
`;var No=m(15327);const mj=m.p+"eefed13edbc1cd855921828aa7109510.svg",hj=m.p+"6df9aba80949608724c7c15d208ebf63.svg",gj=m.p+"181364f7875bfb2e2f9c2514a3d840e1.svg",fj=({variant:t,containerStyle:n,imageStyle:s,testId:o})=>{const r=()=>{switch(t){case"white":return mj;case"lightGrey":return hj;case"mybldr":return gj}};return(0,e.jsx)(dj,{sx:n,"data-testid":o,children:(0,e.jsx)("img",{src:r(),alt:"",style:s})})},La=({children:t,variant:n="white",containerStyle:s,contentStyle:o,testId:r,chevronTestid:a})=>{const i=n==="white"?"var(--common-white-100-p)":"#f2f2f2";return(0,e.jsxs)(ij,{"data-testid":r,sx:s,children:[(0,e.jsx)(lj,{sx:{backgroundColor:i,...o},children:t}),(0,e.jsx)(fj,{variant:n,testId:a})]})};var xj=m(70177);const Vi=({text:t,textStyling:n={},iconStyling:s={},iconButtonStyling:o={},tooltipPlacement:r="top"})=>{const[a,i]=(0,d.useState)(!1),l=async u=>{u?.stopPropagation(),await navigator.clipboard.writeText(t),i(!0)},c=()=>{setTimeout(()=>i(!1),350)};return(0,e.jsx)(qt.A,{title:a?"Copied":"Click to Copy",placement:r,children:(0,e.jsxs)(E.A,{display:"flex",flexDirection:"row",alignItems:"center",gap:"2px",onClick:u=>l(u),onMouseLeave:()=>c(),children:[(0,e.jsx)(I.A,{color:"secondary",sx:{fontSize:"12px",textDecoration:"underline",...n},children:t}),(0,e.jsx)(pt.A,{sx:{padding:"2px",height:"12px",width:"12px",...o},onClick:u=>{l(u)},children:(0,e.jsx)(xj.A,{sx:{fontSize:"12px",...s}})})]})})},yj=({onClick:t,project:n,loading:s})=>{const{company:o}=(0,je.P)(),{selectedCustomerView:r}=(0,Ii.A)(),a=n?.address||{streetOne:"",city:"",state:"",zip:""},{streetOne:i,city:l,state:c,zip:u}=a,p=(0,No.A)(f=>f.breakpoints.down(ba));return s||!n?(0,e.jsx)(zi,{onClick:t,"data-testid":"drawer-open-div",children:(0,e.jsxs)(La,{children:[s&&(0,e.jsx)(bt.A,{sx:{padding:"20px"}}),!s&&!n&&(0,e.jsx)(va,{variant:"h6",children:"Select Project"})]})}):(0,e.jsxs)(zi,{onClick:t,"data-testid":"drawer-open-div",sx:p?void 0:{background:"linear-gradient(to right, #f2f2f2 70%, transparent 30%)"},children:[!p&&(0,e.jsx)(La,{containerStyle:{backgroundColor:"#f2f2f2",padding:"0 8px 0 0"},children:(0,e.jsxs)(cj,{children:[(0,e.jsx)(rm,{variant:"h4",children:n?.companyName||""}),(0,e.jsx)(Vi,{text:o?.accountNumber||"",textStyling:{fontFamily:"Roboto, sans-serif",letterSpacing:"normal",fontStretch:"normal",overflow:"hidden",textOverflow:"ellipsis",fontWeight:300,fontSize:"16px",cursor:"pointer"},iconStyling:{fontSize:"16px"},iconButtonStyling:{height:"16px",width:"16px"},tooltipPlacement:"bottom"})]})}),(0,e.jsx)(La,{variant:p?"white":"lightGrey",contentStyle:p?void 0:{paddingLeft:0},children:(0,e.jsxs)(uj,{"data-testid":"project-info-drawer-opener-project",sx:{flexDirection:"column"},children:[p&&(0,e.jsx)(Ld,{variant:"body1",color:"var(--graythorne-grays-gray-4)",children:n?.companyName||""}),(0,e.jsx)(va,{variant:"h6",children:n?.projectName||r?.name||"Select Project"}),i&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ld,{variant:"body1",color:"var(--graythorne-grays-gray-4)",children:n?.address?`${i}`:""}),(0,e.jsx)(Ld,{variant:"body1",color:"var(--graythorne-grays-gray-4)",children:n?.address?`${l}, ${c} ${u}`:""})]})]})})]})},bj=(t,n,s)=>(0,e.jsx)(yj,{onClick:t,project:n,loading:s}),Fd=({renderHeader:t=bj,autoOpen:n=!1})=>{const s=(0,L.useNavigate)(),{isLoggedIn:o}=(0,Pt.A)(),{showError:r}=(0,Fe.d)(),{project:a,projectLoading:i,selectProject:l}=(0,De.B)(),{company:c,companyLoading:u}=(0,je.P)(),{companyId:p}=(0,L.useParams)(),f=(0,d.useRef)(null),b=(0,L.useLocation)().pathname.split("/").includes("projects"),[x,v]=(0,d.useState)(o&&!b&&n);(0,d.useEffect)(()=>{o&&!b&&n&&v(!0)},[o,u,c,p]);const y=C=>{s(C,{replace:!1})},j=()=>{f?.current?.scrollTo(0,0)},A=()=>{v(!0),j()},w=(C,k)=>{x&&(v(!1),C===!0&&y(`/projects/${k}/documents`))},P=async(C,k,S)=>{l(C,k,R=>w(!0,R),R=>r({message:R}),S)};return(0,e.jsxs)(e.Fragment,{children:[t(A,a,i),(0,e.jsx)(Oo.Ay,{anchor:"left",open:x,variant:"temporary",PaperProps:{sx:vb,ref:f},ModalProps:{keepMounted:!0},onClose:()=>w(!1),children:(0,e.jsx)(nj,{closeFn:w,selectedProjectId:a?.projectExternalId,onProjectSelect:P})})]})},vj=({navLinks:t,getPath:n,isDisabled:s,onNavigate:o,isVisible:r,pathname:a})=>{const i=(0,L.useNavigate)(),l=c=>{i(c),o&&o(c)};return(0,e.jsx)(qn.A,{sx:{paddingBottom:0},children:t.map(c=>r(c)?c.srcType===Pa.COMPONENT?c.src:(0,e.jsxs)(fp,{active:a===n(c),onClick:u=>{if(s(c)){u.preventDefault();return}l(n(c))},disabled:s(c),children:[c.srcType!==Pa.MUISVG?(0,e.jsx)("img",{src:c.src,style:{height:"25px"},alt:`${c.label} navigation icon`}):(0,e.jsx)(bd.A,{children:c.src}),(0,e.jsx)(I.A,{variant:"subtitle2",style:{margin:"8px 0 0 0",color:"var(--bfs-primary-true-white)",height:"14px"},children:c.label})]},`${c.url}-sidebar`):null)})},jj=m.p+"2ec1eb817d78f8bff07514c4b2bfc196.svg",Aj=({navLinks:t,getPath:n,isDisabled:s,onNavigate:o,isVisible:r,pathname:a,onOpenSplash:i})=>{const l=(0,L.useNavigate)(),[c,u]=(0,d.useState)(""),p=(0,L.useLocation)(),{isFlagEnabled:f}=(0,ut.u)(),h=x=>{l(x),o&&o(x)},b=(0,d.useMemo)(()=>{const x=t.find(v=>p.pathname.startsWith(n(v)));return x?n(x):p.pathname},[t,n,p.pathname]);return(0,e.jsxs)(bb,{children:[(0,e.jsxs)(hb,{showLabels:!0,value:b,onChange:(x,v)=>h(v),children:[t.map(x=>{if(!r(x))return null;if(x.srcType===Pa.COMPONENT)return x.src;const v=n(x);return(0,e.jsx)(vd,{"data-testid":`nav-${x.url}`,value:v,showLabel:!0,label:(0,e.jsx)(I.A,{variant:"body2",color:s(x)?"":"var(--light-white)",sx:{textAlign:"center",fontFamily:"Roboto, acumin-pro",fontSize:"12px",fontStyle:"normal",lineHeight:"14px"},children:x.label}),icon:x.srcType!==Pa.MUISVG?(0,e.jsx)(Pi,{src:x.src,alt:`${x.label} navigation icon`}):(0,e.jsx)(bd.A,{sx:{width:"30px",height:"30px"},children:x.src}),disabled:s(x),onMouseEnter:()=>{u(x.label)},onMouseLeave:()=>{u("")},className:c===x.label&&v!==p.pathname?"hovered":""},`${x.url}-topnav`)})," "]}),!f(D.SX.SUNSET_BFS)&&(0,e.jsx)(yb,{"data-testid":"nav-BFSBuilder-redirect",onClick:()=>i(!0),disabled:!1,onMouseEnter:()=>{u("BFSBuilder")},onMouseLeave:()=>{u("")},className:c==="BFSBuilder"?"hovered":"",children:(0,e.jsx)(Pi,{src:jj,alt:"myBFSBuilder",sx:{height:"44px"}})},"BFSBuilder-redirect")]})},Cj=(0,g.Ay)(Ms.A)(({theme:t})=>({position:"absolute",top:t.header?.height,backgroundColor:"rgb(127,129,133)",width:"100%"})),Sj=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  width: 600px;
  height: 200px;
  gap: 6px;
  opacity: 0px;
  background-color: #ffffff;
  padding: 6px 12px;
`,Bd=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  justify-content: start;
  align-items: start;
  margin: 12px;
`,wj=(0,g.Ay)("img")`
  filter: invert(50%);
  cursor: pointer;
`,Ej=(0,g.Ay)("button")`
  width: 57px;
  height: 36px;
  border-radius: 4px;
  background-color: rgba(47, 108, 222, 1);
  border: 1px solid rgba(47, 108, 222, 1);
  box-shadow: 0px 1px 2px 0px rgba(0, 0, 0, 0.05);
  cursor: pointer;
  color: white;
  font-size: 14px;
  font-weight: 600;
`,Pj=(0,g.Ay)("button")`
  height: 36px;
  border-radius: 4px;
  color: blue;
  text-decoration: underline;
  font-size: 14px;
  border: 1px solid rgba(255, 255, 255, 1);
  align-content: center;
  cursor: pointer;
`,am=m.p+"784d83211f38fdeb8bd33aa5187a07a6.svg",im=({onCancel:t,redirectLink:n,isOpen:s,pathName:o})=>{const{createEvent:r}=(0,On.AG)(),a=(0,L.useParams)(),i=sm(o,a);(0,d.useEffect)(()=>{s&&r({content_type:i.content_type,object_id:i.object_id,tool:i.tool,action:D.H1.ESCAPE,event_meta:{action:"ViewModal"}})},[s]);const l=()=>{r({content_type:i.content_type,object_id:i.object_id,tool:i.tool,action:D.H1.ESCAPE,event_meta:{action:"leave"}}),window.location.href=n};return(0,e.jsx)(Cj,{sx:{margin:0},maxWidth:!1,open:s,onClose:t,children:(0,e.jsxs)(Sj,{children:[(0,e.jsxs)(Bd,{sx:{fontSize:20,fontWeight:600,justifyContent:"space-between"},children:["Leaving myBLDR.com",(0,e.jsx)(wj,{src:am,onClick:t})]}),(0,e.jsx)(Bd,{sx:{color:"rgba(85, 90, 102, 1)",fontWeight:400,fontSize:16},children:"myBFSBuilder will no longer be available after October 31st, 2024. Your Orders, Statements and Online Payment experience are available in myBLDR.com!"}),(0,e.jsxs)(Bd,{sx:{justifyContent:"space-between",alignItems:"flex-end"},children:[(0,e.jsx)(Pj,{onClick:l,children:"Proceed to myBFSBuilder"}),(0,e.jsx)(Ej,{onClick:t,children:"Okay"})]})]})})},Nd=({navLinks:t,getPath:n,isDisabled:s,onNavigate:o,isVisible:r=()=>!0,isDrawer:a=!1})=>{const i=(0,L.useLocation)(),[l,c]=(0,d.useState)(!1),u=(0,d.useMemo)(()=>{const p=t.find(f=>i.pathname.startsWith(n(f)));return p?n(p):i.pathname},[t,n,i.pathname]);return a?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(vj,{navLinks:t,getPath:n,isDisabled:s,onNavigate:o,isVisible:r,pathname:u}),(0,e.jsx)(im,{isOpen:l,redirectLink:jd("/"),onCancel:()=>c(!1),pathName:u})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Aj,{navLinks:t,getPath:n,isDisabled:s,onNavigate:o,isVisible:r,pathname:u,onOpenSplash:c}),(0,e.jsx)(im,{isOpen:l,redirectLink:jd("/"),onCancel:()=>c(!1),pathName:u})]})},_d=()=>{const{project:t}=(0,De.B)(),{allRoles:n}=(0,we.Sk)(),{company:s}=(0,je.P)(),{userHasPermission:o,isUserPermissionsLoading:r}=(0,Ye.A)(),a=o({tool:D.w5.MATERIALS,action:D.a2.VIEW_BID_ORDERS_AND_DELIVERIES,companyId:t?.companyId,projectId:t?.id}),i=o({tool:D.w5.BUILD,action:D.a2.VIEW_BUILD,companyId:s?.id,projectId:t?.id}),l=o({tool:D.w5.SCHEDULE,action:D.a2.VIEW_PHASES_AND_TASKS,companyId:s?.id,projectId:t?.id}),c=o({tool:D.w5.CREWS,action:D.a2.VIEW_CREWS,companyId:s?.id,projectId:t?.id}),u=o({tool:D.w5.BUDGET,action:D.a2.VIEW_BUDGET,companyId:s?.id,projectId:t?.id}),p=o({tool:"configure",action:"view",companyId:s?.id,projectId:t?.id}),f=b=>t&&!r?b.url==="materials"&&!a:b.SubsRestricted&&t?.isSubs,h=b=>t?b.url==="build"?!i:b.url==="schedule"?!l:b.url==="crews"?!c:f(b)?!0:b.url=="budget"?!u:b.url=="configure"?!p:Ma(b,n):!0;return(0,e.jsx)(Cd,{focusContainer:(0,e.jsx)(Fd,{autoOpen:!0}),project:t,renderNavLinks:(b,x)=>(0,e.jsx)(Nd,{navLinks:Tp,getPath:v=>`/projects/${t?.id}/${v.url}`,isDisabled:h,onNavigate:x,isDrawer:b,isVisible:v=>Md(v,n)})})},Ij=({onClick:t})=>(0,e.jsx)(zi,{onClick:t,"data-testid":"bfs-focus",children:(0,e.jsx)(La,{children:(0,e.jsx)(pj,{src:Wp})})}),Dj=se().memo(()=>{const{project:t}=(0,De.B)(),{allRoles:n}=(0,we.Sk)(),{isFlagEnabled:s}=(0,ut.u)(),{company:o}=(0,je.P)(),{userHasPermission:r,data:a}=(0,Ye.A)(),i=(0,d.useCallback)(h=>(0,ct.EL)(n)?`/bfs/${h.url}`:`/bfs/${o?.id}/${h.url}`,[n,o]),l=r({tool:D.w5.BIDS,action:D.a2.VIEW_BIDS,projectId:void 0,companyId:o?.id}),c=r({tool:D.w5.DASHBOARD,action:D.a2.VIEW_BFS_DASHBOARD,projectId:void 0,companyId:o?.id}),u=r({tool:D.w5.CATALOG,action:D.a2.EDIT_MARKET_MANAGER_TOOLS,projectId:void 0,companyId:o?.id}),p=a?.some(h=>h.canViewBfsFocusState),f=(0,d.useCallback)(h=>h.url==="bids"?!s(D.SX.BFS_BIDS)||!l:h.url==="dashboard"?!s(D.SX.BFS_DASHBOARD)||!c||Ma(h,n):h.url==="catalog"?!s(D.SX.MARKET_MANAGER_CATALOG)||!u:Ma(h,n),[s,n,u,l,c]);return(0,e.jsx)(Cd,{focusContainer:(0,e.jsx)(Fd,{renderHeader:h=>(0,e.jsx)(Ij,{onClick:h})}),project:t,renderNavLinks:(h,b)=>(0,e.jsx)(Nd,{navLinks:Rp,getPath:i,isDisabled:f,onNavigate:b,isDrawer:h,isVisible:x=>Md(x,n,o?.erpSystem,p)})})}),kj=({onClick:t})=>{const{company:n}=(0,je.P)(),s=om();return(0,e.jsx)(zi,{onClick:t,"data-testid":"builder-tools-focus",children:(0,e.jsx)(La,{children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},children:[(0,e.jsx)(rm,{variant:"h4",children:s}),(0,e.jsx)(Vi,{text:n?.accountNumber||"",textStyling:{fontFamily:"Roboto, sans-serif",letterSpacing:"normal",fontStretch:"normal",overflow:"hidden",textOverflow:"ellipsis",fontWeight:300,fontSize:"16px",cursor:"pointer"},iconStyling:{fontSize:"16px"},iconButtonStyling:{height:"16px",width:"16px"},tooltipPlacement:"bottom"})]})})})},lm=se().memo(()=>{const{project:t}=(0,De.B)(),{user:n}=(0,Pt.A)(),{company:s}=(0,je.P)(),{isFlagEnabled:o}=(0,ut.u)(),{allRoles:r}=(0,we.Sk)(),{userHasPermission:a}=(0,Ye.A)(),[i,l]=(0,d.useState)(Ia);(0,d.useEffect)(()=>{let A=Ia;s?.isPoCustomer&&!(0,ct.EL)(r)&&(A=A.filter(w=>w.url!=="statements")),o(D.SX.USE_SPECS_MANAGER)||(A=A.filter(w=>w.url!=="specifications")),l(A)},[s,r,ct.EL,o,Ia]);const c=a({tool:D.w5.CREWS,action:D.a2.VIEW_CREWS,companyId:s?.id,projectId:t?.id}),u=a({tool:D.w5.SCHEDULE,action:D.a2.VIEW_PHASES_AND_TASKS,companyId:s?.id,projectId:t?.id}),p=a({tool:D.w5.PROFILE,action:"edit",companyId:s?.id,projectId:t?.id}),f=a({tool:D.w5.CATALOG,action:D.a2.VIEW_CATALOG,companyId:s?.id,projectId:t?.id}),h=a({tool:D.w5.MATERIALS,action:D.a2.VIEW_BID_ORDERS_AND_DELIVERIES,companyId:s?.id,projectId:void 0}),b=a({tool:D.w5.STATEMENTS,action:D.a2.VIEW_STATEMENTS,companyId:s?.id,projectId:void 0}),x=a({tool:D.w5.STATEMENTS,action:D.a2.VIEW_BFS_INVOICES,companyId:s?.id,projectId:void 0}),v=a({tool:D.w5.DIGITAL,action:D.a2.VIEW_DIGITAL_TOOLS,projectId:void 0,companyId:s?.id}),y=x||b,j=A=>{switch(A.url){case"digital_tools":return!v;case"crews":if(!o(D.SX.COMPANY_CREWS)||!c)return!0;break;case"schedule":if(!o(D.SX.COMPANY_SCHEDULE)||!u)return!0;break;case"profile":if(!o("CompanyFocusProfilePage")||!p)return!0;break;case"catalog":return!f;case"orders":return!h||s?.erpSystem===An.v.AS400;case"statements":return!y;default:return Ma(A,r)}return Ma(A,r)};return(0,e.jsx)(Cd,{focusContainer:(0,e.jsx)(Fd,{renderHeader:A=>(0,e.jsx)(kj,{onClick:A})}),project:t,renderNavLinks:(A,w)=>(0,e.jsx)(Nd,{navLinks:i,getPath:P=>`/companies/${s?.id}/${P.url}`,isDisabled:P=>j(P),onNavigate:w,isDrawer:A,isVisible:P=>Md(P,r,s?.erpSystem)})})}),dm=t=>{const{isFlagEnabled:n}=(0,ut.u)(),o=n(D.SX.USE_V2_HEADER)?64:90;return t?0:o};var Ud=m(76544),Wd=m(65793),Tj=m(58312),$i=m(24279);const Fa=(0,Ud.A)({palette:{primary:{main:"#1D6BCD"},secondary:{main:"#555A66"},error:{main:"#A50722"},success:{main:"#177802"},info:{main:"#1E7EC3"},warning:{main:"#DC6803"},text:{primary:"#17181A",secondary:"#5D6062",tertiary:"#636769"},background:{secondary:"#F8F8F8",tertiary:"#F1F2F2"},border:{primary:"#878A8D",secondary:"#C3C6CC"},util:{gridRowHover:"#E3E4E5"},foreground:{quaternary:"#75787B"}},typography:{fontFamily:"Roboto",fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700,h1:{fontSize:"48px",lineHeight:"60px"},h2:{fontSize:"36px",lineHeight:"44px"},h3:{fontSize:"30px",lineHeight:"38px"},h4:{fontSize:"24px",lineHeight:"32px"},h5:{fontSize:"20px",lineHeight:"30px"},h6:{fontSize:"18px",lineHeight:"28px"},body1:{fontSize:"16px",lineHeight:"24px"},body2:{fontSize:"14px",lineHeight:"20px"},subtitle2:{fontSize:"16px",lineHeight:"24px"},button:{textTransform:"none"}}}),is=({children:t})=>{const{isAppEmbedded:n}=Os(),s=dm(n);return(0,e.jsx)(Wd.A,{theme:{[Tj.A]:{...Fa,components:{MuiDialogTitle:{styleOverrides:{root:{fontWeight:600,fontSize:"20px",paddingBottom:"32px"}}},MuiDialogActions:{styleOverrides:{root:{padding:Fa.spacing(1.5)}}},MuiButton:{variants:[{props:{variant:"contained",color:"secondary"},style:{backgroundColor:(0,$i.a)(Fa.palette.secondary.main,.9),color:Fa.palette.secondary.main,"&:hover":{backgroundColor:(0,$i.a)(Fa.palette.secondary.main,.8)}}}]},MuiButtonGroup:{styleOverrides:{root:{boxShadow:"none"}}}},header:{height:`${s}px`}}},children:t})};var Rj=m(89828),Oj=m(8532);const Mj=m.p+"3625e4f215ba38abbca747a0879cc34e.svg",Lj=m.p+"e6beadaa92d414797044374dbbc613e1.svg",Fj=m.p+"0948b740ed0f52f12518918093cab7b5.svg",cm=m.p+"8c4de0aedfbc9cca889b9d6a0727c072.svg",Bj=m.p+"950f3b426d10e212adee18881af91391.svg",Nj=m.p+"91e80d18f7a0aa57e243aa478b13c41c.svg",_j=m.p+"29f9a8cf03e99eccc9685acb40e335fd.svg",um=m.p+"7ce6ef33c07e3217c49fdbf8578cc2a9.svg",pm=m.p+"4c128b8cfc530fb3221af4d0ae24ad75.svg",Uj=m.p+"686c55509275034adb5062528cc45dff.svg",Wj=m.p+"1cb37d6d9d04d7bd486dadb304aa325a.svg",zj=m.p+"d4070b267eccef3bc1feb937dfb9db92.svg",Vj=m.p+"c0928b0b0321d3242af3ce119fa27f1b.svg",$j=m.p+"160239b8561b5f707abfd9cf6846961f.svg",Hj=m.p+"dafe4824f55850029e14e6d7d1f88c93.svg",Qj=m.p+"a738db7d41db41cf73d2a9dd2ed43c45.svg",Gj=m.p+"08e007c43a0d978e8254d32737a096e8.svg",mm=[{url:"dashboard",label:"Dashboard",src:Mj,permission:{tool:D.w5.DASHBOARD,action:D.a2.VIEW_BFS_DASHBOARD}},{url:"select_customer",label:"Customers",src:Lj,permission:{tool:D.w5.CUSTOMERS,action:D.a2.VIEW_CUSTOMERS}},{url:"bids",label:"Quotes",src:Fj,permission:{tool:D.w5.BIDS,action:D.a2.VIEW_BIDS}},{url:"catalog",label:"Catalog",src:cm,permission:{tool:D.w5.CATALOG,action:D.a2.EDIT_MARKET_MANAGER_TOOLS}},{url:"reports",label:"Reports",src:zj}],zd=[{url:"projects",label:"Projects",src:Bj,linkAccountsEnabled:!0,permission:{tool:D.w5.PROJECTS,action:D.a2.VIEW_PROJECTS_DASHBOARD}},{url:"orders",label:"Orders",src:Nj,permission:{tool:D.w5.ORDERS,action:D.a2.VIEW_ORDERS},erpGuard:[An.v.AS400]},{url:"statements",label:"Statements",src:_j,permission:{tool:D.w5.STATEMENTS,action:D.a2.VIEW_STATEMENTS}},{url:"catalog",label:"Catalog",src:cm,permission:{tool:D.w5.CATALOG,action:D.a2.VIEW_CATALOG}},{url:"schedule",label:"Schedule",src:um,permission:{tool:D.w5.SCHEDULE,action:"view"}},{url:"crews",label:"Crews",src:pm,permission:{tool:D.w5.CREWS,action:D.a2.VIEW_CREWS}},{url:"profile",label:"Profile",src:Uj,permission:{tool:D.w5.PROFILE,action:D.a2.EDIT_PROFILE}},{url:"digital_tools",label:"Digital Tools",src:Wj,permission:{tool:D.w5.DIGITAL,action:D.a2.VIEW_DIGITAL_TOOLS}}],hm=[{url:"documents",label:"Documents",src:Vj,permission:{tool:D.w5.DOCUMENTS,action:D.a2.VIEW_FILES}},{url:"configure",label:"Configure",src:$j,permission:{tool:D.w5.CONFIGURE,action:D.a2.VIEW_CONFIGURE}},{url:"build",label:"Build",src:Hj,permission:{tool:D.w5.BUILD,action:D.a2.VIEW_BUILD}},{url:"materials",label:"Materials",src:Qj,permission:{tool:D.w5.MATERIALS,action:D.a2.VIEW_MATERIALS}},{url:"schedule",label:"Schedule",src:um,permission:{tool:D.w5.SCHEDULE,action:"view"}},{url:"budget",label:"Budget",src:Gj,permission:{tool:D.w5.BUDGET,action:D.a2.VIEW_BUDGET}},{url:"crews",label:"Crews",src:pm,permission:{tool:D.w5.CREWS,action:D.a2.VIEW_CREWS}}],Kj=t=>t===_t.O.BFS?mm:t===_t.O.BUILDER_TOOLS?zd:t===_t.O.PROJECT?hm:[],Yj=()=>{const{pathname:t}=(0,L.useLocation)(),{appFocus:n}=(0,On.ho)(),{allRoles:s}=(0,we.Sk)(),{project:o}=(0,De.B)(),{company:r}=(0,je.P)(),{userHasPermission:a}=(0,Ye.A)(),i=(0,d.useCallback)(({permission:u,erpGuard:p})=>{const f=u?a({tool:u.tool,action:u.action,projectId:o?.id,companyId:r?.id}):!0,h=p&&r?!p.includes(r.erpSystem):!0;return f&&h},[a,r,o?.id]),l=(0,d.useCallback)(u=>n===_t.O.BFS?(0,ct.EL)(s)?`/bfs/${u.url}`:`/bfs/${r?.id}/${u.url}`:n===_t.O.BUILDER_TOOLS?`/companies/${r?.id}/${u.url}`:n===_t.O.PROJECT?`/projects/${o?.id}/${u.url}`:"",[r?.id,n,s,o?.id]);return(0,d.useMemo)(()=>Kj(n).map(p=>{const f=i(p),h=l(p),b=!!(0,L.matchPath)(`${h}/*`,t);return{...p,enabled:f,path:h,isSelected:b}}).filter(p=>p.enabled),[n,i,l,t])};var gm=m(17469);const qj=m.p+"ae51da0898950cc339def07913a7e66b.svg",Xj=()=>{const{userHasPermission:t}=(0,Ye.A)(),{project:n}=(0,De.B)(),{company:s}=(0,je.P)(),o=t({tool:D.w5.CUSTOMERS,action:D.a2.VIEW_CUSTOMERS,projectId:n?.id,companyId:s?.id}),r=t({tool:D.w5.PROJECTS,action:D.a2.VIEW_PROJECTS_DASHBOARD,projectId:n?.id,companyId:s?.id}),i=o?"/bfs/select_customer":r&&s?`/companies/${s.id}/projects`:"";return(0,e.jsx)(L.Link,{style:{height:"48px",overflow:"hidden",borderRadius:"4px",pointerEvents:i?void 0:"none"},to:i,children:(0,e.jsx)(gm.k,{src:qj,beforeInjection:l=>(l.setAttribute("height","48px"),l.setAttribute("width","48px"),l),className:"test-svg"})})},fm=({label:t,to:n,disabled:s,icon:o,isSelected:r,onClick:a,badgeContent:i})=>{const l="#555352";return(0,e.jsx)(K.A,{component:n?L.Link:void 0,to:n,disabled:s,disableFocusRipple:!0,onClick:a,sx:{height:"100%",paddingTop:"6px",paddingBottom:"4px",width:"72px",borderRadius:"4px","&:hover":{backgroundColor:l},backgroundColor:r?l:"none","&.Mui-disabled":{opacity:"0.5",cursor:"not-allowed"},"&.Mui-focusVisible":{boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05), 0px 0px 0px 2px rgba(255, 255, 255, 0.50)"}},children:(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",gap:"2px"},children:[(0,e.jsx)(er.A,{badgeContent:i,color:"primary",overlap:"circular",sx:{"& .MuiBadge-badge":{backgroundColor:"rgb(30, 84, 186)",color:"white",fontSize:"10px",fontWeight:"normal",minWidth:"unset",width:"16px",height:"16px"}},children:(0,e.jsx)("img",{style:{height:"20px",width:"20px",color:"transparent"},src:o,alt:`menu-item ${t}`})}),(0,e.jsx)(I.A,{sx:{fontSize:"12px",lineHeight:"16px",color:"#FFF",maxWidth:"68px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t})]})})},Jj=({navLink:t})=>(0,e.jsx)(fm,{label:t.label,to:t.path,disabled:!t.enabled,icon:t.src,isSelected:t.isSelected}),Zj=()=>{const[t,n]=(0,d.useState)(0);return(0,d.useEffect)(()=>{const s=()=>{try{const r=window.pendo?.getActiveGuides();if(r){const a=r.filter(i=>!i.hasBeenSeen()&&i.isAnnouncement()&&!i.isExpired()&&!i.isBeforeStartTime()&&i.shouldBeAddedToResourceCenter()&&!i.outsideTimebox());n(a.length)}}catch{console.warn("Unable to check for active Pendo guides")}};s();const o=setInterval(s,3e3);return()=>clearInterval(o)},[]),{unreadGuidesCount:t}},eA=(t,n,s,o)=>{(0,d.useEffect)(()=>{if(n&&t&&Lp()({app_id:"vn7jqq8v",user_id:t.id?.toString(),name:t.name,email:t.email,hide_default_launcher:!0}),window.pendoScriptHasRun&&n){const r={id:t?.email,email:t?.email,full_name:t?.name,mybldr_user_id:t?.id,role:o},a={id:s?.accountNumber,erp_system:s?.erpSystem,mybldr_company_id:s?.id,account_name:s?.name,market:s?.market};pendo.initialize({visitor:r,account:a}),pendo.updateOptions({visitor:r,account:a})}n&&t?.externalB2cId&&Np(t,o)},[t,n,s,o])},tA=()=>{const{isFlagEnabled:t}=(0,ut.u)(),{isLoggedIn:n,onSignOut:s,user:o}=(0,Pt.A)(),{userHighestRole:r}=(0,we.Sk)(),{company:a}=(0,je.P)(),i=t("UseCustomPendoBubble"),l=t("UsePendoHelpCenterTarget"),{unreadGuidesCount:c}=Zj();eA(o,n,a,r);const[u,p]=(0,d.useState)(null),f=v=>{p(v.currentTarget)},h=!!u,b=()=>o?.name?o.name.split(" ")[0]:o?.email?o.email.split("@")[0]:"Home Builder",x={minWidth:"150px",display:"flex",justifyContent:"flex-start",alignItems:"center",backgroundColor:"white",color:v=>v.palette.grey[800],padding:"12px 16px",borderTop:"1px solid #E1E3E6"};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(fm,{label:b(),icon:Bp,badgeContent:i&&c>0?c:null,onClick:f}),(0,e.jsxs)(Hn.A,{anchorEl:u,open:h,onClose:()=>p(null),MenuListProps:{disablePadding:!0,sx:{backgroundColor:v=>v.palette.grey[200]}},slotProps:{paper:{sx:{width:"264px",marginTop:"13px"}}},children:[(0,e.jsx)(it.A,{sx:x,onClick:()=>{window.pendo?.isReady?.()||postMessage({status:"help-center-ticket"})},children:(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center",marginLeft:"30px"},children:l?(0,e.jsx)(ja,{href:void 0,target:"_blank",sx:{paddingLeft:"15px",marginLeft:"-15px"},children:(0,e.jsx)(I.A,{sx:{lineHeight:"16px"},children:"Resource Center"})}):(0,e.jsx)(ja,{href:void 0,target:"_blank",children:"Get Help"})})}),(0,e.jsx)(it.A,{sx:x,onClick:()=>s?.(),children:(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(Fp.A,{sx:{marginRight:1}}),(0,e.jsx)(I.A,{variant:"inherit",children:"Logout"})]})})]})]})};var Mn=m(54706),nA=m(70704);const sA=t=>t.split(" ").map(n=>n[0]).join("").substring(0,2).toUpperCase(),oA=(t,n)=>{let s,o=null,r=null;return t.includes("/companies/")?(s=zd.find(i=>t.includes(i.url)),o="company",r=n.companyId):t.includes("/projects/")?(s=hm.find(i=>t.includes(i.url)),o="project",r=n.projectId):t.includes("/bfs/")&&(s=mm.find(i=>t.includes(i.url))),{tool:s?.label.toLowerCase(),content_type:o,object_id:r}},rA=({onItemClick:t})=>{const{company:n}=(0,je.P)(),{project:s}=(0,De.B)(),{companies:o,userHasPermission:r}=(0,Ye.A)(),a=r({tool:D.w5.CUSTOMERS,action:D.a2.VIEW_CUSTOMERS,companyId:n?.id,projectId:s?.id}),i=(0,d.useMemo)(()=>o?.filter(l=>l.id!==n?.id)??[],[o,n?.id]);return(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",overflow:"hidden",flex:1,gap:"16px"},children:[(0,e.jsxs)(E.A,{sx:{paddingX:"16px",paddingTop:"8px",display:"flex",flexDirection:"column",gap:"8px"},children:[(0,e.jsx)(I.A,{variant:"body2",color:"text.secondary",fontWeight:"medium",children:"Currently Selected"}),(0,e.jsx)(xm,{company:n,emphasized:!0})]}),i.length>0&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ce.A,{}),(0,e.jsxs)(E.A,{sx:{display:"flex",flex:1,flexDirection:"column",overflow:"hidden"},children:[(0,e.jsx)(I.A,{variant:"body2",color:"text.secondary",fontWeight:"medium",sx:{paddingX:"16px"},children:"Available Accounts"}),(0,e.jsx)(E.A,{sx:{display:"flex",flex:1,flexDirection:"column",overflow:"scroll"},children:i?.map(l=>(0,e.jsx)(aA,{company:l,onItemClick:t},l.id))})]})]}),a&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ce.A,{}),(0,e.jsx)(it.A,{sx:{display:"flex",alignItems:"center",padding:"6px 16px"},component:L.Link,to:"/bfs/select_customer",onClick:()=>(console.log("item clicked"),t?t():void 0),children:(0,e.jsxs)(I.A,{sx:{display:"flex",gap:"8px",alignItems:"center"},variant:"body2",color:"text.primary",children:[(0,e.jsx)(Ep.A,{sx:{color:"text.secondary"}})," Customer Search"]})})]})]})},xm=({company:t,emphasized:n})=>(0,e.jsxs)(E.A,{sx:{borderRadius:"4px",marginBottom:n?"8px":0,padding:n?"12px":0,backgroundColor:n?"background.secondary":void 0},children:[(0,e.jsx)(I.A,{variant:"body2",sx:{fontWeight:"medium"},children:t?.name}),(0,e.jsxs)(E.A,{display:"flex",flexDirection:"row",gap:"2px",children:[(0,e.jsx)(Vi,{text:t?.accountNumber??""}),(0,e.jsxs)(I.A,{sx:{fontSize:"12px"},color:"secondary",children:["\u2022 ",t?.erpSystem]})]})]}),aA=({company:t,onItemClick:n})=>{const s=`/companies/${t.id}/projects`;return(0,e.jsxs)(it.A,{sx:{display:"flex",gap:"12px",padding:"12px 16px"},component:L.Link,to:s,onClick:n,children:[(0,e.jsx)(E.A,{children:(0,e.jsx)(ym,{name:t.name,variant:"large"})}),(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},children:[(0,e.jsxs)(I.A,{variant:"body2",children:[t.erpNumber," \u2022 ",t?.erpSystemName]}),(0,e.jsx)(I.A,{variant:"body1",sx:{textWrap:"wrap",textAlign:"left"},children:t.name})]})]})},ym=({name:t,variant:n})=>{const s=n==="small"?"32px":"44px";return(0,e.jsx)(Ti.A,{sx:{borderRadius:"4px",backgroundColor:"#F2F2F2",height:s,width:s,border:"1px solid #EAE8E6"},children:(0,e.jsx)(I.A,{variant:"h6",sx:{fontWeight:"regular",color:"#555352"},children:sA(t)})})},iA=m.p+"8ca5b8ae4e176440a3956687c395cd77.svg",Vd=t=>t?"accountNumber"in t?{id:t.id,name:t.name,erpSystemName:t.erpSystem,erpNumber:t.accountNumber}:{id:t.id,name:t.name,erpSystemName:t.erpSystemName,erpNumber:t.erpNumber}:null,lA=()=>{const{company:t}=(0,je.P)(),{companies:n}=(0,Ye.A)(),{isActive:s,defaultLinkedAccount:o}=(0,ss.F)(),r=(0,L.useLocation)(),a=(0,L.useParams)(),i=(0,d.useMemo)(()=>zd.filter(c=>c.linkAccountsEnabled).map(c=>c.label.toLowerCase()),[]);return(0,d.useMemo)(()=>{const{tool:c}=oA(r.pathname,a),u=i.includes(c??"");if(!s||!u)return Vd(t);const p=n?.find(f=>f.id===o?.companyId);return Vd(p)??Vd(t)},[r.pathname,a,o,n,t,i,s])},dA=t=>{const[n,s]=(0,d.useState)({}),[o,r]=(0,d.useState)(!1),a=(0,d.useCallback)(async c=>{try{const{data:u}=await nt.Ay.get(`/api/projects/${c}/primary_plan`);return{projectId:c,primaryPlan:(0,Ze.bn)(u)}}catch(u){return console.error("Error fetching primary plan",u),{projectId:c}}},[]),i=(0,d.useRef)(n);i.current=n;const l=(0,d.useCallback)(async c=>{r(!0);const u=c.filter(h=>h.id&&h.primaryPlanFilename&&!i.current[h.id]);s(h=>{const b={};return u.forEach(x=>{b[x.id]={status:"loading"}}),{...h,...b}});const p=await Promise.allSettled(u.map(h=>a(h.id))),f={};p.forEach(h=>{if(h.status==="fulfilled"){const{projectId:b,primaryPlan:x}=h.value;f[b]={status:"fulfilled",value:x}}}),s(h=>({...h,...f})),r(!1)},[a]);return(0,d.useEffect)(()=>{l(t)},[t,l]),{metaData:n,loading:o}},bm=({onChange:t,debounceTime:n=0,initialValue:s,testId:o,overRideStyles:r})=>{const[a,i]=(0,d.useState)(s??""),l=(0,d.useRef)(t);l.current=t;const c=(0,d.useCallback)((0,H.debounce)(p=>{l.current(p)},n),[n,l]),u=p=>{i(p),c(p)};return(0,e.jsx)(Dv,{sx:{...r},value:a,placeholder:"Find Project",size:"small",onChange:p=>u(p.target.value),"data-testid":o||"project-search",InputProps:{endAdornment:(0,e.jsx)(Ks.A,{position:"end",children:a.length>0&&(0,e.jsx)(Ss.A,{onClick:()=>u(""),sx:{cursor:"pointer"}})}),startAdornment:(0,e.jsx)(Ks.A,{position:"start",children:(0,e.jsx)(_p.A,{})})}})},cA=m.p+"692fcff3cabce2cb5edbf79647cf67fb.svg",vm=()=>(0,e.jsx)("img",{style:{pointerEvents:"none",width:20,height:20},src:cA,alt:"Label Filter"}),jm=({onSelectionChange:t,keyProp:n})=>{const{isActive:s}=(0,ss.F)(),{company:o}=(0,je.P)(),{availableProjectLabels:r}=Ni(o?.id,s),[a,i]=(0,d.useState)([]),[l,c]=(0,d.useState)(!1),[u,p]=(0,d.useState)(!1),f=(h,b)=>{i(b);const x=b.map(v=>v.value);i(b),t(x)};return(0,d.useEffect)(()=>{a.length===0&&!u&&c(!1)},[a,u]),l?(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row",borderRadius:"4px",gap:"6px",background:"#FFF",padding:"0 12px",width:304,border:`${u?"2px":"1px"} solid ${u?"#1D6BCD":"#B3B5B6"}`},children:[(0,e.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,e.jsx)(vm,{})}),(0,e.jsx)(Nv,{id:"label-filter",limitTags:1,multiple:!0,options:r.map(h=>({label:h.name,value:h.name})),onChange:(h,b)=>f(h,b),size:"small",freeSolo:!0,renderInput:h=>(0,e.jsx)(_.A,{...h,label:""}),onFocus:()=>p(!0),onBlur:()=>p(!1),sx:{"& .MuiOutlinedInput-root .MuiOutlinedInput-notchedOutline":{border:"none"},"&.MuiAutocomplete-root .MuiAutocomplete-tag":{borderRadius:"4px",border:"1px solid #E3E4E5",background:"#F8F8F8",color:"#5D6062"}}},n)]}):(0,e.jsxs)(K.A,{onClick:()=>c(!0),style:{borderRadius:"4px",border:"1px solid #B3B5B6",background:"#FFF",color:"#5D6062",gap:8,fontSize:16},children:[(0,e.jsx)(vm,{}),"Filter"]})},uA=({search:t,setSearch:n,filtered:s,resultsSize:o,totalSize:r,loadingProjects:a,showArchived:i,setShowArchived:l,refreshProjects:c,onFilterProjects:u})=>{const[p,f]=(0,d.useState)(!1),{isFlagEnabled:h}=(0,ut.u)(),{userHasPermission:b}=(0,Ye.A)(),{company:x}=(0,je.P)(),v=b({tool:D.w5.PROJECTS,action:D.a2.CREATE_PROJECT,companyId:x?.id,projectId:void 0});return(0,e.jsxs)(Pv,{"data-testid":"toolbar",children:[(0,e.jsx)(Iv,{children:i?"Archived Projects":"Active Projects"}),(0,e.jsx)(bm,{initialValue:t,onChange:n,debounceTime:1e3},"all"),h(D.SX.PROJECT_SYSTEM_LABELS)&&(0,e.jsx)(jm,{onSelectionChange:u,keyProp:"all"}),(0,e.jsx)(ye.A,{control:(0,e.jsx)(Ri.A,{checked:i,onChange:y=>l(y.target.checked),name:"showArchived",color:"primary","data-testid":"show-archived-switch"}),label:(0,e.jsx)("span",{style:{color:"white"},children:"Show Archived"})}),(0,e.jsx)(kv,{children:s&&!a&&(0,e.jsxs)("span",{children:["Showing",(0,e.jsxs)("b",{children:[" ",o," "]})," projects"]})}),(0,e.jsx)("div",{style:{marginRight:"24px"},children:(0,e.jsx)(Qp,{disabled:!v,variant:"contained","data-testid":"create-project-button",onClick:()=>{f(!0)},children:"Create New Project"})}),p&&(0,e.jsx)(Rd,{open:p,closeDrawer:y=>{f(!1),y&&c()}})]})},Am=({communityName:t,open:n,onClose:s,onConfirm:o})=>{const r=()=>(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,e.jsx)(K.A,{variant:"text",onClick:s,style:{display:"flex",padding:" 8px 12px",justifyContent:"center",alignItems:"center",gap:6,borderRadius:4,fontFamily:"Roboto",fontSize:14,fontWeight:500,lineHeight:"20px",cursor:"pointer",border:"1px solid rgba(255, 255, 255, 0.00)",backgroundColor:"rgba(255, 255, 255, 0.00)",color:"rgba(93, 96, 98, 1)"},children:"Cancel"}),(0,e.jsx)(K.A,{variant:"contained",onClick:o,style:{display:"flex",padding:" 8px 12px",justifyContent:"center",alignItems:"center",gap:6,borderRadius:4,boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",fontFamily:"Roboto",fontSize:14,fontWeight:500,lineHeight:"20px",cursor:"pointer",border:"1px solid #A50722",background:"#A50722",color:"white"},children:"Delete"})]});return(0,e.jsx)(Qn,{title:`Delete community ${t}`,open:n,onClose:s,onSubmit:o,cancelText:"Cancel",submitText:"Delete",titleBackgroundColor:"white",titleColor:"black",destructive:!0,customFooter:(0,e.jsx)(r,{}),closeButtonColor:"rgba(46, 48, 50, 1)",children:(0,e.jsx)("p",{children:"Deleting a community will return all of its contents to All Projects."})})},Cm={border:"1px solid #1D6BCD",backgroundColor:"#1D6BCD",color:"white"},Sm={border:"1px solid #B3B5B6",backgroundColor:"#FFF",color:"rgba(93, 96, 98, 1)"},pA={border:"1px solid rgba(255, 255, 255, 0.00)",backgroundColor:"rgba(255, 255, 255, 0.00)",color:"#B54708"},Ba=(0,g.Ay)(K.A)`
  display: flex;
  padding: 8px 12px;
  justify-content: center;
  align-items: center;
  gap: 6px;
  border-radius: 4;
  font-family: 'Roboto';
  font-size: 14;
  font-weight: 500;
  line-height: 20px;
  cursor: pointer;
`,mA=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  align-self: stretch;
  justify-content: center;
  gap: 8px;
`,hA=(0,g.Ay)("div")`
  display: flex;
  justify-content: flex-start;
  align-items: flex-start;
  color: #1b1c20;
  font-family: 'Roboto';
  font-size: 16px;
  font-weight: 500;
`,wm=({open:t,community:n,onClose:s})=>{const{linkedAccounts:o,isActive:r,defaultLinkedAccount:a}=(0,ss.F)(),{companyId:i}=(0,L.useParams)(),l=(0,L.useNavigate)(),[c]=Zp(),[u]=Jv(),[p]=em(),[f,h]=(0,d.useState)(n?n.communityName:""),[b,x]=(0,d.useState)(!1),v=r?a?.companyId:parseInt(i),y=r?o.find(S=>S.erpNumber===n?.accountNumber)?.companyId:parseInt(i),j=async()=>{if(n){const S={...n,communityName:f};await u({companyId:y,communityData:S})&&s()}},A=async()=>{(await c({companyId:v,communityData:{communityName:f}}).unwrap()).communityId&&s()},w=async()=>{if(n)try{await p({companyId:y,communityId:n.communityId}),s(),l(`/companies/${i}/projects`,{replace:!0})}catch{}},P=S=>S==="Edit"?j():A(),C=()=>(0,e.jsx)("div",{children:n?(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,e.jsx)(Am,{communityName:n.communityName,onClose:()=>x(!1),open:b,onConfirm:()=>w()}),(0,e.jsx)(Ba,{onClick:()=>w(),sx:pA,children:"Delete Community"}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,e.jsx)(Ba,{onClick:()=>s(),sx:Sm,children:"Cancel"}),(0,e.jsx)(Ba,{onClick:()=>j(),sx:Cm,children:"Save Community"})]})]}):(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,e.jsx)(Ba,{variant:"text",onClick:()=>s(),sx:Sm,children:"Cancel"}),(0,e.jsx)(Ba,{variant:"contained",onClick:()=>A(),sx:Cm,children:"Create Community"})]})}),k=n?"Edit":"Create";return(0,e.jsx)(Qn,{title:`${k} Community`,open:t,onClose:s,cancelText:"Cancel",submitText:`${k==="Create"?"Create Community":"Save Community"}`,onSubmit:()=>P(k),customFooter:(0,e.jsx)(C,{}),titleBackgroundColor:"white",titleColor:"black",hideCloseButton:!0,children:(0,e.jsxs)(mA,{children:[(0,e.jsx)(hA,{children:"Community Name"}),(0,e.jsx)(_.A,{onChange:S=>h(S.target.value),value:f,style:{display:"flex",alignSelf:"stretch"},inputProps:{maxLength:40}})]})})},bN={top:t=>`calc(${t.header?.height} )`,height:t=>`calc(100% - ${t.header?.height} )`},gA=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  height: 100%;
  overflow-y: hidden;
`,fA=(0,g.Ay)("div")`
  display: flex;
  padding: 8px 12px;
  align-items: flex-start;
  gap: 8px;
  align-self: stretch;
  border-radius: 4px;
`,xA=(0,g.Ay)("div")`
  display: flex;
  padding: 4px 12px;
  align-items: flex-start;
  gap: 8px;
  align-self: stretch;
  border-radius: 4px;
  width: '100%';
`,yA=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  gap: 4px;
  width: 100%;
`,Em=(0,g.Ay)("div")`
  padding-left: 4px;
  overflow: 'hidden';
  font-family: 'Roboto';
  font-size: 16px;
  font-style: normal;
  font-weight: 400;
  line-height: 24px;
  flex-grow: 2;
`,Pm=(0,g.Ay)("div")`
  display: flex;
  padding: 2px 0px;
  align-items: center;
  cursor: pointer;
`,bA=(0,g.Ay)("div")`
  display: flex;
  overflow-y: scroll;
  padding: 4px 12px 0px 12px;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  align-self: stretch;
`,vA=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  gap: 8px;
  padding: 4px 12px;
  justify-content: space-between;
  align-items: center;
  align-self: stretch;
  height: 40px;
`,jA=(0,g.Ay)("div")`
  overflow: 'hidden';
  font-family: 'Roboto';
  font-size: 16px;
  font-style: normal;
  font-weight: 500;
  line-height: 24px;
`,AA=(0,g.Ay)("div")`
  display: flex;
  padding: 2px 0px;
  align-items: center;
  gap: 4px;
  flex-grow: 2;
`,CA=(0,g.Ay)("div")`
  width: 282;
  height: 134;
  gap: 4;
  width: 100%;
`,SA=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px 24px;
  margin: auto;
`,wA=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  align-self: stretch;
  width: 210;
  height: 64;
  gap: 4px;
`,EA=(0,g.Ay)("div")`
  color: var(--gray-gray-45, #333);
  text-align: center;

  font-family: Roboto;
  font-size: 14px;
  font-style: normal;
  font-weight: 600;
  line-height: 20px;
  width: 170;
  height: 20;
`,PA=(0,g.Ay)("div")`
  color: #555352;
  text-align: center;
  font-family: Roboto;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 20px;
  width: 210px;
  height: 40px;
  text-wrap: auto;
`,IA=(0,g.Ay)(K.A)`
  width: 124px;
  height: 24px;
  gap: 6;
  padding: 2px 4px;
  border-radius: 4;
  border-width: 1px;
  color: #2e3032;
  border: 1px solid #b3b5b6;
  display: flex;
  justify-self: center;
  font-size: 12px;
  align-self: center;
`,DA=(0,g.Ay)("div")`
  display: flex;
  padding: 12px;
  flex-direction: row;
  align-items: flex-start;
  gap: 8px;
  align-self: stretch;
  gap: 4px;
`,kA=(0,g.Ay)(K.A)`
  display: flex;
  padding: 6px 16px;
  height: 32px;
  justify-content: center;
  align-items: center;
  gap: 6px;
  border-radius: 4px;
`,TA=(0,g.Ay)(K.A)`
  display: flex;
  height: 32px;
  padding: 6px 16px;
  justify-content: center;
  align-items: center;
  gap: 6px;
  border-radius: 4px;
`,vN=(0,g.Ay)("div")`
  display: flex;
  padding: 12px;
  justify-content: center;
  align-items: center;
  align-self: stretch;
`,Im=m.p+"a775b98a2c5321610d74f8266ed323cd.svg",Dm=m.p+"c36543c79e5341d412193db3d41d399f.svg";var $d=m(16718),RA=m(53225),OA=m(43939),MA=m(75818),LA=m(85916),Na=m(11692),_a=m(87558),Hd=m(87467),Fs=m(60538);const FA=m.p+"e4a06b9aed3c5fd1958ed4430719200b.svg",BA=m.p+"3a06f27e94bdbf243ff58307a4a84634.svg",km="active",Tm="disabled",Rm=({disabled:t,...n})=>t?n.children:(0,e.jsx)(qt.A,{...n}),NA=(0,g.Ay)(Oo.Ay)(({theme:t,width:n})=>{const s={width:n,overflow:"hidden",paddingTop:t.header.height,boxSizing:"border-box",transition:t.transitions.create("width",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen})},o={width:"56px",overflow:"hidden",paddingTop:t.header.height,boxSizing:"border-box",transition:t.transitions.create("width",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})};return{zIndex:49,flexShrink:0,whiteSpace:"nowrap",variants:[{props:({open:r})=>r,style:{...s,"& .MuiDrawer-paper":s}},{props:({open:r})=>!r,style:{...o,"& .MuiDrawer-paper":o}}]}}),Om="[",Mm=(0,d.createContext)(null),Lm=()=>{const t=(0,d.useContext)(Mm);if(!t)throw new Error("Context must be used in CollapsibleSidebar");return t},Fm=({menuContent:t,trigger:n})=>{const[s,o]=(0,d.useState)(null),r=!!s;return(0,e.jsxs)("div",{onMouseEnter:a=>o(a.currentTarget),onMouseLeave:()=>o(null),children:[n,(0,e.jsx)(_a.A,{onClick:a=>{a.preventDefault(),a.stopPropagation()},open:r,anchorEl:s,placement:"right-start",transition:!0,children:({TransitionProps:a})=>(0,e.jsx)(Hd.A,{...a,children:(0,e.jsx)(Fs.A,{children:t})})})]})},Qd="active-icon",_A=(0,g.Ay)("div")(()=>({[`.${Qd}`]:{visibility:"hidden"},[`.${Tm}`]:{pointerEvents:"none",cursor:"not-allowed"},[`.${km} > .MuiListItemButton-root:not(.Mui-disabled)`]:{backgroundColor:ke.colors["background-secondary"].value,color:ke.colors["text-primary"].value,"& .MuiListItemText-primary":{fontWeight:"500"},"& .MuiListItemIcon-root":{color:"inherit"},[`& .${Qd}`]:{visibility:"visible"}}})),bo=({to:t,end:n,sx:s,disabled:o,...r})=>(0,e.jsx)(_A,{children:(0,e.jsx)(L.NavLink,{className:({isActive:a})=>{if(o)return Tm;if(a)return km},to:t,end:n,children:(0,e.jsx)(xs.A,{...r,disabled:o,sx:[{"& .MuiListItemIcon-root":{minWidth:"unset",marginRight:"12px"}},...Array.isArray(s)?s:[s]]})})}),UA=({icon:t,to:n,text:s,children:o,disabled:r})=>{const a=(0,L.useResolvedPath)(n),i=(0,L.useLocation)(),[l,c]=(0,d.useState)(i.pathname.includes(a.pathname));return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(bo,{disabled:r,to:n,sx:{margin:"4px 8px",borderRadius:"4px"},children:[(0,e.jsx)(Un.A,{children:t}),(0,e.jsx)(Cn.A,{primary:s}),(0,e.jsx)(pt.A,{sx:{margin:"-8px"},onClick:u=>{u.preventDefault(),u.stopPropagation(),c(!l)},children:l?(0,e.jsx)(LA.A,{}):(0,e.jsx)(Na.A,{})})]}),(0,e.jsx)(ho.A,{in:l,timeout:"auto",unmountOnExit:!0,children:(0,e.jsx)(qn.A,{component:"div",disablePadding:!0,children:o?.map(u=>(0,e.jsxs)(bo,{to:`${n}/${u.to}`,sx:{margin:"4px 8px",borderRadius:"4px"},children:[(0,e.jsx)(Un.A,{sx:{visibility:"hidden"},children:t}),(0,e.jsx)(Cn.A,{primary:u.text})]},u.key))})})]})},WA=({icon:t,to:n,text:s,children:o,disabled:r})=>(0,e.jsx)(Fm,{trigger:(0,e.jsx)(bo,{disabled:r,sx:{margin:"8px",padding:"8px",borderRadius:"4px"},to:n,children:(0,e.jsx)(Un.A,{children:t})}),menuContent:(0,e.jsxs)(qn.A,{component:"div",sx:{width:"220px"},children:[(0,e.jsx)(_n.Ay,{sx:{margin:"0px 8px"},children:(0,e.jsx)(Cn.A,{primaryTypographyProps:{fontWeight:"500",color:"text.secondary"},primary:s})}),o?.map(a=>(0,e.jsxs)(bo,{to:`${n}/${a.to}`,sx:{margin:"4px 8px",borderRadius:"4px"},children:[(0,e.jsx)(Cn.A,{primary:a.text}),(0,e.jsx)(ki.A,{className:Qd})]},a.key))]})}),zA=t=>{const{icon:n,to:s,text:o,children:r,hidden:a,disabled:i}=t,{isSidebarExpanded:l}=Lm();return a?null:r?.length?l?(0,e.jsx)(UA,{...t}):(0,e.jsx)(WA,{...t}):l?(0,e.jsxs)(bo,{disabled:i,to:s,sx:{margin:"4px 8px",borderRadius:"4px"},children:[(0,e.jsx)(Un.A,{children:n}),(0,e.jsx)(Cn.A,{primary:o})]}):(0,e.jsx)(bo,{disabled:i,to:s,sx:{margin:"8px",padding:"8px",borderRadius:"4px"},children:(0,e.jsx)(Rm,{title:o,placement:"right",arrow:!0,children:(0,e.jsx)(Un.A,{children:n})})})},Hi=({items:t})=>(0,e.jsx)(qn.A,{children:t.map(({key:n,...s})=>(0,e.jsx)(zA,{...s},n))}),Ua=({children:t,persistKey:n,width:s,sidebarContent:o})=>{const[r,a]=(0,d.useState)(!1),[i,l]=fo(n,{initialState:!0}),c=(0,d.useCallback)((...u)=>{a(!0),l(...u)},[l,a]);return(0,d.useEffect)(()=>{const u=p=>{const f=p.target;p.key===Om&&f&&"tagName"in f&&f.tagName!=="INPUT"&&c(h=>!h)};return document.addEventListener("keydown",u),()=>{document.removeEventListener("keydown",u)}},[c]),(0,e.jsxs)(E.A,{sx:{display:"flex"},children:[(0,e.jsxs)(NA,{onTransitionEnd:u=>{u.propertyName==="width"&&a(!1)},variant:"permanent",open:i,width:s,children:[(0,e.jsx)(Mm.Provider,{value:{isSidebarExpanded:i,setIsExpanded:c},children:(0,e.jsx)(E.A,{sx:{overflowY:"auto"},children:o})}),(0,e.jsx)(qn.A,{sx:u=>({marginTop:"auto",borderTop:i?`1px solid ${u.palette.divider}`:void 0}),children:(0,e.jsx)(_n.Ay,{sx:{justifyContent:"end",paddingY:"2px",paddingX:"10px"},children:(0,e.jsx)(Rm,{title:`${i?"Collapse":"Expand"} Sidebar ( ${Om} )`,placement:"right",arrow:!0,disabled:r,children:(0,e.jsx)(xs.A,{onClick:()=>c(u=>!u),sx:{maxWidth:"min-content",borderRadius:"4px",padding:"6px"},children:(0,e.jsx)(Un.A,{sx:{minWidth:0},children:(0,e.jsx)("img",{src:i?FA:BA,alt:"open sidebar"})})})})})})]}),(0,e.jsx)(E.A,{sx:{flexGrow:1,overflowX:"hidden"},children:t})]})};var Gd=m(94017);const VA=m.p+"938b887b099708d7bb990bc25620aee8.svg",$A=(0,g.Ay)("div")`
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 4px;
  flex-grow: 2;
  width: 24px;
  height: 24px;
`,jN=(0,g.Ay)(Hn.A)`
  z-index: 9999;
  transform: translate(-30px, 50px);
  overflow: visible;
`,Bm=(0,g.Ay)(Cn.A)`
  text-align: left;
`,HA=(0,g.Ay)("hr")`
  margin: 0;
  border-top: 1px solid #ccc;
  color: #e1e3e6;
`;function QA({setEditModalOpen:t,setDisplayDeleteConfirmation:n,isHovering:s,selected:o,setHovering:r}){const[a,i]=(0,d.useState)(null),l=!!a,c=x=>{t()},u=async x=>{n(),h(x)},p=x=>{i(x.currentTarget),x.stopPropagation(),x.preventDefault()},f=()=>i(null),h=x=>{x.stopPropagation(),f()},b=s&&o;return(0,e.jsx)($A,{children:b&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qt.A,{sx:{borderRadius:4,borderWidth:1,gap:8},title:"More",children:(0,e.jsx)(wv,{onClick:p,children:(0,e.jsx)(Mo.A,{color:"secondary"})})}),(0,e.jsxs)(Hn.A,{id:"community-kebab-menu",open:l,anchorEl:a,onClose:h,children:[(0,e.jsx)(it.A,{onClick:c,children:(0,e.jsx)(Bm,{children:"Edit Community"})}),(0,e.jsx)(HA,{}),(0,e.jsx)(it.A,{onClick:u,children:(0,e.jsx)(Bm,{children:"Delete Community"})})]})]})})}const GA=({community:t,selected:n,onDrop:s,draggingProjectCommunityId:o,clearFilterAndSearch:r})=>{const{companyId:a}=(0,L.useParams)(),i=(0,L.useNavigate)(),[l]=em(),[c,u]=(0,d.useState)(!1),[p,f]=(0,d.useState)(!1),[h,b]=(0,d.useState)(!1),{userHasPermission:x}=(0,Ye.A)(),[v,y]=(0,d.useState)(null),j=v===t.communityId,{isActive:A}=(0,ss.F)(),w=x({tool:D.w5.PROJECTS,action:D.a2.EDIT_PROJECT,companyId:parseInt(a),projectId:void 0}),P=async T=>{await l({companyId:parseInt(a),communityId:T}),i(`/companies/${a}/projects`,{replace:!0}),u(!1)},C=T=>T.communityId===o,k=(T,W)=>{T.stopPropagation(),T.preventDefault(),C(W)||y(W.communityId)},S=(T,W)=>{T.stopPropagation(),T.preventDefault(),C(W)||y(W.communityId)},R=async(T,W)=>{T.stopPropagation(),T.preventDefault();const N=T.dataTransfer.getData("text");s(N,W.communityId)},B=T=>{T.stopPropagation(),T.preventDefault(),y(null)};return(0,e.jsx)(qt.A,{title:A?t.accountNumber:null,placement:"right",children:(0,e.jsx)(xA,{style:{backgroundColor:`${n||j?"#F8F8F8":"white"}`},children:(0,e.jsx)("div",{style:{width:"100%",alignSelf:"stretch",height:28},children:(0,e.jsxs)("div",{style:{gap:8},children:[(0,e.jsx)(wm,{community:t,open:p,onClose:()=>f(!1)}),(0,e.jsx)(Am,{communityName:t.communityName,open:c,onClose:()=>u(!1),onConfirm:()=>P(t.communityId)}),(0,e.jsxs)(AA,{onMouseEnter:()=>b(!0),onMouseLeave:()=>b(!1),children:[(0,e.jsxs)(L.Link,{"data-testid":`community-selectable-row-${t.communityId}`,to:`/companies/${a}/projects/community/${t.communityId}`,style:{display:"flex",alignItems:"center",padding:"2 0px",gap:4,cursor:"pointer"},onMouseEnter:()=>{y(t.communityId)},onMouseLeave:()=>{y(null)},onDragOver:T=>k(T,t),onDragEnter:T=>S(T,t),onDragLeave:B,onDrop:T=>R(T,t),onClick:()=>{r()},children:[(0,e.jsx)("img",{src:VA,alt:"house icon",style:{height:20,width:20}}),(0,e.jsx)("div",{style:{paddingLeft:4,maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis"},children:t.communityName})]}),w&&(0,e.jsx)(QA,{isHovering:h,setEditModalOpen:()=>f(!0),setDisplayDeleteConfirmation:()=>u(!0),selected:n,setHovering:T=>b(T)})]})]})})})})},KA=({onDrop:t,draggingProject:n,clearSearchAndFilter:s,setShowArchived:o,showArchived:r})=>{const{isSidebarExpanded:a}=Lm(),{isActive:i}=(0,ss.F)(),{companyId:l,communityId:c}=(0,L.useParams)(),{communities:u,isLoading:p}=Wi(i),[f,h]=(0,d.useState)(!1),{userHasPermission:b}=(0,Ye.A)(),x=Bi(),v=b({tool:D.w5.PROJECTS,action:D.a2.EDIT_PROJECT,companyId:parseInt(l),projectId:void 0});return a?p?(0,e.jsx)(bt.A,{style:{position:"absolute",top:"50%",left:"50%"}}):(0,e.jsxs)(gA,{"data-testid":"community-drawer",children:[f&&(0,e.jsx)(wm,{open:f,onClose:()=>h(!1)}),(0,e.jsxs)(DA,{children:[(0,e.jsx)(kA,{"data-testid":"show-active-button",onClick:()=>o(!1),style:{backgroundColor:r?"white":"#f1f2f2",color:r?"rgba(93, 96, 98, 1)":"rgba(23, 24, 26, 1)"},children:"Active"}),(0,e.jsx)(TA,{"data-testid":"show-archive-button",onClick:()=>o(!0),style:{backgroundColor:r?"#f1f2f2":"white",color:r?"rgba(23, 24, 26, 1)":"rgba(93, 96, 98, 1)"},children:"Archived"})]}),(0,e.jsx)(qs,{sx:{margin:"0"}}),(0,e.jsx)(fA,{sx:{padding:"8px 12px"},children:(0,e.jsx)(L.Link,{style:{display:"flex",alignItems:"center",backgroundColor:!c&&!x?"#F8F8F8":"white",flexGrow:2,padding:"4px 12px",borderRadius:4,gap:8},onDragOver:y=>{c&&y.preventDefault()},to:`/companies/${l}/projects`,onClick:s,children:(0,e.jsxs)(Pm,{onDrop:y=>{y.preventDefault();const j=y.dataTransfer.getData("text");j&&t(j,void 0)},children:[(0,e.jsx)("img",{src:Im,alt:"folder",style:{height:20,width:20}}),(0,e.jsx)(Em,{children:"All Projects"})]})})}),(0,e.jsx)(qs,{sx:{margin:"0"}}),u.length===0?(0,e.jsx)(CA,{children:(0,e.jsxs)(SA,{children:[(0,e.jsxs)(wA,{children:[(0,e.jsx)(EA,{children:"No Communities to display"}),(0,e.jsx)(PA,{children:"Create a new community to help organize and sort your projects."})]}),(0,e.jsx)(IA,{onClick:()=>h(!0),children:"Create Community"})]})}):(0,e.jsxs)(bA,{children:[(0,e.jsxs)(vA,{children:[(0,e.jsx)(jA,{children:"Communities"}),v&&(0,e.jsx)(pt.A,{onClick:()=>h(!0),style:{height:32,width:32,padding:6},children:(0,e.jsx)($d.A,{})})]}),(0,e.jsxs)(yA,{children:[(0,e.jsx)(L.Link,{style:{display:"flex",alignItems:"center",backgroundColor:x?"#F8F8F8":"white",flexGrow:2,padding:"4px 12px",borderRadius:4,gap:8},onDragOver:y=>{c&&y.preventDefault()},to:`/companies/${l}/projects/unmapped`,onClick:s,children:(0,e.jsxs)(Pm,{onDrop:y=>{y.preventDefault();const j=y.dataTransfer.getData("text");j&&t(j,void 0)},children:[(0,e.jsx)("img",{src:Dm,alt:"folder",style:{height:20,width:20}}),(0,e.jsx)(Em,{children:"Unmapped"})]})}),u.map(y=>(0,e.jsx)(GA,{community:y,selected:c?parseInt(c)===y.communityId:!1,onDrop:(j,A)=>t(j,A),draggingProjectCommunityId:n?.communityId??null,clearFilterAndSearch:s},y.communityId))]})]})]}):(0,e.jsxs)(qn.A,{sx:{overflowX:"hidden",overflowY:"auto"},children:[(0,e.jsx)(Fm,{trigger:(0,e.jsx)(xs.A,{sx:{margin:"8px",padding:"8px",borderRadius:"4px"},onClick:()=>o(!r),children:(0,e.jsx)(Un.A,{children:r?(0,e.jsx)(RA.A,{}):(0,e.jsx)(MA.A,{})})}),menuContent:(0,e.jsxs)(qn.A,{component:"div",sx:{width:"220px"},children:[(0,e.jsx)(_n.Ay,{sx:{margin:"0px 8px"},children:(0,e.jsx)(Cn.A,{primaryTypographyProps:{fontWeight:"500",color:"text.secondary"},primary:"Showing"})}),(0,e.jsxs)(xs.A,{sx:{margin:"4px 8px",borderRadius:"4px"},onClick:()=>o(!1),children:[(0,e.jsx)(Cn.A,{primary:"Active"}),!r&&(0,e.jsx)(Gd.A,{})]}),(0,e.jsxs)(xs.A,{sx:{margin:"4px 8px",borderRadius:"4px"},onClick:()=>o(!0),children:[(0,e.jsx)(Cn.A,{primary:"Archived"}),r&&(0,e.jsx)(Gd.A,{})]})]})}),(0,e.jsx)(bo,{end:!0,to:`/companies/${l}/projects`,sx:{margin:"8px",padding:"8px",borderRadius:"4px"},children:(0,e.jsx)(qt.A,{title:"All Projects",placement:"right",arrow:!0,children:(0,e.jsx)(Un.A,{children:(0,e.jsx)("img",{src:Im,alt:"folder"})})})}),u.length>0&&(0,e.jsx)(bo,{end:!0,to:`/companies/${l}/projects/unmapped`,sx:{margin:"8px",padding:"8px",borderRadius:"4px"},children:(0,e.jsx)(qt.A,{title:"Unmapped",placement:"right",arrow:!0,children:(0,e.jsx)(Un.A,{children:(0,e.jsx)("img",{src:Dm,alt:"folder"})})})}),u.map(y=>(0,e.jsx)(bo,{to:`/companies/${l}/projects/community/${y.communityId}`,sx:{margin:"8px",padding:"8px",borderRadius:"4px"},children:(0,e.jsx)(qt.A,{title:y.communityName,placement:"right",arrow:!0,children:(0,e.jsx)(Un.A,{children:(0,e.jsx)(OA.A,{})})})},y.communityId))]})},YA=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  color: 'rgba(0, 0, 0, 0.87)';
  justify-content: space-between;
  align-items: center;
  align-self: stretch;
  width: 100%;
  gap: 8px;
`,qA=(0,g.Ay)("div")`
  font-size: 24px;
  font-weight: 600;
  flex-grow: 2;
`,XA=(0,g.Ay)("div")`
  gap: 8px;
  font-family: Roboto;
  font-size: 16px;
  font-weight: 400;
  line-height: 24px;
  text-align: left;
  text-underline-position: from-font;
  text-decoration-skip-ink: none;
  color: #5d6062;
  flex-grow: 2;
`,Nm=(0,g.Ay)("span")`
  color: #17181a;
`,JA=(0,g.Ay)("div")`
  font-family: Roboto;
  font-size: 16px;
  font-weight: 400;
  line-height: 24px;
  text-align: left;
  color: rgba(53, 114, 201, 1);
  text-underline-position: from-font;
  text-decoration-skip-ink: none;
`,ZA=(0,g.Ay)(K.A)({backgroundColor:"white",borderColor:"#B3B5B6",boxSizing:"border-box",width:"42px",minWidth:"unset"});var eC=m(84740);const os=()=>(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center",paddingTop:"200px"},className:"centered-loader",children:(0,e.jsx)(bt.A,{})}),Es=()=>(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{children:"An unexpected error occurred."}),(0,e.jsx)("p",{children:"Please try refreshing the page. Contact the Support Team if the issue persists."})]});class Kd extends d.Component{constructor({suppressUncaughtErrors:n=!1,...s}){super({...s,suppressUncaughtErrors:n}),this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,s){console.error("Uncaught error:",n,s),this.props.onError?.(n,s)}render(){return this.state.hasError?this.props.suppressUncaughtErrors?null:(0,e.jsx)(Es,{}):this.props.children}}let tC=()=>jsx("div",{});tC=(0,d.lazy)(()=>m.e(677).then(m.t.bind(m,1677,23)).then(t=>({default:t.default})).catch(()=>({default:Es})));const vo=({suppressLoader:t=!1,children:n,...s})=>{const[o,r]=(0,d.useState)(!1),[a,i]=(0,d.useState)(!1),{user:l,onSignOut:c,refreshToken:u,accessToken:p}=(0,Pt.A)();return(0,d.useEffect)(()=>{const f=async()=>{try{await u()}catch(h){console.error("Error renewing tokens:",h),(0,Nn.Fc)(),c?.()}i(!0)};!a&&!o&&(r(!0),f())},[a,o,u,c,l]),a?(0,e.jsx)(Kd,{...s,children:n}):t?null:(0,e.jsx)(os,{})};var Yd=m(64268),nC=m(59468);const sC=({title:t})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.A,{fontWeight:500,children:t}),(0,e.jsxs)(I.A,{sx:{display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"4px",mt:"4px",fontStyle:"italic"},children:[(0,e.jsx)(nC.A,{})," Hidden from Builders"]})]}),qd=({title:t,doesUserHaveAccess:n,testId:s,icon:o,children:r})=>{const{company:a}=(0,je.P)(),{showError:i}=(0,Fe.d)(),[l,c]=(0,d.useState)(!1),[u,p]=(0,d.useState)(!1),[f,h]=(0,d.useState)(!1);return(0,Yd.P)(b=>{b.type==="close-modal"&&c(!1)}),n?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qt.A,{title:(0,e.jsx)(sC,{title:t}),children:(0,e.jsx)(ZA,{onClick:()=>{c(!0),p(!0)},color:"secondary",variant:"outlined",disabled:f,"data-testid":s,children:l&&u?(0,e.jsx)(bt.A,{size:"12px"}):o})}),l&&!!a&&(0,e.jsx)(vo,{suppressLoader:!0,suppressUncaughtErrors:!0,onError:()=>{i({message:"Unable to load modal. Please try again later."}),p(!1),h(!0)},children:r})]}):null},oC=(0,d.lazy)(()=>m.e(680).then(m.t.bind(m,14680,23)).then(t=>({default:t.RefreshPriceModal}))),rC=()=>{const{company:t}=(0,je.P)(),{accessToken:n}=(0,Pt.A)();return t?(0,e.jsx)(oC,{accessToken:n,erpSystem:t.erpSystem,customerNumber:t.accountNumber}):(console.error("Tried to load RefreshPriceModal without a company"),null)},aC=()=>{const{allRoles:t}=(0,Ye.A)();return(0,e.jsx)(qd,{title:"Refresh Pricing From Date",testId:"refresh-price-modal-button",icon:(0,e.jsx)(eC.A,{sx:{color:"#5D6062"}}),doesUserHaveAccess:(0,ct.EL)(t),children:(0,e.jsx)(rC,{})})};var iC=m(22562);const lC=(0,d.lazy)(()=>m.e(680).then(m.t.bind(m,14680,23)).then(t=>({default:t.SkuReplacementModal}))),dC=()=>{const{company:t}=(0,je.P)(),{accessToken:n}=(0,Pt.A)();return t?(0,e.jsx)(lC,{accessToken:n,erpSystem:t.erpSystem,customerNumber:t.accountNumber}):(console.error("Tried to load SkuReplacementModal without a company"),null)},cC=()=>{const{allRoles:t,userHasPermission:n}=(0,Ye.A)(),{company:s}=(0,je.P)(),o=n({tool:D.w5.PROJECTS,action:D.a2.USE_SKU_REPLACEMENT,companyId:s?.id,projectId:void 0});return(0,e.jsx)(qd,{title:"Replace SKU(s)",testId:"sku-replacement-modal-button",icon:(0,e.jsx)(iC.A,{sx:{color:"#5D6062"}}),doesUserHaveAccess:(0,ct.EL)(t)&&o,children:(0,e.jsx)(dC,{})})};var uC=m(48075);const pC=(0,d.lazy)(()=>m.e(680).then(m.t.bind(m,14680,23)).then(t=>({default:t.BulkDownloadModal}))),mC=()=>{const{company:t}=(0,je.P)(),{accessToken:n}=(0,Pt.A)();return t?(0,e.jsx)(pC,{accessToken:n,erpSystem:t.erpSystem,customerNumber:t.accountNumber}):(console.error("Tried to load BulkDownloadModal without a company"),null)},hC=()=>{const{allRoles:t}=(0,Ye.A)();return(0,e.jsx)(qd,{title:"Quote Package Download",testId:"bulk-download-modal-button",icon:(0,e.jsx)(uC.A,{sx:{color:"#5D6062"}}),doesUserHaveAccess:(0,ct.EL)(t),children:(0,e.jsx)(mC,{})})},gC=({search:t,companyId:n,selectedCommunity:s,projectLength:o,communitySearch:r,refreshProjects:a,onFilterProjects:i,setSearch:l})=>{const{userHasPermission:c}=(0,Ye.A)(),{company:u}=(0,je.P)(),[p,f]=(0,d.useState)(!1),h=Bi(),b=Yv(s),{isFlagEnabled:x}=(0,ut.u)(),v=c({tool:D.w5.PROJECTS,action:D.a2.CREATE_PROJECT,companyId:u?.id,projectId:void 0});return(0,e.jsxs)(fv,{"data-testid":`community-name-header-${s?.communityId}`,children:[(0,e.jsxs)(YA,{children:[t.length===0?(0,e.jsx)(qA,{children:b}):(0,e.jsxs)(XA,{"data-testid":"community-search-result-header",children:[(0,e.jsxs)(e.Fragment,{children:["Showing ",o," ",o===1?"result":"results"," for"," ",(0,e.jsxs)(Nm,{"data-testid":"community-search-text",children:['"',t,'"']})," ","in"," ",(0,e.jsxs)(Nm,{"data-testid":"selected-community-search",children:['"',b,'"']})," "]}),(r||h)&&(0,e.jsx)(L.Link,{style:{display:"inline-block"},to:`/companies/${n}/projects`,children:(0,e.jsx)(JA,{"data-testid":"search-all-communities-link",children:"Search All Projects"})})]}),(0,e.jsx)(hC,{}),(0,e.jsx)(cC,{}),(0,e.jsx)(aC,{}),(0,e.jsx)(bm,{testId:"community-search-input",onChange:l,initialValue:t,debounceTime:1e3,overRideStyles:{margin:"0",width:330}},s?`community-${s}`:"all"),x(D.SX.PROJECT_SYSTEM_LABELS)&&(0,e.jsx)(jm,{onSelectionChange:i,keyProp:s?`community-${s.communityId}`:"all"}),(0,e.jsx)(Qp,{disabled:!v,variant:"contained","data-testid":"create-project-button",onClick:()=>{f(!0)},children:"Create New Project"})]}),p&&(0,e.jsx)(Rd,{open:p,closeDrawer:y=>{f(!1),y&&a()}})]})},fC=()=>(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,e.jsxs)("div",{style:{width:"597px",height:"64px",padding:"16px",flexDirection:"column",justifyContent:"center",alignItems:"center",display:"flex",gap:"24px"},children:[(0,e.jsx)(I.A,{variant:"h4",sx:{fontSize:"32px",color:"#5D6062"},children:"No projects in this community yet"}),(0,e.jsx)(I.A,{variant:"body1",sx:{fontSize:"20px",color:"#5D6062"},children:"Create a new project or move an existing project to this community"})]})}),xC=t=>{const{allRoles:n}=(0,we.Sk)(),{userHasPermission:s}=(0,Ye.A)(),[o,r]=fo("hasDismissedInvoiceTip",{initialState:!1}),a=s({tool:D.w5.STATEMENTS,action:D.a2.VIEW_STATEMENTS,companyId:t?.id,projectId:void 0}),i=s({tool:D.w5.STATEMENTS,action:D.a2.VIEW_BFS_INVOICES,companyId:t?.id,projectId:void 0}),l=t?.isPoCustomer??!1,c=a||i;return{showInvoiceTip:n.size>0&&!(0,ct.EL)(n)&&c&&!l&&!o,setHasDismissed:r}};var yC=m(97834);const bC=(0,g.Ay)(Fs.A)`
  position: relative;
  background-color: white;
  text-align: start;
  padding: 0;
  width: 336px;
  height: 320px;
  cursor: pointer;
  box-shadow: none;
  margin: 0.5em;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  border-radius: 8px;
`,vC=(0,g.Ay)("span")``,jC=(0,g.Ay)("span")`
  display: -webkit-box;
  -webkit-box-orient: vertical;
  max-width: 263px;
  font-size: 14px;
  height: 28px;
  line-height: 14px;
  font-weight: 600;
  color: white;
  flex-grow: 2;
  overflow: hidden;
  -webkit-line-clamp: 2;
  padding-bottom: 2px;
`,AC=(0,g.Ay)("div")`
  height: 90px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  border-bottom-left-radius: 8px;
  border-bottom-right-radius: 8px;
  padding: 12px;
`,CC=t=>{switch(t){case"primary":return"var(--graythorne-blues-blue-4)";case"published":return"#125E01";case"none":return"#ffffff"}},CN=(0,g.Ay)("div",{shouldForwardProp:t=>t!=="isPublished"})`
  background-color: ${t=>CC(t.status)};
  color: white;
  width: 94px;
  height: 37px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 14px;
  font-weight: 300;
  line-height: 1.57;
  border-top-left-radius: 8px;
`,_m=(0,g.Ay)("div")`
  position: relative;
  text-align: center;
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
`,SC=(0,g.Ay)("div")`
  position: absolute;
  top: 75%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: var(--graythorne-grays-gray-4);
  font-size: 12px;
  font-weight: 300;
`,Mr=(0,g.Ay)("div")`
  color: white;
  font-size: 12px;
  font-weight: 400;
  line-height: 12px;
`,wC=(0,g.Ay)(yC.A)`
  width: 321px;
  height: 36px;
  display: flex;
  justify-content: space-around;
  align-items: flex-start;
  gap: 16px;
`,EC=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  gap: 2px;
  padding-right: 8px;
`,PC=(0,g.Ay)("img")`
  width: 100%;
  height: 210px;
  aspect-ratio: 1.375;
  display: flex;
  pointer-events: none;
`,IC=({fileUuid:t,projectId:n,handleError:s})=>{const[o,r]=(0,d.useState)(!1),[a,i]=(0,d.useState)("");(0,d.useEffect)(()=>(nt.Ay.get(`/api/pdf/${t}/thumbnail?project_id=${n}`,{responseType:"blob"}).then(c=>{const u=URL.createObjectURL(c.data);i(u)}).catch(c=>{console.error("Error loading thumbnail:",c),s()}),()=>{a&&URL.revokeObjectURL(a)}),[t,n,s]);const l=({style:c})=>(0,e.jsx)(bt.A,{size:"71px",style:{display:"flex",height:"100%",alignSelf:"center",justifyContent:"center",...c}});return(0,e.jsxs)(_m,{children:[(0,e.jsx)(l,{style:o||!a?{display:"none"}:{}}),a&&(0,e.jsx)(PC,{"data-testid":"thumbnail-image",src:a,style:o?{}:{display:"none"},onLoad:()=>{r(!0)},onError:s})]})},Um=se().memo(IC),Wm=m.p+"d17b8af6d3a25bd741ac6a92d4fba223.svg",DC=m.p+"720ef57d767b21c70d6e7a15a74d8ab3.svg",kC=({projectId:t,thumbnailAndMetaData:n,noPlans:s})=>{const[o,r]=(0,d.useState)(!1);return!o&&n?.status==="fulfilled"&&n.value?(0,e.jsx)(Um,{fileUuid:n.value.uuid,projectId:t,handleError:()=>r(!0)}):!o&&n?.status==="loading"?(0,e.jsx)(bt.A,{"data-testid":"project-thumbnail-loading",size:"71px",style:{display:"flex",height:"100%",alignSelf:"center",justifyContent:"center"}}):(0,e.jsx)(Ev,{src:s?DC:Wm,alt:"placeholder",noPlans:s})},TC=m.p+"8405fbfa6165fac09f4c02b257a1c258.svg",RC=({selectedLabels:t,systemLabels:n})=>{const o=[...t].sort((i,l)=>n?.has(i)&&!n?.has(l)?-1:!n?.has(i)&&n?.has(l)?1:0),r=o.length-5,a=()=>o.slice(5).join();return(0,e.jsxs)(Lv,{children:[o.slice(0,5).map(i=>(0,e.jsx)(Fv,{sx:{backgroundColor:n?.has(i)?"#904EE2":void 0},children:i},i)),o.length>5&&(0,e.jsx)(Bv,{title:a(),placement:"right-end",children:(0,e.jsxs)("div",{children:["+",r]})})]})},OC=({project:t,systemLabels:n})=>(0,e.jsxs)(Mv,{children:[(0,e.jsxs)(Rv,{children:[(0,e.jsx)(Xd,{dataTestId:"plans_on_file_meta",available:!!t.primaryPlanFilename,title:"Plans on File"}),(0,e.jsx)(Xd,{dataTestId:"has_home_configure_meta",available:!!t.hasHomeConfigure,title:"Home Configure"}),(0,e.jsx)(Xd,{dataTestId:"has_bid_meta",available:!!t.quoteRequestId,title:"Quote"})]}),(0,e.jsx)(RC,{selectedLabels:t.labels?t.labels:[],systemLabels:n})]}),Xd=({available:t,title:n,dataTestId:s})=>{const o=t?TC:am;return(0,e.jsxs)(Tv,{"data-testid":s,children:[(0,e.jsx)("img",{"data-testid":"avail_icon",src:o,alt:t?"yes":"no",style:{width:"12px",height:"20px"}}),(0,e.jsx)(Ov,{children:n})]})},Jd=()=>{const[t,n]=(0,d.useState)(!1),s=(0,d.useCallback)(o=>async(...r)=>{try{return n(!0),await o(...r)}finally{n(!1)}},[n]);return(0,d.useMemo)(()=>[t,s],[t,s])},sn=({title:t,onClick:n,children:s,disabled:o,loading:r,...a})=>{const[i,l]=Jd(),c=i||r;return(0,e.jsx)(K.A,{disabled:c||o,onClick:n?(...u)=>l(n)(...u):void 0,...a,children:(0,e.jsxs)("div",{style:{position:"relative"},children:[(0,e.jsx)("div",{style:c?{visibility:"hidden"}:{},children:s||t}),c&&(0,e.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,e.jsx)(bt.A,{color:"inherit",size:"1.5rem"})})]})})},ln=(t=!1)=>{const[n,s]=(0,d.useState)(t);return(0,d.useMemo)(()=>({isModalOpen:n,openModal:()=>s(!0),closeModal:()=>s(!1),setIsModalOpen:s}),[n,s])};function rs(t){return n=>n.open?(0,e.jsx)(t,{...n}):null}const Zt=({title:t,subtitle:n,children:s,content:o,actions:r,hideCancel:a,maxWidth:i="sm",infoElement:l,...c})=>(0,e.jsxs)(Ms.A,{maxWidth:i,...c,children:[t&&(0,e.jsxs)(tr.A,{children:[(0,e.jsxs)(E.A,{sx:{display:"flex",justifyContent:"space-between"},children:[t,(0,e.jsx)(pt.A,{"aria-label":"close",onClick:u=>c.onClose?.(u,"cancelClick"),sx:{padding:"0px"},children:(0,e.jsx)(Ss.A,{})})]}),n&&(0,e.jsx)(I.A,{variant:"subtitle1",color:"text.tertiary",children:n})]}),o&&(0,e.jsx)(nr.A,{children:o}),s,r&&(0,e.jsxs)(Rr.A,{sx:{paddingLeft:l?"16px":void 0},children:[l&&(0,e.jsx)(E.A,{sx:{marginRight:"auto"},children:l}),!a&&(0,e.jsx)(sn,{variant:"text",color:"secondary",onClick:u=>c.onClose?.(u,"cancelClick"),children:"Cancel"}),r.map((u,p)=>(0,e.jsx)(sn,{variant:"contained",...u},p))]})]}),zm=(t,n)=>{let s="";n==="move"&&t.isValidProjectToMove?s="validMove":n==="merge"&&t.isValidSourceProjectToMerge&&(s="validMerge");const{data:o,isLoading:r,isFetching:a,error:i,refetch:l}=(0,ws.VY)({companyId:t.companyId.toString(),projectId:t.projectExternalId,projectName:t.projectName,containsPreviewLink:!!t.previewLink,action:s},{skip:!t});return{actionAllowed:o?.actionEnabled,isLoading:r,isFetching:a,error:i,refetch:l}},MC=({project:t,setSelectedCustomer:n,setPreviouslySelectedCustomer:s,selectedCustomer:o})=>{const[r,a]=(0,d.useState)(""),{searchCustomers:i,customersList:l,fetchingCustomersList:c}=(0,Ii.A)(),u=(0,d.useRef)((0,H.debounce)(p=>{i(p)},500));return(0,d.useEffect)(()=>()=>{u.current.cancel()},[]),(0,d.useEffect)(()=>{r.length>=3&&u.current(r)},[r]),(0,e.jsxs)(E.A,{sx:{marginTop:"1rem"},children:[(0,e.jsxs)(I.A,{sx:{marginBottom:"1.5rem",lineHeight:"1.5rem"},children:["Move"," ",(0,e.jsx)(I.A,{sx:{display:"inline-block",fontWeight:"bold"},children:t?.projectName})," ","from"," ",(0,e.jsx)(I.A,{sx:{display:"inline-block",fontWeight:"bold"},children:t?.companyName})," ",(0,e.jsx)(I.A,{sx:{display:"inline-block",color:"text.secondary"},children:`(${t?.erpSystem} - ${t?.accountNumber})`})," ","to a different account."]}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{sx:{display:"inline-block",fontWeight:"bold",marginBottom:".75rem"},children:"Customer Account"}),(0,e.jsx)(Gn.A,{options:r.length>=3&&l||[],filterOptions:p=>p,loading:c,value:o||"",size:"small",getOptionLabel:p=>typeof p=="string"?p:`${p.name} (${p.erpSystem} - ${p.accountNumber})`,blurOnSelect:!0,inputValue:r,noOptionsText:"Start typing to find customer accounts.",renderInput:p=>(0,e.jsx)(_.A,{...p}),onInputChange:(p,f)=>{a(f)},onChange:(p,f)=>{n(f),s(f),a(`${f.name} (${f.erpSystem} - ${f.accountNumber})`)}})]})]})},LC=()=>{const t={fontFamily:"Roboto",fontSize:"16px",lineHeight:"24px"};return(0,e.jsxs)(E.A,{sx:{fontFamily:"Roboto",fontSize:"16px",gap:"12px",display:"flex",flexDirection:"column",marginTop:"1rem"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",gap:"24px",flexDirection:"column"},children:[(0,e.jsx)(I.A,{sx:t,children:"Project cannot be moved due to one or more of the following:"}),(0,e.jsx)(I.A,{sx:t,children:"Orders have already placed, Paradigm Estimate requested, delivered Home Configure project, or a catalog has been set up."})]}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{sx:{...t,display:"inline-block",fontWeight:"bold",marginBottom:".75rem",color:"#B3B5B6"},children:"Customer Account"}),(0,e.jsx)(Gn.A,{disabled:!0,options:[],size:"small",noOptionsText:"Start typing to find customer accounts...",renderInput:n=>(0,e.jsx)(_.A,{...n,sx:{backgroundColor:"#F1F2F2"}})})]})]})},FC=()=>(0,e.jsxs)(E.A,{sx:{marginTop:"1rem",display:"flex",flexDirection:"column",gap:"12px"},children:[(0,e.jsx)(Mn.A,{variant:"rounded",width:120,height:12}),(0,e.jsx)(Mn.A,{variant:"rounded",width:552,height:12,animation:"wave"}),(0,e.jsx)(Mn.A,{variant:"rounded",width:552,height:120,animation:"wave"})]}),BC=t=>t?"Cannot Move Project":"Move project to a different account",NC=rs(({open:t,onClose:n,project:s,onRetry:o,setPreviouslySelectedCustomer:r,isRetryingMoveProject:a,previouslySelectedCustomer:i})=>{const{actionAllowed:l,isLoading:c,error:u}=zm(s,"move"),[p]=(0,ws.l)(),[f,h]=(0,d.useState)(a?i:null),b=(0,L.useNavigate)(),x=(0,Fe.d)(),v=(0,Dt.A)(),y=[{title:"Move Project",disabled:!l||c,onClick:async()=>{if(!f)return;const A=x.showLoadingToast("Hang Tight! Moving Project...",{spinnerColor:v.palette.primary.main});try{const P=(await p({externalId:String(s.projectExternalId),dstCompanyData:{erp_system:f.erpSystem,account_number:f.accountNumber},srcCompanyData:{erp_system:s.erpSystem,account_number:s.accountNumber}}).unwrap()).project_id;x.closeToast(A),x.showSuccess({message:`Project moved to ${f.name} (${f.erpSystem} - ${f.accountNumber}).`,autoTimeout:1e4,renderAction:C=>(0,e.jsx)(K.A,{variant:"text",size:"small",sx:{color:v.palette.success.dark,fontWeight:"bold"},onClick:()=>{x.closeToast(C),b(`/projects/${P}/documents`)},children:"Go To Project"})}),n()}catch{x.closeToast(A),n(),x.showError({message:"Project Could Not Be Moved.",autoTimeout:6e3,renderAction:P=>(0,e.jsx)(K.A,{variant:"text",size:"small",sx:{color:v.palette.error.dark,fontWeight:"bold"},onClick:()=>{x.closeToast(P),o()},children:"Retry"})})}}}],j=()=>c?(0,e.jsx)(FC,{}):l?(0,e.jsx)(MC,{project:s,setSelectedCustomer:h,setPreviouslySelectedCustomer:r,selectedCustomer:f,isRetryingMoveProject:a,previouslySelectedCustomer:i}):(0,e.jsx)(LC,{});return(0,e.jsx)(Zt,{open:t,onClose:n,title:BC(!!u),content:j(),actions:y})});var Zd=m(1795),Wn=m(71479);const Qi=(0,Wn.A)(Cn.A)`
  font-family: 'Roboto';
  font-size: 16px;
  font-weight: 400;
`,_C=({setEditModalOpen:t,project:n,setMoveProjectModalOpen:s,setMergeProjectModalOpen:o,refreshProjects:r})=>{const{userHasPermission:a}=(0,Ye.A)(),{isFlagEnabled:i}=(0,ut.u)(),{company:l}=(0,je.P)(),{createProjectFromNullId:c,setArchivingProject:u}=(0,De.B)(),{updateProject:p}=(0,Or.A)(),[f,h]=(0,d.useState)(null),b=()=>h(null),x=!!f,v=a({tool:D.w5.PROJECTS,action:D.a2.MOVE_PROJECTS,companyId:l?.id,projectId:void 0}),y=i(D.SX.USE_MOVE_PROJECT),j=qp(n),A=()=>v&&y&&!j,w=()=>v&&y&&!j,P=T=>{h(T.currentTarget)},C=T=>{T.stopPropagation(),b()},k=T=>{T.stopPropagation(),t(),b()},S=async T=>{let W=n?.id;b();try{u(!0),!W&&c&&l?.id&&(W=(await c(l?.id,n.projectExternalId)).id),await p(W,{name:n.projectName,archived:T,communityId:n.communityId||void 0})}finally{u(!1),r()}},R=T=>{T.stopPropagation(),s(),b()},B=T=>{T.stopPropagation(),b(),o()};return(0,e.jsxs)("span",{onClick:T=>T.stopPropagation(),children:[(0,e.jsx)(pt.A,{id:"long-button","aria-label":"more","aria-controls":x?"long-menu":void 0,"aria-expanded":x?"true":void 0,"aria-haspopup":"true",onClick:P,"data-testid":"edit-project-kebab",sx:{color:"var(--bfs-primary-true-white)",padding:"0px",pointerEvents:"all"},children:(0,e.jsx)(Zd.A,{})}),(0,e.jsxs)(Hn.A,{id:"kebab-menu",anchorEl:f,open:x,onClose:C,sx:{padding:"8px 0"},slotProps:{paper:{sx:{width:220}}},children:[(0,e.jsx)(it.A,{sx:{height:"36px",padding:"6px 16px",width:"188px"},children:(0,e.jsx)(Qi,{style:{textAlign:"left"},onClick:k,children:"Edit Details"})}),(0,e.jsx)(Ce.A,{}),A()&&(0,e.jsx)(it.A,{sx:{height:"36px"},disabled:!n.isValidProjectToMove,children:(0,e.jsx)(Qi,{style:{textAlign:"left"},onClick:R,children:"Move Project"})}),w()&&(0,e.jsx)(it.A,{sx:{height:"36px"},disabled:!n.isValidSourceProjectToMerge,children:(0,e.jsx)(Qi,{style:{textAlign:"left"},onClick:B,children:"Merge"})}),(0,e.jsx)(Ce.A,{}),(0,e.jsx)(it.A,{sx:{height:"36px"},children:(0,e.jsx)(Qi,{style:{textAlign:"left"},onClick:T=>S(!n.archived),children:n.archived?"Unarchive":"Archive"})})]})]})};var Gi=m(41340),_o=m(53215);const UC=({project:t,setSelectedProject:n,setPreviouslySelectedProject:s,selectedProject:o})=>{const[r,a]=(0,d.useState)(""),[i,l]=(0,d.useState)(""),{projectList:c,isFetching:u}=(0,Ys.Y)({searchTerm:i||"",showErrorMessage:!0,shouldRefetch:!1}),p=(0,d.useRef)((0,H.debounce)(h=>{l(h)},500));(0,d.useEffect)(()=>()=>{p.current.cancel()},[]),(0,d.useEffect)(()=>{p.current(r)},[r]);const f=(0,d.useMemo)(()=>!c||u?[]:c.filter(h=>h.projectExternalId!==t.projectExternalId&&!isNaN(Number(h.projectExternalId))),[c,t.projectExternalId,u]);return(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"20px",alignSelf:"stretch"},children:[(0,e.jsxs)(I.A,{style:{color:"#0B0C0D",fontSize:16,fontWeight:400,display:"flex",alignItems:"center",gap:"4px",alignSelf:"stretch",flexWrap:"wrap"},children:["Merge",(0,e.jsx)("span",{style:{fontWeight:700,whiteSpace:"nowrap"},children:t?.projectName}),t.onlineJobId&&(0,e.jsx)("span",{style:{color:"#636769",whiteSpace:"nowrap"},children:`(Job ID:${t.onlineJobId})`}),"with existing project."]}),(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"8px",alignSelf:"stretch"},children:[(0,e.jsx)(I.A,{sx:{color:"#0B0C0D",fontWeight:600,fontSize:16},children:"Destination Project"}),(0,e.jsx)(Gn.A,{options:f,filterOptions:h=>h,loading:u,value:o||"",size:"small",sx:{width:"100%",".MuiInputBase-root":{height:"60px",display:"flex",alignItems:"center",alignSelf:"stretch"},".MuiAutocomplete-option":{paddingTop:"8px",paddingBottom:"8px"}},getOptionLabel:h=>h.projectName||"",renderOption:(h,b)=>{const{key:x,...v}=h,{streetOne:y,city:j,state:A,zip:w}=b.address||{};return(0,d.createElement)("li",{...v,key:x},(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:".5rem"},children:[(0,e.jsx)(I.A,{children:b.projectName}),b.address&&(0,e.jsxs)(I.A,{variant:"body2",color:"text.secondary",children:[b.onlineJobId?(0,e.jsxs)("span",{children:["Job ID: ",b.onlineJobId," ",(0,e.jsx)("span",{style:{fontSize:10},children:"\u25CF"})," "]}):"",y,", ",j,", ",A," ",w]})]}))},blurOnSelect:!0,inputValue:r,noOptionsText:"Start typing to find projects.",renderInput:h=>(0,e.jsx)(_.A,{...h,label:"Select project",sx:{display:"flex-column",height:"44px",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",flex:"1 0 0"}}),onInputChange:(h,b)=>{a(b)},onChange:(h,b)=>{n(b),s(b),a(b.projectName)}}),(0,e.jsx)(I.A,{sx:{color:"text.secondary",fontSize:"12px"},children:"The Home Configure, orders, budget, and name associated with the destination project will be used for the newly merged project."})]})]})},WC=()=>{const t={fontFamily:"Roboto",fontSize:"16px",lineHeight:"24px"};return(0,e.jsxs)(E.A,{sx:{fontFamily:"Roboto",fontSize:"16px",gap:"12px",display:"flex",flexDirection:"column"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",gap:"24px",flexDirection:"column"},children:[(0,e.jsx)(I.A,{sx:t,children:"Project cannot be merged due to one or more of the following:"}),(0,e.jsx)(I.A,{sx:t,children:"Orders have been placed through myBLDR.com, Paradigm Estimate requested, delivered Home Configure project, or a catalog has been set up."})]}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{sx:{...t,display:"inline-block",fontWeight:"bold",marginBottom:".75rem",color:"#B3B5B6"},children:"Destination Project"}),(0,e.jsx)(Gn.A,{disabled:!0,options:[],size:"small",noOptionsText:"Start typing to find projects...",renderInput:n=>(0,e.jsx)(_.A,{...n,sx:{backgroundColor:"#F1F2F2"}})})]})]})},zC=()=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,e.jsx)(Mn.A,{variant:"rounded",width:120,height:12}),(0,e.jsx)(Mn.A,{variant:"rounded",width:552,height:12,animation:"wave"}),(0,e.jsx)(Mn.A,{variant:"rounded",width:552,height:120,animation:"wave"})]}),Vm=({projectName:t,jobId:n})=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",fontFamily:"Roboto",fontSize:"14px",fontWeight:14,gap:"8px"},children:[(0,e.jsx)(I.A,{sx:{fontSize:16},children:t}),(0,e.jsx)("span",{style:{color:"#3E4041"},children:`Job ID ${n}`})]}),VC=({sourceProject:t})=>(0,e.jsx)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"2px",width:"600px"},children:(0,e.jsxs)(I.A,{sx:{gap:"8px",display:"flex",alignItems:"center",alignSelf:"stretch",flexWrap:"wrap"},children:["The merged project will inherit Job ID:"," ",(0,e.jsx)("span",{style:{fontWeight:700,whiteSpace:"nowrap"},children:t.onlineJobId})," ","from source project"," ",(0,e.jsx)("span",{style:{fontWeight:700,whiteSpace:"nowrap"},children:t.projectName})]})}),$C=({sourceProject:t,destinationProject:n,onSelect:s,selectedValue:o})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"2px",marginBottom:"16px",width:"600px"},children:[(0,e.jsx)(I.A,{sx:{color:"#3E4041"},children:"Select Job ID to Retain"}),(0,e.jsx)(I.A,{sx:{color:"#636769",fontSize:14,fontWeight:400},children:"Related orders will appear on the merged project's Materials page."})]}),(0,e.jsx)(E.A,{children:(0,e.jsxs)(Gi.A,{value:o,onChange:r=>{s(r.target.value)},sx:{gap:"16px"},children:[(0,e.jsx)(ye.A,{value:t.onlineJobId,control:(0,e.jsx)(_o.A,{}),label:(0,e.jsx)(Vm,{projectName:t.projectName,jobId:t.onlineJobId})}),(0,e.jsx)(ye.A,{value:n.onlineJobId,control:(0,e.jsx)(_o.A,{}),label:(0,e.jsx)(Vm,{projectName:n.projectName,jobId:n.onlineJobId})})]})})]}),HC=t=>t?"Cannot Merge Project":"Merge Projects",QC=rs(({open:t,onClose:n,project:s,onRetry:o,setPreviouslySelectedProject:r,isRetryingMergeProject:a,previouslySelectedProject:i})=>{const{actionAllowed:l,isLoading:c,error:u}=zm(s,"merge"),[p,{isLoading:f}]=(0,ws.zt)(),[h,b]=(0,d.useState)(a?i:null),[x,v]=(0,d.useState)(!1),[y,j]=(0,d.useState)(null),A=(0,L.useNavigate)(),[w,P]=(0,d.useState)(!1),C=(0,Fe.d)(),k=(0,Dt.A)(),S=async()=>{if(!h)return;const O=C.showLoadingToast("Hang Tight! Merging projects.",{spinnerColor:k.palette.primary.main});try{const Q=(await p({srcProjectExternalId:String(s.projectExternalId),dstProjectExternalId:String(h.projectExternalId),erpSystem:h.erpSystem,accountNumber:h.accountNumber,onlineJobId:y}).unwrap()).projectId;C.closeToast(O),C.showSuccess({message:"Projects merged.",autoTimeout:1e4,renderAction:re=>(0,e.jsx)(K.A,{variant:"text",size:"small",sx:{color:k.palette.success.dark,fontWeight:"bold"},onClick:()=>{C.closeToast(re),A(`/projects/${Q}/documents`)},children:"Open Project"})}),n()}catch{C.closeToast(O),n(),C.showError({message:"Couldn't merge projects",autoTimeout:6e3,renderAction:Q=>(0,e.jsx)(K.A,{variant:"text",size:"small",sx:{color:k.palette.error.dark,fontWeight:"bold",alignSelf:"center"},onClick:()=>{C.closeToast(Q),o()},children:"Retry"})})}},R=[{title:"Merge Projects",disabled:!l||c||!h,loading:f,onClick:async()=>{h&&h.onlineJobId!==null&&s.onlineJobId!==null&&h.onlineJobId!==s.onlineJobId?v(!0):h&&s.onlineJobId&&h.onlineJobId===null?(j(s.onlineJobId),P(!0)):S()}}],B=[{title:"Previous",onClick:()=>{v(!1),b(null),j(null),P(!1)},disabled:f,color:"secondary",variant:"text",loading:!1},{title:"Finish",disabled:!y||f,onClick:async()=>{S()},loading:f}],T=()=>c?(0,e.jsx)(zC,{}):l&&!x&&!w?(0,e.jsx)(UC,{project:s,setSelectedProject:b,setPreviouslySelectedProject:r,selectedProject:h,isRetryingMergeProject:a,previouslySelectedProject:i}):x&&h?(0,e.jsx)($C,{sourceProject:s,destinationProject:h,onSelect:j,selectedValue:y}):w?(0,e.jsx)(VC,{sourceProject:s}):(0,e.jsx)(WC,{}),W=()=>x||w?B:R,N=()=>!!(x||w);return(0,e.jsx)(Zt,{open:t,onClose:n,title:HC(!!u),content:T(),actions:W(),hideCancel:N(),sx:{"& .MuiDialogTitle-root":{lineHeight:"32px"}}})}),GC=se().memo(({project:t,thumbnailAndMetaData:n,refreshProjects:s,systemLabels:o,setDraggingProject:r,isDragging:a})=>{const i=(0,L.useNavigate)(),{selectProject:l,createLoading:c}=(0,De.B)(),{showError:u}=(0,Fe.d)(),{company:p}=(0,je.P)(),{isActive:f}=(0,ss.F)(),[h,b]=(0,d.useState)({showEditModal:!1,showMoveProjectModal:!1,showMergeProjectModal:!1,showDuplicateAddressModal:!1}),[x,v]=(0,d.useState)(null),[y,j]=(0,d.useState)(null),[A,w]=(0,d.useState)(!1),[P,C]=(0,d.useState)(!1),{userHasPermission:k}=(0,Ye.A)(),[S,R]=(0,ws.P3)(),{updateProject:B}=(0,Or.A)();(0,d.useEffect)(()=>{R.isError&&u({message:"Failed to check for duplicate project address. Please try again."})},[R.isError,u]);const[T,W]=(0,d.useState)({id:"",externalId:"",name:"",address:{streetOne:"",city:"",state:"",zip:""},onlineJobId:""}),[N,O]=(0,d.useState)({id:"",externalId:"",name:"",address:{streetOne:"",city:"",state:"",zip:""}}),[z,Q]=(0,d.useState)(null);function re(){b({showEditModal:!0,showMoveProjectModal:!1,showMergeProjectModal:!1,showDuplicateAddressModal:!1})}function ue(){b({showEditModal:!1,showMoveProjectModal:!0,showMergeProjectModal:!1,showDuplicateAddressModal:!1})}function le(){b({showEditModal:!1,showMoveProjectModal:!1,showMergeProjectModal:!0,showDuplicateAddressModal:!1})}function F(){b({showEditModal:!1,showMoveProjectModal:!1,showMergeProjectModal:!1,showDuplicateAddressModal:!0})}const V=k({tool:D.w5.PROJECTS,action:D.a2.EDIT_PROJECT,companyId:p?.id,projectId:void 0}),$=pe=>{if(t===void 0){pe.preventDefault();return}if(!V){pe.preventDefault();return}r(t),pe.dataTransfer.setData("text",`${t.projectExternalId}`),X(pe)},ee=pe=>{r(null)},X=pe=>{const Te=pe.currentTarget.querySelector("img");if(Te){const me=Te.cloneNode();me.style.position="fixed",me.style.width="142px",me.style.height="104px",document.body.appendChild(me),pe.dataTransfer.setDragImage(me,0,0)}},G=qp(t),Y=async()=>{const pe=t.projectName,Ee=t.address?.streetOne,Te=t.address?.city,me=t.address?.state,$e=t.address?.zip;W({id:t.id?String(t.id):"",externalId:t.projectExternalId,name:pe,address:{streetOne:Ee,city:Te,state:me,zip:$e},onlineJobId:t.onlineJobId||""});try{const gt=await S({companyId:t.companyId,address:{streetOne:Ee,city:Te,state:me,zip:$e}}).unwrap();if(gt.counts.count===2){const Rt=gt.projects.filter(rt=>rt.projectExternalId!==t.projectExternalId);return Q(Rt[0]),O({id:Rt[0].id.toString(),externalId:Rt[0].projectExternalId,name:Rt[0].projectName,address:{streetOne:Rt[0].address?.streetOne,city:Rt[0].address?.city,state:Rt[0].address?.state,zip:Rt[0].address?.zip}}),!0}else return!1}catch(gt){return console.log("failed to check for duplicate project address",gt),!1}},he=async(pe,Ee=!0)=>{if(!c){if(G&&!z&&Ee&&await Y()){F();return}l(pe.id,pe.projectExternalId,Te=>i(`/projects/${Te}/documents`),Te=>u({message:Te}),pe.companyId)}},ne=async()=>{const pe={companyId:t.companyId,name:N.name,onlineJobId:T.onlineJobId};try{await B(parseInt(N.id),pe),he(z,!1)}catch(Ee){console.error("Failed to update onlineJobId from synthetic project to existing project",Ee),u({message:"Unable to merge projects. Please contact your sales rep for more assistance."})}},J=()=>{he(t,!1)};return(0,e.jsxs)(e.Fragment,{children:[h.showEditModal&&(0,e.jsx)(nm,{project:t,open:h.showEditModal,closeDrawer:pe=>{b({...h,showEditModal:!1}),pe&&s()}}),(0,e.jsx)(NC,{project:t,open:h.showMoveProjectModal,onClose:()=>{b({...h,showMoveProjectModal:!1}),w(!1)},onRetry:()=>{w(!0),b({...h,showMoveProjectModal:!0})},setPreviouslySelectedCustomer:v,previouslySelectedCustomer:x,isRetryingMoveProject:A}),(0,e.jsx)(QC,{project:t,open:h.showMergeProjectModal,onClose:()=>{b({...h,showMergeProjectModal:!1}),C(!1)},onRetry:()=>{C(!0),b({...h,showMergeProjectModal:!0})},setPreviouslySelectedProject:j,previouslySelectedProject:y,isRetryingMergeProject:P}),(0,e.jsx)(Gp,{open:h.showDuplicateAddressModal,title:"Existing Project",showWarning:!0,warningText:"This address is currently associated with an existing project.",message:"The address you have entered is currently associated with an existing project. Would you like to use the found project or continue with the selected one?",currentProjectDetails:T,existingProjectDetails:N,acceptButtonText:"Use Existing Project",submit:()=>ne(),cancelButtonText:"Open Selected Project",cancel:J,close:J}),(0,e.jsxs)(yv,{"data-testid":"project-tile",style:{opacity:a?.5:1},onDragStart:$,onDragEnd:ee,draggable:V,onClick:()=>he(t),children:[(0,e.jsx)(bv,{children:(0,e.jsx)(kC,{projectId:String(t.id),thumbnailAndMetaData:n,noPlans:!t.primaryPlanFilename})}),(0,e.jsxs)(vv,{children:[(0,e.jsxs)(Av,{children:[(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"row",alignItems:"center",width:"100%"},children:[(0,e.jsx)(Hp,{children:(0,e.jsx)(Cv,{children:t.projectName})}),(0,e.jsx)(E.A,{children:(0,e.jsx)("div",{style:{overflow:"visible"},children:(0,e.jsx)(_C,{setEditModalOpen:re,setMoveProjectModalOpen:ue,setMergeProjectModalOpen:le,project:t,refreshProjects:s})})})]}),(0,e.jsx)(Hp,{children:(0,e.jsx)(Sv,{children:(0,e.jsxs)(E.A,{sx:{display:"flex",gap:"1rem"},children:[(0,e.jsxs)("p",{children:["Project ID:"," ",G?"N/A":t.projectExternalId]}),(0,e.jsxs)("p",{children:["Job ID: ",t.onlineJobId]}),f&&(0,e.jsxs)(e.Fragment,{children:[" ",(0,e.jsx)("p",{children:t.accountNumber}),(0,e.jsx)("p",{children:t.erpSystem})]})]})})})]}),(0,e.jsx)(OC,{project:t,systemLabels:o})]})]})]})});function KC(){return(0,e.jsxs)("div",{style:{width:"686px",height:"140px",padding:"16px",borderRadius:"8px",boxShadow:"0 4px 4px 0 rgba(0, 0, 0, 0.25)",backgroundColor:"var(--bfs-primary-true-white)",flexDirection:"column",justifyContent:"center",alignItems:"center",display:"flex",gap:"24px"},children:[(0,e.jsx)("img",{src:ce,alt:"MyBLDR Welcome logo",style:{width:"123px"}}),(0,e.jsxs)("div",{style:{flexDirection:"column",justifyContent:"center",alignItems:"center",display:"flex",gap:"8px"},children:[(0,e.jsx)(I.A,{variant:"h5",sx:{fontSize:"22px"},children:"Looks like you don't have any archived projects!"}),(0,e.jsx)(I.A,{variant:"body1",sx:{fontSize:"20px"},children:"To archive a project, open the project actions menu and select 'Archive'"})]})]})}const YC=m.p+"6cd1614070597d3aaf3204c9ccb162dc.png";var io=m(47263);const qC=({companyId:t,setHasDismissed:n})=>{const s=(0,L.useNavigate)(),{createEvent:o}=(0,io.A)(),r=()=>{o({content_type:"company",object_id:t,tool:"projects",action:D.H1.ESCAPE,event_meta:{action:"statements"}}),s(`/companies/${t}/statements`)},a=()=>{n(!0)};return(0,e.jsxs)(_v,{children:[(0,e.jsx)(E.A,{sx:{display:"flex",justifyContent:"center",overflow:"hidden",width:"100%"},children:(0,e.jsx)("img",{src:YC,alt:"Invoices"})}),(0,e.jsxs)(E.A,{sx:{justifyContent:"center",alignItems:"flex-start",display:"flex",flexDirection:"column",padding:"24px",gap:"16px"},children:[(0,e.jsx)("h3",{children:"Looking to review your invoices?"}),(0,e.jsx)(Uv,{children:"In myBLDR.com you can view your account balance, manage invoices and access payment options all from Statements in the main navigation toolbar or click this button."}),(0,e.jsx)(K.A,{variant:"contained",onClick:r,sx:{width:"100%"},children:"Make a Payment"}),(0,e.jsx)(K.A,{variant:"text",onClick:a,sx:{width:"100%",color:"#2E3032",backgroundColor:"#F1F2F2"},children:"Dismiss"})]})]})},$m=({search:t,setSearch:n,filteredProjects:s,refreshProjects:o,isFetching:r,showArchivedProjects:a,draggedProject:i,setDraggingProject:l,filterByLabelsOnProject:c,setPage:u,renderedProjects:p,nextPageDisabled:f,nextPage:h,systemLabels:b,metaData:x})=>{const{company:v}=(0,je.P)(),{companyId:y,communityId:j}=(0,L.useParams)(),{showInvoiceTip:A,setHasDismissed:w}=xC(v),P=j?parseInt(j):null,{isActive:C}=(0,ss.F)(),{communities:k}=Wi(C),{isFlagEnabled:S}=(0,ut.u)();return(0,e.jsxs)(hv,{children:[r&&(0,e.jsx)(bt.A,{style:{position:"absolute",top:"50%",left:"50%"}}),(0,e.jsxs)(gv,{children:[S(D.SX.COMMUNITIES)&&(0,e.jsx)(gC,{companyId:y,selectedCommunity:k.find(R=>R.communityId===P)||null,search:t,projectLength:s.length,communitySearch:P?.toString()??null,refreshProjects:()=>{t?n(""):o()},onFilterProjects:c,setSearch:R=>{n(R),u(1)}}),!r&&(0,e.jsxs)(e.Fragment,{children:[p.length===0&&a&&(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,e.jsx)(KC,{})}),p.length===0&&P&&(0,e.jsx)(fC,{}),p.length>0&&(0,e.jsx)(xv,{children:p.map((R,B)=>(0,e.jsx)(GC,{project:R,thumbnailAndMetaData:x[R.id],refreshProjects:o,systemLabels:b,setDraggingProject:T=>{l(T)},isDragging:i?.id===R.id},`${R.projectExternalId}`))}),s.length>0&&(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsx)(K.A,{style:{width:115,height:48,marginTop:37,backgroundColor:"#404040"},disabled:f,onClick:h,variant:"contained",children:"Load More"})})]})]}),A&&(0,e.jsx)(qC,{companyId:Number(y),setHasDismissed:R=>{w(R)}})]})},Wa=()=>{const{isActive:t}=(0,ss.F)(),[n,s]=(0,d.useState)(1),[o,r]=(0,d.useState)(""),{showArchivedProjects:a,setShowArchivedProjects:i}=Os(),{createEvent:l}=(0,On.AG)(),{companyId:c,communityId:u}=(0,L.useParams)(),p=Bi(),{company:f}=(0,je.P)(),{updateProject:h}=(0,Or.A)(),{createLoading:b,archivingProject:x,createProjectFromNullId:v}=(0,De.B)(),y=(0,L.useNavigate)(),j=(0,L.useLocation)(),{communities:A}=Wi(t),w=u?parseInt(u):null,[P,C]=(0,d.useState)(null),[k,S]=(0,d.useState)(!1),{showError:R}=(0,Fe.d)(),[B,T]=(0,d.useState)(),{projectList:W,isLoading:N,isFetching:O,refetch:z}=(0,Ys.Y)({searchTerm:o,showErrorMessage:!0,shouldRefetch:!0,communityId:w??(p?"UNSORTED":"ALL"),filteredLabels:B,showArchived:a,shouldLink:!0}),{availableProjectLabels:Q}=Ni(f?.id,t),re=(0,d.useMemo)(()=>new Set(Yp(Q)),[Q]),ue=(0,d.useMemo)(()=>W??[],[W]),le=25,F=Math.ceil(ue.length/le),V=(0,d.useMemo)(()=>ue.slice(0,n*le),[ue,n]),{metaData:$,loading:ee}=dA(V),X=n>=F||ee,G=()=>{X||s(Te=>Te+1)},Y=Te=>{T(Te)},{isFlagEnabled:he}=(0,ut.u)();(0,d.useEffect)(()=>{l({content_type:"company",object_id:c,tool:"projects"})},[c,l]);const{canViewPage:ne}=(0,$n.s)({tool:D.w5.PROJECTS,action:D.a2.VIEW_PROJECTS_DASHBOARD,companyId:f?.id,projectId:void 0},[f?.id]),J=async Te=>Te?.id?Te?.id:f?.id&&v&&Te.projectExternalId?(await v(f?.id,Te?.projectExternalId)).id:null,pe=async(Te,me)=>{const $e=W.find(lt=>lt.projectExternalId===Te);if(!$e)return;const gt=A.find(lt=>lt.communityId===me);if($e&&me&&$e.accountNumber!==gt?.accountNumber){R({message:"The account number on the community does not match the account number on the project"});return}const Rt=await J($e);if(!Rt)return;const rt={street_one:$e.address?.streetOne,city:$e.address?.city,state:$e.address?.state,zip:$e.address?.zip},Ue={communityId:me||null,name:$e.projectName,address:rt};try{S(!0),await h(Rt,Ue),y(me?`community/${me}`:`/companies/${c}/projects`)}finally{S(!1),C(null)}},Ee=(0,d.useRef)(!0);return(0,d.useEffect)(()=>{Ee.current&&!u&&Array.isArray(A)&&A.length>0&&j.pathname.endsWith("/projects")&&(y(`/companies/${c}/projects/unmapped`,{replace:!0}),Ee.current=!1)},[A]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(ls,{showLoadingScreen:N||b||x||k}),he(D.SX.COMMUNITIES)?(0,e.jsx)(Ua,{persistKey:"communitySidebar",width:"282px",sidebarContent:(0,e.jsx)(KA,{onDrop:(Te,me)=>{pe(Te,me)},draggingProject:P,clearSearchAndFilter:()=>{r(""),Y([])},showArchived:a,setShowArchived:i}),children:ne&&!N&&W&&(0,e.jsx)($p,{children:(0,e.jsx)($m,{search:o,setSearch:r,filteredProjects:ue,refreshProjects:z,isFetching:O,showArchivedProjects:a,draggedProject:P,setDraggingProject:C,filterByLabelsOnProject:Y,setPage:s,renderedProjects:V,nextPageDisabled:X,nextPage:()=>G(),systemLabels:re,metaData:$})})}):(0,e.jsx)(e.Fragment,{children:ne&&!N&&W&&(0,e.jsxs)($p,{children:[(0,e.jsx)(uA,{setSearch:Te=>{r(Te),s(1)},search:o,filtered:o.length>0,resultsSize:ue.length,totalSize:W.length,showArchived:a,setShowArchived:i,loadingProjects:O||N,refreshProjects:()=>{o?r(""):z()},onFilterProjects:Y}),(0,e.jsx)($m,{search:o,setSearch:r,filteredProjects:ue,refreshProjects:z,isFetching:O,showArchivedProjects:a,draggedProject:P,setDraggingProject:C,filterByLabelsOnProject:Y,setPage:s,renderedProjects:V,nextPageDisabled:X,nextPage:()=>G(),systemLabels:re,metaData:$})]})})]})};var XC=m(74097);const JC=()=>{const{project:t}=(0,De.B)(),{company:n}=(0,je.P)(),{userHasPermission:s}=(0,Ye.A)(),{isActive:o}=(0,ss.F)(),[r,a]=(0,d.useState)(""),[i,l]=(0,d.useState)(r??""),c=(0,d.useCallback)((0,H.debounce)(b=>{a(b)},500),[a]),{projectList:u,isFetching:p}=(0,Ys.Y)({searchTerm:r,shouldRefetch:!1}),f=r?u:u.filter(b=>b.id?b.id!==t?.id:!0).slice(0,5),h=s({tool:D.w5.PROJECTS,action:D.a2.VIEW_PROJECTS_DASHBOARD,projectId:t?.id,companyId:n?.id});return(0,e.jsxs)(E.A,{display:"flex",flexDirection:"column",gap:"16px",flex:1,overflow:"hidden",children:[(0,e.jsxs)(E.A,{sx:{paddingX:"16px",paddingTop:"8px",display:"flex",flexDirection:"column",gap:"8px"},children:[(0,e.jsx)(xm,{company:n}),t&&(0,e.jsx)(e1,{project:t,showERP:o})]}),(0,e.jsx)(Ce.A,{}),(0,e.jsxs)(E.A,{display:"flex",flex:1,flexDirection:"column",overflow:"hidden",children:[(0,e.jsx)(I.A,{variant:"body2",color:"text.secondary",fontWeight:"medium",marginLeft:"16px",children:"Recently Viewed Projects"}),(0,e.jsx)(E.A,{display:"flex",flex:1,overflow:"scroll",flexDirection:"column",children:p?[0,1].map(b=>(0,e.jsx)(ZC,{},b)):f.map(b=>(0,e.jsx)(t1,{project:b,showERP:o},b.projectExternalId))})]}),h&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ce.A,{}),(0,e.jsx)(it.A,{sx:{display:"flex",alignItems:"center",padding:"6px 16px"},component:L.Link,to:`/companies/${n?.id}/projects`,children:(0,e.jsxs)(I.A,{sx:{display:"flex",gap:"8px",alignItems:"center"},variant:"body2",color:"text.primary",children:[(0,e.jsx)(XC.A,{sx:{color:"text.secondary"}}),"View All Projects"]})})]})]})},Hm=({project:t,copiable:n=!1,showERP:s=!1})=>(0,e.jsxs)(E.A,{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"6px",children:[(0,e.jsx)(I.A,{variant:"body2",color:"text.primary",sx:{textWrap:"wrap",textAlign:"left"},children:t.projectName}),(0,e.jsxs)(I.A,{display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:"12px",color:"text.secondary",lineHeight:"12px",gap:"4px",sx:{textWrap:"wrap",textAlign:"left"},children:[(0,e.jsx)(E.A,{children:t?.address?.streetOne}),(0,e.jsx)(E.A,{children:`${t?.address?.city?t?.address.city+",":""} ${t?.address?.state} ${t.address?.zip}`})]}),(0,e.jsx)(E.A,{display:"flex",flexDirection:"row",children:(0,e.jsxs)(I.A,{fontSize:"12px",color:"text.secondary",display:"flex",flexDirection:"row",children:[n?(0,e.jsx)(E.A,{marginRight:"2px",children:(0,e.jsx)(Vi,{text:t?.projectExternalId})}):t?.projectExternalId," ",s?`\u2022 ${t?.erpSystem}`:null]})})]}),ZC=()=>(0,e.jsxs)(E.A,{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"6px",px:"16px",children:[(0,e.jsx)(Mn.A,{height:"20px",width:"180px"}),(0,e.jsxs)(E.A,{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"4px",sx:{textWrap:"wrap",textAlign:"left"},children:[(0,e.jsx)(Mn.A,{height:"12px",width:"100px"}),(0,e.jsx)(Mn.A,{height:"12px",width:"100px"})]}),(0,e.jsx)(E.A,{display:"flex",flexDirection:"row",children:(0,e.jsx)(Mn.A,{height:"14px",width:"75px"})})]}),e1=({project:t,showERP:n})=>(0,e.jsx)(E.A,{padding:"12px",borderRadius:"4px",sx:{backgroundColor:"background.secondary"},children:(0,e.jsx)(Hm,{project:t,copiable:!0,showERP:n})}),t1=({project:t,showERP:n})=>{const s=`/projects/${t?.id}/documents`;return(0,e.jsx)(it.A,{component:L.Link,to:s,sx:{padding:"12px 16px"},children:(0,e.jsx)(Hm,{project:t,showERP:n})})},n1=()=>{const{appFocus:t}=(0,On.ho)();return t===_t.O.BUILDER_TOOLS?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s1,{}),(0,e.jsx)(Qm,{})]}):t===_t.O.PROJECT?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(o1,{}),(0,e.jsx)(Qm,{})]}):(0,e.jsx)(e.Fragment,{})},s1=()=>(0,e.jsx)(Gm,{disabled:!1,renderButtonContent:()=>(0,e.jsx)(a1,{}),renderMenu:t=>(0,e.jsx)(rA,{onItemClick:t})}),o1=()=>{const{project:t,projectLoading:n}=(0,De.B)();return(0,e.jsx)(Gm,{disabled:!t||n,renderButtonContent:()=>n?(0,e.jsx)(r1,{}):(0,e.jsx)(i1,{}),renderMenu:()=>(0,e.jsx)(JC,{})})},Qm=()=>(0,e.jsx)(E.A,{sx:{paddingY:"6px",boxSizing:"border-box",height:"100%"},children:(0,e.jsx)(Ce.A,{orientation:"vertical",sx:{borderRightWidth:"1.5px",borderRightColor:"#555352"}})}),Gm=({disabled:t,renderButtonContent:n,renderMenu:s})=>{const[o,r]=(0,d.useState)(null),a=!!o,i=()=>r(null);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(K.A,{sx:{height:"100%",width:"227px",backgroundColor:"#555352",padding:"6px 8px","&:hover":{backgroundColor:"#818181"},display:"flex",flexDirection:"row",flexShrink:0},onClick:l=>r(l.currentTarget),disabled:t,disableRipple:!0,children:[n(),(0,e.jsx)(nA.A,{sx:{marginLeft:"auto",color:"white"}})]}),(0,e.jsx)(Hn.A,{open:a,anchorEl:o,onClose:i,slotProps:{paper:{sx:{width:"264px",marginTop:"13px",overflow:"hidden",display:"flex"}}},MenuListProps:{sx:{display:"flex",flex:1,flexDirection:"column"}},children:s(i)})]})},Km=({topText:t,bottomText:n,icon:s})=>(0,e.jsxs)(E.A,{display:"flex",flexDirection:"row",alignItems:"center",gap:"12px",children:[s,(0,e.jsxs)(E.A,{sx:{display:"flex",flex:1,flexDirection:"column",alignItems:"flex-start"},children:[(0,e.jsx)(I.A,{sx:{fontSize:"12px",lineHeight:"16px",fontWeight:"light",maxWidth:"147px"},noWrap:!0,color:"#FFF",children:t}),(0,e.jsx)(I.A,{variant:"body2",sx:{fontWeight:"medium",maxWidth:"147px"},noWrap:!0,color:"#FFF",children:n})]})]}),r1=()=>{const t={bgcolor:"border.secondary"};return(0,e.jsxs)(E.A,{display:"flex",flexDirection:"row",alignItems:"center",gap:"12px",children:[(0,e.jsx)(Mn.A,{variant:"rectangular",height:"32px",width:"32px",sx:{...t,borderRadius:"4px"}}),(0,e.jsxs)(E.A,{sx:{display:"flex",flex:1,flexDirection:"column",alignItems:"flex-start"},children:[(0,e.jsx)(Mn.A,{width:"55px",variant:"text",height:"12px",sx:t}),(0,e.jsx)(Mn.A,{width:"100px",height:"14px",sx:t})]})]})},a1=()=>{const t=lA();return(0,e.jsx)(Km,{icon:(0,e.jsx)(ym,{variant:"small",name:t?.name??""}),topText:t?.erpNumber??"",bottomText:t?.name??""})},i1=()=>{const{project:t}=(0,De.B)(),n=()=>(0,e.jsx)(E.A,{sx:{borderRadius:"4px",backgroundColor:"#F2F2F2",height:"32px",width:"32px",border:"1px solid #EAE8E6",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)("img",{src:iA,alt:"project-icon"})});return(0,e.jsx)(Km,{icon:n(),topText:t?.companyName??"",bottomText:t?.projectName??""})},l1="header-nav-grid",d1=()=>{const t=Yj();return(0,e.jsx)(Rj.A,{position:"fixed",sx:{zIndex:1200,height:"64px",backgroundColor:"#333333"},id:l1,children:(0,e.jsxs)(Oj.A,{sx:{padding:"8px 12px !important",boxSizing:"border-box",gap:"12px"},children:[(0,e.jsx)(Xj,{}),(0,e.jsx)(n1,{}),(0,e.jsx)(E.A,{sx:{display:"flex",flexDirection:"row",gap:"4px"},children:t.map(n=>(0,e.jsx)(Jj,{navLink:n},n.label))}),(0,e.jsx)(E.A,{sx:{marginLeft:"auto",display:"flex"},children:(0,e.jsx)(tA,{})})]})})},c1=()=>(0,e.jsx)(e.Fragment,{}),u1=se().memo(()=>{const t=(0,Dt.A)();return(0,No.A)(t.breakpoints.down("md"))?(0,e.jsx)(c1,{}):(0,e.jsx)(d1,{})}),hn=se().memo(()=>{const{appFocus:t}=(0,_t.A)(),{isAppEmbedded:n}=Os(),{isFlagEnabled:s,fetched:o}=(0,ut.u)(),r=s(D.SX.USE_V2_HEADER);return n||!o?null:r?(0,e.jsx)(is,{children:(0,e.jsx)(u1,{})}):t===_t.O.BFS?(0,e.jsx)(Dj,{}):t===_t.O.BUILDER_TOOLS?(0,e.jsx)(lm,{}):(0,e.jsx)(_d,{})}),p1=()=>{const{isFlagEnabled:t}=(0,ut.u)(),{project:n}=(0,De.B)(),{company:s,addCrew:o,fetchCompanyCrewInfo:r,removeCrew:a,updateCrew:i}=(0,xd.A)(n?.id,n?.companyId);(0,d.useEffect)(eb);const[l,c]=(0,d.useState)(),[u,p]=(0,d.useState)(!1),{showError:f}=(0,Fe.d)(),{createEvent:h}=(0,On.AG)(),{canViewPage:b}=(0,$n.s)({tool:D.w5.CREWS,action:D.a2.VIEW_CREWS,companyId:n?.companyId,projectId:n?.id},[n?.id,n?.companyId]);(0,d.useEffect)(()=>{n&&h({content_type:"project",object_id:n.id,tool:"crews"})},[n]);const x=async(j,A)=>{let w={userAdded:null,error:null};return w=await o(j,A),await r(),w},v=async(j,A)=>{let w={userAdded:null,error:null};return w=await i(j,A),await r(),w},y=async(j,A,w)=>{let P;return P=await a(j,A,w),await r(),P&&!P.userRemoved&&c({visible:!0,title:`Error Removing ${(0,H.capitalize)(j)} Crew`,severity:"error",message:P.error.message}),P};return u?(0,e.jsx)(L.Navigate,{to:"/select_project",replace:!0}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),b&&(0,e.jsxs)(E.A,{sx:{margin:{xs:"5rem 1rem 1rem 1rem",lg:"6.1rem 1rem 1rem 1rem",xl:"8rem 1rem 1rem 1rem"},backgroundColor:"white",borderRadius:".5rem",padding:"1rem",overflowX:"scroll"},children:[(0,e.jsxs)(E.A,{sx:{marginBottom:"1.5rem"},children:[(0,e.jsx)(I.A,{variant:"h6",sx:{marginBottom:".5rem"},children:"Crew Permissions"}),(0,e.jsx)(I.A,{variant:"body2",children:"Easily invite and manage admins, staff, home buyers, and project subcontractors with customizable permissions on this page."})]}),(0,e.jsx)(L1,{onRemove:y,onAdd:x,onEdit:v})]})]}),(0,e.jsx)(kr.A,{open:l?.visible,autoHideDuration:3e3,onClose:()=>c({...l,visible:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,e.jsxs)(Rs.A,{severity:l?.severity,children:[(0,e.jsx)(Tr.A,{children:l?.title}),l?.message]})},"remove_crew_snack")]})};var m1=m(14953),Lr=m.n(m1);const h1=Lr()(()=>m.e(579).then(m.bind(m,20579)),{ssr:!1}),wN=(0,d.memo)(({role:t,data:n,columns:s,handleSubmit:o,companyId:r,projectId:a})=>{const[i,l]=(0,d.useState)(!1),{userHasPermission:c}=(0,Ye.A)(),u=c({tool:"crews",action:"addUser",companyId:r,projectId:a});return(0,e.jsxs)("div",{style:{margin:0,padding:0},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",backgroundColor:"#dedede"},children:[(0,e.jsx)(ie,{children:t.toUpperCase()}),t!==we.wy.CompanyManager&&r&&a&&(0,e.jsx)(md,{onClick:()=>l(!0),disabled:!u,children:"Invite"})]}),(0,e.jsx)("div",{style:{margin:0,padding:0},children:(0,e.jsx)(h1,{role:t,data:n,columns:s})}),(0,e.jsx)(fd,{isOpen:i,submitCallback:o,closeModal:()=>l(!1),role:t})]})}),EN=null,g1=(0,g.Ay)("div")`
  margin-top: 1rem;
  text-align: center;
  opacity: ${t=>t.loading?"0.5":"1"};
`,Ym=(0,g.Ay)("div")`
  margin-top: 1rem;
  text-align: center;
  opacity: ${t=>t.loading?"0.5":"1"};
`,f1=(0,g.Ay)("div")`
  margin-top: 1rem;
  margin-bottom: 1rem;
  font-weight: 600;
  text-align: center;
  opacity: ${t=>t.loading?"0.5":"1"};
`,ec=({open:t,onRemove:n,userId:s,onClose:o,userEmail:r,roleType:a})=>{const[i,l]=(0,d.useState)(!1);return(0,e.jsx)(Qn,{loading:i,title:"Remove Crew Member",submitText:"Remove",destructive:!0,titleBackgroundColor:"var(--light-error-dark)",onSubmit:async()=>{l(!0);try{(await n(s)).userRemoved&&o()}finally{l(!1)}},onClose:i?()=>{}:o,open:t,children:r?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(g1,{loading:i,children:"Are you sure you want to remove"}),(0,e.jsx)(f1,{loading:i,children:r}),a&&a==="company"&&(0,e.jsx)(Ym,{loading:i,children:"from this company?"}),a&&a==="field"&&(0,e.jsx)(Ym,{loading:i,children:"from this project?"})]}):(0,e.jsx)("span",{style:i?{opacity:.5}:{},children:"Are you sure you want to remove this crew member?"})})},x1=({isOpen:t,submitCallback:n,closeModal:s,role:o,roleID:r})=>{const[a,i]=(0,d.useState)(!1),[l,c]=(0,d.useState)(void 0),u=(0,d.useRef)(null),[p,f]=(0,d.useState)(0);(0,d.useEffect)(()=>{u.current&&(u.current.selectionStart=p,u.current.selectionEnd=p)},[p]);const h=async()=>{i(!0);try{await n(r),c(void 0)}finally{i(!1)}},b=(0,g.Ay)(oe)({}),x=(0,g.Ay)(I.A)({lineHeight:"19px",marginBottom:"24px"});return(0,e.jsx)(Qn,{titleBackgroundColor:"var(--light-error-dark)",destructive:!0,open:t,onSubmit:h,title:`Delete ${o}`,onClose:s,disabled:!!l,submitText:"Delete",loading:a,"data-testid":"delete-role-modal",children:(0,e.jsx)(b,{children:(0,e.jsxs)(x,{variant:"body1",style:{marginBottom:"0px",paddingBottom:"0px"},children:["Are you sure you want to remove the ",o," role?"]})})})};var PN=m(42824),y1=m(85072),Bs=m.n(y1),b1=m(97825),Ns=m.n(b1),v1=m(77659),_s=m.n(v1),j1=m(55056),Us=m.n(j1),A1=m(10540),Ws=m.n(A1),C1=m(41113),zs=m.n(C1),Ki=m(75927),Fr={};Fr.styleTagTransform=zs(),Fr.setAttributes=Us(),Fr.insert=_s().bind(null,"head"),Fr.domAPI=Ns(),Fr.insertStyleElement=Ws();var IN=Bs()(Ki.A,Fr);const DN=Ki.A&&Ki.A.locals?Ki.A.locals:void 0,tc=({role:t,onKebabClick:n,userCanEditPermissions:s,canInviteOrEditCrew:o,hideKebab:r})=>{const i=![we.wy.CompanyManager,we.wy.OSR,we.wy.Homebuyer,we.wy.BFSComponentDesign,we.wy.Subs,we.wy.CompanyCrew].includes(t),c=[we.wy.OSR,we.wy.Homebuyer,we.wy.BFSComponentDesign].includes(t);return(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},"data-testid":"bryntum-kebab-renderer",children:[(0,e.jsx)("h3",{style:{color:"black"},children:t}),!i&&(!o||c)||r?null:(0,e.jsx)("div",{onClick:n,style:{cursor:"pointer",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"10px"},children:[...Array(3)].map((u,p)=>(0,e.jsx)("div",{style:{width:"3px",height:"3px",borderRadius:"50%",backgroundColor:"black",margin:"2px"}},p))})]})},S1=(t,n,s,o,r,a,i)=>({groupSortFn:hp,field:"role",toggleOnRowClick:!1,renderer:({row:l,groupRowFor:c})=>{const u=n?.filter(b=>b.name===c)[0]?.id,p=s[u];l.cells.forEach(b=>{const x=b._domData.column;p&&x in p&&(b.textContent=p[x])});const f=l.cells[0];f._reactRootContainer&&f._reactRootContainer.unmount(),(0,ae.createRoot)(f).render((0,e.jsx)(tc,{role:c,onKebabClick:b=>t(c,b),userCanEditPermissions:r,canInviteOrEditCrew:a,hideKebab:!i}))}}),w1=(t,n,s,o,r,a,i)=>({height:"70vh",features:{cellMenu:{disabled:!0}},groupFeature:S1(t,n,s,o,r,a,i)}),qm=()=>{const[t,n]=(0,d.useState)(!1),[s,o]=(0,d.useState)(null),{company:r}=(0,je.P)(),a=(0,d.useCallback)(async(l,c,u)=>{n(!0),o(null);const p=`/api/user-permissions/company/${r?.id}/${l}/${c}/${u}`;try{return await nt.Ay.post(p,{}),n(!1),{success:!0}}catch(f){return console.error("Error adding permission:",f),n(!1),o(f),{success:!1,error:f}}},[r?.id]),i=(0,d.useCallback)(async(l,c,u)=>{n(!0),o(null);const p=`/api/user-permissions/company/${r?.id}/${l}/${c}/${u}`;try{return await nt.Ay.delete(p,{}),n(!1),{success:!0}}catch(f){return console.error("Error removing permission:",f),n(!1),o(f),{success:!1,error:f}}},[r?.id]);return{loading:t,error:s,addUserPermission:a,removeUserPermission:i}};var Xm=m(15884);const Yi=(0,g.Ay)(it.A)`
  font-size: 16px;
  padding-top: 10px;
  padding-bottom: 10px;
  &:hover {
    background-color: var(--light-primary-dark);
    color: var(--bfs-primary-true-white);
    border-radius: 3px;
  }
  border-bottom: 1px solid #ccc;
`,E1=(0,g.Ay)(E.A)({position:"absolute",width:"169px",borderRadius:"3px",display:"flex",flexDirection:"column",backgroundColor:"white",boxShadow:"0 4px 4px 0 rgba(0, 0, 0, 0.25)",zIndex:1e3}),P1=(0,g.Ay)(it.A)`
  padding-top: 10px;
  padding-bottom: 10px;
  font-size: 16px;
  &:hover {
    background-color: var(--light-primary-dark);
    color: var(--bfs-primary-true-white);
  }
  color: #e30014;
`,Jm=(0,d.forwardRef)(({role:t,position:n,onClose:s,isVisible:o,setIsDeleteModalOpen:r,setIsDeleteUserModalOpen:a,setIsAddOpen:i,setIsEditOpen:l,value:c,setValue:u,company:p,editRolePermission:f,deleteRolePermission:h,userCanEditPermissions:b,canInviteOrEditCrew:x,crewData:v},y)=>{const A=![we.wy.CompanyManager,we.wy.OSR,we.wy.Homebuyer,we.wy.BFSComponentDesign,we.wy.Subs,we.wy.CompanyCrew].includes(t),w=()=>{i(!0),s()},P=()=>{l(!0),s()},C=()=>{r(!0),s()};return(0,e.jsxs)(E1,{ref:y,sx:{top:n.top,left:n.left,display:o?"flex":"none"},children:[x&&!v&&(0,e.jsxs)(Yi,{onClick:w,children:[t===we.wy.Subs?"Add Subcontractor":"Invite User"," "]}),A&&f&&!v?(0,e.jsx)(Yi,{onClick:P,children:"Edit Role"}):null,A&&h&&!v?(0,e.jsx)(P1,{onClick:C,children:"Delete Role"}):null,v&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Yi,{onClick:w,children:[t===we.wy.Subs?"Edit Subcontractor":"Edit User"," "]}),(0,e.jsxs)(Yi,{onClick:()=>a(!0),children:[t===we.wy.Subs?"Delete Subcontractor":"Delete User"," "]})]})]})}),Zm="230px",I1={[D.w5.CREWS]:{[D.a2.EDIT_BFS_PERMISSIONS]:t=>t?.role!==we.wy.CompanyManager}};function eh(t,n,s){return I1[t]?.[n]?.(s)??!1}const D1=t=>({field:t,text:"",hidden:!0,align:"center",readOnly:!0,width:"150px"}),k1=(t,n)=>({text:t,collapsible:!0,collapsed:!0,collapseMode:"toggleAll",children:n,readOnly:!0}),T1=(t,n,s="180px",o,r,a,i)=>({field:t,text:n,id:o,type:"check",width:s,align:"center",readOnly:!0,cellCls:"bryntum-column-background",renderer({record:l,widgets:c,cellElement:u}){if(r?eh(a,i,l):!0){const f=c[0];f.disabled=!0,u.classList.add("b-force-read-only")}}}),R1=(t,n,s="180px")=>({field:t,text:n,width:s,align:"center",readOnly:!1,cellCls:"bryntum-column-background"}),O1=(t,n,s,o)=>{const r=[{field:"role",text:"Role",hidden:!0,readOnly:!0},{field:"user_name",text:"Name",width:"250px",renderer:n,htmlEncode:!1,readOnly:!0,locked:!0},{field:"user_email",text:"Email",width:"250px",readOnly:!0,locked:!0},{field:"user_phone",text:"Phone",width:"180px",readOnly:!0}],a=(c,u)=>{const p=[];return u.map(f=>{f.visible_to_user&&f.display_name&&!p.some(h=>h.action===f.action||h.display_name===f.display_name)&&p.push(f)}),p.filter(f=>f?.visible_to_user).map(f=>{const h=`${c.toLowerCase()}_${f.action.toLowerCase()}`,b=f.display_name,x=f.id,v=D.w5[c],y=D.a2[f.action.toLocaleUpperCase()];return s?T1(h,b,Zm,x,o,v,y):R1(h,b,Zm)})},i=Object.entries(t).map(([c,u])=>{const p=tb(c),f=a(c,u),h=`${p}_short`,b=D1(h);if(f.length)return k1(c,[...f,b])}),l=[];return i.map(c=>{c&&l.push(c)}),[...r,...l]},ON=({removeUser:t})=>jsx(Fragment,{children:jsx("button",{className:"delete-user-btn",onClick:t,"data-testid":"crews-delete-btn",children:"+"})}),M1=({disabled:t,userRecord:n,addUser:s,removeUser:o})=>{const[r,a]=(0,d.useState)(!1),{project:i}=(0,De.B)();(0,d.useEffect)(()=>{a(n.project_id===i?.id)},[i,n]);function l(c){if(c.target?.checked===!0){a(!0);const u={email:n.user_email,firstName:n.user_name.split(" ")[0],lastName:n.user_name.split(" ")[1],phone:n.user_phone};s(n.role_id,u,a)}else o()}return(0,e.jsx)(ve.A,{"data-testid":"subs-checkbox",onChange:l,checked:r,disabled:t,color:"success"})},th=({value:t,onRemove:n,onAdd:s,onEdit:o,companyId:r,handleKebabClick:a})=>{const{user:i}=(0,Pt.A)(),[l,c]=(0,d.useState)(!1),[u,p]=(0,d.useState)(t?.record?.data?.user_id||""),{userHasPermission:f,isUserPermissionsLoading:h}=(0,Ye.A)(),{isFlagEnabled:b}=(0,ut.u)(),x=b(D.SX.COMPANY_CREWS),{project:v}=(0,De.B)(),[y,j]=(0,d.useState)(!1),[A,w]=(0,d.useState)(null),[P,C]=(0,d.useState)(!1),k=f({tool:D.w5.CREWS,action:D.a2.INVITE_OR_EDIT_CREW,companyId:r||v.companyId,projectId:r?void 0:v.id}),S=f({tool:D.w5.CREWS,action:D.a2.EDIT_MYBLDR_AND_BFS_PERMISSIONS,companyId:r||v.companyId,projectId:r?void 0:v.id});(0,d.useEffect)(()=>{!h&&(v||r)&&C(k)},[v,h,r]);const R=t?.record?.data?.user_name??"",B=t?.record?.data?.user_email??"",T=t?.record?.data?.user_phone??"",W=t?.record?.data?.role??"",N=t?.record?.data?.assignment_id??"",O=t?.record?.data?.project_id??"";(0,d.useEffect)(()=>{const $=R.split(" "),ee={id:u,assignmentId:N,role:W,fullName:R,firstName:$[0]??"",lastName:$.length>1?$.slice(1).join(" "):"",email:B,phoneNumber:T};w(ee)},[R,B,T]),(0,d.useEffect)(()=>{j(O===v?.id)},[O,v]);const z=()=>{p(u),c(!0)},re=[we.wy.OSR.toString(),we.wy.BFSComponentDesign.toString()].includes(W)||!B,ue=W===we.wy.Subs,le=x&&ue&&!r,F=!re&&S,V=async()=>(await n(W,u,N),c(!1),j(!1),{userRemoved:!0});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"user-name-flex-container",children:[(0,e.jsx)("div",{className:"user-name-content",children:R}),(0,e.jsxs)("div",{className:"user-name-delete-content",children:[le&&(0,e.jsx)(M1,{userRecord:t.record?.data,addUser:s,removeUser:z,disabled:!P}),P&&F&&(0,e.jsx)(tc,{onKebabClick:$=>a(W,$,A),userCanEditPermissions:!0})]})]}),(0,e.jsx)(ec,{open:l,onRemove:V,userId:u,userEmail:B,roleType:W,onClose:()=>c(!1)})]})},LN=Lr()(()=>m.e(579).then(m.bind(m,20579)),{ssr:!1}),L1=({onRemove:t,onAdd:n,onEdit:s})=>{const{company:o}=(0,je.P)(),{project:r}=(0,De.B)(),{showError:a,showSuccess:i}=(0,Fe.d)(),{addUserPermission:l,removeUserPermission:c}=qm(),{isFlagEnabled:u}=(0,ut.u)(),{addCrew:p,removeCrew:f,updateCrew:h}=(0,On.ts)(r?.id,r?.companyId),{userHasPermission:b,isUserPermissionsLoading:x}=(0,Ye.A)(),[v,y]=(0,d.useState)(!0),[j,A]=(0,d.useState)([]),[w,P]=(0,d.useState)(null),[C,k]=(0,d.useState)(null),[S,R]=(0,d.useState)(!1),[B,T]=(0,d.useState)(!1),[W,N]=(0,d.useState)(!1),[O,z]=(0,d.useState)(null),[Q,re]=(0,d.useState)(""),[ue,le]=(0,d.useState)(!1),[F,V]=(0,d.useState)({top:0,left:0}),[$,ee]=(0,d.useState)([]),[X,G]=(0,d.useState)(!1),[Y,he]=(0,d.useState)(""),[ne,J]=(0,d.useState)(!1),[pe,Ee]=(0,d.useState)([]),[Te,me]=(0,d.useState)(0),$e=(0,d.useRef)(null),gt=(0,d.useRef)(null),Rt=(0,d.useRef)(r);Rt.current=r;const rt=async(yt,zt,Nt)=>{await l(yt,zt,Nt)},Ue=async(yt,zt,Nt)=>{await c(yt,zt,Nt)},{assignments:lt,crewAssignments:ge,tools:We,isLoading:At,error:xn,fetchAssignments:on,getUpdatedAssignments:Xe,roles:dt,roleBasedData:Tn,isPortalAccessEnabled:In}=(0,On.DZ)(String(Rt?.current?.id)),Ct=b({tool:D.w5.CREWS,action:D.a2.EDIT_MYBLDR_AND_BFS_PERMISSIONS,companyId:r?.companyId,projectId:r?.id}),Mt=b({tool:D.w5.CREWS,action:D.a2.EDIT_ROLE,companyId:o?.id,projectId:r?.id}),Pe=b({tool:D.w5.CREWS,action:D.a2.DELETE_ROLE,companyId:o?.id,projectId:r?.id}),Qe=yt=>{yt.on("cellClick",({record:zt,column:Nt,cellElement:gs})=>{const fa=gs.querySelector('input[type="checkbox"]')?.disabled;if(Nt.type==="check"&&pn&&!fa){let ld=zt.get(Nt.field);const dd=zt.get(Nt.field)===!0;zt.set(Nt.field,!ld);const wi=zt.get("assignment_id"),cd=zt.get("user_id"),ud=Nt.id;dd||rt(cd,wi,ud),dd&&Ue(cd,wi,ud)}})},ht=b({tool:D.w5.CREWS,action:D.a2.INVITE_OR_EDIT_CREW,companyId:r?.companyId,projectId:r?.id});(0,d.useEffect)(()=>{r&&!x&&y(ht)},[r,x]);const Xt=async(yt,zt,Nt)=>{await t(yt,zt,Nt),await Xe()},Qt=(0,d.useRef)(Xt);Qt.current=Xt;const As=async(yt,zt,Nt)=>{let gs,Jo;gs=await n(yt,zt),gs?.userAdded?(await Xe(),i({title:`${zt.fullName?zt.fullName:zt.email} invited to this project!`,message:"They will receive a link to this project in their inbox. The email link will expire after 30 minutes, after which you must send a new invite."})):(Nt(!1),a({title:"Users could not be invited",message:"Sorry, we couldn't invite the users. Make sure each email address is correctly formatted and separated by commas. Still having issues? Please reach out to our Customer Support."}))},Ln=async(yt,zt,Nt)=>{let gs,Jo;gs=await s},hs=(0,d.useRef)(As);hs.current=As;const Qs=(0,d.useRef)(Ln);Qs.current=Ln;const Le=(yt,zt,Nt)=>{J(!1);const gs=yd(yt,dt),Jo=mp(gs,dt);if(gs){const fa=zt.currentTarget.getBoundingClientRect();V({top:fa.bottom,left:fa.left}),le(!0),he(yt),re(yt),Ee(Jo),me(gs),z(Nt||null)}},mt=yt=>(0,e.jsx)(th,{value:yt,onRemove:Qt.current,onAdd:hs.current,onEdit:Qs.current,handleKebabClick:Le}),Wt=u(D.SX.USER_LEVEL_PERMISSIONS),pn=b({tool:D.w5.CREWS,action:D.a2.EDIT_BFS_PERMISSIONS,companyId:r?.companyId,projectId:r?.id}),mn=yt=>{let zt=[];return yt?O1(yt,mt,Wt,pn):[...zt]};(0,d.useEffect)(()=>{We&&A(mn(We))},[We]),(0,d.useEffect)(()=>{r?.id&&on()},[r?.id,on]),(0,d.useEffect)(()=>{if(We&&Object.keys(We).length!==0&&lt){const yt=w1(Le,dt,Tn,o,pn,ht,In);k(yt)}},[lt,We]);const yn=u(D.SX.HOME_BUYER);(0,d.useEffect)(()=>{ee(yn?ge:ge.filter(yt=>yt.role!==we.wy.Homebuyer))},[ge,yn]);const es=async(yt,zt)=>{const Nt=O?await h(yt,zt,O.assignmentId):await p(yt,zt),gs=O?`${zt.fullName||zt.email} has been updated!`:`${zt.fullName||zt.email} invited to this project!`;Nt?(i({title:gs,message:O?"":"They will receive a link to this project in their inbox. The email link will expire after 30 minutes, after which you must send a new invite."}),R(!1),await Xe()):a({title:"User could not be invited",message:"Sorry, we couldn't invite the user to the project. Make sure the email address is correctly formatted. Still having issues? Please reach out to our Customer Support."})},Ir=async(yt,zt,Nt)=>{await f(yt,zt,Nt),await Xe(),T(!1)};(0,d.useEffect)(()=>{if($e.current){const yt=$e.current.instance;Qe(yt)}return()=>{$e.current&&$e.current.instance.removeAllListeners()}},[C,j]);const ns=()=>{le(!1)};return(0,d.useEffect)(()=>{const yt=zt=>{const Nt=zt.target;ue&&gt.current&&!gt.current.contains(Nt)&&le(!1)};return document.addEventListener("mousedown",yt),()=>{document.removeEventListener("mousedown",yt)}},[ue,gt]),At?(0,e.jsx)("div",{children:"Loading..."}):xn?(0,e.jsxs)("div",{children:["Error: ",xn.message]}):!At&&C&&(0,e.jsxs)(e.Fragment,{children:[!In&&(0,e.jsx)(Rs.A,{severity:"info",sx:{marginBottom:"1.5rem"},children:"This account has portal access disabled for customers."}),(0,e.jsx)(Xm.C4,{ref:$e,config:C,columns:j,data:$}),(0,e.jsx)(Jm,{ref:gt,role:Q,position:F,onClose:ns,isVisible:ue,setIsDeleteModalOpen:N,setIsAddOpen:R,setIsDeleteUserModalOpen:T,setIsEditOpen:G,value:Y,setValue:he,company:o,editRolePermission:Mt,deleteRolePermission:Pe,userCanEditPermissions:pn,canInviteOrEditCrew:ht,crewData:O}),(0,e.jsx)(Zy,{isOpen:S,submitCallback:(yt,zt)=>es(zt.id,yt),closeModal:()=>R(!1),roles:dt,setSelectedRole:re,currentRole:dt.find(yt=>yt.name===Y),crewData:O}),(0,e.jsx)(ec,{open:B,onRemove:()=>Ir(O?.role,O?.id,O?.assignmentId),userId:O?.id,userEmail:O?.email,roleType:Q,onClose:()=>T(!1)})]})},F1=(0,g.Ay)("div")({backgroundColor:"white",width:"100%",height:"5em",textAlign:"right"}),BN=()=>useLocation().pathname==="/materials"?jsx(Fragment,{}):jsx(F1,{});function nh(){const[t,n]=(0,d.useState)(""),[s,o]=(0,d.useState)(!1);return{requestMarketingContent:(0,d.useCallback)(async a=>{try{n(""),o(!0);const{data:i}=await nt.Ay.get(`/config/marketing_content/${a}`);n(i.body)}catch(i){console.error("Error requesting configure marketing content",i)}finally{o(!1)}},[]),content:t,loading:s}}const sh=t=>{const n=t.querySelectorAll(".marketing-media"),s=`${window.location.protocol}//${window.location.host}/config/marketing_content_media`;n.forEach(o=>{o.setAttribute("src",`${s}/${o.getAttribute("id")}`)})},oh=({htmlContent:t,eventListeners:n,overrideStyle:s={},attachMedia:o=!1})=>{const r=(0,d.useRef)(null);return(0,d.useEffect)(()=>{if(r.current&&t){let a;r.current.shadowRoot||(a=r.current.attachShadow({mode:"open"})),a=r.current.shadowRoot,a.innerHTML=t,n&&n.forEach(i=>{a.getElementById(i.id)?.addEventListener(i.trigger,function(){i.action(i,r.current?.shadowRoot)})}),o&&sh(a)}else r.current&&t&&(r.current.innerHTML=t,r.current.innerHTML=t,n&&n.forEach(a=>{r.current?.shadowRoot?.getElementById(a.id)?.addEventListener("click",function(){a.action(a,r.current?.shadowRoot)})}),o&&r.current?.shadowRoot&&sh(r.current?.shadowRoot));return()=>{n&&n.forEach(a=>{r.current?.shadowRoot?.getElementById(a.id)?.removeEventListener("click",function(){a.action(a,r.current?.shadowRoot)})})}},[t,o]),(0,e.jsx)("div",{ref:r,"data-testid":"test-shadow-dom",style:{overflowX:"hidden",backgroundColor:"var(--bfs-primary-true-white)",padding:"0px",...s}})},B1=(0,g.Ay)("section")``,NN=(0,g.Ay)("section")`
  height: 100%;
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  padding: 0 90px;
  margin-top: 90px;
`,_N=(0,g.Ay)("section")`
  max-width: 450px;
  min-width: 450px;
  flex-grow: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  gap: 8px;
  padding: 40px;
  background-color: #ffffff;
`,UN=(0,g.Ay)("section")`
  display: flex;
  flex-direction: column-reverse;

  ${t=>t.theme.breakpoints.up("sm")} {
    flex-direction: row;
  }
`,WN=(0,g.Ay)("div")`
  align-self: stretch;
  flex-grow: 0;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  padding: 36px;
  background-color: #eae8e6;
`,zN=(0,g.Ay)("img")`
  height: 192px;
  margin-right: 20px;
`,VN=(0,g.Ay)("img")`
  width: 100%;
  object-fit: cover;
`,$N=(0,g.Ay)(K.A)`
  background-color: var(--bfs-primary-green);
  text-transform: none;
  color: white;
  margin-right: 16px;
  height: 48px;
  font-weight: 600;
  gap: 8px;
  padding: 17px 16px 20px;

  &:hover {
    background-color: #2aba27;
  }
`,HN=(0,g.Ay)("form")`
  padding: 36px 0;
`,QN=(0,g.Ay)(K.A)`
  background-color: var(--light-secondary-main);
  text-transform: none;
  color: white;
  margin: auto;
  height: 48px;
  font-weight: 600;
  gap: 8px;
  padding: 17px 16px 20px;

  &:hover {
    background-color: #555352;
  }
`,GN=(0,g.Ay)("div")`
  display: flex;
  font-style: italic;
  font-weight: normal;
  font-size: 12px;
  line-height: 12px;
  text-align: left;
  color: var(--light-secondary-dark);
  margin: 0;
  margin-left: 10px;
`,KN=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 32px;
  line-height: 32px;
  margin-right: 30px;
`,YN=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 12px;
  line-height: 12px;
`,qN=(0,g.Ay)("ul")`
  padding: 12px;
  margin: 0;
  font-weight: normal;
  font-size: 14px;
  line-height: 16.8px;
`,XN=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 26px;
  line-height: 28px;
  letter-spacing: -0.5px;
`,JN=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 28px;
  line-height: 28px;
  letter-spacing: -0.5px;
`,ZN=(0,g.Ay)(I.A)`
  font-weight: normal;
  font-size: 18px;
  line-height: 18px;
  margin-bottom: 16px;
`,e_=(0,g.Ay)("div")`
  width: 100%;
  display: flex;
  flex-direction: row;
  justify-content: space-around;
`,t_=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 16px;
  line-height: 19.2px;
`,n_=(0,g.Ay)("div")`
  display: flex;
  align-content: center;
  justify-content: center;
`,N1=(0,g.Ay)("div")`
  display: flex;
  height: 100%;
`,s_=(0,g.Ay)("div")`
  padding: 15px 0 36px 0;
  display: flex;
  flex-direction: column;
`,_1=(0,g.Ay)("div")`
  display: flex;
  width: 100%;
  height: 100%;
  flex-grow: 0;
  background-color: rgba(0, 0, 0, 0.75);
  position: absolute;
`,rh=(0,g.Ay)("img")`
  width: 100%;
  object-fit: cover;
`,U1=(0,g.Ay)("div")`
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 24px;
  padding: 0;
`,W1=(0,g.Ay)("div")`
  flex-grow: 0;
  font-family: acumin-pro;
  font-size: 40px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.2;
  letter-spacing: normal;
  text-align: left;
  color: var(--bfs-primary-true-white);
`,z1=(0,g.Ay)("div")`
  width: 707px;
  flex-grow: 0;
  font-family: acumin-pro;
  font-size: 20px;
  font-weight: 500;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.5;
  letter-spacing: normal;
  text-align: center;
  color: var(--bfs-primary-true-white);
`;function ah(){const[t,n]=(0,d.useState)(!1),s=(0,d.useCallback)(async(r,a)=>{const i=`/api/projects/${r}/configure-request/${a}`;try{return n(!0),(await nt.Ay.post(i)).data}catch(l){return{message:`Error communicating with the server. Please try again. ${l}`}}finally{n(!1)}},[]),o=(0,d.useCallback)(async(r,a,i,l)=>{const c=`/api/projects/${r}/configure-renewal`,u={ext_line_id:i,ext_quote_id:a,template_id:l};return(await nt.Ay.post(c,u)).data},[]);return{requestConfigurePackage:s,loading:t,requestConfigureRenewal:o}}const V1=({setPackage:t,onSelectionBook:n,refetchConfigureValues:s})=>{const o=(0,Dt.A)(),{requestMarketingContent:r,content:a,loading:i}=nh(),{requestConfigurePackage:l,loading:c}=ah(),{project:u,fetchProject:p}=(0,De.B)(),{showToast:f}=(0,Fe.d)(),{userHasPermission:h}=(0,Ye.A)(),b=!h({tool:D.w5.CONFIGURE,action:D.a2.PURCHASE,companyId:u?.companyId,projectId:u?.id});(0,d.useEffect)(()=>{r("configure")},[]);const x=(w,P)=>{w.scrollToId&&P?.getElementById(w.scrollToId)?.scrollIntoView({behavior:"smooth"})},v=async(w,P)=>{b?j():u?.id&&(await l(u?.id,w.id),p(u?.id),t(w.id),s())},y=async(w,P)=>{b?j():n()},j=()=>{f({severity:"warning",title:"Please contact the homebuilder to request activating this project",message:"You don't have permission to request activating this project",style:{top:o.header.height,bottom:void 0},anchorOrigin:{vertical:"top",horizontal:"center"}})},A=[{id:"scroll-to-packages",action:x,trigger:"click",scrollToId:"package-table"},{id:"contracted-exterior-only",trigger:"click",action:v},{id:"contracted-exterior-interior",trigger:"click",action:v},{id:"prospective-exterior-only",trigger:"click",action:v},{id:"prospective-exterior-interior",trigger:"click",action:v},{id:"selection-book",trigger:"click",action:y},{id:"learn-more-selections-book",trigger:"click",action:x,scrollToId:"learn-more-selections-book-landing"}];return i||c?(0,e.jsx)(ls,{showLoadingScreen:!0,dataTestId:"configure-lead-loading"}):(0,e.jsx)(B1,{"data-testid":"configure-html",children:!(i||c)&&(0,e.jsx)(oh,{htmlContent:a,eventListeners:A,attachMedia:!0})})},ih=m.p+"3d2ae897fcbad4cf8f5eb560eb17326d.png",$1=m.p+"52667a121f51071b6dc2b45600bb7aa5.svg",H1=({selectedPackage:t})=>(0,e.jsxs)(N1,{children:[(0,e.jsx)(rh,{src:ih,alt:"3D Home Rendering"}),(0,e.jsx)(_1,{children:(0,e.jsxs)(U1,{children:[(0,e.jsx)("img",{src:$1}),(0,e.jsx)(W1,{children:"We received your request!"}),(0,e.jsxs)(z1,{children:["Thank you for your interest in Home Configure. We will reach out to you shortly with any questions and to confirm next steps. We look forward to making your build easier and engaging your homebuyer in new ways.",(0,e.jsx)("br",{}),"If you have any questions, please refer to our",(0,e.jsx)("text",{onClick:()=>window.open("/help"),children:" Support page."})]})]})})]});var Q1=m(74353),dn=m.n(Q1);const lh=(0,g.Ay)("iframe")`
  display: block;
  width: 100%;
  height: 100%;
  margin: 0;
  padding: 0;
  border: none;
`,G1=(0,g.Ay)(K.A)`
  background-color: #996600;
  text-transform: none;
  color: white;

  &:hover {
    background-color: #996600;
  }
`,K1=(0,g.Ay)("div")`
  font-family: acumin-pro;
  font-size: 16px;
  font-weight: bold;
`,Y1=(0,g.Ay)("div")`
  font-family: 'Roboto';
  font-size: 14px;
`,q1=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 36px;
`,X1=({open:t,onClose:n,hasExpired:s,expirationDate:o,projectId:r,exteriorQuoteId:a,exteriorLineId:i,templateId:l,canPurchase:c,refetchConfigureStatusData:u})=>{const p=(0,Dt.A)(),{showSuccess:f,showError:h}=(0,Fe.d)(),{requestConfigureRenewal:b}=ah(),[x,v]=(0,d.useState)(!1),y=dn()(o).format("MMMM Do, YYYY"),j=async()=>{v(!0);try{await b(r,a,i,l),n(),f({message:"Project Renewal Confirmed!"}),u()}catch{h({message:"Error renewing project"}),n()}finally{v(!1)}},A=()=>s&&!c?"This Home Configure project has expired. Please contact the homebuilder to request reactivating this project.":(s?`This Home Configure project expired on ${y}.`:`Your Home Configure project will expire on ${y}, and you will no longer be able to access it.`)+" Would you like to renew it now for one year using $100 from your BFS credit?";return(0,e.jsx)(Qn,{open:t,onClose:s?void 0:n,hideCloseButton:s,onSubmit:c?j:void 0,title:"Home Configure Renewal",submitText:"Yes, Renew Home Configure",cancelText:"Cancel",loading:x,backdropStyle:{marginTop:p.header.height},rootStyle:{zIndex:5,marginTop:p.header.height},children:(0,e.jsxs)(q1,{children:[(0,e.jsx)(K1,{children:"Confirm Home Configure Renewal"}),(0,e.jsx)(Y1,{style:c?void 0:{textAlign:"center"},children:A()})]})})},J1=t=>{const n=dn()(t);if(n.isToday())return"today";const s=dn()().endOf("day"),r=dn()(n).endOf("day").diff(s,"days");return r===1?"in 1 day":`in ${r} days`},Z1=({project:t,previewData:n,refetchConfigureStatusData:s})=>{const o=(0,Dt.A)(),{company:r}=(0,je.P)(),{showToast:a,closeToast:i}=(0,Fe.d)(),l=(0,d.useRef)(),[c,u]=(0,d.useState)(!1),{hasPermission:p}=(0,we.Sk)(),f=(0,d.useMemo)(()=>p({tool:D.w5.CONFIGURE,action:D.a2.PURCHASE_CONFIGURE,projectId:t?.id,companyId:r?.id}),[p,r,t?.id]),h=n.previewLink,b=n.expirationDate,x=dn()(),v=b?dn()(b).isBefore(x):!1,y=b?!v&&dn()(b).diff(x,"days")<=30:!1,j=(0,d.useCallback)(()=>{l.current&&i(l.current);const A=a({severity:"warning",title:`Your Home Configure project expires ${J1(b)}.`,message:f?"Please renew your project for $100 BFS credits to maintain access.":"Please contact the homebuilder to request reactivating this project.",style:{top:o.header.height,bottom:void 0},anchorOrigin:{vertical:"top",horizontal:"center"},renderAction:f?w=>(0,e.jsx)(G1,{variant:"contained",onClick:()=>{i(w),u(!0)},children:"Renew Project"}):void 0});l.current=A},[a,i,o.header.height,f,b]);return(0,d.useEffect)(()=>(y&&j(),()=>{l.current&&i(l.current)}),[y,i,j]),(0,d.useEffect)(()=>{v&&u(!0)},[v]),(0,e.jsxs)(e.Fragment,{children:[!v&&(0,e.jsx)(lh,{src:h,"data-testid":"finish-configure-container"}),v&&(0,e.jsx)(rh,{src:ih,alt:"3D Home Rendering",sx:{flex:1}}),c&&(0,e.jsx)(X1,{projectId:t.id,exteriorQuoteId:n?.exteriorQuoteId,exteriorLineId:n?.exteriorLineId,templateId:n?.templateId,onClose:()=>{u(!1),y&&j()},open:c,hasExpired:v,expirationDate:b,canPurchase:f,refetchConfigureStatusData:s})]})},qi=(0,Lo.xP)({baseQuery:(0,Zo.S)({baseUrl:"/api"}),reducerPath:"configure",keepUnusedDataFor:1,endpoints:t=>({getProjectConfigureStatus:t.query({query:({projectId:n})=>({url:`/project/${n}/configure-status`}),transformResponse:n=>(0,Ze.bn)(n)}),getSelectionBookValues:t.query({query:({projectId:n})=>({url:`/project/${n}/get-selection-book-values`}),transformResponse:n=>(0,Ze.bn)(n)}),getConfigureStatus:t.query({query:({projectId:n,projectName:s})=>({url:`/project/${n}/configure-values`,method:"POST",data:{projectName:s}}),transformResponse:n=>(0,Ze.bn)(n)})})}),{useGetProjectConfigureStatusQuery:o_,useGetSelectionBookValuesQuery:eS,useGetConfigureStatusQuery:tS}=qi,nS=t=>{const{data:n,isLoading:s,error:o}=eS({projectId:t});return{selectionBookResponse:n,isLoading:s,error:o}},sS=(0,d.lazy)(()=>m.e(770).then(m.t.bind(m,2770,23))),oS=({areaCode:t,builderId:n})=>{const{project:s}=(0,De.B)(),{selectionBookResponse:o,isLoading:r}=nS(s?.id);return r?(0,e.jsx)(os,{}):o&&s?.projectExternalId&&s?.projectName?(0,e.jsx)(d.Suspense,{fallback:(0,e.jsx)(os,{}),children:(0,e.jsx)(Kd,{children:(0,e.jsx)(sS,{externalProjectId:s.projectExternalId,builderIntegrationId:n,projectName:s.projectName,code:o.token,areaCode:t})})}):null},nc=(t,n=!1)=>{const{data:s,isLoading:o,error:r,refetch:a}=tS({projectId:t?.id,projectName:t?.projectName},{skip:!t||n}),i=s?.hc3DData?.exteriorLineId??s?.visualizerData?.lineId??"",l=s?.hc3DData?.exteriorQuoteId??s?.visualizerData?.quoteId??"";return{configureStatusData:s,lineId:i,quoteId:l,isLoading:o,error:r,refetch:a}},dh=()=>{const{project:t,projectLoading:n}=(0,De.B)(),[s,o]=(0,d.useState)(""),{createEvent:r}=(0,On.AG)(),{configureStatusData:a,isLoading:i,error:l,refetch:c}=nc(t),[u,p]=(0,d.useState)(!1),{canViewPage:f}=(0,$n.s)({tool:D.w5.CONFIGURE,action:D.a2.VIEW_CONFIGURE,companyId:t?.companyId,projectId:t?.id},[t?.id,t?.companyId]),h=(a?.configureRequested||s!="")??!1;if((0,d.useEffect)(()=>{t?.id&&r({content_type:"project",object_id:t.id,tool:"configure"})},[t?.id]),n||i)return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(ls,{showLoadingScreen:!0})]});const b=!!a?.hc3DData?.previewLink,x=!b&&h&&!i,v=!x&&!b&&a?.visualizerData?.visualizerLink,y=!x&&!b&&s=="";return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),f&&(0,e.jsxs)(kn,{children:[y&&!u&&!v&&(0,e.jsx)(V1,{setPackage:o,onSelectionBook:()=>p(!0),refetchConfigureValues:c}),x&&(0,e.jsx)(H1,{selectedPackage:s}),b&&t&&a?.hc3DData&&(0,e.jsx)(Z1,{project:t,previewData:a.hc3DData,refetchConfigureStatusData:c}),v&&(0,e.jsx)(lh,{src:a.visualizerData?.visualizerLink}),u&&(0,e.jsx)(oS,{areaCode:a?.areaCode??"",builderId:a?.builderId??""})]})]})},rS=t=>{const{scripts:n}=document;for(let s=0;s<n.length;++s){const o=n.item(s);if(o?.getAttribute("src")===t)return o}return null},aS=({src:t,onLoad:n,onError:s,async:o=!0})=>{const[r,a]=(0,d.useState)(!1),[i,l]=(0,d.useState)(null),c=(0,d.useRef)({onLoad:n,onError:s,async:o});return c.current={onLoad:n,onError:s,async:o},(0,d.useEffect)(()=>{let u=rS(t);const p=!u;u||(u=document.createElement("script"),u.src=t,u.async=c.current.async??!0);const f=b=>{c.current.onLoad&&c.current.onLoad(),a(!0)},h=b=>{c.current.onError&&c.current.onError()};return u.addEventListener("load",f),u.addEventListener("error",h),p&&document.body.appendChild(u),l(u),p||a(!0),()=>{u.removeEventListener("load",f),u.removeEventListener("error",h)}},[t,c]),{ready:r,script:i}},ch=({urn:t,version:n,proxy:s,...o})=>{const[r,a]=(0,d.useState)(),[i,l]=(0,d.useState)(!1),c=(0,d.useRef)(null),u=n||"7.*",p=`https://developer.api.autodesk.com/viewingservice/v1/viewers/${u}/style.min.css`,f=`https://developer.api.autodesk.com/viewingservice/v1/viewers/${u}/viewer3D.js`,{ready:h}=aS({src:f,onLoad:()=>console.log("Autodesk scripts have finished loading.")}),b=(0,d.useRef)({...o});b.current={...o},(0,d.useEffect)(()=>{let y;return h&&(()=>{const A={env:"AutodeskProduction2",api:"streamingV2",getAccessToken:b.current?.onTokenRequest},w=()=>{console.log("Forge Viewer has finished initializing."),s&&Autodesk.Viewing.endpoint.setEndpointAndApi(s,"streamingV2");const P=c.current;if(P!==null){y=new Autodesk.Viewing.Private.GuiViewer3D(P),console.log("Starting the Forge Viewer...");const C=y.start();C?(console.error("Error starting Forge Viewer - code:",C),l(!0),b.current.onViewerError&&b.current.onViewerError(y,C)):(console.log("Forge Viewer has successfully started."),a(y))}else console.error("Failed to initialize Forge Viewer. Container is null.")};Autodesk.Viewing.Initializer(A,w)})(),()=>{y&&(y.tearDown(),y.finish(),console.log("React Forge Viewer destroyed"))}},[h,s]),(0,d.useEffect)(()=>{r&&t&&((j,A)=>{console.log("Forge Viewer is loading document:",j);const w=`urn:${j}`,P=k=>{console.log("Forge viewer has successfully loaded document:",k);const S=k.getRoot();console.log(S);const R=k.getRoot().getDefaultGeometry();A.loadDocumentNode(k,R),console.log("Forge viewer has successfully loaded the default model."),b.current?.onDocumentLoad&&b.current.onDocumentLoad(k)},C=(k,S,R)=>{console.error("Error loading Forge document - errorMessage:"+S),l(!0),b.current?.onDocumentError&&b.current.onDocumentError(r,S)};Autodesk.Viewing.Document.load(w,P,C)})(t,r)},[r,t]);const x=()=>!r||i,v=()=>x()?i?"Viewer Error":"Viewer Loading":"";return(0,e.jsxs)("div",{style:{width:"100%",height:"100%",position:"relative"},children:[(0,e.jsx)("div",{style:{height:"100%",width:"100%"},className:"vier-div",ref:c}),(0,e.jsx)("link",{rel:"stylesheet",type:"text/css",href:p}),(0,e.jsx)("div",{style:{position:"relative",width:"100%",height:"100%",zIndex:"1000",backgroundColor:"#ededed",color:"#95a5a6",display:x()?"flex":"none",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:v()})})]})};var Ps=m(17197);const za=(t,n,s=!1)=>{const{data:o,error:r,isLoading:a,isFetching:i,refetch:l}=(0,Ps.Q8)({projectId:t,jiraKey:n},{skip:!t||!n||s});return{data:o,error:r,isLoading:a||i,refetch:l}},iS=()=>{const{project:t}=(0,De.B)(),{data:n,error:s,isLoading:o}=za(t?.id,t?.jiraKey);return{publishedModelFile:n?.find(a=>a.isPublished),error:s,isLoading:o}},lS=(0,g.Ay)("div")(({theme:t})=>({position:"fixed",bottom:0,left:0,width:"100%",height:"100%",zIndex:2e3,top:t.header?.height,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.6)",backdropFilter:"blur(2px)"})),ls=({showLoadingScreen:t,dataTestId:n})=>t?(0,e.jsx)("div",{"data-testid":n||"loading-screen",children:(0,e.jsx)(lS,{"data-testid":"screen-shadow",children:(0,e.jsx)(bt.A,{})})}):null,uh=(0,g.Ay)("section")`
  height: 100%;
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  padding: 0 90px;
  margin-top: 90px;
`,ph=(0,g.Ay)("section")`
  max-width: 450px;
  min-width: 450px;
  flex-grow: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  gap: 8px;
  padding: 40px;
  background-color: #ffffff;
`,mh=(0,g.Ay)("section")`
  display: flex;
  flex-direction: column-reverse;

  ${t=>t.theme.breakpoints.up("sm")} {
    flex-direction: row;
  }
`,hh=(0,g.Ay)("div")`
  align-self: stretch;
  flex-grow: 0;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  padding: 36px;
  background-color: #eae8e6;
`,gh=(0,g.Ay)("img")`
  height: 192px;
  margin-right: 20px;
`,fh=(0,g.Ay)("img")`
  width: 100%;
  object-fit: cover;
`,dS=(0,g.Ay)("div")`
  padding: 36px 0;
  display: flex;
`,cS=(0,g.Ay)(K.A)`
  background-color: var(--bfs-primary-green);
  text-transform: none;
  color: white;
  margin-right: 16px;
  height: 48px;
  font-weight: 600;
  gap: 8px;
  padding: 17px 16px 20px;

  &:hover {
    background-color: #2aba27;
  }
`,r_=(0,g.Ay)("form")`
  padding: 36px 0;
`,uS=(0,g.Ay)(K.A)`
  background-color: var(--light-secondary-main);
  text-transform: none;
  color: white;
  margin: auto;
  height: 48px;
  font-weight: 600;
  gap: 8px;
  padding: 17px 16px 20px;

  &:hover {
    background-color: #555352;
  }
`,xh=(0,g.Ay)("div")`
  display: flex;
  font-style: italic;
  font-weight: normal;
  font-size: 12px;
  line-height: 12px;
  text-align: left;
  color: var(--light-secondary-dark);
  margin: 0;
  margin-left: 10px;
`,pS=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 32px;
  line-height: 32px;
  margin-right: 30px;
`,mS=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 12px;
  line-height: 12px;
`,yh=(0,g.Ay)("ul")`
  padding: 12px;
  margin: 0;
  font-weight: normal;
  font-size: 14px;
  line-height: 16.8px;
`,bh=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 26px;
  line-height: 28px;
  letter-spacing: -0.5px;
`,a_=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 28px;
  line-height: 28px;
  letter-spacing: -0.5px;
`,vh=(0,g.Ay)(I.A)`
  font-weight: normal;
  font-size: 18px;
  line-height: 18px;
  margin-bottom: 16px;
`,jh=(0,g.Ay)("div")`
  width: 100%;
  display: flex;
  flex-direction: row;
  justify-content: space-around;
`,Ah=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 16px;
  line-height: 19.2px;
`,hS=(0,g.Ay)("div")`
  display: flex;
  align-content: center;
  justify-content: center;
`,gS=(0,g.Ay)("div")`
  padding: 15px 0 36px 0;
  display: flex;
  flex-direction: column;
`;function fS(){return{requestBuild:async n=>{try{return nt.Ay.post(`/api/project/${n}/build-request`)}catch(s){console.error("Error making build optimize request",s)}}}}const Ch=m.p+"914624ab4b81c873e7f3b088d354a594.jpg",Sh=m.p+"373b9f4784e18ad27c23ddd803747e7f.jpg",xS=t=>{const{setBuildIsInProgress:n}=t,{project:s,fetchProject:o}=(0,De.B)(),[r,a]=(0,d.useState)(!1),{requestBuild:i}=fS(),{showError:l}=(0,Fe.d)(),[c,u]=(0,d.useState)(!1),{company:p}=(0,je.P)(),{userHasPermission:f,isUserPermissionsLoading:h}=(0,Ye.A)(),b=f({tool:"build",action:"view",companyId:p?.id,projectId:s?.id});(0,d.useEffect)(()=>{p?.id&&s?.id&&!h&&(b||(setTimeout(()=>{l({message:"You do not have permission to view this build."})},0),u(!0)))},[p,h]);const x=(0,d.useCallback)(()=>{a(!0),n(!0),s&&s.id&&(i(s.id),o(s.id))},[r,o,s]),v=()=>!f({tool:"build",action:"purchase",companyId:p?.id,projectId:s?.id})||r;return c?(0,e.jsx)(L.Navigate,{to:"/select_project",replace:!0}):(0,e.jsx)(uh,{children:(0,e.jsxs)(mh,{children:[(0,e.jsxs)(ph,{children:[(0,e.jsx)(bh,{children:"Solve Building Problems Before They Happen with Build Optimize!"}),(0,e.jsx)(vh,{children:"Proper planning of your construction project reduces time, cost, and waste\u2014resulting in more dollars on your bottom line. Our Building Information Modeling (BIM) experts will provide a detailed 3D model that streamlines your build process by identifying and eliminating construction conflicts in the virtual world\u2014 rather than at the job site."}),(0,e.jsxs)(hh,{children:[(0,e.jsxs)(jh,{children:[(0,e.jsx)(gh,{src:Sh,alt:"visualizer_preview"}),(0,e.jsxs)("div",{children:[(0,e.jsx)(Ah,{children:"Single family home up to 8,000 sqft.*"}),(0,e.jsxs)(yh,{children:[(0,e.jsx)("li",{children:"Advanced 3D modeling"}),(0,e.jsx)("li",{children:"Coordinate architects, builders and trades"}),(0,e.jsx)("li",{children:"Quickly and efficiently resolve questions"}),(0,e.jsx)("li",{children:"Experienced BIM coordinators"}),(0,e.jsx)("li",{children:"Unified 3D models"})]}),(0,e.jsxs)(hS,{children:[(0,e.jsx)(mS,{children:"Starting at"}),(0,e.jsx)(pS,{children:"$4,999"})]})]})]}),(0,e.jsx)(dS,{children:(0,e.jsx)(cS,{onClick:x,"data-testid":"request-build-button",type:"submit",disabled:v(),children:"Request Build Optimize"})}),(0,e.jsxs)(xh,{children:[(0,e.jsx)("div",{children:"*"}),(0,e.jsxs)("div",{children:["Total square footage is calculated from your 2D plans and includes all finished and unfinished areas. Some restrictions apply. Please ",(0,e.jsx)("u",{children:"contact your sales rep"})," for more information."]})]})]})]}),(0,e.jsx)("div",{style:{display:"flex"},children:(0,e.jsx)(fh,{src:Ch,alt:"visualizer_preview"})})]})})},yS=()=>(0,e.jsx)(uh,{children:(0,e.jsxs)(mh,{children:[(0,e.jsxs)(ph,{children:[(0,e.jsx)(bh,{children:"Your 3D Visualization is in progress..."}),(0,e.jsx)(vh,{children:"Taking your plans and turning them into 3D can take from six to ten days, depending on the complexity of your design."}),(0,e.jsxs)(hh,{children:[(0,e.jsxs)(jh,{children:[(0,e.jsx)(gh,{src:Sh,alt:"visualizer_preview"}),(0,e.jsxs)("div",{children:[(0,e.jsx)(Ah,{children:"Single family home up to 8,000 sqft.*"}),(0,e.jsxs)(yh,{children:[(0,e.jsx)("li",{children:"Realistic visuals"}),(0,e.jsx)("li",{children:"Built from your 2D plans"}),(0,e.jsx)("li",{children:"Multiple 3D viewpoints"}),(0,e.jsx)("li",{children:"Explore colors"}),(0,e.jsx)("li",{children:"Explore products"}),(0,e.jsx)("li",{children:"6-10 business days"})]})]})]}),(0,e.jsxs)(gS,{children:[(0,e.jsx)("p",{children:"Your visualization should be ready in 6-10 days."}),(0,e.jsx)(uS,{children:"Contact Sales Rep"})]}),(0,e.jsxs)(xh,{children:[(0,e.jsx)("div",{children:"*"}),(0,e.jsxs)("div",{children:["Total square footage is calculated from your 2D plans and includes all finished and unfinished areas. Some restrictions apply. Please"," ",(0,e.jsx)("u",{children:"contact your sales rep"})," for more information."]})]})]})]}),(0,e.jsx)("div",{style:{display:"flex"},children:(0,e.jsx)(fh,{src:Ch,alt:"visualizer_preview"})})]})}),bS=()=>{const{project:t}=(0,De.B)(),{createEvent:n}=(0,io.A)(),{showError:s}=(0,Fe.d)(),{publishedModelFile:o,isLoading:r,error:a}=iS(),[i,l]=(0,d.useState)(!!t?.buildRequestUser),c=o?.derivativeId,{canViewPage:u}=(0,$n.s)({tool:D.w5.BUILD,action:D.a2.VIEW_BUILD,companyId:t?.companyId,projectId:t?.id},[t?.id,t?.companyId]),p=(0,d.useCallback)(h=>{console.log("Token requested by the viewer."),nt.Ay.get("/api/viewer_auth").then(b=>{h(b.data.accessToken,b.data.expiresInSeconds),console.log("Token generated for the viewer.")})},[]);(0,d.useEffect)(()=>{t&&n({content_type:"project",object_id:t.id,tool:"build"})},[t,n]),(0,d.useEffect)(()=>{a&&s({message:"Failed to load model data"})},[a,s]),(0,d.useEffect)(()=>{t?.buildRequestUser&&l(!0)},[t?.buildRequestUser]);const f=()=>i?(0,e.jsx)(yS,{}):(0,e.jsx)(xS,{setBuildIsInProgress:l});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(ls,{showLoadingScreen:r}),(0,e.jsxs)(kn,{id:"page-cotnainer",children:[u&&c&&(0,e.jsx)(ch,{urn:c,onTokenRequest:p}),u&&!r&&!c&&f()]})]})},wh=(0,g.Ay)(kn)`
  overflow-x: hidden;
`,vS=(0,g.Ay)("div")`
  background-color: #e5e5e5;
  padding: 0px;
  height: 100%;
`,i_=(0,g.Ay)("img")`
  width: 13.5px;
  height: 11.5px;
  flex-grow: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 2.3px;
  padding: 10px;
`,jS=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  gap: 20px;
  height: 100%;
  width: 100%;
`,l_=(0,g.Ay)("div")`
  border-right: 3px solid grey;
  width: 30%;
  padding-right: 5px;
`,d_=(0,g.Ay)("img")`
  height: 100%;
  margin: 0;
  cursor: pointer;
`,c_=(0,g.Ay)("div")`
  height: 65px;
  align-self: stretch;
  flex-grow: 0;
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: center;
  padding: 0 10px;
  background-color: #f1f0ef;
`,u_=(0,g.Ay)("div")`
  width: 98%;
  height: 65px;
  align-self: stretch;
  flex-grow: 0;
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: center;
  padding: 0 16px;
  background-color: #f1f0ef;
`,p_=(0,g.Ay)("div")`
  width: 124px;
  height: 30px;
  flex-grow: 1;
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: flex-end;
  gap: 16px;
  padding: 0;
`,m_=(0,g.Ay)("div")`
  height: 25px;
  flex-grow: 0;
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: center;
  padding: 0;
`,h_=(0,g.Ay)("div")`
  height: 20px;
  flex-grow: 0;
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: center;
  gap: 24px;
  padding: 20px;
  background-color: #f1f0ef;
`,g_=(0,g.Ay)("button")`
  height: 15px;
  max-height: 15px;
  border: none;
  border-radius: 4px;
  background-color: var(--bfs-secondary-support-gray-dark);
  color: white !important;
  font-size: 13px;
  font-weight: 600;
  font-stretch: normal;
  font-style: normal;
  opacity: ${t=>t.disabled?.3:1};
  cursor: ${t=>t.disabled?"not-allowed":"pointer"};
  align-items: center;
  display: flex;
`,f_=(0,g.Ay)("button")`
  height: 15px;
  max-height: 15px;
  padding: 12px 12px 12px 12px;
  border: solid rgba(190, 190, 197);
  border-width: 1px;
  background-color: rgba(236, 237, 239);
  font-size: 10px;
  color: #363030;
  cursor: pointer;
  align-items: center;
  display: flex;
`,x_=(0,g.Ay)("button")`
  height: 15px;
  max-height: 15px;
  padding: 12px 12px 12px 12px;
  border: solid rgba(190, 190, 197);
  border-width: 1px;
  border-radius: 2px;
  background-color: rgba(236, 237, 239);
  font-size: 10px;
  color: #363030;
  cursor: pointer;
  align-items: center;
  display: flex;
`,y_=(0,g.Ay)("button")`
  height: 15px;
  max-height: 15px;
  padding: 12px 12px 12px 12px;
  border: solid rgba(190, 190, 197);
  border-width: 1px;
  border-top-right-radius: 5px;
  border-bottom-right-radius: 5px;
  background-color: rgba(236, 237, 239);
  font-size: 10px;
  color: #363030;
  cursor: pointer;
  align-items: center;
  display: flex;
`,b_=(0,g.Ay)("button")`
  height: 15px;
  max-height: 15px;
  padding: 12px 12px 12px 12px;
  border: solid rgba(120, 120, 131);
  border-width: 1px;
  border-top-left-radius: 5px;
  border-bottom-left-radius: 5px;
  background-color: rgba(120, 120, 131);
  font-size: 10px;
  color: #fff;
  cursor: pointer;
  align-items: center;
  display: flex;
`;var AS=m(22),Xi=m(88399),Br={};Br.styleTagTransform=zs(),Br.setAttributes=Us(),Br.insert=_s().bind(null,"head"),Br.domAPI=Ns(),Br.insertStyleElement=Ws();var v_=Bs()(Xi.A,Br);const j_=Xi.A&&Xi.A.locals?Xi.A.locals:void 0;var Xs=m(51986);const Ji=(0,g.Ay)("div")`
  height: 20px;
  flex-grow: 0;
  margin: 10px 0 6px 4px;
  font-size: 16px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  text-align: left;
  color: var(--common-black-100-p);
`,Eh=(0,g.Ay)("div")`
  flex-grow: 0;
  margin: 10px 0 6px 0;
  height: 20px;
  font-size: 16px;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  text-align: left;
  color: var(--common-black-100-p);
`,Ph=(0,g.Ay)("div")`
  width: 84%;
  font-size: 13px;
  font-weight: bold;
  text-align: left;
  padding: 10px 8% 4px;
  margin: 0;
  color: var(--common-white-100-p);
`,Ih=(0,g.Ay)("div")`
  width: 84%;
  font-size: 11px;
  text-align: left;
  padding: 0 8%;
  color: var(--common-white-100-p);
`,CS=(0,g.Ay)("div")`
  align-items: center;
  font-size: 18px;
  font-family: acumin-pro;
  letter-spacing: normal;
  line-height: normal;
  text-align: center;
  margin: 0;
`,SS=(0,g.Ay)("div")`
  align-items: center;
  font-size: 24px;
  font-weight: 700;
  font-family: acumin-pro;
  letter-spacing: normal;
  line-height: normal;
  text-align: center;
  margin: 0;
`,wS=(0,g.Ay)(Rr.A)`
  padding: 20px 20px 0 20px;
  position: absolute;
  bottom: 20px;
  width: 100%;
  max-width: 58.5%;
  right: 0;
`,ES={"& .MuiDialog-container":{"& .MuiPaper-root":{maxWidth:"1000px",height:"auto",display:"flex",position:"relative",backgroundColor:"var(--bfs-primary-true-white)",overflow:"visible",borderRadius:0}}},PS={paddingLeft:"0",height:"auto",padding:"32px"},IS={width:"800px",height:"auto",minHeight:"480px"},DS={height:"100%",width:"100%",backgroundColor:"var(--bfs-11-22-nav-background-gray)"},Zi={marginRight:"8px"},kS={marginRight:"8px",marginTop:"10px"},Va={fontSize:"14px"};var Nr=m(98280),Vs=m(8239),Xn=m(29322),ys=m(96710),Dh=m(81692);const Uo=({title:t,subTitle:n,message:s,open:o,onClose:r,onConfirm:a,loading:i,closeButtonText:l,submitButtonText:c,titleBackgroundColor:u,modalWidth:p})=>(0,e.jsx)(Qn,{title:t,open:o,onClose:r,onSubmit:a,modalWidth:p,cancelText:l,submitText:c,titleBackgroundColor:u,destructive:!0,children:i?(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsx)(bt.A,{color:"error"})}):(0,e.jsxs)(e.Fragment,{children:[n&&(0,e.jsx)("center",{children:(0,e.jsx)("h3",{style:{paddingBottom:"20px"},children:n})}),s.map(f=>(0,e.jsx)("p",{dangerouslySetInnerHTML:{__html:f},style:{marginTop:"0px"}},f))," "]})});var Ot=m(88835);const C_=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  flex-direction: column;
  overflow: hidden;
`,S_=(0,g.Ay)("div")`
  margin-top: 90px;
`,TS=(0,g.Ay)("img")`
  width: 404.5px;
  height: 269.7px;
  flex-grow: 0;
  align-self: center;
`,RS=(0,g.Ay)("img")`
  height: 130px;
  max-width: 100%;
  align-self: center;
`,OS=(0,g.Ay)("div")`
  display: flex;
  padding: 40px 0px;
  justify-content: center;
  align-items: center;
  flex: 1 0 0;
  align-self: stretch;
`,w_=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  padding-top: 9%;

  ${t=>t.theme.breakpoints.down("xs")} {
    padding-top: 0px;
  }
`,MS=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  font-family: Roboto;
  font-size: 16px;
  font-weight: 600;
  line-height: 24px;
`,E_=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  margin-top: -8px;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  text-align: center;
`,P_=(0,g.Ay)(I.A)`
  height: 19px;
  overflow: hidden;
  white-space: nowrap;
  color: #000d;
  font-size: 16px;
  font-weight: 400;
`,LS=(0,g.Ay)(I.A)`
  font-weight: 600;
  line-height: 1.2;
  color: #000d;
  max-width: 100%;
  white-space: initial;

  // white-space: nowrap;
  // text-overflow: ellipsis;
`,FS=(0,g.Ay)(I.A)`
  font-weight: normal;
  line-height: 1;
  color: var(--graythorne-grays-gray-3);
  margin-top: 8px;
  overflow: hidden;
  margin-bottom: 24px;
  white-space: normal;
`,BS=(0,g.Ay)(I.A)`
  font-weight: normal;
  line-height: 1;
  color: #000d;
  margin-top: 8px;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;

  align-self: center;
`,NS=(0,g.Ay)(I.A)`
  font-weight: 600;
  line-height: 1;
  color: #000d;
`,_S=(0,g.Ay)(I.A)`
  line-height: 1;
  font-weight: normal;
  color: #000d;
`,US=(0,g.Ay)(I.A)`
  display: flex;
  align-items: end;
  font-weight: bold;
  line-height: 1;
  color: #000d;
`,WS=(0,g.Ay)(oe)`
  overflow: hidden;
`,I_=(0,g.Ay)(I.A)(({theme:t})=>({marginBottom:"10px",textAlign:"center",fontWeight:"bold",[t.breakpoints.down(600)]:{fontSize:ke.text_styles["typography-h5"].value.font.size*.7,lineHeight:ke.text_styles["typography-h5"].value.line_height+"px"}})),D_=(0,g.Ay)(I.A)(({theme:t})=>({marginBottom:"20px",textAlign:"center",fontWeight:"normal",fontSize:t.typography.h6.fontSize,[t.breakpoints.down(600)]:{fontSize:ke.text_styles["typography-h6"].value.font.size*.7,lineHeight:ke.text_styles["typography-h6"].value.line_height*.7+"px"}})),k_=(0,g.Ay)("div")`
  background-color: grey;
  display: flex;
  color: white;
  width: 200px;
  height: 160px;
`,zS=(0,g.Ay)("div")`
  background-color: white;
  padding: 0 16px 16px 16px;
  display: flex;
  flex-direction: column;
  overflow: auto;
  height: 100%;
`,VS=(0,g.Ay)("div",{shouldForwardProp:t=>t!=="isConfirmed"})`
  top: 0;
  left: 0;
  z-index: 9;

  position: absolute;
  padding: 10px 14px 11px;

  /* center overlay text */
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--bfs-primary-true-white);
  font-size: 14px;
  font-weight: 300;
  font-stretch: normal;
  font-style: normal;
  line-height: 1;
  letter-spacing: 0.1px;
  text-align: right;

  background: ${({isConfirmed:t})=>t?"#818181":"#cd0000"};
`,$S=(0,g.Ay)("div",{shouldForwardProp:t=>t!=="isClickable"})`
  position: relative;
  display: flex;
  flex-direction: column;
  overflow: auto;
  height: 100%;
  border: 1px solid #bfbfbf;
  border-radius: 8px;
  ${({isClickable:t})=>t&&"cursor: pointer;"}
`,HS=(0,g.Ay)(K.A)`
  margin: auto;
  margin-top: 2.25rem;
`,T_=({href:t})=>jsx(CenteredLink,{href:t,target:"_blank",children:jsx(HS,{variant:"contained",disableElevation:!0,color:"success",children:"Contact Sales Rep"})}),Wo=(0,g.Ay)("div")`
  background-color: var(--bfs-primary-true-white);
  padding: 12px 16px;
  box-sizing: border-box;
  width: 296px;
  border: 1px solid #e3e4e5;
  border-radius: 4px;

  cursor: pointer;
`,or={backgroundColor:"#F1F2F2"},QS=(0,g.Ay)("div")`
  background-color: #555352;
  color: #ffffff;
  padding: 12px 16px 15px;
  font-size: 18px;
  text-align: center;
  font-family: acumin-pro;
  font-weight: normal;
`,GS=(0,g.Ay)("div")`
  height: 46px;
  color: #fff;
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: center;
  gap: 24px;
  padding: 4px 18px;
  background-color: var(--graythorne-grays-gray-4);
  ${t=>{if(t.isCustomPreviewOn)return`
        background-color: var(--graythorne-blues-blue-2);
    `}}
`,KS=m.p+"b5132d0a52e21a118c0d88fe255966dd.png",YS=(0,g.Ay)(K.A)`
  text-transform: capitalize !important;
`,qS=(0,g.Ay)(YS)`
  margin: auto;
  margin-top: 1.5rem;
  margin-bottom: 1.5rem;
  display: block;
  padding-top: 7px;
  background-color: var(--bfs-11-22-nav-selected-gray);
`,XS=t=>(0,e.jsx)(Bn,{href:t.href,target:"_blank",children:(0,e.jsx)(qS,{variant:"contained",disableElevation:!0,"data-testid":"contactOsr",color:"success",children:"Contact Sales Rep"})}),JS=()=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(TS,{style:{padding:"15px 5% 0",width:"90%",height:"auto"},"data-testid":"imageGantt",src:KS,alt:"Placeholder image"}),(0,e.jsxs)("div",{"data-testid":"leftContent",children:[(0,e.jsx)(Ph,{children:"Applying Schedule Templates"}),(0,e.jsxs)(Ih,{children:[(0,e.jsx)("p",{children:"Get a jumpstart on building your project schedule by either copying a schedule from another project, or use a template specifically built for your company."}),(0,e.jsx)("p",{children:"After applying the schedule, you can customize dates, durations, and dependencies to meet your project's specific needs."})]}),(0,e.jsx)(Ph,{children:"Questions? We're here to help!"}),(0,e.jsx)(Ih,{children:"Reach out to your OSR or Digital Sales Specialist to help with any of your scheduling needs."})]})]});var ZS=m(41e3),He=m.n(ZS),el=m(82651);const ew=t=>{const{applyTemplateWithProjects:n,applyTemplateWithTemplates:s}=(0,Xs.P)(t.project?.id),[o,r]=(0,d.useState)(null),[a,i]=(0,d.useState)(),[l,c]=(0,d.useState)(null),[u,p]=(0,d.useState)("my_projects"),[f,h]=(0,d.useState)(!1),[b,x]=(0,d.useState)(!1),[v,y]=(0,d.useState)(!1),[j,A]=(0,d.useState)(null),[w,P]=(0,d.useState)(!1),[C,k]=(0,d.useState)(!1);var S=[{value:1,label:"Overwrite"},{value:2,label:"Append To"}];const R=O=>{r(He()(O?.format(Ot.MK)+" 00:00:00"))};(0,d.useEffect)(()=>{t.lstMyProjects.length>0?p("my_projects"):p("templates"),t.applyByDropdownEnabled?c(null):c(S[0])},[t.open,t.applyByDropdownEnabled]);const B=()=>{r(null),i(null),c(null),h(!1),x(!1),P(!1),y(!1),t.closeModal()},T=O=>{p(O.target.value),r(null),i(null),h(!1),x(!1),P(!1),y(!1)},W=()=>{const O=l.value==1;k(!0),N(a.value,O,o,f,u=="my_projects"?"projects":"templates",b,w,v),r(null),i(null),c(null),h(!1),x(!1),A(!1),P(!1),y(!1)},N=async(O,z,Q,re,ue,le,F,V)=>{if(ue=="templates"){let $={project_id:t.project?.id,template_id:O,company_id:t.company?.id,project_start_date:Q?.format(Ot.hw),overwrite:z,include_crew:re};const ee=await s($);k(!1),t.closeModal(),ee.data?(t.setMessage("Success","Template Applied Successfully","success"),t.refresh()):t.setMessage("Error",ee.error,"error")}else{let $={to_project_id:t.project?.id,from_project_id:O,project_start_date:Q?.format(Ot.hw),overwrite:z,include_crew:re,include_holidays_weekends:le,include_todo:F,include_dependencies:V};const ee=await n($);k(!1),t.closeModal(),ee.data?(t.setMessage("Success","Template Applied Successfully","success"),t.refresh()):t.setMessage("Error",ee.error,"error")}};return(0,e.jsxs)(e.Fragment,{children:[" ",(0,e.jsx)(Uo,{title:"Overwriting the schedule",message:["By choosing the Overwrite option, all existing tasks in your schedule will be deleted, and To-Do's will return back to the authors To-Do list.","Would you like to proceed?"],open:j||!1,onClose:()=>A(!1),onConfirm:W,loading:!1,closeButtonText:"Cancel",submitButtonText:"Overwrite Schedule"}),(0,e.jsx)(Ms.A,{sx:ES,open:t.open,onClose:B,children:(0,e.jsxs)(Vs.Ay,{container:!0,className:"",style:IS,children:[C&&(0,e.jsx)("div",{className:"applyTemplateLoader",children:(0,e.jsx)(os,{})}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Vs.Ay,{item:!0,xs:4.5,className:`${C&&"grey-effect-box"}`,children:(0,e.jsxs)("div",{style:DS,children:[(0,e.jsx)(JS,{}),t.company&&t.company.osrEmail&&(0,e.jsx)(XS,{href:`mailto:${t.company.osrEmail}`})]})}),(0,e.jsx)(Vs.Ay,{item:!0,xs:7.5,style:PS,className:`${C&&"grey-effect-box"}`,children:(0,e.jsxs)("div",{children:[(0,e.jsx)(CS,{children:"Apply Schedule Template to"}),(0,e.jsx)(SS,{children:t.project?.projectName}),(0,e.jsxs)("form",{action:"","data-testid":"templateForm",children:[(0,e.jsxs)(Vs.Ay,{container:!0,spacing:2,children:[(0,e.jsx)(Vs.Ay,{item:!0,xs:1.5,children:(0,e.jsx)(Ji,{children:" From"})}),(0,e.jsx)(Vs.Ay,{item:!0,xs:10.5,children:(0,e.jsxs)("div",{children:[" ",(0,e.jsxs)(Vs.Ay,{container:!0,spacing:2,children:[(0,e.jsx)(Vs.Ay,{item:!0,xs:4,children:(0,e.jsxs)(Eh,{children:[(0,e.jsx)("input",{type:"radio",checked:u=="my_projects",disabled:!(t.lstMyProjects.length>0),value:"my_projects",onChange:T,name:"radioFrom"})," ","My Projects"," "]})}),(0,e.jsx)(Vs.Ay,{item:!0,xs:4,children:(0,e.jsxs)(Eh,{children:[" ",(0,e.jsx)("input",{type:"radio",checked:u=="templates",disabled:!(t.lstTemplateProjects.length>0),value:"templates",name:"radioFrom",onChange:T})," ","Templates"]})})]})]})})]}),(0,e.jsx)("div",{"data-testid":"selectProjectDiv",children:(0,e.jsx)(Dh.Ay,{classNamePrefix:"select","data-testid":"selectProject",name:"projects",placeholder:"Select...",options:u=="my_projects"?t.lstMyProjects:t.lstTemplateProjects,value:a,onChange:O=>{i(O)}})}),(0,e.jsxs)(Vs.Ay,{container:!0,spacing:2,children:[(0,e.jsxs)(Vs.Ay,{item:!0,xs:6,children:[(0,e.jsx)(Ji,{children:" Project Start Date"}),(0,e.jsx)(Xn.LocalizationProvider,{dateAdapter:el.Y,children:(0,e.jsx)(Xn.DatePicker,{desktopModeMediaQuery:"@media (min-width: 1199px)",onChange:R,value:o,views:["day"],components:{OpenPickerIcon:Nr.A},slotProps:{textField:{size:"small",inputProps:{"data-testid":"selectDate"},variant:"outlined",placeholder:"Select...",label:"Select Date",InputLabelProps:{shrink:!0,style:{color:"transparent"}}}}})})]}),(0,e.jsxs)(Vs.Ay,{item:!0,xs:6,children:[(0,e.jsx)(Ji,{children:" Apply By"}),(0,e.jsx)("div",{"data-testid":"selectApplyByDiv",children:(0,e.jsx)(Dh.Ay,{"data-testid":"selectApplyBy",classNamePrefix:"select",name:"applyby",value:l,placeholder:"Select...",options:S,isDisabled:!t.applyByDropdownEnabled,onChange:O=>{c(O)}})})]})]}),u=="my_projects"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ji,{children:" Option"}),(0,e.jsxs)("div",{className:"form-group",style:{display:"flex"},children:[(0,e.jsx)("div",{"data-testid":"checkbox",style:Zi,onClick:()=>{h(!f)},children:f?(0,e.jsx)(ys.b7E,{fill:"black",size:14}):(0,e.jsx)(ys.LvK,{fill:"black",size:14})}),(0,e.jsx)("label",{htmlFor:"assignments",onClick:()=>{h(!f)},style:Va,children:"Include Crew Assignments"})]}),(0,e.jsxs)("div",{className:"form-group",style:{display:"flex"},children:[(0,e.jsx)("div",{"data-testid":"checkbox",style:Zi,onClick:()=>{y(!v)},children:v?(0,e.jsx)(ys.b7E,{fill:"black",size:14}):(0,e.jsx)(ys.LvK,{fill:"black",size:14})}),(0,e.jsx)("label",{htmlFor:"holidays",onClick:()=>{y(!v)},style:Va,children:"Include Predecessor & Successor Relationships"})]}),(0,e.jsxs)("div",{className:"form-group",style:{display:"flex"},children:[(0,e.jsx)("div",{"data-testid":"checkbox",style:Zi,onClick:()=>{x(!b)},children:b?(0,e.jsx)(ys.b7E,{fill:"black",size:14}):(0,e.jsx)(ys.LvK,{fill:"black",size:14})}),(0,e.jsx)("label",{htmlFor:"holidays",onClick:()=>{x(!b)},style:Va,children:"Include Holiday/Weekend Definitions"})]}),(0,e.jsxs)("div",{className:"form-group",style:{display:"flex"},children:[(0,e.jsx)("div",{"data-testid":"checkbox",style:Zi,onClick:()=>{P(!w)},children:w?(0,e.jsx)(ys.b7E,{fill:"black",size:14}):(0,e.jsx)(ys.LvK,{fill:"black",size:14})}),(0,e.jsx)("label",{htmlFor:"holidays",onClick:()=>{P(!w)},style:Va,children:"Include To-Do's"})]})]})]}),(0,e.jsxs)(wS,{children:[(0,e.jsx)(K.A,{"data-testid":"cancelButton",onClick:B,color:"secondary",variant:"contained",sx:{marginRight:"auto",marginLeft:"10px"},children:"Cancel"}),(0,e.jsx)(K.A,{"data-testid":"applyButton",disabled:!(a&&o&&l),onClick:()=>{l.value==1?A(!0):W()},variant:"contained",color:"primary",sx:{marginLeft:"auto"},children:"Apply To This Project"})]})]})})]})]})})]})};var R_=m(58623),lo=m(28072),rr=m(47419),gn=m(94261),O_=m(43532),co=m(39781),sc=m(2784),_r=m(1612),tl=m(13629),Ur={};Ur.styleTagTransform=zs(),Ur.setAttributes=Us(),Ur.insert=_s().bind(null,"head"),Ur.domAPI=Ns(),Ur.insertStyleElement=Ws();var M_=Bs()(tl.A,Ur);const L_=tl.A&&tl.A.locals?tl.A.locals:void 0,tw=t=>{const{project:n}=(0,De.B)(),{company:s}=(0,je.P)(),{userHasPermission:o}=(0,Ye.A)(),r=o({tool:D.w5.SCHEDULE,action:D.a2.EDIT_PHASES,companyId:s?.id,projectId:n?.id}),{fetchPhaseList:a}=(0,Xs.P)(n?.id),{closeModal:i,modalIsOpen:l,currentTaskData:c,isGanttType:u,taskList:p,taskStatusList:f,phaseList:h,crewMembers:b,setMessage:x,refresh:v,isNewTask:y,resources:j,assignments:A}=t,{isNonWorkingDay:w,updateTask:P,addNewTask:C,updateTaskSequence:k}=(0,Xs.P)(n?.id),S=(0,d.useRef)(),[R,B]=(0,d.useState)(0),[T,W]=(0,d.useState)(""),[N,O]=(0,d.useState)(""),[z,Q]=(0,d.useState)(""),[re,ue]=(0,d.useState)(""),[le,F]=(0,d.useState)({}),[V,$]=(0,d.useState)({}),[ee,X]=(0,d.useState)(1),[G,Y]=(0,d.useState)(0),[he,ne]=(0,d.useState)(""),[J,pe]=(0,d.useState)(1),[Ee,Te]=(0,d.useState)(!1),[me,$e]=(0,d.useState)(!1);let[gt,Rt]=(0,d.useState)([]);const[rt,Ue]=(0,d.useState)([]),[lt,ge]=(0,d.useState)([]),We={dependencyIdField:"id",columns:gn._C,barMargin:10,enableDeleteKey:!1,cellEditFeature:{addNewAtEnd:!1}},At=Le=>{r&&pe(Le)},xn=Le=>w(t.holidays,Le.toDate(),Ee,me),on=async()=>{if(A){let mn=[];A.forEach(yn=>{j.filter(es=>es.id===yn.resource).length>0&&mn.push({id:yn.id,resourceId:yn.resource,assignedTo:j.filter(es=>es.id===yn.resource)[0].name})}),Ue(mn)}let Le=await a(c?.project_id);if(Le.data){const mn=Le?.data?.filter(yn=>yn.id===c.parent_task_id);mn[0]?$(mn[0]):$({id:0,name:""})}else x("Error",Le.error,"error");const mt=He()(c.start_date||c.startDate).format(Ot.OY),Wt=He()(c.end_date||c.endDate).format(Ot.OY);let pn=f.filter(mn=>mn.id===c.task_status_id);W(c.name),O(c.notes),Y(c.task_completion_percentage),Q(mt),ue(Wt),F(pn[0]),X(Math.ceil(c.t_duration?c.t_duration:c.duration)),Te(c.includeHolidays||c.include_holidays),$e(c.includeWeekends||c.include_weekends)},Xe=()=>{if(ne(""),c&&c.name)on();else{const Le=He()(c?.start_date).format(Ot.OY),mt=He()(c?.end_date).add(1,"days").format(Ot.OY);Ue([]),$({id:0,name:""}),W("New Task..."),Q(Le),ue(mt),F({status:"Not Started",id:2}),X(1),Y(0)}};(0,d.useEffect)(()=>{Xe()},[c,c.name,c.start_date,c.startDate,c.duration,c.end_date,c.endDate,c.assigned_to,c.assignedTo,c.task_status_id,c.notes,c.task_completion_percentage]);const dt=(Le,mt)=>{if(Le){let Wt=Le.toDate();if(mt==="start_date"){let pn=new Date(Wt.toString()),mn=He()(pn).add(c.duration,"days").toDate(),yn=He()(new Date(pn)).format(Ot.OY),es=He()(new Date(mn)).format(Ot.OY);Q(yn),ue(es)}else if(mt==="end_date"){let pn=new Date(Wt.toString()),mn=He()(new Date(pn)).format(Ot.OY);if(mn>=z){const yn=new Date(z),es=pn.getTime()-yn.getTime(),Ir=Math.ceil(es/(1e3*3600*24));X(Ir+1),ue(mn)}else x("Warning","End date should not be less than start date.","warning")}}},Tn=Le=>{let mt=[];Le.selection.forEach(Wt=>{mt.push(Wt.data.id)}),Rt(mt)},In=async()=>{let Le=[];Le=rt.filter(mt=>!gt.some(Wt=>Wt==mt.id)),Ue(Le),ge(gt)},Ct=async()=>{let Le=!0,mt=t.taskList.filter(ns=>ns.parent_task_id===V.id),Wt=He()(z).format(Ot.MK)+" 00:00:00",pn=He()(re).format(Ot.MK)+" 00:00:00",mn=[],yn=[];rt.forEach(ns=>{ns.resourceId!=null&&ns.id.toString().includes("generated")?mn.push({resource:ns.resourceId,event:c?.id}):ns.resourceId!=null&&A.filter(yt=>yt.id==ns.id)[0].resource!=ns.resourceId&&yn.push({id:ns.id,resource:ns.resourceId,event:c?.id})});let es={id:c?.id,name:T,parent_task_id:V?.id,start_date:Wt,end_date:pn,assignments:{added:mn,updated:yn,deleted:lt},duration:Number(ee),project_id:n?.id?n.id:c.project_id,task_color_id:null,include_holidays:Ee,include_weekends:me,notes:N};c.task_status_id!=le?.id&&(es={...es,task_status_id:le?.id}),c.task_completion_percentage!=G&&(es={...es,task_completion_percentage:Number(G)});let Ir={task_color:{},task_color_id:null,start_date:Wt,end_date:pn,duration:Number(ee),task_completion_percentage:Number(G),name:T,assignments:{added:mn,updated:yn,deleted:lt},project_id:n?.id,task_status_id:le?.id,parent_task_id:V?.id,include_holidays:Ee,include_weekends:me,sequence:mt.length+1};if(!V?.name&&c.parent_task_id!==0)ne("Task phase field is required.");else if(Wt&&Wt.startsWith("Invalid date"))ne("Start date is invalid.");else if(he===""){if(y){const yt=await C(Ir);yt.data||(x("Error",yt.error,"error"),v(),Le=!1)}else{const yt=await P(c?.id,es,c?.project_id);yt.data||(x("Error",yt.error,"error"),v(),Le=!1)}let ns=p&&p.filter(yt=>yt.parent_task_id===V.id);if(c?.parent_task_id!==V.id){let yt=[];yt.push({id:c?.id,new_parent_task_id:V?.id,new_sequence:ns?.length+1});const zt=await k(yt);zt.data||(x("Error",zt.error,"error"),Le=!1)}Le&&(B(0),i(),v(),pe(1),x("Success","Task Updated Successfully","success"))}},Mt=()=>{if(A){let Le=[];A.forEach(mt=>{j.filter(Wt=>Wt.id===mt.resource).length>0&&Le.push({id:mt.id,resourceId:mt.resource,assignedTo:j.filter(Wt=>Wt.id===mt.resource)[0].name})}),Ue(Le)}Xe(),ne(""),B(0),i(),v(),pe(1)},Pe=Le=>{const mt=Le.target.value;let Wt=(0,gn.DX)(mt,le.id);Y(Wt);const pn=f&&f.filter(mn=>mn.id==mt);F(pn[0])},Qe=Le=>{const mt=Le.target.value,Wt=h&&h.filter(pn=>pn.name===mt);$(Wt[0]),ne("")},ht=!!(u&&c.parent_task_id===0),Xt=Le=>{let mt=Le.target.value;if(X(mt),mt<1)ne("Duration should be more than 0");else{ne("");let Wt=He()(z).add(mt,"days").format(Ot.OY);ue(Wt)}},Qt=Le=>{const mt=Le.target.value.replace(/[^0-9]/g,"");Y(mt),mt<0||mt>100?ne("Percentage should be 0 - 100"):ne("");let Wt=(0,gn.K7)(mt,c.task_type);const pn=f&&f.filter(mn=>mn.id==Wt);F(pn[0])},As=Le=>{W(Le.target.value)},Ln=Le=>{O(Le.target.value)},hs={"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"750px",minHeight:"700px"}}},Qs=Le=>{ne(Le==="invalidDate"?"Start date is invalid.":"")};return(0,e.jsx)("div",{className:"bldr-popup",children:(0,e.jsxs)(Ms.A,{"data-testid":"dialog",onClose:Mt,open:l,sx:hs,className:"bldr-main-modal",children:[(0,e.jsxs)("div",{className:"bldr-popup-header",style:{display:"flex",justifyContent:"space-between"},children:[(0,e.jsx)("h2",{children:"Task Information"}),(0,e.jsx)("span",{className:"close-wrap",children:(0,e.jsx)(co.A,{onClick:()=>Mt()})})]}),(0,e.jsxs)(E.A,{className:"bldr-popup-tabs",children:[(0,e.jsx)(E.A,{children:(0,e.jsxs)("ul",{className:"bldr-popup-tabs-header",children:[(0,e.jsx)("li",{className:J===1?"active":"",onClick:()=>At(1),children:"GENERAL"}),u&&(0,e.jsx)("li",{className:`${J===2?"active":""} disable-current-tab`,onClick:()=>At(2),children:"PREDESESSORS"}),u&&(0,e.jsx)("li",{className:`${J===3?"active":""} disable-current-tab`,onClick:()=>At(3),children:"SUCCESSORS"}),(0,e.jsx)("li",{className:`${J===4?"active":""}`,style:{color:r?"black":"lightgrey",cursor:r?"pointer":"not-allowed"},onClick:()=>At(4),children:"RESOURCES"}),(0,e.jsx)("li",{className:`${J===5?"active":""}`,style:{color:r?"black":"lightgrey",cursor:r?"pointer":"not-allowed"},onClick:()=>At(5),children:"ADVANCED"}),(0,e.jsx)("li",{className:`${J===6?"active":""} `,onClick:()=>At(6),style:{color:r?"black":"lightgrey",cursor:r?"pointer":"not-allowed"},children:(0,e.jsx)(_r.TPo,{size:11})})]})}),(0,e.jsxs)("div",{className:"tab_content",children:[J===1&&(0,e.jsx)("div",{className:"bldr-popup-inner",children:(0,e.jsxs)("form",{className:"bldr-edit-form",children:[(0,e.jsxs)("div",{className:"bldr-form-group",children:[(0,e.jsx)("label",{className:"bldr-form-label",children:"Task Name"}),(0,e.jsx)("input",{className:"bldr-form-input",type:"text",autoFocus:!0,value:T,required:!0,style:{color:r?"black":"rgba(0, 0, 0, 0.38)"},onChange:As,disabled:!r})]}),(0,e.jsxs)("div",{"data-testid":"selectProjectDiv",className:"custom-popup-select-wrap",children:[(0,e.jsx)(sr.A,{className:"custom-popup-label",id:"phase",sx:{paddingLeft:2},children:"Phase"}),(0,e.jsx)(go.A,{labelId:"phase",id:"phase",value:V?.name,onChange:Le=>Qe(Le),role:"list",label:"Phase",className:"custom-popup-select",disabled:!r,MenuProps:{style:{maxHeight:400}},children:h&&h.map((Le,mt)=>(0,e.jsx)(it.A,{value:Le.name,"data-id":Le.id,children:Le.name},mt))})]}),(0,e.jsxs)("div",{className:"bldr-form-group",children:[(0,e.jsx)("label",{className:"bldr-form-label",children:"Start Date"}),(0,e.jsx)(Xn.LocalizationProvider,{dateAdapter:el.Y,children:(0,e.jsx)(Xn.DatePicker,{onError:Le=>Qs(Le),shouldDisableDate:xn,className:"bldr-form-date bldr-form-date-start-date",value:He()(z),onChange:Le=>dt(Le,"start_date"),disabled:!r&&ht,slotProps:{textField:{fullWidth:!0}}})})]}),(0,e.jsxs)("div",{className:"bldr-form-group",children:[(0,e.jsx)("label",{className:"bldr-form-label",children:"Duration"}),(0,e.jsx)("input",{type:"number",min:1,value:ee,disabled:!r||c.task_type=="TODO",style:{color:r?"black":"rgba(0, 0, 0, 0.38)"},className:"bldr-form-input",onChange:Le=>Xt(Le)})]}),(0,e.jsxs)("div",{className:"bldr-form-group",style:{display:"none"},children:[(0,e.jsx)("label",{className:"bldr-form-label",children:"End"}),(0,e.jsx)(Xn.LocalizationProvider,{dateAdapter:el.Y,children:(0,e.jsx)(Xn.DatePicker,{disabled:!r||ht,className:"bldr-form-date",value:He()(re),onChange:Le=>dt(Le,"end_date"),slotProps:{textField:{className:"bldr-form-date-text",fullWidth:!0}}})})]}),(0,e.jsxs)("div",{"data-testid":"selectProjectDiv",className:"custom-popup-select-wrap",children:[(0,e.jsx)(sr.A,{className:"custom-popup-label",id:"status",sx:{paddingLeft:2},children:"Status"}),(0,e.jsx)(go.A,{labelId:"status",id:"status",value:le?.id,onChange:Le=>Pe(Le),role:"list",label:"Status",className:"custom-popup-select",MenuProps:{style:{maxHeight:400}},children:f&&f.map((Le,mt)=>(0,e.jsx)(it.A,{value:Le.id,"data-id":Le.id,children:Le.status},mt))})]}),(0,e.jsxs)("div",{className:"bldr-form-group",children:[(0,e.jsx)("label",{className:"bldr-form-label",children:"% Complete"}),(0,e.jsx)("input",{type:"number",min:0,max:100,value:G,disabled:!r,className:"bldr-form-input",onChange:Le=>Qt(Le)})]})]})}),J===2&&(0,e.jsx)("div",{className:"tab_panel",children:"Predecessor Tab Content"}),J===3&&(0,e.jsx)("div",{className:"tab_panel",children:"Successor Tab Content"}),J===4&&(0,e.jsxs)("div",{className:"tab_panel resources_tab",style:{height:"100%"},children:[(0,e.jsx)(sc.C4,{height:400,cls:"bryntum-gantt-updated",ref:S,...We,data:rt,onSelectionChange:Tn,onBeforeCellEditStart:Le=>{let mt=[];j.forEach(Wt=>{rt.filter(pn=>pn.resourceId==Wt.id).length==0&&mt.push(Wt)}),Le.editorContext.editor.items=mt.map(Wt=>({text:Wt.name,value:Wt.id,id:Wt.resourceId}))},onFinishCellEdit:Le=>{let mt=[];rt.forEach((Wt,pn)=>{pn===Le.editorContext._rowIndex?mt.push({resourceId:Le.editorContext.value,id:Le.editorContext._id,assignedTo:j.filter(mn=>mn.id===Le.editorContext.value)[0].name}):mt.push(Wt)}),Ue(mt)}}),(0,e.jsx)("div",{className:"button-wrap",children:(0,e.jsxs)("div",{className:"bldr-popup-action-wrap-left",children:[(0,e.jsx)("div",{onClick:()=>{let Le=[];Le.push({id:"generated_"+Date.now().toString(36),assignedTo:"",resourceId:null}),rt.forEach(mt=>{Le.push(mt)}),Ue(Le)},className:"bldr-plus-icon-popup",children:(0,e.jsx)(_r.OiG,{size:12,color:"#008000"})}),(0,e.jsx)("div",{onClick:()=>In(),className:"bldr-trash-icon-popup",children:(0,e.jsx)(_r.qbC,{size:12,color:"#ff0000"})})]})}),(0,e.jsx)("div",{className:"button-wrap"})]}),J===5&&(0,e.jsxs)("div",{className:"tab_panel",children:[(0,e.jsxs)("div",{className:"form-group checkbox-wrap",children:[(0,e.jsx)("label",{htmlFor:"holidays",onClick:()=>{Te(!Ee)},className:"checkBoxLabel",children:"Include Holidays"}),(0,e.jsx)("div",{"data-testid":"checkbox",className:"checkBox",onClick:()=>{Te(!Ee)},children:Ee?(0,e.jsx)(ys.b7E,{fill:"black",size:16}):(0,e.jsx)(ys.LvK,{fill:"#aaa",size:16})})]}),(0,e.jsxs)("div",{className:"form-group checkbox-wrap",children:[(0,e.jsx)("label",{htmlFor:"weekends",onClick:()=>{$e(!me)},className:"checkBoxLabel",children:"Include Weekends"}),(0,e.jsx)("div",{"data-testid":"checkbox",className:"checkBox",onClick:()=>{$e(!me)},children:me?(0,e.jsx)(ys.b7E,{fill:"black",size:16}):(0,e.jsx)(ys.LvK,{fill:"#aaa",size:16})})]})]}),J===6&&(0,e.jsx)("div",{className:"tab_panel",children:(0,e.jsx)("div",{className:"bldr-popup-inner",children:(0,e.jsx)("form",{className:"bldr-edit-form",children:(0,e.jsx)("div",{className:"bldr-form-group",style:{height:360},children:(0,e.jsx)("textarea",{className:"bldr-form-input",value:N,required:!0,rows:20,onChange:Ln})})})})})]})]}),(0,e.jsxs)("div",{className:"bldr-popup-footer",children:[(0,e.jsx)("span",{className:"bldr-popup-error",children:he||""}),(0,e.jsxs)("div",{className:"bldr-popup-action-wrap",children:[(0,e.jsx)("button",{onClick:()=>Mt(),className:"bldr-action-cancel",children:"CANCEL"}),(0,e.jsx)("button",{onClick:()=>Ct(),className:"bldr-action-save",children:"SAVE"})]})]})]})})},nw=m.p+"259096e7705bc93cc2af94e7af9ee002.png";var nl=m(65258),Wr={};Wr.styleTagTransform=zs(),Wr.setAttributes=Us(),Wr.insert=_s().bind(null,"head"),Wr.domAPI=Ns(),Wr.insertStyleElement=Ws();var B_=Bs()(nl.A,Wr);const N_=nl.A&&nl.A.locals?nl.A.locals:void 0;var kh=m(29093),Th=m(65875);const sw=t=>{switch(t){case"LEFT":return"left: -105%;";case"IN":return"left: 0px;";case"RIGHT":default:return"left: 105%;"}},ow={sx:{maxWidth:"970px",width:"100%",height:{xs:"100%",md:"auto"},borderRadius:0,boxShadow:"0 4px 4px 0 rgba(0, 0, 0, 0.25);",margin:{xs:"0",md:"2rem"}}},__=(0,g.Ay)("div")`
  max-width: 280px;
  min-width: 82px;
  flex-wrap: wrap;

  & img {
    margin: 4px;
    cursor: pointer;
    object-fit: cover;
    width: 75px;
    height: 53px;
  }

  @media (max-width: 1300px) {
    max-width: 82px;
    max-height: 190px;
    overflow: hidden;
  }
`,rw=(0,g.Ay)(Ge)`
  align-items: center;

  ${({theme:t})=>t.breakpoints.down("md")} {
    height: 100%;
  }
`,aw=(0,g.Ay)("div")`
  overflow: hidden;
  position: relative;
  width: 800px;
  height: 600px;

  ${({theme:t})=>t.breakpoints.down("md")} {
    height: 100%;
    display: flex;
    align-items: center;
  }
`,iw=(0,g.Ay)("img")`
  width: 800px;
  height: 600px;

  position: absolute;
  transition: left 0.5s ease;
  object-fit: contain;

  max-width: 100%;

  ${({position:t})=>sw(t)}

  ${({theme:t})=>t.breakpoints.down("md")} {
    & img {
      height: auto;
      width: auto;
    }
  }
`,lw=(0,g.Ay)("p")`
  font-size: 16px;
  font-weight: normal;
  font-stretch: normal;
  font-style: normal;
  line-height: 86px;
  height: 86px;
  text-align: center;

  margin: 0;
`,Rh=(0,g.Ay)(K.A,{shouldForwardProp:t=>t!=="visible"})`
  min-height: 48px;
  min-width: unset;
  padding-left: 0;
  padding-right: 0;

  ${({visible:t})=>t?"opacity: 1":"opacity: 0"};

  ${({theme:t})=>t.breakpoints.down("md")} {
    margin: 0;
  }
`,dw=(0,g.Ay)(Ss.A)`
  font-size: 26px;
  color: var(--light-other-snackbar);
`,cw=(0,g.Ay)(K.A)`
  color: blue;
  cursor: pointer;
  padding-left: 0;

  &:hover {
    text-decoration: underline;
  }
`,Oh=({deliveryPhotos:t,imageIndex:n,setImageIndex:s,isModalOpen:o,closeModal:r})=>{const a=p=>p<n?"LEFT":p===n?"IN":"RIGHT",i=()=>{s(n+1)},l=()=>{s(n-1)},c=n===t?.length-1,u=n===0;return(0,e.jsx)("section",{children:(0,e.jsxs)(Ms.A,{open:o,onClose:r,PaperProps:ow,children:[(0,e.jsx)(tr.A,{sx:{height:"96px",padding:"0",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:(0,e.jsx)(Sd,{onClick:r,sx:{minHeight:"48px",marginRight:"1.25rem"},children:(0,e.jsx)(dw,{})})}),(0,e.jsxs)(rw,{children:[(0,e.jsx)(Rh,{variant:"text",color:"secondary",onClick:l,visible:!u,sx:{marginLeft:"1.25rem"},disabled:u,children:(0,e.jsx)(kh.A,{sx:{fontSize:"48px",color:"black"}})}),(0,e.jsx)(aw,{children:t&&t.map((p,f)=>(0,e.jsx)(iw,{src:p,position:a(f)},`modal-image-${f}`))}),(0,e.jsx)(Rh,{visible:!c,sx:{marginRight:"1.5rem"},color:"secondary",variant:"text",onClick:i,disabled:c,children:(0,e.jsx)(Th.A,{sx:{fontSize:"48px",color:"black"}})})]}),(0,e.jsxs)(lw,{children:[n+1," of ",t?.length]})]})})},sl=(0,g.Ay)("td")(({theme:t})=>({paddingTop:t.spacing(1)})),uw=t=>{const n=(0,Dt.A)(),{showError:s}=(0,Fe.d)(),{fetchDeliveryPhotos:o}=(0,On.HO)(),r=(0,L.useNavigate)(),{company:a}=(0,je.P)(),{createProjectFromNullId:i}=(0,De.B)(),[l,c]=(0,d.useState)(0),[u,p]=(0,d.useState)([]),[f,h]=(0,d.useState)([]),[b,x]=(0,d.useState)(""),[v,y]=(0,d.useState)(!1),[j,A]=(0,d.useState)(!1),w=()=>{A(!1),setTimeout(()=>{c(0)},150)};(0,d.useEffect)(()=>{f?.length>0&&A(!0)},[f]),(0,d.useEffect)(()=>{let C=u&&u.find(k=>k.orderId===b);C&&C.photos&&(h(C.photos),C.photos.length===0&&C.numPhotos===0&&s({message:"This delivery does not have any photos."}))},[u]);const P=async C=>{x(C.orderId||"");const k=t.projectList&&t.projectList.find(S=>S.projectExternalId===C?.external_project_id);if(k&&!k.id&&a?.id&&C?.external_project_id){const S=await i?.(a?.id,C?.external_project_id,!1);S?.id&&(t.addProjectIdToState(C.external_project_id,S.id),k.id=S.id)}await o(k?.id,C?.orderId||"",u,p,5e3,C?.deliveryId,!0),y(!1)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ms.A,{className:"delivery-dialog-company",open:t.open,onClose:t.closeModal,children:(0,e.jsxs)(E.A,{sx:{position:"relative"},children:[(0,e.jsxs)("div",{className:"header-div",children:[(0,e.jsx)("span",{className:"dialog-title",children:"Delivery Details"}),(0,e.jsx)(pt.A,{"aria-label":"close",onClick:t.closeModal,sx:{color:"white"},children:(0,e.jsx)(co.A,{})})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"divider-div"}),(0,e.jsx)(E.A,{children:(0,e.jsx)("table",{style:{margin:n.spacing(1),maxHeight:"600px",display:"block",overflowY:"auto"},children:(0,e.jsxs)("tbody",{children:[(0,e.jsxs)("tr",{style:{height:"40px",alignItems:"start",verticalAlign:"text-top"},children:[(0,e.jsx)("td",{className:"col-project-name",children:(0,e.jsx)("b",{children:"Project"})}),(0,e.jsx)("td",{className:"col-pack-name",children:(0,e.jsx)("b",{children:"Pack Name"})}),(0,e.jsx)("td",{className:"col-delivery-id",children:(0,e.jsx)("b",{children:"Delivery ID"})}),(0,e.jsx)("td",{className:"col-delivery-id",children:(0,e.jsx)("b",{children:"Photos"})}),(0,e.jsx)("td",{className:"col-view"})]}),t.selectedDelivery&&t.selectedDelivery.map((C,k)=>{let S;const R=t.projectList?.find(T=>T.projectExternalId===C?.external_project_id);t.project&&C?.external_project_id===t.project.projectExternalId?S=t.project:S=R;const B=R?R.name:"";return(0,e.jsxs)("tr",{style:{verticalAlign:"text-top",marginTop:n.spacing(1)},children:[(0,e.jsx)(sl,{className:"col-project-name",children:B}),(0,e.jsx)(sl,{className:"col-pack-name",children:C.deliveryNote&&C.deliveryNote}),(0,e.jsx)(sl,{className:"col-delivery-id",children:C.deliveryId&&C.deliveryId}),(0,e.jsx)("td",{className:"col-delivery-photos",children:v&&b===C.orderId?(0,e.jsx)(bt.A,{size:18}):(0,e.jsx)("img",{src:nw,alt:"Delivery Photos",onClick:()=>{v||(y(!0),P(C))},style:{width:"20",height:"20",cursor:v?"default":"pointer",opacity:v?.5:1}})}),(0,e.jsx)(sl,{className:"col-view",onClick:()=>{r(`/open?erpSystem=${a?.erpSystem}&orderId=${C.orderId}&deliveryId=${C.deliveryId}&next=materials`)},children:"View in Materials"})]},k)})]})})})]})]})}),f?.length>0&&(0,e.jsx)(Oh,{deliveryPhotos:f,imageIndex:l,setImageIndex:c,isModalOpen:j,closeModal:w})]})},uo=["Name cannot be empty.","Date cannot be Empty","Invalid Due Date","Percentage should be 0 - 100"],pw=["Are you sure you want to unschedule this Task?","Do you wish to continue?"],mw=["Are you sure you want to delete these Tasks?","Do you wish to continue?"],Mh=({phaseList:t,taskStatusList:n,taskList:s,modalIsOpen:o,setModalIsOpen:r,todoItem:a,refresh:i,setMessage:l,status:c,dependencies:u,resources:p,assignments:f})=>{const{updateTask:h,deleteTask:b,updateTaskSequence:x,deleteDependency:v}=(0,Xs.P)(a?.project_id),y=(0,d.useRef)(),j=He()(a.start_date||a.startDate).format(Ot.OY);let A=n.filter(Pe=>Pe.is_todo_status);const[w,P]=(0,d.useState)(1),[C,k]=(0,d.useState)(""),[S,R]=(0,d.useState)("");let[B,T]=(0,d.useState)([]);const[W,N]=(0,d.useState)(!1),[O,z]=(0,d.useState)(!1),[Q,re]=(0,d.useState)(!1),[ue,le]=(0,d.useState)(!1);let[F,V]=(0,d.useState)([]);const[$,ee]=(0,d.useState)([]),[X,G]=(0,d.useState)([]),[Y,he]=(0,d.useState)({}),[ne,J]=(0,d.useState)({}),[pe,Ee]=(0,d.useState)(0),[Te,me]=(0,d.useState)(a&&j?j:He()(new Date).format(Ot.OY)),$e=Pe=>{P(Pe)},gt=()=>{if(!O&&!Q){if(f){let Pe=[];f.forEach(Qe=>{p.filter(ht=>ht.id===Qe.resource).length>0&&Pe.push({id:Qe.id,resourceId:Qe.resource,assignedTo:p.filter(ht=>ht.id===Qe.resource)[0].name})}),ee(Pe)}ge(),r(!1),R(""),P(1)}};(0,d.useEffect)(()=>{if(f){let Pe=[];f.forEach(Qe=>{p.filter(ht=>ht.id===Qe.resource).length>0&&Pe.push({id:Qe.id,resourceId:Qe.resource,assignedTo:p.filter(ht=>ht.id===Qe.resource)[0].name})}),ee(Pe)}if(a.name&&k(a.name),t&&t.length>0&&a.parent_task_id&&a){const Pe=t&&t.filter(Qe=>Qe.id==a.parent_task_id);Pe[0]&&he(Pe[0])}if(A&&A.length>0){const Pe=A&&A.filter(Qe=>Qe.id===a.task_status_id);Pe[0]&&J(Pe[0])}if(a.start_date||a.startDate){const Pe=He()(a.start_date||a.startDate).format(Ot.OY);me(Pe)}R(a.notes),Ee(a.task_completion_percentage)},[t,n,a,a.name,a.start_date,a.startDate,a.notes,a.parent_task_id,a.task_status_id,a.task_completion_percentage,f]);const Rt={"& .MuiDialog-container":{"& .MuiPaper-root":{width:"100%",maxWidth:"750px",minHeight:"630px"}}},rt=Pe=>{k(Pe.target.value),Pe.target.value.trim()!=""?T(B.filter(Qe=>Qe!=uo[0])):(B.push(uo[0]),T(B))},Ue=Pe=>{const Qe=Pe.target.value,ht=t&&t.filter(Xt=>Xt.name===Qe);he(ht[0])},lt=Pe=>{const Qe=Pe.target.value.replace(/[^0-9]/g,"");Ee(Qe),Qe<0||Qe>100?(B.push(uo[3]),T(B)):T(B.filter(Qt=>Qt!=uo[3]));let ht=(0,gn.K7)(Qe,"TODO");const Xt=n&&n.filter(Qt=>Qt.id==ht);J(Xt[0])},ge=()=>{T([]);const Pe=t?.filter(Xt=>Xt.id===a.parent_task_id),Qe=He()(a.start_date||a.startDate).format(Ot.OY);let ht=A?.filter(Xt=>Xt.id===a.task_status_id);R(a.notes),k(a.name),Ee(a.task_completion_percentage),me(Qe),J(ht[0]),Pe[0]?he(Pe[0]):he({id:0,name:""})},We=Pe=>{if(Pe)if(Pe.toDate().toString().includes("Invalid Date"))B.push(uo[2]),T(B.filter(Qe=>Qe!=uo[1]));else{let Qe=Pe.toDate(),ht=new Date(Qe.toString()),Xt=He()(new Date(ht)).format(Ot.OY);me(Xt),T(B.filter(Qt=>Qt!==uo[1]&&Qt!==uo[2]))}else B.push(uo[1]),T(B.filter(Qe=>Qe!==uo[2]))},At=Pe=>{const Qe=Pe.target.value;let ht=(0,gn.DX)(Qe,ne.id);Ee(ht);const Xt=n&&n.filter(Qt=>Qt.id==Qe);J(Xt[0])},xn=Pe=>{R(Pe.target.value)},on=async Pe=>{let Qe=!0;if(B.length==0&&!O&&!Q){z(!0);let ht=He()(Te).format(Ot.MK)+" 00:00:00",Xt=He()(Te).add(1,"days").format(Ot.MK)+" 00:00:00",Qt=[],As=[];$.forEach(Le=>{Le.resourceId!=null&&Le.id.toString().includes("generated")?Qt.push({resource:Le.resourceId,event:a?.id}):Le.resourceId!=null&&f.filter(mt=>mt.id==Le.id)[0].resource!=Le.resourceId&&As.push({id:Le.id,resource:Le.resourceId,event:a?.id})});let Ln={id:a?.id,name:C,start_date:ht,end_date:Xt,duration:1,assignments:{added:Qt,updated:As,deleted:X},project_id:a?.project_id,task_color_id:null,include_holidays:a?.includeHolidays,include_weekends:a?.includeWeekends,task_type:"TODO",notes:S};a.task_status_id!=ne?.id&&(Ln={...Ln,task_status_id:ne?.id}),a.task_completion_percentage!=pe&&(Ln={...Ln,task_completion_percentage:Number(pe)});const hs=await h(a?.id,Ln);if(!hs.data){l("Error",hs.error,"error"),r(!1),z(!1),Qe=!1,P(1);return}let Qs=s&&s.filter(Le=>Le.parent_task_id===Y?.id);if(Y!=null&&Y.id!=a.parent_task_id){let Le=[];Le.push({id:Ln?.id,new_parent_task_id:Y?.id,new_sequence:Qs?.length+1});const mt=await x(Le);mt.data||(l("Error",mt.error,"error"),Qe=!1,z(!1))}Qe&&(R(""),r(!1),z(!1),P(1),l("Success","Todo Updated successfully","success"),i("update"))}},Xe=a.parent_task_id===0,dt=async()=>{le(!1),re(!0);let Pe={start_date:null,end_date:null};u&&u.map(async ht=>{(ht.from===a?.id||ht.fromEvent===a?.id||ht.to===a?.id||ht.toEvent===a?.id)&&await v(ht.id,a.project_id)});const Qe=await h(a?.id,Pe);if(!Qe.data){l("Error",Qe.error,"error");return}i("update"),r(!1),re(!1),l("Success","Todo Unscheduled successfully","success")},Tn=Pe=>{let Qe=[];Pe.selection.forEach(ht=>{Qe.push(ht.data.id)}),V(Qe)},In=async()=>{let Pe=[];Pe=$.filter(Qe=>!F.some(ht=>ht==Qe.id)),ee(Pe),G(F)},Ct=async()=>{N(!1);let Pe={ids:[a?.id]};const Qe=await b(Pe);Qe.data?l("Success","Todo Deleted successfully","success"):l("Error",Qe.error,"error"),i("update"),r(!1)},Mt={dependencyIdField:"id",columns:gn._C,barMargin:10,enableDeleteKey:!1,cellEditFeature:{addNewAtEnd:!1}};return(0,e.jsx)("div",{className:"todo-popup",children:o&&(0,e.jsxs)("div",{className:"bldr-popup",children:[(0,e.jsxs)(Ms.A,{"data-testid":"dialog",onClose:gt,open:o,sx:Rt,className:"bldr-main-modal",children:[(0,e.jsxs)("div",{className:"bldr-popup-header",style:{display:"flex",justifyContent:"space-between"},children:[(0,e.jsx)("h2",{children:"To-Do Information"}),(0,e.jsx)("span",{className:"close-wrap",children:(0,e.jsx)(co.A,{onClick:()=>gt()})})]}),(0,e.jsxs)(E.A,{className:"bldr-popup-tabs",children:[(0,e.jsx)(E.A,{children:(0,e.jsxs)("ul",{className:"bldr-popup-tabs-header",children:[(0,e.jsx)("li",{className:w===1?"active":"",onClick:()=>$e(1),children:"GENERAL"}),(0,e.jsx)("li",{className:w===2?"active":"",onClick:()=>$e(2),children:"RESOURCES"}),(0,e.jsx)("li",{className:`${w===4?"active":""} `,onClick:()=>$e(4),children:(0,e.jsx)(_r.TPo,{size:11})})]})}),(0,e.jsxs)("div",{className:"tab_content",children:[w===1&&(0,e.jsx)("div",{className:"bldr-popup-inner",children:(0,e.jsxs)("form",{className:"bldr-edit-form",children:[(0,e.jsxs)("div",{className:"bldr-form-group",children:[(0,e.jsx)("label",{className:"bldr-form-label",children:"TO-DO NAME"}),(0,e.jsx)("input",{className:"bldr-form-input",type:"text","data-testid":"todo-name",autoFocus:!0,value:C,required:!0,onChange:Pe=>rt(Pe)})]}),(0,e.jsxs)("div",{"data-testid":"selectProjectDiv",className:"custom-popup-select-wrap",children:[(0,e.jsx)(sr.A,{className:"custom-popup-label",id:"phase",sx:{paddingLeft:2},children:"Phase"}),(0,e.jsx)(go.A,{labelId:"phase",id:"phase",value:Y?.name?Y.name:"","data-testid":"todo-phase",onChange:Pe=>Ue(Pe),role:"list",label:"Phase",className:"custom-popup-select",MenuProps:{style:{maxHeight:400}},children:t&&t.map((Pe,Qe)=>(0,e.jsx)(it.A,{value:Pe.name,"data-id":Pe.id,children:Pe.name},Qe))})]}),(0,e.jsxs)("div",{className:"bldr-form-group","data-testid":"todo-date",children:[(0,e.jsx)("label",{className:"bldr-form-label",children:"DUE DATE"}),(0,e.jsx)(Xn.LocalizationProvider,{dateAdapter:el.Y,children:(0,e.jsx)(Xn.DatePicker,{className:"bldr-form-date bldr-form-date-start-date",disabled:Xe,"data-testid":"todo-date",value:He()(Te),onChange:Pe=>We(Pe),slotProps:{textField:{fullWidth:!0}}})})]}),(0,e.jsxs)("div",{"data-testid":"selectProjectDiv",className:"custom-popup-select-wrap",children:[(0,e.jsx)(sr.A,{className:"custom-popup-label",id:"status",sx:{paddingLeft:2},children:"Status"}),(0,e.jsx)(go.A,{labelId:"status",id:"status",value:ne?.id?ne.id:null,onChange:Pe=>At(Pe),"data-testid":"todo-status",role:"list",label:"Status",className:"custom-popup-select",MenuProps:{style:{maxHeight:400}},children:A&&A.map((Pe,Qe)=>(0,e.jsx)(it.A,{value:Pe.id,"data-id":Pe.id,children:Pe.status},Qe))})]}),(0,e.jsxs)("div",{className:"bldr-form-group",children:[(0,e.jsx)("label",{className:"bldr-form-label",children:"% Complete"}),(0,e.jsx)("input",{type:"number",min:0,max:100,value:pe,className:"bldr-form-input",onChange:Pe=>lt(Pe)})]})]})}),w===2&&(0,e.jsxs)("div",{className:"tab_panel resources_tab",style:{height:"100%"},children:[(0,e.jsx)(sc.C4,{height:330,cls:"bryntum-gantt-updated",ref:y,...Mt,data:$,onSelectionChange:Tn,onBeforeCellEditStart:Pe=>{let Qe=[];p.forEach(ht=>{$.filter(Xt=>Xt.resourceId==ht.id).length==0&&Qe.push(ht)}),Pe.editorContext.editor.items=Qe.map(ht=>({text:ht.name,value:ht.id,id:ht.resourceId}))},onFinishCellEdit:Pe=>{let Qe=[];$.forEach((ht,Xt)=>{Xt===Pe.editorContext._rowIndex?Qe.push({resourceId:Pe.editorContext.value,id:Pe.editorContext._id,assignedTo:p.filter(Qt=>Qt.id===Pe.editorContext.value)[0].name}):Qe.push(ht)}),ee(Qe)}}),(0,e.jsx)("div",{className:"button-wrap",children:(0,e.jsxs)("div",{className:"bldr-popup-action-wrap-left",children:[(0,e.jsx)("div",{onClick:()=>{let Pe=[];Pe.push({id:"generated_"+Date.now().toString(36),assignedTo:"",resourceId:null}),$.forEach(Qe=>{Pe.push(Qe)}),ee(Pe)},className:"bldr-plus-icon-popup",children:(0,e.jsx)(_r.OiG,{size:12,color:"#008000"})}),(0,e.jsx)("div",{onClick:()=>In(),className:"bldr-trash-icon-popup",children:(0,e.jsx)(_r.qbC,{size:12,color:"#ff0000"})})]})}),(0,e.jsx)("div",{className:"button-wrap"})]}),w===4&&(0,e.jsx)("div",{className:"tab_panel",children:(0,e.jsx)("div",{className:"bldr-popup-inner",children:(0,e.jsx)("form",{className:"bldr-edit-form",children:(0,e.jsx)("div",{className:"bldr-form-group",children:(0,e.jsx)("textarea",{className:"bldr-form-input",value:S,rows:16,onChange:Pe=>xn(Pe)})})})})})]})]}),(0,e.jsxs)("div",{className:"bldr-popup-footer bldr-popup-todo-footer",children:[(0,e.jsx)("span",{className:"bldr-popup-error",children:B.length>0?B[0]:""}),(0,e.jsxs)("div",{className:"button-wrap",children:[(0,e.jsx)("div",{className:"bldr-popup-action-wrap-left",children:(0,e.jsx)("button",{onClick:!O&&!Q?()=>N(!0):()=>{},className:"bldr-action-delete",disabled:c===gn.e1.Open||Xe,"data-testid":"todo-delete",children:"Delete"})}),(0,e.jsxs)("div",{className:"bldr-popup-action-wrap",children:[(0,e.jsx)("button",{onClick:!O&&!Q?()=>le(!0):()=>{},className:"bldr-action-unschedule",disabled:c===gn.e1.Open||Xe,"data-testid":"todo-unschedule",children:Q?(0,e.jsx)(bt.A,{size:"0.85rem",style:{color:"white"}}):"Unschedule"})," ",(0,e.jsx)("button",{onClick:()=>gt(),"data-testid":"todo-cancel",className:"bldr-action-cancel",children:"Cancel"}),(0,e.jsx)("button",{onClick:Pe=>on(Pe),className:"bldr-action-save","data-testid":"todo-save",children:O?(0,e.jsx)(bt.A,{size:"0.85rem",style:{color:"white"}}):"Save"})]})]})]})]}),(0,e.jsx)(Uo,{title:"This To-Do task will be deleted",message:mw,open:W,onClose:()=>N(!1),onConfirm:Ct,loading:!1,closeButtonText:"Go Back",submitButtonText:"Delete"}),(0,e.jsx)(Uo,{title:"This To-Do task will be unschedule",message:pw,open:ue,onClose:()=>{le(!1),r(!1)},onConfirm:dt,loading:!1,closeButtonText:"Cancel",submitButtonText:"Yes"})]})})};var ol=m(32784),zr={};zr.styleTagTransform=zs(),zr.setAttributes=Us(),zr.insert=_s().bind(null,"head"),zr.domAPI=Ns(),zr.insertStyleElement=Ws();var W_=Bs()(ol.A,zr);const z_=ol.A&&ol.A.locals?ol.A.locals:void 0,hw=(t,n,s,o,r)=>{let a=1,i=[],l=t;for(;He()(l).isBefore(He()(n).subtract(1,"days"));)i.push(l),l=He()(l).add(1,"days").toDate();const c=gw(s,t,n);let u=[];return c.forEach(p=>{!o&&!p.isWeekDay&&u.push(p),!r&&p.isWeekDay&&u.push(p)}),i.forEach(p=>{u.find(f=>He()(f.startDate).isSame(He()(p)))||a++}),a},gw=(t,n,s)=>{let o=[],r=[],a=n;for(;He()(a).isBefore(He()(s));)r.push(a),a=He()(a).add(1,"days").toDate();return r?.forEach((i,l)=>{if(i.getDay(),t)switch(i.getDay()){case 0:t.weekDays[0]&&o.push({id:l,name:"Sunday",startDate:i,duration:1,isWeekDay:!0,durationUnit:"day"});break;case 1:t.weekDays[1]&&o.push({id:l,name:"Monday",startDate:i,duration:1,isWeekDay:!0,durationUnit:"day"});break;case 2:t.weekDays[2]&&o.push({id:l,name:"Tuesday",startDate:i,duration:1,isWeekDay:!0,durationUnit:"day"});break;case 3:t.weekDays[3]&&o.push({id:l,name:"Wednesday",startDate:i,isWeekDay:!0,duration:1,durationUnit:"day"});break;case 4:t.weekDays[4]&&o.push({id:l,name:"Thursday",startDate:i,isWeekDay:!0,duration:1,durationUnit:"day"});break;case 5:t.weekDays[5]&&o.push({id:l,name:"Friday",startDate:i,isWeekDay:!0,duration:1,durationUnit:"day"});break;case 6:t.weekDays[6]&&o.push({id:l,name:"Saturday",startDate:i,isWeekDay:!0,duration:1,durationUnit:"day"});break;default:break}}),t.holidays.forEach((i,l)=>{o.push({id:l+r.length,name:i.description,startDate:i.date,duration:1,isWeekDay:!1,durationUnit:"day"})}),o},fw=(t,n,s,o)=>{let r,a;switch(t){case"week":n==="next"?r=new Date(s.setDate(s.getDate()+7)):n==="previous"?r=new Date(s.setDate(s.getDate()-7)):r=new Date(o),a=He()(s).format("MMMM")+" "+He()(s).format("YYYY")+" (week "+He()(s).week().toString()+")";break;case"month":const i=s.getFullYear(),l=s.getMonth(),c=new Date(i,l,1),u=Bh(l,i),p=Bh(l-1,i);n==="next"?r=new Date(s.setDate(c.getDate()+u)):n==="previous"?r=new Date(s.setDate(c.getDate()-p)):r=new Date(o),a=He()(s).format("MMMM")+", "+He()(s).format("YYYY");break;case"day":n==="next"?r=new Date(s.setDate(s.getDate()+1)):n==="previous"?r=new Date(s.setDate(s.getDate()-1)):r=new Date(o),a=He()(s).format("LL");break}return{switchDate:r,switchTitle:a}},xw=(t,n,s,o,r,a,i,l,c,u,p,f)=>p?[{style:{"margin-top":"auto","margin-bottom":"auto"},type:"buttongroup",items:[{type:"button",text:"MONTH",presed:!0,height:"fit-content",width:"fit-content",style:{color:n=="month"?"#FFF":"#000","font-size":"10px"},toggleable:!0,pressed:n=="month",onAction(){s("month")}},{type:"button",text:"AGENDA",height:"fit-content",width:"fit-content",style:{color:n=="day"?"#FFF":"#000","font-size":"10px"},toggleable:!0,pressed:n=="day",onAction(){s("day")}}]},{type:"buttongroup",style:{margin:"auto",color:"#000"},items:[{type:"button",ref:"todayButton",text:"Today",height:"fit-content",icon:"b-fa-calendar",width:"fit-content",style:{"font-size":"10px"},align:"center",onAction(){r("",new Date)}},{type:"button",icon:"b-fa-angle-left",height:"fit-content",width:"fit-content",style:{"margin-left":"15px","font-size":"10px"},onAction(){a.includes("-")?u("Error","Cannot change. Date range is selected.","error"):r("previous",null)}},{type:"button",icon:"b-fa-angle-right",height:"fit-content",width:"fit-content",style:{"margin-left":"15px","font-size":"10px"},onAction(){a.includes("-")?u("Error","Cannot change. Date range is selected.","error"):r("next",null)}},{type:"widget",float:!0,style:{"margin-left":"15px","font-size":"22px","font-family":"Inter","font-weight":"600","flex-grow":0,"font-stretch":"normal","font-style":"normal","line-height":"normal","letter-spacing":"normal","text-align":"center",color:"#4f5964"},html:(0,e.jsx)(e.Fragment,{children:a})}]}]:[{style:{"margin-top":"auto","margin-bottom":"auto"},type:"buttongroup",items:[{type:"button",text:"LIST",height:"fit-content",width:"fit-content",style:{color:"#000","font-size":"10px","border-top-left-radius":"5px","border-bottom-left-radius":"5px"},onAction(){t("scheduler")}},{type:"button",text:"MONTH",presed:!0,height:"fit-content",width:"fit-content",style:{color:n=="month"?"#FFF":"#000","font-size":"10px"},toggleable:!0,pressed:n=="month",onAction(){s("month")}},{type:"button",text:"WEEK",height:"fit-content",width:"fit-content",style:{color:n=="week"?"#FFF":"#000","font-size":"10px"},toggleable:!0,pressed:n=="week",onAction(){s("week")}},{type:"button",text:"AGENDA",height:"fit-content",width:"fit-content",style:{color:n=="day"?"#FFF":"#000","font-size":"10px"},toggleable:!0,pressed:n=="day",onAction(){s("day")}},{type:"button",text:"TIMELINE",height:"fit-content",width:"fit-content",style:{color:"#000","font-size":"10px","border-top-right-radius":"5px","border-bottom-right-radius":"5px"},onAction(){t("gantt")}}]},{type:"buttongroup",style:{margin:"auto",color:"#000"},items:[{type:"button",ref:"todayButton",text:"Today",height:"fit-content",icon:"b-fa-calendar",width:"fit-content",style:{"font-size":"10px"},align:"center",onAction(){r("",new Date)}},{type:"button",icon:"b-fa-angle-left",height:"fit-content",width:"fit-content",style:{"margin-left":"15px","font-size":"10px"},onAction(){a.includes("-")?u("Error","Cannot change. Date range is selected.","error"):r("previous",null)}},{type:"button",icon:"b-fa-angle-right",height:"fit-content",width:"fit-content",style:{"margin-left":"15px","font-size":"10px"},onAction(){a.includes("-")?u("Error","Cannot change. Date range is selected.","error"):r("next",null)}},{type:"widget",float:!0,style:{"margin-left":"15px","font-size":"22px","font-family":"Inter","font-weight":"600","flex-grow":0,"font-stretch":"normal","font-style":"normal","line-height":"normal","letter-spacing":"normal","text-align":"center",color:"#4f5964"},html:(0,e.jsx)(e.Fragment,{children:a})}]},{type:"buttongroup",style:{"margin-top":"auto","margin-bottom":"auto"},items:[{type:"button",text:"APPLY TEMPLATE",height:"fit-content",width:"fit-content",style:{color:"#000","font-size":"10px",borderRadius:"5px"},onAction(){i.length>0||l.length>0?c(!0):u("Error","No Schedules or Templates Exist for your company","error")},disabled:!(i.length||l.length)||!f}]}],yw=(t,n,s,o,r,a,i,l,c,u)=>[{type:"buttongroup",style:{margin:"auto",color:"#000"},items:[{type:"button",ref:"todayButton",text:"Today",height:"fit-content",icon:"b-fa-calendar",width:"fit-content",style:{"font-size":"10px"},align:"center",onAction(){r("",new Date)}},{type:"button",icon:"b-fa-angle-left",height:"fit-content",width:"fit-content",style:{"margin-left":"15px","font-size":"10px"},onAction(){a.includes("-")?u("Error","Cannot change. Date range is selected.","error"):r("previous",null)}},{type:"button",icon:"b-fa-angle-right",height:"fit-content",width:"fit-content",style:{"margin-left":"15px","font-size":"10px"},onAction(){a.includes("-")?u("Error","Cannot change. Date range is selected.","error"):r("next",null)}},{type:"widget",float:!0,style:{"margin-left":"15px","font-size":"22px","font-family":"Inter","font-weight":"600","flex-grow":0,"font-stretch":"normal","font-style":"normal","line-height":"normal","letter-spacing":"normal","text-align":"center",color:"#4f5964"},html:(0,e.jsx)(e.Fragment,{children:a})}]}],bw=(t,n)=>{let s;switch(t){case"week":s=He()(n).format("MMMM")+" "+He()(n).format("YYYY")+" (week "+He()(n).week().toString()+")";break;case"month":s=He()(n).format("MMMM")+" "+He()(n).format("YYYY");break;case"day":s=He()(n).format("LL");break}return s},vw=`<svg
    xmlns='http://www.w3.org/2000/svg'
    height='24px'
    viewBox='0 0 24 24'
    width='24px'
    fill='#e8eaed'
  >
    <path d='M0 0h24v24H0z' fill='none' />
    <path d='M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z' />
  </svg>`,Lh=(t,n)=>{var s="";return t.eventRecord.data.event_type=="delivery"?(t.renderData.iconCls["b-icon-circle"]=0,t.renderData.cls["icon-cls"]=1,s=`<div class='delivered-icon'>${vw} ${t.eventRecord.data.count}</div>`):s=`<div>${lo.MZC.encodeHtml(t.eventRecord.name)}</div>`,s},Fh=t=>t.sort((n,s)=>n.event_type>s.event_type?1:s.event_type>n.event_type?-1:0),jw=t=>{let n="",s="",o="",r="";return t.eventRecord.data.event_type=="task"&&(n=t.eventRecord.name,s=`${lo.rVz.format(t.eventRecord.data.startDate,Ot.SH)} - ${lo.rVz.format(t.eventRecord.data.endDate,Ot.SH)}`,o="Assigned To: "+t.eventRecord.data.resourceAssignment,r="Project Name:"+t.eventRecord.data.project_name),t?.eventRecord?.data?.event_type==="task"?`<dl>
      <dt><b>${lo.MZC.encodeHtml(n)}</b></dt>
        <dt>${lo.MZC.encodeHtml(s)}</dt>
        <dt>${lo.MZC.encodeHtml(o)}</dt>
        <dt>${lo.MZC.encodeHtml(r)}</dt>
      </dl>
      `:null},Bh=(t,n)=>t===0||t===2||t===4||t===6||t===7||t===9||t===11?31:t===1?n%4===0?29:28:30;He().suppressDeprecationWarnings=!0;const Aw=Lr()(()=>m.e(11).then(m.bind(m,38011)),{ssr:!1}),rl=["red","blue","green","yellow","orange","purple","pink","cyan","black","teal","indigo"],Js={appendTo:"container",eventEditFeature:{editorConfig:{centered:!0,bbar:{items:{deleteButton:!1}}},items:{allDay:null,startTimeField:null,endTimeField:null,endDateField:{name:"endDate",type:"datefield",label:"End Date",value:"",disabled:!0},t_duration:{name:"t_duration",type:"number",label:"Duration",min:1,required:!0},taskStatus:{type:"combo",items:[],label:"Task Status",value:""},groups:{type:"combo",items:[],label:"Phase",value:"",required:!0},includeHolidays:{type:"checkbox",name:"includeHolidays",label:"INCLUDE HOLIDAYS",labelPosition:"before"},includeWeekends:{type:"checkbox",name:"includeWeekends",label:"INCLUDE WEEKENDS",labelPosition:"before"}}},modeDefaults:{listRangeMenu:null}},oc=t=>{const{showError:n}=(0,Fe.d)(),{isAppEmbedded:s}=Os(),{company:o}=(0,je.P)(),{allRoles:r}=(0,we.Sk)(),a=s&&(0,ct.MI)(r),{project:i}=(0,De.B)(),l=(0,d.useRef)(),[c,u]=(0,d.useState)(""),[p,f]=(0,d.useState)([]),[h,b]=(0,d.useState)([]),[x,v]=(0,d.useState)([]),{userHasPermission:y}=(0,Ye.A)(),j=y({tool:D.w5.SCHEDULE,action:D.a2.EDIT_TASKS,companyId:i?.companyId,projectId:i?.id}),A={id:i?.id,projectExternalId:i?.projectExternalId,name:i?.projectName},w=t.companyLevelSchedule?[]:[{originalData:A}],[P,C]=(0,d.useState)(w),[k,S]=(0,d.useState)([]),[R,B]=(0,d.useState)([]),[T,W]=(0,d.useState)([]),[N,O]=(0,d.useState)([]),[z,Q]=(0,d.useState)([]),[re,ue]=(0,d.useState)({}),[le,F]=(0,d.useState)(!1),[V,$]=(0,d.useState)(!1),[ee,X]=(0,d.useState)(!1),{projectList:G}=(0,Ys.Y)({searchTerm:"",showErrorMessage:!1,shouldRefetch:!1});let Y=new Date,he=Y.getFullYear(),ne=Y.getMonth();const[J,pe]=(0,d.useState)(He()(new Date(he,ne,1)).format(Ot.OY)),[Ee,Te]=(0,d.useState)(He()(new Date(he,ne+1,0)).format(Ot.OY)),[me,$e]=(0,d.useState)([]),{fetchTasksListMultiple:gt,addNewTask:Rt,updateTask:rt,deleteTask:Ue,getDeliveries:lt,isNonWorkingDay:ge,getHolidayDetails:We,fetchNonWorkingDays:At,fetchPhaseList:xn,fetchResourceAssignments:on}=(0,Xs.P)(i?.id),[Xe,dt]=(0,d.useState)(!1),[Tn,In]=(0,d.useState)(null),[Ct,Mt]=(0,d.useState)(null),[Pe,Qe]=(0,d.useState)(null),[ht,Xt]=(0,d.useState)(null),[Qt,As]=(0,d.useState)(t.selectedMode),[Ln,hs]=(0,d.useState)(new Date),[Qs,Le]=(0,d.useState)(""),[mt,Wt]=(0,d.useState)([]),[pn,mn]=(0,d.useState)(!1),[yn,es]=(0,d.useState)(void 0),[Ir,ns]=(0,d.useState)(!1),[yt,zt]=(0,d.useState)([]),Nt=t.holidayList,[gs,Jo]=(0,d.useState)([]),[fa,ld]=(0,d.useState)(new Date),[dd,wi]=(0,d.useState)(new Date),cd=Z=>{if(ge(Nt,Z.date,!1,!1)||t.companyLevelSchedule)return!1};var ud={items:{duplicate:!1,deleteEvent:{text:"Delete",async onItem(Z){if(Z.eventRecord.originalData.event_type=="delivery")return En("Error","Cannot Delete Delivery","error"),!1;if(Z.eventRecord.originalData.project_id==i?.id){if(await lo.E1Z.confirm({title:"Please confirm",message:"Are You sure want to delete this task",okButton:"Confirm"})==lo.E1Z.okButton){var at=[];at.push(Z.eventRecord.originalData.id);let Lt=at.length===R.length?null:{ids:at};(await Ue(Lt)).data?(fs(),En("Success","Task Deleted Successfully","success")):En("Error","Cannot Delete Task !","error")}}else En("Error","Cannot Delete Task From Other Projects","error")}}}};let Zu=()=>{let at=sessionStorage.getItem("selectedProject")?.split(",").map(Number);at&&at.length&&at[0]!==0&&Q(at)};const y6=(Z,at)=>{let st=[],Lt={},tn=[];for(const bn of at)Z&&Z.length&&Z.forEach(vn=>{vn.external_project_id==bn.originalData.projectExternalId&&vn?.deliveries?.forEach(St=>{St?.deliveryDetails?.forEach(ks=>{let Dn=ks;Dn.orderId=St?.orderId,Dn.jobId=St?.jobId,Dn.external_project_id=vn?.external_project_id,(Dn.status==="DELIVERED"||Dn.status==="OUT_FOR_DELIVERY"||Dn.status==="DELIVERY_SCHEDULED")&&st.push(Dn)})})});for(let bn of st){let vn=He()(bn?.actualDeliveryAt?bn?.actualDeliveryAt:bn?.requestedDeliveryAt).format(Ot.OY),St=bn.status==="DELIVERED"?vn:bn?.requestedDeliveryAt;Lt.hasOwnProperty(St)?Lt[St].push(bn):Lt[St]=[bn]}Object.keys(Lt).forEach(bn=>{const vn=Lt[bn];tn.push({id:null,task:vn,is_new:!1,name:vn?.length==1?"Delivery":"Deliveries",parent_task_id:null,project_id:null,eventColor:"#ffffff00",task_color:null,startDate:bn,endDate:bn,manuallyScheduled:!0,editEvent:null,event_type:"delivery",count:vn.length})}),v(tn)};(0,d.useEffect)(()=>{Zu()},[]),(0,d.useEffect)(()=>{o&&C6(J,Ee)},[J,Ee,o]),(0,d.useEffect)(()=>{y6(me,P)},[me,P]),(0,d.useEffect)(()=>{S([...x,...h])},[x,h]),(0,d.useEffect)(()=>()=>{sessionStorage.setItem("selectedProject",""),sessionStorage.setItem("selectedResourcesData",JSON.stringify([]))},[]),(0,d.useEffect)(()=>{t.companyLevelSchedule||(sessionStorage.setItem("selectedProject",""),sessionStorage.setItem("selectedResourcesData",JSON.stringify([])),Q([i.id]))},[i?.id]),(0,d.useEffect)(()=>{i&&location?.pathname?.includes(i.id.toString())&&(dt(!0),Uy(),dt(!1))},[i?.id,G]),(0,d.useEffect)(()=>{t.companyLevelSchedule&&(dt(!1),Uy())},[G]),(0,d.useEffect)(()=>{i?(dt(!0),fs()):t.companyLevelSchedule&&fs()},[z,t.state]),(0,d.useEffect)(()=>{mt.length&&!yn?(es({...mt[0]}),Wt(Z=>Z.slice(1)),mn(!0)):mt.length&&yn&&pn&&setTimeout(()=>{mn(!1)},4e3)},[mt,pn,yn]),(0,d.useEffect)(()=>{sessionStorage.setItem("selectedTab",Qt);let Z=bw(Qt,Ln);Le(Z)},[Qt,Ln]);function En(Z,at,st){Wt([...mt,{title:Z,message:at,severity:st,key:new Date().getTime()}]),mn(!0)}async function Ny(Z,at){let st=fw(Qt,Z,Ln,at),Lt=He()(Ln).format(Ot.OY),tn=new Date(Ln.getFullYear(),Ln.getMonth()+1,0),bn=He()(tn).format(Ot.OY);pe(Lt),Te(bn),hs(st.switchDate),Le(st.switchTitle),ld(st.switchDate),wi(st.switchDate)}const b6=a?yw(t.clickedTab,Qt,As,hs,Ny,Qs,t.lstMyProjects,t.lstTemplateProjects,t.setApplyTemplateOpen,En):xw(t.clickedTab,Qt,As,hs,Ny,Qs,t.lstMyProjects,t.lstTemplateProjects,t.setApplyTemplateOpen,En,t.companyLevelSchedule,j),v6={sortEvents:Fh,eventRenderer:Lh,disableWeekends:!0,nonWorkingDays:Nt?Nt.weekDays:null,dayCellRenderer:function(Z){if(ge(Nt,Z.date,!1,!1))return Z.isNonWorking=!0,Z.cls["b-dynamic-nonworking-day"]=!0,Z.style.fontStyle="italic",Z.style.color="var(--bfs-secondary-support-gray-light) !important",Z.style.backgroundColor="var(--bfs-secondary-support-gray-light)",`${Z.date.getDate()}`}},j6={sortEvents:Fh,eventRenderer:Lh,dayCellRenderer(Z){return ge(Nt,He()(Z.dataset.date).toDate(),!1,!1)&&(Z.className["b-nonworking-day"]=!0,Z.style.color="var(--bfs-secondary-support-gray-light) !important",Z.style.backgroundColor="var(--bfs-secondary-support-gray-light)"),Z}};function A6(Z,at,st,Lt){let tn=ep(Z,st,Lt),bn=at,vn=1,St=He()(tn).add(vn,"day").toDate();for(;bn>1;)ge(Nt,St,st,Lt)||bn--,vn++,St=He()(tn).add(vn,"day").toDate();St=He()(St).subtract(1,"day").toDate();let ks=ep(St,st,Lt);return ks=He()(ks).add(1,"day").toDate(),{startDate:tn,endDate:ks}}async function C6(Z,at){dt(!0);let st;if(a)st={data:{},error:null};else try{st=await lt(o,Z,at)}catch(Lt){n({message:Lt})}if($e(st?.data?.delivery_data),dt(!1),st?.data&&st?.data.exceptions&&st?.data.exceptions.length>0){let Lt="";st.data.exceptions.forEach(tn=>{let vn=`${G.find(St=>St.projectExternalId==tn)?.projectName} -> Can't fetch deliveries.`;Lt=Lt==""?`${Lt} ${vn}`:`${Lt} ,${vn}`}),n({message:Lt})}if(!st?.data){En("Error","Unable to fetch deliveries.","error");return}}async function fs(){if(z.length){dt(!0);let Z=await on(z);Z.error?En("Error",Z.error,"error"):(O(Z.data.resources),W(Z.data.assignments));let at=await gt(z);if(!at.data){En("Error",at.error,"error"),dt(!1);return}let st=at.data,Lt=[],tn=0,bn=[],vn=[];st.forEach(async St=>{if(St.parent_task_id!=0){var ks="#27ca37";const Dn=p.find(sp=>sp.id==St.project_id);Dn&&(ks=Dn?.eventColor);const xa=p.find(sp=>sp.id===St.project_id);let Dr=xa?xa.name:"",{startDate:tp,endDate:np}=A6(new Date(St.start_date),St.duration,St.include_holidays,St.include_weekends);bn.push({id:St.id,task:St,is_new:!1,name:St.name,parent_task_id:St.parent_task_id,project_id:St.project_id,project_name:Dr,eventColor:ks,task_color:St.task_color,startDate:tp,cls:St.task_type=="TODO"?"bullet-style":"",task_type:St.task_type,t_duration:St.duration,endDate:np,manuallyScheduled:!0,editEvent:null,event_type:"task",task_completion_percentage:St.task_completion_percentage,count:0,resourceAssignment:St.resourceAssignment,notes:St.notes,allDay:Qt!="day"})}else St.project_id==i?.id&&(Lt.push({...St,resourceAssignment:St.resourceAssignment}),vn.push({id:St.id,name:St.name,task_type:St.task_type}));tn++}),Jo(vn),await b(bn),t.setApplyByDropdownEnabled(st.length>0),dt(!1)}else i?Q([i.id]):t.companyLevelSchedule&&b([])}const _y=(0,d.useCallback)(async Z=>{let at=Z?`search?search_term=${Z}`:"search";if((Z.length>2||Z.length===0)&&o)try{dt(!0);const st=await nt.Ay.get(`/api/company/${o?.id}/projects/${at}`),Lt=i?.projectName?.length||0;if(st.data){dt(!1);let tn=t.companyLevelSchedule?[]:[{id:i?.id,name:i?.projectName?.padStart(Lt+2," "),projectExternalId:i?.projectExternalId}];if(st.data){let bn=sessionStorage.getItem("selectedResourcesData");if(bn){let Dn=JSON.parse(bn);Dn&&tn.push(...Dn)}st.data.forEach((Dn,xa)=>{const Dr={id:Dn.id,name:Dn.project_name,eventColor:rl[xa%rl.length],projectExternalId:Dn.project_external_id,archived:Dn.archived};let tp=tn.find(np=>Dr.id?np.projectExternalId===Dr.projectExternalId:!1);(t.companyLevelSchedule||Dr.id!==i?.id)&&!Dr?.archived&&!tp&&tn.push(Dr)});let vn=[],St={};for(let Dn in tn){let xa=tn[Dn].projectExternalId;St[xa]=tn[Dn]}for(let Dn in St)vn.push(St[Dn]);let ks=document.querySelector(".sidebar-project-list-custom");t.companyLevelSchedule||(vn.length===1?ks?.classList?.add("empty-list-project-level"):ks?.classList?.remove("empty-list-project-level")),f(vn)}}else dt(!1)}catch{dt(!1),n({message:"Sorry, Something went wrong."})}},[o,i,t.companyLevelSchedule,n]),S6=(0,d.useMemo)(()=>(0,H.debounce)(Z=>{_y(Z)},500),[_y]);function ep(Z,at,st){return ge(Nt,Z,at,st)?ep(He()(Z).add(1,"day").toDate(),at,st):Z}function Uy(){if(p.length===0){const Z=i?.projectName?.length??0,at=t.companyLevelSchedule?[]:[{id:i?.id,name:i?.projectName?.padStart(Z+2," ")}];G&&G.length>0&&(G.forEach((st,Lt)=>{const tn={id:st.id,name:st.projectName,eventColor:rl[Lt%rl.length],projectExternalId:st.projectExternalId,archived:st.archived};(t.companyLevelSchedule||tn.id!==i?.id)&&!tn?.archived&&at.push(tn)}),f(at))}}const Wy=async Z=>{const at=t.companyLevelSchedule?[]:[i?.id];if(Z&&Z.value){let st=t.companyLevelSchedule?[...Z?.value]:[{originalData:A},...Z?.value],Lt=[];C(st);for(const tn of Z.value)tn.originalData.id&&(at.push(tn.originalData.id),Lt.push(tn.data));Q(at),sessionStorage.setItem("selectedResourcesData",JSON.stringify(Lt)),sessionStorage.setItem("selectedProject",at)}};Js.sidebar={items:{eventFilter:null,datePicker:{multiSelect:Qt=="day"?"range":!1,weight:0,listeners:{selectionChange:Z=>{ld(Z.selection[0]),wi(Z.selection[1]);let at=He()(new Date(Z.selection[0])),st=He()(new Date(Z.selection[1])),Lt=at.format("MMMM DD, yyyy");if(hs(Z.selection[0]),Qt==="day"&&Z.selection[0]!==Z.selection[1]){let vn=He()(new Date(Z.selection[0])).format(Ot.OY),St=He()(new Date(Z.selection[1])).format(Ot.OY);pe(vn),Te(St)}else{let vn=new Date(Z.selection[0]).getFullYear(),St=new Date(Z.selection[0]).getMonth(),ks=He()(new Date(vn,St,1)).format(Ot.OY),Dn=He()(new Date(vn,St+1,0)).format(Ot.OY);pe(ks),Te(Dn)}let tn=Lt,bn;at.diff(st)&&(Lt=at.format("MMMM DD"),bn=st.format("DD, yyyy"),tn=`${Lt} - ${bn}`),Le(tn)}}},searchField:{type:"text",weight:299,value:c,placeholder:"Search Projects",listeners:{input:async Z=>{u(Z?.value),S6(Z?.value)}}},resourceFilter:{weight:300,selectAllItem:!0,flex:"0 0 auto",cls:"sidebar-project-list-custom",selected:[...z],listeners:{change:Wy}}}},t.companyLevelSchedule||(Js.sidebar={items:{...Js?.sidebar?.items,selectedProject1:{html:"Active Project",weight:200,type:"checkbox",style:{"font-size":"14px",margin:"0px !important",padding:"0 !important"}},selectedProject:{weight:200,type:"checkbox",text:i?.projectName,readOnly:!0,checked:!0,cls:"fontsize"}}}),Js.autoCreate=!(Qt=="day"||t.companyLevelSchedule),Js.features={drag:{async validateMoveFn(Z){if(Z?.eventRecord?.data?.event_type=="delivery"||Z.eventRecord.data.project_id!==i?.id&&!t.companyLevelSchedule||ge(Nt,new Date(Z.eventRecord.startDate),Z.eventRecord.data.task.include_holidays,Z.eventRecord.data.task.include_weekends))return!1;let at={id:Z.eventRecord.data.task.id,name:Z.eventRecord.data.task.name,parent_task_id:Z.eventRecord.data.task.parent_task_id,start_date:He()(Z.eventRecord.startDate).format(Ot.OY)+" 00:00:00",duration:Z.eventRecord.data.task.duration,end_date:He()(Z.eventRecord.endDate).format(Ot.OY)+" 00:00:00",project_id:Z.eventRecord.data.project_id,task_color_id:Z.eventRecord.data.task.task_color!=null?Z.eventRecord.data.task.task_color.id:null};dt(!0);let st=await rt(Z.eventRecord.data.task.id,at,Z.eventRecord.data.project_id);if(st.data)dt(!1),fs(),Q(Js?.sidebar?.items?.resourceFilter?.selected),Zu();else return En("Error",st.error,"error"),dt(!1),!1},async validateResizeFn(Z){if(Z.eventRecord.data.project_id!==i?.id&&!t.companyLevelSchedule)return!1;let at={id:Z.eventRecord.data.task.id,name:Z.eventRecord.data.task.name,parent_task_id:Z.eventRecord.data.task.parent_task_id,start_date:He()(Z.eventRecord.startDate).format(Ot.OY)+" 00:00:00",duration:hw(He()(Z.eventRecord.startDate).toDate(),He()(Z.eventRecord.endDate).toDate(),Nt,Z.eventRecord.data.task.include_holidays,Z.eventRecord.data.task.include_weekends),end_date:He()(Z.eventRecord.endDate).format(Ot.OY)+" 00:00:00",project_id:Z.eventRecord.data?.project_id,task_color_id:Z.eventRecord.data.task.task_color!=null?Z.eventRecord.data.task.task_color.id:null};dt(!0);let st=await rt(Z.eventRecord.data.task.id,at,Z.eventRecord.data?.project_id);if(st.data)dt(!1),fs(),Q(Js?.sidebar?.items?.resourceFilter?.selected),Zu();else return En("Error",st.error,"error"),dt(!1),!1}},eventTooltip:{align:"l-r",showOn:"hover",renderer:jw},scheduleMenu:{items:{addEvent:Qt!="day"}}},a&&(Js.sidebar=!1),Js.readOnly=a;const w6=async Z=>{if(Z.eventRecords[0].data.event_type=="delivery")return Z.context.finalize(!1),fs(),En("Error","Cannot Delete Delivery","error"),!1;if(Z.eventRecords[0].data.project_id!=i?.id)return fs(),En("Error","Cannot Delete Task From Other Projects","error"),!1;const at=await lo.E1Z.confirm({title:"Please confirm",message:"Are You sure want to delete this task",okButton:"Confirm"});if(at==1){var st=[];st.push(Z.eventRecords[0].data.id);let Lt=st.length===R.length?null:{ids:st};(await Ue(Lt)).data?(fs(),En("Success","Task Deleted Successfully","success")):(fs(),En("Error","Cannot Delete Task","error"))}else at==3&&fs();return!1},E6=async Z=>{if(Z.eventRecord.data.is_new==!1){let at={id:Z.eventRecord.data.id,name:Z.eventRecord.data.name,parent_task_id:Pe,task_status_id:Ct,start_date:(ht?He()(ht).format(Ot.OY):He()(Z.eventRecord.startDate).format(Ot.OY))+" 00:00:00",duration:Z.eventRecord.data.t_duration,task_completion_percentage:Z.eventRecord.data.task_completion_percentage,end_date:He()(Z.eventRecord.endDate).format(Ot.OY)+" 00:00:00",assigned_to:Tn??"",project_id:i?.id,task_color_id:Z.eventRecord.data.task.task_color!=null?Z.eventRecord.data.task.task_color.id:null,include_holidays:Z.eventRecord.data.includeHolidays,include_weekends:Z.eventRecord.data.includeWeekends},st=await rt(Z.eventRecord.data.id,at);if(!st.data){En("Error",st.error,"error"),fs();return}En("Success","Tasks updated Successfully","success")}else{let at={id:0,name:Z.eventRecord.data.name,parent_task_id:Pe,task_status_id:Ct,start_date:He()(Z.eventRecord.startDate).format(Ot.OY)+" 00:00:00",duration:Z.eventRecord.data.t_duration,task_completion_percentage:Z.eventRecord.data.task_completion_percentage,end_date:He()(Z.eventRecord.endDate).format(Ot.OY)+" 00:00:00",assigned_to:Tn??"",project_id:i?.id,task_color_id:null,include_holidays:Z.eventRecord.data.includeHolidays,include_weekends:Z.eventRecord.data.includeWeekends},st=await Rt(at);if(!st.data){En("Error",st.error,"error"),fs();return}En("Success","Task added Successfully","success")}fs()};function P6(Z){if(ge(Nt,Z.date,!1,!1)){var at=We(Nt,Z.date);return En("Warning",at.description,"warning"),!1}}let I6=async Z=>{let at=await xn(Z);at.data?Jo(at.data):En("Error",at.error,"error")};const D6=Z=>{if(Xt(null),In(null),Qe(null),Mt(null),Z.eventRecord.data.task&&Z.eventRecord.data.task.project_id!==i?.id&&!t.companyLevelSchedule||t.companyLevelSchedule&&!Z.eventRecord.data.project_id)return!1;if(I6(Z.eventRecord.data.task?.project_id),ge(Nt,Z.eventRecord.data.startDate,Z.eventRecord.data.task?Z.eventRecord.data.task.include_holidays:!1,Z.eventRecord.data.task?Z.eventRecord.data.task.include_weekends:!1)){const Lt=We(Nt,Z.eventRecord.data.startDate);return En("Warning",Lt.description,"warning"),!1}if(Z.eventRecord.data.event_type=="delivery")return En("Error","Cannot Edit Delivery","error"),!1;let at=Z.eventRecord.data.task;F(!at);let st={...at,start_date:Z.eventRecord.data.startDate,end_date:Z.eventRecord.data.endDate,resources:Z.eventRecord.data.resources,assignments:Z.eventRecord.data.assignments};return ue(st),Z.eventRecord.data.task_type==="TODO"?X(!0):$(!0),!1},k6=Z=>{Z.eventRecord.data.event_type=="delivery"&&(zt(Z.eventRecord.data.task),ns(!0))},T6=Z=>{if(t.companyLevelSchedule)return!1;if(ge(Nt,Z.date,!1,!1)){const at=We(Nt,Z.date);return En("Warning",at.description,"warning"),!1}return!0};let pd=sessionStorage?.getItem("selectedProject");const R6=(0,d.useMemo)(()=>P.map(Z=>({id:Z.originalData.id,name:Z.originalData.name,projectExternalId:Z.originalData.projectExternalId})),[P]),O6=(Z,at)=>{C(st=>st.map(Lt=>Lt.originalData.projectExternalId===Z?{...Lt,originalData:{...Lt.originalData,id:at}}:Lt))};return i||t.companyLevelSchedule?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(kr.A,{"data-testid":"error",open:pn,autoHideDuration:2e3,TransitionProps:{onExited:()=>{es(void 0)}},onClose:()=>{mn(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},message:yn?yn.message:void 0,children:(0,e.jsxs)(Rs.A,{severity:yn?.severity,children:[(0,e.jsx)(Tr.A,{children:yn?.title})," ",yn?.message]})},yn?yn.key:void 0),a?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(tw,{closeModal:()=>$(!1),modalIsOpen:V,currentTaskData:re,taskList:R,taskStatusList:t.taskStatusList,phaseList:gs,crewMembers:t.crewMembers,setMessage:En,refresh:fs,isNewTask:le,holidays:Nt,resources:N,assignments:T.filter(Z=>Z.event===re.id)}),(0,e.jsx)(Mh,{phaseList:gs,taskStatusList:t.taskStatusList,selectedTab:t.selectedTab,modalIsOpen:ee,taskList:R,setModalIsOpen:X,todoItem:re,refresh:fs,setMessage:En,dependencies:t.dependencies,dependenciesData:t.dependenciesDataList,status:gn.e1.NotStarted,resources:N,assignments:T.filter(Z=>Z.event===re.id)})]}),(0,e.jsx)(uw,{companyLevelSchedule:t.companyLevelSchedule,projectList:R6,open:Ir,closeModal:()=>ns(!1),selectedDelivery:yt,project:i,addProjectIdToState:O6}),(0,e.jsx)("div",{id:"container",className:`${(t.companyLevelSchedule?"company-level-schedule":"project-level-schedule")+" cal-cell-fix-height"}`,children:o&&(!pd?.split(",")?.length||pd?.split(",")?.length===1&&pd?.split(",")[0]===""||Js?.sidebar?.items?.resourceFilter.selected.length===pd?.split(",").length)&&(0,e.jsx)(Aw,{ref:l,config:Js,height:"80vh",mode:Qt,events:k,resources:p,tbar:b6,date:Ln,monthViewRenderer:v6,viewRenderer:j6,onSelectionChange:Wy,eventMenuFeature:ud,onBeforeEventEdit:D6,onAfterEventSave:E6,onBeforeEventDelete:w6,nonWorkingDays:Nt?Nt.weekDays:null,onScheduleDblClick:P6,onEventClick:k6,onBeforeAutoCreate:T6,onScheduleMenuBeforeShow:cd,startDate:fa,endDate:dd})}),(0,e.jsx)(rr.A,{open:Xe,invisible:!0,sx:{zIndex:Z=>Z.zIndex.drawer+1},children:(0,e.jsx)(bt.A,{})})]}):(0,e.jsx)(e.Fragment,{})};var al=m(51926),Vr={};Vr.styleTagTransform=zs(),Vr.setAttributes=Us(),Vr.insert=_s().bind(null,"head"),Vr.domAPI=Ns(),Vr.insertStyleElement=Ws();var V_=Bs()(al.A,Vr);const $_=al.A&&al.A.locals?al.A.locals:void 0;var Nh=m(40921),_h=m(48719),Uh=m(16576),Cw=m(72048);const Sw=m.p+"70b5a28f5c9f52cd422122273a1cf118.svg",ww=m.p+"034128463e85e4df008e48696062f5bc.svg",Ew=m.p+"9bf2e499a9f8e48975fb036942d9650e.png",rc=(0,g.Ay)(pt.A)({width:"30px !important"}),Pw=({status:t,itemId:n,setEditTaskModalIsOpen:s,setDeleteTaskId:o,createdById:r})=>{const{getRoleFromPermissions:a}=(0,we.Sk)(),{project:i}=(0,De.B)(),l=a({tool:D.w5.SCHEDULE,action:D.a2.EDIT_TASKS,companyId:i?.companyId,projectId:i?.id}),{user:c}=(0,Pt.A)(),u=l===we.wy.Subs,p=t===gn.e1.Completed&&r===c?.id;return u&&!p?null:t===gn.e1.Open?(0,e.jsx)(rc,{onClick:()=>s(!0),children:(0,e.jsx)("img",{alt:"open-task-icon","data-testid":"openIcon",src:Sw})}):t===gn.e1.NotStarted?(0,e.jsx)(rc,{onClick:()=>s(!0),children:(0,e.jsx)("img",{alt:"scheduled-task-icon","data-testid":"scheduledIcon",src:ww})}):t===gn.e1.Completed?(0,e.jsx)(rc,{onClick:()=>o(n),children:(0,e.jsx)("img",{alt:"completed-task-icon",src:Ew,"data-testid":"completedIcon"})}):null},Iw=t=>{const[n,s]=(0,d.useState)(t.item.name),[o,r]=(0,d.useState)(!1),[a,i]=(0,d.useState)(null),l=p=>{s(p.target.value),p.target.value.trim()!=""?i(null):i("Name cannot be empty.")},c=p=>{p.preventDefault(),a==null&&(t.inlineUpdateTask(t.item.id,n),t.setAutoFocus(null))},u=(p,f)=>{t.updateTaskStatus(p,f)};return(0,d.useEffect)(()=>{s(t.item.name)},[t.item.name]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"todo-content",children:[(0,e.jsxs)("div",{className:"todo-checkbox-and-label",children:[(0,e.jsx)("div",{"data-testid":"checkbox",style:kS,onClick:()=>{},children:t.status==gn.e1.Completed?(0,e.jsx)(ys.b7E,{fill:"black",size:14,onClick:()=>{u(t.item.id,t.taskStatusList.filter(p=>p.id==gn.e1.NotStarted)[0].id)}}):(0,e.jsx)(ys.LvK,{fill:"black",size:14,onClick:()=>{u(t.item.id,t.taskStatusList.filter(p=>p.id==gn.e1.Completed)[0].id)}})}),(0,e.jsx)("div",{}),t.item.id==0||t.autoFocus==t.item.id?(0,e.jsxs)("form",{onSubmit:c,children:[(0,e.jsx)("input",{className:"sidepanel-input",autoFocus:t.item.id==0||t.autoFocus==t.item.id,value:n,onChange:l,"data-testid":"todo-input",onBlur:p=>{a==null?(t.inlineUpdateTask(t.item.id,n),t.setAutoFocus(null)):(s(t.item.name),i(null))},onFocus:p=>p.target.select()},t.item.id),a&&(0,e.jsx)("span",{className:"sidepanel-error",children:a})]}):(0,e.jsx)("label",{className:t.status===gn.e1.Open||t.status===gn.e1.Completed&&!t.item.start_date?"sidepanel-input-open-state sidepanel-input-label":"sidepanel-input-label","data-testid":"todo-input-label",onClick:()=>{i(null),t.setAutoFocus(t.item.id),s(t.item.name)},children:t.item.name})]}),t.status!=gn.e1.Open&&t.item.start_date!=null&&(0,e.jsx)("label",{style:Va,children:He()(new Date(t.item.start_date)).format(Ot.SH)}),(0,e.jsx)(Pw,{status:t.status,itemId:t.item.id,setEditTaskModalIsOpen:r,setDeleteTaskId:t.setDeleteTask,createdById:t.item.created_by})]},t.item.id),(0,e.jsx)(Mh,{phaseList:t.phaseList,taskStatusList:t.taskStatusList,crewMembers:t.crewMembers,modalIsOpen:o,setModalIsOpen:r,todoItem:t.item,refresh:t.refresh,setMessage:t.setMessage,taskList:t.taskList,dependencies:t.dependencies,status:t.status,resources:t.resources,assignments:t.assignments})]})},ac=t=>(0,e.jsx)("div",{className:"sidepanel-inner-content",children:(0,e.jsxs)(Nh.A,{defaultExpanded:!0,children:[t.status==gn.e1.Completed?(0,e.jsx)(_h.A,{expandIcon:(0,e.jsx)(Cw.A,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:(0,e.jsx)("div",{className:"sidepanel-status",children:t.label})}):(0,e.jsx)("div",{className:"sidepanel-status",children:t.label}),(0,e.jsx)(Uh.A,{children:t.listTasks&&t.listTasks.map((n,s)=>(0,e.jsx)(Iw,{setNewTaskObject:t.setNewTaskObject,resources:t.resources,assignments:t.assignments&&t.assignments.filter(o=>o.event===n.id),autoFocus:t.autoFocus,updateTaskStatus:t.updateTaskStatus,setAutoFocus:t.setAutoFocus,inlineUpdateTask:t.inlineUpdateTask,item:n,status:t.status,setDeleteTask:t.setDeleteTask,phaseList:t.phaseList,taskStatusList:t.taskStatusList,crewMembers:t.crewMembers,refresh:t.refresh,setMessage:t.setMessage,taskList:t.taskList,dependencies:t.dependencies},n.id))})]})}),H_="'To-Do's",Dw=t=>{const{addNewTask:n,deleteTask:s,updateTask:o,fetchTodoList:r,fetchPhaseList:a,fetchTasksList:i,fetchDependencies:l,fetchResourceAssignments:c}=(0,Xs.P)(t.project?.id),[u,p]=(0,d.useState)(null),[f,h]=(0,d.useState)([]),[b,x]=(0,d.useState)(!1),[v,y]=(0,d.useState)(!1),[j,A]=(0,d.useState)([]),[w,P]=(0,d.useState)(!1),[C,k]=(0,d.useState)([]),[S,R]=(0,d.useState)([]),[B,T]=(0,d.useState)(void 0),[W,N]=(0,d.useState)(null),[O,z]=(0,d.useState)([]),[Q,re]=(0,d.useState)([]);let[ue,le]=(0,d.useState)([]);function F(me,$e,gt){A([...j,{title:me,message:$e,severity:gt,key:new Date().getTime()}]),P(!0)}async function V(){let me=await a();me.data?h(me.data):F("Error",me.error,"error")}async function $(){let me=await i(),$e=[];me.data.forEach(async gt=>{$e.push({...gt,start_date:(0,Ot.pv)(gt.start_date),end_date:(0,Ot.pv)(gt.end_date),include_holidays:gt.include_holidays,include_weekends:gt.include_weekends})}),await re($e)}const ee=async()=>{let me=await r();z(me.data)},X=async()=>{let me=await l();if(me.data){let $e=[];me.data.forEach(gt=>{$e.push({id:gt.id,from:gt.from_task,to:gt.to_task,lag:gt.lag,type:gt.type})}),le($e)}else F("Error",me.error,"error")};async function G(){let me=await c([t.project?.id]);me.error?F("Error",me.error,"error"):(R(me.data.resources),k(me.data.assignments))}(0,d.useEffect)(()=>{t.project?.id&&t.companyLevelSchedule===!1&&(V(),G(),ee(),$(),X())},[t.project]),(0,d.useEffect)(()=>{b&&t.project?.id&&t.companyLevelSchedule===!1&&V()},[b]),(0,d.useEffect)(()=>{j.length&&!B?(T({...j[0]}),A(me=>me.slice(1)),P(!0)):j.length&&B&&w&&setTimeout(()=>{P(!1)},4e3)},[j,w,B]);const Y=async()=>{const me={name:"New Todo",project_id:t.project.id,parent_task_id:0,task_status_id:null,duration:1,include_holidays:!1,include_weekends:!1,sequence:1,task_type:"TODO"},$e=await n(me);if(!$e.data){F("Error",$e.error,"error");return}ee(),G(),f.filter(Rt=>Rt.taskType=="TODO").length==0&&V(),p($e.data.task_id)},he=async(me,$e)=>{const Rt=await o(me,{name:$e});Rt.data||F("Error",Rt.error,"error"),ee(),G(),Rt.data.filter(Ue=>Ue.id==me).length>0&&t.refresh("update")},ne=async(me,$e)=>{y(!0);const Rt={task_completion_percentage:(0,gn.DX)($e,$e),task_status_id:$e,id:me},rt=await o(me,Rt);rt.data||(F("Error",rt.error,"error"),y(!1)),y(!1),ee(),G(),rt.data.filter(lt=>lt.id==me).length>0&&t.refresh("update")},J=async()=>{y(!0);const $e=await s({ids:[W]});$e.data?(F("Success","Tasks deleted successfully","success"),y(!1),ee(),G(),O.filter(gt=>gt.id==W)[0].start_date&&t.refresh("delete")):(F("Error",$e.error,"error"),y(!1)),N(null)},pe=()=>{ee(),G(),x(!b)},Ee=me=>{me=="update"&&t.refresh(),ee(),G()},Te=["Are you sure you want to delete these Tasks?","Do you wish to continue?"];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(kr.A,{"data-testid":"error",open:w,autoHideDuration:2e3,TransitionProps:{onExited:()=>{T(void 0)}},onClose:()=>{P(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},message:B?B.message:void 0,children:(0,e.jsxs)(Rs.A,{severity:B?.severity,children:[(0,e.jsx)(Tr.A,{children:B?.title})," ",B?.message]})},B?B.key:void 0),(0,e.jsxs)("div",{className:"sidepanel-wrapper",children:[(0,e.jsx)("div",{className:`sidepanel-left ${b?"open-left-wrap":"close-left-wrap"}`,onClick:()=>{x(!1)}}),(0,e.jsxs)("div",{className:`sidepanel ${b?"open-panel":"close-panel"}`,children:[(0,e.jsx)("div",{className:"sidepanel-tab",onClick:()=>pe(),children:(0,e.jsx)("span",{children:"My To-Do's"})}),(0,e.jsxs)("div",{style:{overflowY:"scroll",height:"90vh"},children:[" ",(0,e.jsxs)("div",{className:"sidepanel-inner",children:[(0,e.jsxs)("div",{className:"sidepanel-inner-top",children:["My To-Do List",(0,e.jsx)(K.A,{style:{borderRadius:"10px"},"data-testid":"add-todo",variant:"contained",onClick:()=>{Y()},children:"New"})]}),(0,e.jsx)(ac,{autoFocus:u,resources:S,assignments:C,setAutoFocus:p,updateTaskStatus:ne,inlineUpdateTask:he,status:gn.e1.Open,label:"Open",listTasks:O&&O.filter(me=>me.task_status_id==null||(me.start_date==null||me.start_date=="")&&me.task_status_id==gn.e1.NotStarted),phaseList:f,taskStatusList:t.taskStatusList,crewMembers:t.crewMembers,refresh:me=>{Ee(me)},setMessage:t.setMessage,taskList:Q}),(0,e.jsx)(ac,{autoFocus:u,resources:S,assignments:C,setAutoFocus:p,updateTaskStatus:ne,inlineUpdateTask:he,status:gn.e1.NotStarted,label:"Scheduled",listTasks:O&&O.filter(me=>me.start_date!=null&&me.start_date!=""&&me.task_status_id==gn.e1.NotStarted),phaseList:f,taskStatusList:t.taskStatusList,crewMembers:t.crewMembers,refresh:me=>{Ee(me)},setMessage:t.setMessage,taskList:Q,dependencies:ue}),(0,e.jsx)(ac,{autoFocus:u,resources:S,assignments:C,setAutoFocus:p,inlineUpdateTask:he,status:gn.e1.Completed,label:"Completed",updateTaskStatus:ne,listTasks:O&&O.filter(me=>me.task_status_id==gn.e1.Completed),setDeleteTask:me=>{N(me)},phaseList:f,taskStatusList:t.taskStatusList,crewMembers:t.crewMembers,refresh:me=>{Ee(me)},setMessage:t.setMessage,taskList:Q})]})]})]})]}),(0,e.jsx)(rr.A,{open:v,invisible:!0,sx:{zIndex:me=>me.zIndex.drawer+1},children:(0,e.jsx)(bt.A,{})}),(0,e.jsx)(Uo,{title:"This To-Do task will be deleted        ",message:Te,open:W!=null,onClose:()=>N(null),onConfirm:J,loading:!1,closeButtonText:"Go Back",submitButtonText:"Delete"})]})};var il=m(9755);(0,AS.um)();const kw=Lr()(()=>m.e(474).then(m.bind(m,33474)),{ssr:!1}),Tw=Lr()(()=>Promise.all([m.e(670),m.e(288)]).then(m.bind(m,39288)),{ssr:!1}),Wh=()=>{const t=(0,d.useRef)(),n=(0,L.useLocation)(),{isAppEmbedded:s}=Os(),{allRoles:o}=(0,we.Sk)(),{project:r,clearSelectedProject:a}=(0,De.B)(),{accessToken:i}=(0,Pt.A)(),[l,c]=(0,d.useState)(new il.NNt),{createEvent:u}=(0,On.AG)(),[p,f]=(0,d.useState)([]),[h,b]=(0,d.useState)([]),[x]=(0,d.useState)(!0),[v,y]=(0,d.useState)(null),{fetchTaskStatus:j,fetchTaskColors:A,fetchScheduledItemsProjectList:w,fetchScheduledItemsTemplates:P,fetchNonWorkingDays:C}=(0,Xs.P)(r?.id),{fetchCompanyCrewInfo:k}=(0,xd.A)(r?.id,r?.companyId),{company:S}=(0,je.P)(),[R,B]=(0,d.useState)([]),[T,W]=(0,d.useState)([]),[N,O]=(0,d.useState)(!1),[z,Q]=(0,d.useState)(void 0),[re,ue]=(0,d.useState)(!1),[le,F]=(0,d.useState)([]),[V,$]=(0,d.useState)([]),[ee,X]=(0,d.useState)(!1),[G,Y]=(0,d.useState)(()=>{const ge=sessionStorage.getItem("selectedTab");let We=window.location.search;return new URLSearchParams(We).get("view")=="gantt"?"gantt":ge!==null?ge:"scheduler"});var he={weekDays:{0:!1,1:!1,2:!1,3:!1,4:!1,5:!1,6:!1},holidays:[]};const[ne,J]=(0,d.useState)(he),{canViewPage:pe}=(0,$n.s)();(0,d.useEffect)(()=>{r&&$e(),n?.pathname?.includes("companies")?(y(!0),a()):n?.pathname?.includes("projects")&&y(!1)},[]),(0,d.useEffect)(()=>{r&&$e()},[r?.id]),(0,d.useEffect)(()=>{r?(u({content_type:"project",object_id:r.id,tool:"schedule"}),Rt()):S?.id&&u({content_type:"company",object_id:S.id,tool:"schedule"}),gt(),me()},[r]),(0,d.useEffect)(()=>{sessionStorage.setItem("selectedTab",G)},[G,r]);const Ee=(0,d.useCallback)((ge,We,At)=>{W([...T,{title:ge,message:We,severity:At,key:new Date().getTime()}]),O(!0)},[T,W,O]);(0,d.useEffect)(()=>{T.length&&!z?(Q({...T[0]}),W(ge=>ge.slice(1)),O(!0)):T.length&&z&&N&&setTimeout(()=>{O(!1)},4e3)},[T,N,z]),(0,d.useEffect)(()=>{if(S){let ge=[];S.CompanyManagers?.forEach(We=>{ge=Te(We,ge)}),S.companyCrew?.forEach(We=>{ge=Te(We,ge)}),S.Subs?.forEach(We=>{ge=Te(We,ge)}),ge.unshift("Not Assigned"),B(ge)}},[S]);function Te(ge,We){return ge.name&&ge.name.length>0?We.push(ge.name):We.push(ge.email),We}async function me(){let ge=await C();if(ge.data){let We=ge.data;he.weekDays=We.week_days,We.holidays.forEach(At=>{let xn={description:At.description,date:new Date(At.date+" 00:00:00")};he.holidays.push(xn)}),J(he)}}async function $e(){r&&(await w(r.companyId).then(ge=>{let We=ge.data.map(At=>({value:At.id,label:At.name}));F(We)}),await P(r.companyId).then(ge=>{let We=ge.data.map(At=>({value:At.id,label:At.name}));$(We)}))}async function gt(){let ge=await j();ge.error?Ee("Error",ge.error,"error"):f(ge.data),await k()}async function Rt(){let ge=await A();ge.error?Ee("Error",ge.error,"error"):b(ge.data)}const[rt,Ue]=se().useState(!1),lt=se().useCallback(()=>Ue(!rt),[rt]);return(0,d.useEffect)(()=>{r?.id&&S?.id&&c((0,gn.RX)(r.id,S.id,i)),t.current&&t.current.instance.mask("Loading...")},[r?.id,S?.id,i,rt,G]),s&&(0,ct.MI)(o)?(0,e.jsx)(e.Fragment,{children:pe&&(0,e.jsx)("div",{style:{paddingTop:"0px",height:"100%",margin:"24px",backgroundColor:"#fff"},children:(0,e.jsx)(oc,{setApplyByDropdownEnabled:X,clickedTab:ge=>Y(ge),selectedMode:"month",taskColorsList:h,taskStatusList:p,crewMembers:R,setApplyTemplateOpen:ue,lstMyProjects:le,lstTemplateProjects:V,applyTemplateOpen:re,companyLevelSchedule:!1,holidayList:ne})})}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),pe&&(0,e.jsxs)(e.Fragment,{children:[r&&v===!1&&(0,e.jsx)(Dw,{refresh:lt,project:r,taskStatusList:p,setMessage:Ee,crewMembers:R,companyLevelSchedule:v}),v&&(0,e.jsx)(wh,{children:(0,e.jsx)("div",{style:{paddingTop:"0px",height:"100%",margin:"24px",backgroundColor:"#fff"},children:(0,e.jsx)(oc,{setApplyByDropdownEnabled:X,clickedTab:ge=>Y(ge),selectedMode:v?"month":G,taskColorsList:h,taskStatusList:p,crewMembers:R,setApplyTemplateOpen:ue,lstMyProjects:le,lstTemplateProjects:V,applyTemplateOpen:re,setLoading:x,companyLevelSchedule:v,holidayList:ne})})}),r&&!v&&(0,e.jsx)(wh,{children:(0,e.jsxs)(vS,{children:[(0,e.jsx)(kr.A,{"data-testid":"error",open:N,autoHideDuration:2e3,TransitionProps:{onExited:()=>{Q(void 0)}},onClose:()=>{O(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},message:z?z.message:void 0,children:(0,e.jsxs)(Rs.A,{severity:z?.severity,children:[(0,e.jsx)(Tr.A,{children:z?.title})," ",z?.message]})},z?z.key:void 0),(0,e.jsx)(ew,{open:re,setApplyByDropdownEnabled:X,applyByDropdownEnabled:ee,project:r,closeModal:()=>ue(!1),company:S,lstMyProjects:le,lstTemplateProjects:V,setMessage:Ee,refresh:lt}),(0,e.jsxs)(jS,{children:[G=="scheduler"&&(0,e.jsx)("div",{style:{paddingTop:"0px",height:"100%",margin:"24px",backgroundColor:"#fff"},children:(0,e.jsx)(Tw,{projectModel:l,setApplyByDropdownEnabled:X,ganttRef:t,selectedTab:G,setTabSelected:Y,lstMyProjects:le,lstTemplateProjects:V,setApplyTemplateOpen:ue,setMessage:Ee,crewMembers:R,taskStatusList:p})}),(G=="month"||G=="week"||G=="day")&&(0,e.jsx)("div",{style:{paddingTop:"0px",height:"100%",margin:"24px",backgroundColor:"#fff"},children:(0,e.jsx)(oc,{setApplyByDropdownEnabled:X,clickedTab:ge=>Y(ge),selectedMode:G,taskColorsList:h,taskStatusList:p,crewMembers:R,setApplyTemplateOpen:ue,lstMyProjects:le,lstTemplateProjects:V,applyTemplateOpen:re,state:rt,holidayList:ne})}),G=="gantt"&&(0,e.jsx)("div",{style:{paddingTop:"0px",height:"100%",margin:"24px",backgroundColor:"#fff"},children:(0,e.jsx)(kw,{projectModel:l,setApplyByDropdownEnabled:X,ganttRef:t,selectedTab:G,setTabSelected:Y,lstMyProjects:le,lstTemplateProjects:V,setApplyTemplateOpen:ue,setMessage:Ee,crewMembers:R,taskStatusList:p})})]})]})})]})]})},ll=(0,Lo.xP)({baseQuery:(0,Zo.S)({baseUrl:"/api"}),reducerPath:"costCodes",tagTypes:["CostCode"],endpoints:t=>({saveCostCodeChanges:t.mutation({query:({companyId:n,...s})=>({url:`/v2/company/${n}/cost_codes`,method:"POST",data:s})}),getCostCodes:t.query({query:n=>({url:`/v2/company/${n}/cost_codes`,method:"GET"}),providesTags:["CostCode"]})})}),{useSaveCostCodeChangesMutation:zh,useGetCostCodesQuery:ar,useLazyGetCostCodesQuery:Rw}=ll,ic=t=>({routes:(0,d.useMemo)(()=>t.filter(s=>!s.hidden),[t])});var Ow=m(61604),Vh=m(71644),Mw=m(69135),Lw=m(79418),ir=m(91434),ds=m(47016),Fw=m(1301),Bw=m(270);const lc="Other (Undefined Cost Code)",jo="__other__",lr="Miscellaneous Expenses",Ao="No Listed PO#",$a="No Listed Vendor",dc=(t,n)=>{if(t?.parentPath){const s=t.parentPath.map(o=>o.codeDescription);return t.childrenCount>0?{path:[...s,lr],isMiscellaneousRow:!0}:{path:s,isMiscellaneousRow:!1}}return{path:[n],isMiscellaneousRow:!1}},Co=t=>t.type==="group"||t.type==="leaf"?String(t.groupingKey):"",cc={costCode:"Cost Code",purchaseOrder:"Purchase Order",vendor:"Vendor"},Nw=t=>!!(t&&t in cc);var _w=m(47815);const $h="negative",cs=({value:t})=>typeof t=="number"&&t<0?$h:"",vt=t=>{const n=(0,Ze.up)(t??0);return n==="$0.00"?"-":n},Uw=new Intl.NumberFormat("en-US",{style:"percent",maximumFractionDigits:2}),uc=(t,n)=>{if(typeof t!="number")return n?.noValue??"";const s=Uw.format(t/100);return typeof n?.zero<"u"&&t===0?n.zero:s},$r=t=>uc(t,{noValue:"-"}),Ww=600,zo=t=>{if(t){const n=window.scrollY+t.getBoundingClientRect().top;t.style.height=`${Math.max(window.innerHeight-n-20,Ww)}px`}},us=t=>t?(t instanceof Date?t:new Date(t)).toISOString().slice(0,10):null,Ha="revenueToolbar",dl="expensesToolbar";function Q_(t,n,s,o,r){return!((n||s)&&!o&&!r||!t||n&&!o&&!r)}const G_=t=>{Mask.mask({text:t,mode:"dark-blur"},document.body)},K_=()=>{Mask.unmask(document.body)},dr="__totals__",ps=t=>({row:n,field:s,value:o})=>{const r=(0,ds.h)(),a=(0,Fw.uz)(r),i="isAggregationRow"in n&&n.isAggregationRow?a[Bw.OL]?.[s].value:o,l=t(i),c=cs({value:i});return(0,e.jsx)("div",{className:c,children:l})},cl=(t,n,s,o)=>{const r=t||Co(s.rowNode),a=n||Co(o.rowNode);return r===lc||r===lr?-1:a===lc||a===lr?1:r.localeCompare(a)},Hh="costCodeLabel",zw={field:Hh,headerName:"Cost Code",type:"string",valueGetter:(t,n)=>n.isMiscellaneousRow?lr:t,sortComparator:cl},zn="createdAt",Zs={field:zn,headerName:"Created At",type:"dateTime"},Y_="__temp__",eo=t=>(0,d.useCallback)(n=>{if("isAggregationRow"in n.row&&n.row.isAggregationRow)return"";const s=t.current.getSortedRowIds().filter(r=>t.current.getRowNode(r)?.depth===0);let o=t.current.getRowNode(n.id);for(;o&&o.parent&&o.depth!==0;)o=t.current.getRowNode(o.parent);return o&&s.indexOf(o.id)%2?"gray":""},[t]),Vw="ids",Qa=()=>{const[t]=(0,L.useSearchParams)(),n=t.get(Vw);return(0,d.useMemo)(()=>n?.split(",")??[],[n])},pc=()=>{const t=Qa();return(0,d.useCallback)(n=>t.includes(String(n.row.id))?"highlight":"",[t])},$w=200,Qh=(t,n,{skip:s}={skip:!1})=>{const o=(0,d.useRef)(!1),r=Array.isArray(n)?n.map(String):[String(n)];(0,d.useEffect)(()=>t.current.subscribeEvent("stateChange",i=>{const l=i.sorting.sortedRows;if(!s&&l.length&&!o.current){o.current=!0;const c=l.map(String),u=(Array.isArray(r)?r:[r]).reduce((p,f)=>Math.min(p,c.indexOf(f)),1/0);u!==1/0&&u!==-1&&setTimeout(()=>{t.current.setPage(Math.floor(u/i.pagination.paginationModel.pageSize)),t.current.scrollToIndexes({rowIndex:u})},$w)}}),[r,s])},mc=t=>{const n=Qa();Qh(t,n)},Gh=(...t)=>n=>t.map(s=>s(n)).filter(s=>s).join(" "),So=(t,n)=>{const{project:s}=(0,De.B)(),{company:o}=(0,je.P)(),{userHasPermission:r}=(0,Ye.A)();return r({tool:t,action:n,companyId:o?.id,projectId:s?.id})},Kh=(0,d.forwardRef)(({onChange:t,...n},s)=>(0,e.jsx)(_w._g,{...n,mask:Number,unmask:!0,radix:".",thousandsSeparator:",",inputRef:s,onAccept:o=>t({target:{name:n.name,value:o}})})),hc=t=>{const[n,s]=(0,d.useState)(!1),{showError:o,showSuccess:r}=(0,Fe.d)(),[a,i]=(0,d.useState)(!1),[l,c]=(0,d.useState)(),[u,p]=(0,d.useState)(),[f,h]=(0,d.useState)([]),[b,x]=(0,d.useState)({account_mapping:[],qb_vendor_mapping:[],project_customer_mapping:[],vendor_mapping:[]}),[v,y]=(0,d.useState)([]),[j,A]=(0,d.useState)([]),[w,P]=(0,d.useState)([]),C=(0,d.useCallback)(async()=>{s(!0);try{const N=await nt.Ay.get(`/budgeting/company/${t}/quickbooks_entities`);N.data&&(y(N.data?.accounts?.map(O=>({value:O.id,label:O.text}))),A(N.data?.vendors?.map(O=>({value:O.id,label:O.text}))),P(N.data?.customers?.map(O=>({value:O.id,label:O.text}))))}catch{o({message:"Failed to fetch QuickBooks Accounts"})}finally{s(!1)}},[t,o]),k=(0,d.useCallback)(async()=>{s(!0);try{const N=await nt.Ay.get(`/budget/v2/company/${t}/vendors`);N.data&&N.data.length>0&&h(N.data.map(O=>({value:O.id,label:O.name})))}catch(N){const O="Failed to fetch Vendors";console.error(O,N),o({message:O})}finally{s(!1)}},[t,o]),S=(0,d.useCallback)(async()=>{s(!0);try{const N=await nt.Ay.get(`/budgeting/company/${t}/quickbooks_mappings`);N.data&&N.data.length>0&&x(N.data[0])}catch(N){const O="Failed to fetch Mappings";console.error(O,N),o({message:O})}finally{s(!1)}},[t,o]),R=(0,d.useCallback)(async()=>{try{s(!0);const N=await nt.Ay.get(`/budgeting/company/${t}/qb_connect`);N.data&&(N.data.status==="InActive"?(c(N.data.auth_url),p(N.data.redirect_uri)):N.data.status==="Active"&&(i(!0),N.data.auth_url&&(c(N.data.auth_url),p(N.data.redirect_uri))))}catch(N){const O="Failed to fetch connection status";console.error(O,N),o({message:O})}finally{s(!1)}},[t,o]);return{loading:n,fetchQuickbooksConnectionLink:R,setupQuickBooksConnection:async N=>{try{s(!0),(await nt.Ay.post(`/budgeting/company/${t}/qb_connect`,N)).data&&(i(!0),c(void 0),p(void 0))}catch(O){const z="Failed to connect.";console.error(z,O),o({message:z})}finally{s(!1)}},disconnectFromQuickbooks:async()=>{try{s(!0),(await nt.Ay.delete(`/budgeting/company/${t}/qb_connect`)).data&&(i(!1),R())}catch(N){const O="Failed to disconnect, try again.";console.error(O,N),o({message:O})}finally{s(!1)}},setLoading:s,redirectUri:u,authUrl:l,isConnected:a,setIsConnected:i,accountList:v,bfsVendorsList:j,qbCustomersList:w,vendorList:f,qbMapping:b,getQuickBookEntities:C,getVendors:k,getQuickBookMapping:S,saveQuickBookSettings:async N=>{try{s(!0),(await nt.Ay.post(`/budgeting/company/${t}/quickbooks_mappings`,N)).data&&(r({message:"Quickbooks setup successfully."}),S())}catch(O){const z="Failed to save settings, Try again.";console.error(z,O),o({message:z}),s(!1)}}}};var Kn=m(85646),Hr=m(31214),en=m(74787),Yh=m(53229);const Vn=50,Hw=t=>{if(!t.length)return{};const n=t.map(s=>`[data-field*=${s}], [data-fields*=${s}]`).join(", ");return{[`.${en.x.cell}${n}, .${en.x.columnHeader}${n}`]:{borderLeftWidth:"1px",borderLeftStyle:"solid"}}},Vo=(0,g.Ay)("div")(({theme:t,columnsWithBorder:n=[],ignoreEditableOutline:s,showRowBorder:o=!1})=>({...Hw(n),height:1,display:"flex",flexDirection:"column",[`.${$h}`]:{color:t.palette.error.main},[`.${en.x.cell}:not(.${en.x["cell--editable"]}):focus, .${en.x.cell}:not(.${en.x["cell--editable"]}):focus-within`]:{...s?{outline:"0px"}:{outline:`dashed ${t.palette.border.primary} 1px`}},[`.${en.x.cell}:not(.${en.x["cell--editable"]}):hover`]:{cursor:"default"},[`.${en.x.row}.gray`]:{backgroundColor:`${t.palette.background.secondary}`},[`.${en.x.row}.gray .${en.x["cell--pinnedLeft"]}`]:{backgroundColor:`${t.palette.background.secondary}`},[`.${en.x.row}.highlight`]:{backgroundColor:"#FFF2CC"},[`.${en.x.row}:not(.Mui-selected):hover, .${en.x.root} .${en.x.virtualScrollerContent} .${en.x.row}:not(.Mui-selected):hover .${en.x["cell--pinnedLeft"]}`]:{backgroundColor:`${t.palette.util.gridRowHover}`},[`.${en.x.cell}`]:{borderColor:"var(--DataGrid-rowBorderColor)",...o?{}:{borderTop:"0 !important"}},[`.${en.x.columnHeader}`]:{padding:"0 !important"},'[data-fields="|-actions-|"] .MuiDataGrid-columnHeaderTitleContainer':{borderBottomWidth:"1px",borderBottomStyle:"solid"},[`.${en.x.columnHeaderTitle}`]:{padding:"0 10px",fontWeight:"bold",whiteSpace:"normal",lineHeight:"normal"},[`.${en.x["columnHeader--alignRight"]}`]:{textAlign:"right"},[`[data-field="${Yh.it}"], [data-fields="|-${Yh.it}-|"]`]:{borderLeft:"0 !important"},[`.${en.x.aggregationColumnHeaderLabel}`]:{display:"none"},[`.${en.x["pinnedRows--bottom"]}`]:{display:"none"},[`.${en.x["pinnedRows--top"]}`]:{borderColor:"var(--DataGrid-rowBorderColor)",borderTopWidth:"1px",borderBottomWidth:"1px",borderTopStyle:"solid",borderBottomStyle:"solid"},[`.${en.x.root}`]:{backgroundColor:"white",borderTopLeftRadius:"0px",borderTopRightRadius:"0px"},[`.${en.x.root}[style*="--DataGrid-hasScrollX: 0"] > * > .${en.x.virtualScroller}`]:{overflowX:"hidden"}})),Ga=(0,g.Ay)("div")(({theme:t})=>({[`.${en.x.root}, .${en.x.main}`]:{borderTopLeftRadius:t.shape.borderRadius,borderTopRightRadius:t.shape.borderRadius},[`.${en.x.columnHeader}`]:{backgroundColor:t.palette.background.secondary}})),q_=t=>t.url!==void 0,qh=t=>t.isManual;var cr=(t=>(t.NotApproved="not_approved",t.Approved="approved",t.Invoiced="invoiced",t))(cr||{});const Xh="Invoice",Jh="Credit",gc="Purchase Order",Zh="Other",fc="Variance",e0=[{value:Xh,label:Xh},{value:Jh,label:Jh},{value:gc,label:gc},{value:Zh,label:Zh},{value:fc,label:fc}],ul=t=>(0,e.jsx)(_.A,{...t,size:"small",InputProps:{...t.InputProps,sx:{height:"100%"}},sx:{height:"100%","& fieldset":{border:"none"}}}),t0=({options:t,hasFocus:n,value:s,onChange:o,placeholder:r})=>{const a=(0,Dt.A)();return(0,e.jsx)(Gn.A,{openOnFocus:!0,autoFocus:!0,fullWidth:!0,sx:{height:"100%"},autoHighlight:!0,options:t,getOptionLabel:i=>i.label,isOptionEqualToValue:(i,l)=>i.id===l.id,onChange:o,renderInput:i=>(0,e.jsx)(ul,{...i,autoFocus:n,placeholder:r}),getOptionDisabled:i=>!!i.disabled,value:s,renderOption:({key:i,...l},c,{selected:u})=>(0,e.jsx)(I.A,{component:"li",...l,sx:{height:"44px",padding:a.spacing(1,2),display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"4px",minWidth:"75px"},children:(0,e.jsx)(I.A,{fontWeight:u?"bold":"normal",sx:{ml:c.marginLeft},children:c.label})},i),componentsProps:{popper:{style:{width:"fit-content"}}}})};class n0 extends il.Bo7{async isValidDependency(n,s){const o=n._data,r=s._data;return o.isParent||r.isParent?!1:super.isValidDependency(n._data.id,s._data.id)}}const s0="Cost Code Category",o0="Cost Code",xc=(0,Wn.A)("button")`
  flex-grow: 0;
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: center;
  gap: 10px;
  padding: 12px 16px 12px 16px;
  margin-left: 20px;
  border: none;
  border-radius: 4px;
  background-color: #368eff;
  color: white;
  cursor: pointer;
  font-size: 15px;
  font-weight: 600;
  font-stretch: normal;
  font-style: normal;
  opacity: ${t=>t.disabled?.3:1};
  cursor: ${t=>t.disabled?"not-allowed":"pointer"};
`,Qw=(0,Wn.A)("h1")`
  margin: 0;
  font-size: 22px;
  font-weight: 600;
`,Ka=(0,Wn.A)("button")`
  border: none;
  margin-left: 20px;
  border-radius: 4px;
  background-color: var(--bfs-secondary-support-gray-dark);
  color: white !important;
  font-size: 15px;
  padding: 12px 16px 12px 16px;
  font-weight: 600;
  font-stretch: normal;
  font-style: normal;
  opacity: ${t=>t.disabled?.3:1};
  cursor: ${t=>t.disabled?"not-allowed":"pointer"};
  align-items: center;
  display: flex;
`,Gw=(0,Wn.A)("button")`
  border: none;
  border-radius: 4px;
  font-size: 15px;
  font-weight: 600;
  padding: 12px 16px 12px 16px;
  margin-left: 20px;
  opacity: ${t=>t.disabled?.3:1};
  cursor: ${t=>t.disabled?"not-allowed":"pointer"};
  align-items: center;
  display: flex;
  background-color: #368eff;
  color: white;
`,r0=(0,Wn.A)("a")`
  color: #368eff;
`,Kw={"& fieldset":{border:"1px solid rgba(0,0,0,0.23)",borderRadius:"4px",backgroundColor:"transparent"},minWidth:"300px",width:"30%",flexGrow:1,height:"100%"},a0={cursor:"pointer",height:"20px",color:"red"},X_={"& fieldset":{border:"1px solid rgba(0,0,0,0.23)",borderRadius:"4px",backgroundColor:"transparent"},flexGrow:1,marginRight:"20px",height:"100%"},yc=(0,Wn.A)("h1")`
  margin: 0;
  font-size: 16px;
  padding-top: 5px;
  padding-bottom: 5px;
  font-weight: 600;
`,Yw=(0,Wn.A)("div")`
  background-color: transparent;
  border: 1px solid rgba(0, 0, 0, 0.23);
  flex-grow: 1;
  display: flex;
  border-radius: 4;
  color: #716f6f;
  padding: 8px 12px;
  margin-right: 20px;
`,i0=(0,Wn.A)("div")`
  display: flex;
  width: 30%;
  min-width: 300px;
`,qw=(0,Wn.A)("div")`
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
`,l0={position:"absolute",top:"60%"},d0="/static/NAHBGenericCostCodes.xlsx",Xw=(0,e.jsx)(r0,{href:d0,children:"download our template"}),c0=t=>{const n={},s=[];return t.forEach(o=>{const r=o[s0].trim(),a=o[o0].trim();if(!n[r]){const c={id:`p-${r}`,codeDescription:r,isActive:!0,children:[]};n[r]=c,s.push(c)}r===a&&(n[r].codeDescription=`${n[r].codeDescription} - Category`);const i=n[r];let l=i.children.find(c=>c.id===`c-${a}`);l||(l={id:`c-${a}`,codeDescription:a,isActive:!0,children:[]},l.codeDescription&&i.children.push(l))}),s},pl=t=>Array.from(t.getRowModels().values()),u0=t=>t.sort((n,s)=>n.parentPath.length-s.parentPath.length).map(n=>({id:typeof n.id=="number"?n.id:void 0,codeDescription:n.codeDescription,isActive:n.isActive,qbItemId:n.qbItemId,qbItemName:n.qbItemName,parentCode:n.parentPath.length>1?n.parentPath[0]:void 0,sortOrder:n.sortOrder})),Jw=(t,n)=>{const s=pl(t).filter(o=>o.codeDescription?n?n.includes(String(o.id)):!0:!1);return u0(s)},Zw=(t,n)=>{if(t.length<2)return n({message:"No CostCode present"}),!1;const s=t[0],o=[s0,o0];if(s.join(",")!==o.join(","))return n({message:"Uploaded template does not match the required formatting. When using the provided template, make sure not to change the column headers. Please try again"}),!1;for(let r=1;r<t.length;r++){const a=t[r],[i,l]=a;if(l&&!i)return n({message:`Child '${l}' must have a parent..`}),!1}return!0};function wo(t,{processCostCodePathEntry:n=s=>s}={}){const s=[];return t.forEach((o,r)=>{const a=n(o),i=[a];s.push({...o,parentPath:i,children:void 0,childrenCount:o.children?.length??0,sortOrder:o.sortOrder??r}),(o.children??[]).forEach((l,c)=>{const u=n(l),p=[a,u];s.push({...l,parentPath:p,children:void 0,childrenCount:l.children?.length??0,sortOrder:l.sortOrder??c})})}),s}const p0=({hasFocus:t,value:n,onChange:s,getOptionDisabled:o=a=>!a.isActive,placeholder:r})=>{const{company:a}=(0,je.P)(),{data:i=[]}=ar(a?.id,{skip:!a?.id}),l=(0,d.useMemo)(()=>wo(i).map(u=>({id:u.id,label:u.codeDescription,disabled:o(u),marginLeft:`${(u.parentPath.length-1)*20}px`})),[i,o]),c=(0,d.useMemo)(()=>l.find(u=>Number(u.id)===Number(n))??null,[n,l]);return(0,e.jsx)(t0,{value:c,options:l,hasFocus:t,onChange:s,placeholder:r})},ur=({id:t,field:n,hasFocus:s,value:o})=>{const r=(0,ds.h)();return(0,e.jsx)(p0,{hasFocus:s,value:o,onChange:async(a,i)=>{await r.current.setEditCellValue({id:t,field:n,value:i?Number(i.id):null}),i&&r.current.stopCellEditMode({id:t,field:n})}})};var Me=m(17978),bc=m(98821),eE=m(45586),m0=m(17451),Is=m(12310),vc=m(93494);const Ya=(t,n)=>t?.error?.error?String(t.error.error):t?.error?.data?.error?String(t.error.data.error):n??"An unexpected error occurred.",tE=(t,n)=>t?.error?.data?.errors?t.error.data.errors.map(s=>String(s)):Ya(t)?[Ya(t)]:[n??"An unexpected error occurred."];var h0=m(72505),jc=m.n(h0);const nE=async(t,n,s,o)=>{try{const r=o===An.v.SAPS4HANA&&s?`invoice_id=${s}`:`invoice_id=${t}`,a=await nt.Ay.get(`/budgeting/download_invoice?${r}&invoice_type=${n}&erp_system=${o}`);if(a.data){const i=`data:application/pdf;base64,${a.data.invoice_pdf}`,l=document.createElement("a"),c=`${t}.pdf`;l.href=i,l.download=c,l.click()}return{success:!0,error:""}}catch(r){return console.error("Failed to download invoice",r),r instanceof h0.AxiosError?{success:!1,error:r.response?.data}:{success:!1,error:"Failed to download invoice"}}},g0=()=>{const t=(0,Fe.d)(),{company:n}=(0,je.P)();return async s=>{if(n?.erpSystem){const o=await nE(s.bfsId,s.billType,s.bfsKey,n?.erpSystem);o.success||t.showError({message:o.error||"Failed to download invoice"})}else t.showError({message:"Cannot download invoice without company ERP system"})}};var ml=m(83882);const Ac=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=Math.random()*16|0;return(t==="x"?n:n&3|8).toString(16)});var sE=m(26336);const oE=t=>{const n=t.split(".");return n.length>1?[n.slice(0,-1),`.${n.slice(-1)}`]:[t,""]},rE=({file:t,removeFile:n,disableRemoveFile:s})=>{const o=(0,Dt.A)(),[r,a]=oE(t.name);return(0,e.jsxs)(E.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:o.spacing(1),padding:o.spacing(1),borderRadius:"4px",whiteSpace:"nowrap",backgroundColor:ke.colors["background-secondary"].value,border:`1px solid ${ke.colors["border-tertiary"].value}`,marginBottom:o.spacing(1)},children:[(0,e.jsxs)(I.A,{sx:{display:"flex",flex:1,overflow:"hidden",color:o.palette.primary.dark,lineHeight:"inherit"},children:[(0,e.jsx)(I.A,{sx:{textOverflow:'ellipsis "[...]"',lineHeight:"inherit",overflowX:"hidden"},children:r}),(0,e.jsx)(I.A,{sx:{lineHeight:"inherit"},children:a})]}),(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[t.url&&(0,e.jsx)(pt.A,{onClick:()=>window.open(t.url,"_blank"),sx:{mb:"-4px"},children:(0,e.jsx)(bc.A,{})}),(0,e.jsx)(pt.A,{onClick:()=>n(t.id),disabled:s,children:(0,e.jsx)(sE.A,{})})]})]},t.id)},Cc=({files:t,removeFile:n,disableRemoveFile:s,title:o,sx:r})=>{const a=(0,Dt.A)();return t.length?(0,e.jsxs)(e.Fragment,{children:[o&&(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"row",gap:"4px",mb:a.spacing(2)},children:[(0,e.jsx)(I.A,{variant:"subtitle1",sx:{fontWeight:"bold",color:"black"},children:o}),(0,e.jsxs)(I.A,{variant:"subtitle1",children:["(",t.length,")"]})]}),(0,e.jsx)(E.A,{sx:{display:"flex",flexDirection:"column",...r||{}},children:t.map(i=>(0,e.jsx)(rE,{file:i,removeFile:n,disableRemoveFile:s},i.id))}),o&&(0,e.jsx)(Ce.A,{sx:{my:a.spacing(2)}})]}):null};var aE=m(50690);const f0={content:'" "',height:"1px",width:"130px",background:ke.colors["border-tertiary"].value,display:"block",position:"absolute",top:"50%"},Sc=({size:t,isDragActive:n,fileTypes:s="pdf, jpg, png"})=>{const o=(0,Dt.A)();return(0,e.jsxs)(E.A,{sx:{display:"flex",overflowX:"hidden",flexDirection:t==="large"?"column":"row",justifyContent:"center",alignItems:"center",borderRadius:"4px",border:`1px dashed ${ke.colors["border-tertiary"].value}`,padding:o.spacing(2,1),cursor:"pointer",backgroundColor:n?ke.colors["background-hover-primary"].value:"transparent"},children:[(0,e.jsx)(aE.A,{sx:{color:ke.colors["foreground-secondary"].value,...t==="large"?{height:"88px",width:"88px"}:{mr:"2px"}}}),(0,e.jsxs)(I.A,{children:["Drop files to attach",t==="small"?", or ":""]}),t==="large"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.A,{variant:"caption",children:s}),(0,e.jsx)(I.A,{variant:"caption",sx:{position:"relative","&:before":{...f0,right:o.spacing(2)},"&:after":{...f0,left:o.spacing(2)}},children:"or"})]}),(0,e.jsx)(K.A,{variant:"text",sx:{p:0,backgroundColor:"transparent","&:hover":{backgroundColor:"transparent",textDecoration:"underline"}},children:t==="large"?"Browse":"browse"})]})},x0=t=>typeof t=="object"&&t!==null&&"status"in t,iE=t=>x0(t)&&t.status===400&&typeof t.data=="object"&&t.data&&Array.isArray(Object.values(t.data)[0])&&Object.values(t.data)[0][0],lE=t=>typeof t=="object"&&t!==null&&"detail"in t,fn=(t,n="An unexpected error occurred.")=>{if(x0(t)){const s=t.data;if(lE(t.data)&&typeof t.data.detail=="string")return t.data.detail;if(Array.isArray(s)&&typeof s[0]=="string")return s[0]}return t instanceof Error?t.message:n},dE={"Too many files":"You can only upload 5 files at a time.","File type must be image/png,image/png,image/jpeg,image/jpeg,application/pdf,application/pdf":"File type must be PDF, JPG, or PNG"},cE=t=>dE[t]||t,uE=async(t,n)=>{await nt.v3.put(n,t,{headers:{"Content-Type":t.type,"x-ms-version":"2019-12-12","x-ms-blob-type":"BlockBlob"}})},y0=rs(({open:t,onClose:n,title:s,files:o,isFetching:r,refetchFiles:a,createFileUploadUrl:i,deleteFiles:l,onFileCountChange:c,userCanModifyFiles:u})=>{const p=(0,Dt.A)(),[f,h]=(0,d.useState)([]),{showError:b,showSuccess:x}=(0,Fe.d)(),[v,y]=(0,d.useState)([]),[j,A]=(0,d.useState)(!1),[w,P]=(0,d.useState)(!1),C=r||j,k=W=>{if(P(!1),u){const N=W.map(ue=>Object.assign(ue,{id:Ac(),filePreview:URL.createObjectURL(ue)})),O=o?.map(ue=>ue.name)||[],z=f.map(ue=>ue.name),Q=N.map(ue=>ue.name),re=[...O,...z,...Q];if(new Set(re).size!==re.length){b({message:"You cannot upload a file with the same name as an existing file."});return}else if(Q.some(ue=>ue.includes(","))){b({message:"You cannot upload a file with a comma in the name."});return}h(ue=>[...ue,...N])}},S=W=>{h(N=>N.filter(O=>O.id!==W)),o?.find(N=>N.id===W)&&y(N=>[...N,W])},R=async()=>await new Promise(async W=>{A(!0);let N=!0;for(const z of f)try{const Q=await i(z.name);await uE(z,Q)}catch(Q){N=!1,console.error(Q),b({message:fn(Q,"Failed to update files")})}if(v.length>0)try{await l(v)}catch(z){N=!1,console.error(z),b({message:fn(z,"Failed to update files")})}const O=f.length>0?4e3:0;if(!N)h([]),y([]),setTimeout(async()=>{await a(),A(!1),W()},O);else{const z=(o?.length||0)-v.length+f.length;setTimeout(()=>{c(z),x({message:"File changes saved successfully."}),A(!1),n(),W()},O)}}),B=C?[]:[...o?.filter(W=>!v.includes(W.id))||[],...f],T=f.length>0||v.length>0;return(0,e.jsx)(Zt,{open:t,onClose:n,fullWidth:!0,title:s,actions:[{title:"Save",onClick:R,disabled:!T||C}],content:(0,e.jsxs)(E.A,{sx:{maxHeight:"calc(100vh - 400px)",overflowY:"auto"},children:[!r&&(0,e.jsx)(Cc,{files:B,removeFile:S,disableRemoveFile:!u}),C?(0,e.jsx)(E.A,{sx:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",height:"75px"},children:(0,e.jsx)(bt.A,{})}):u?(0,e.jsx)(ml.Ay,{onDrop:k,accept:{"image/png":["image/png"],"image/jpeg":["image/jpeg"],"application/pdf":["application/pdf"]},children:({getRootProps:W,getInputProps:N,fileRejections:O})=>(0,e.jsxs)("div",{...W(),onDragEnter:()=>P(!0),onDragLeave:()=>P(!1),children:[(0,e.jsx)("input",{...N(),hidden:!0}),O.length>0&&(0,e.jsx)(I.A,{color:"error",sx:{py:p.spacing(1)},children:cE(O[0].errors[0]?.message)}),(0,e.jsx)(Sc,{size:B.length>0?"small":"large",isDragActive:w})]})}):(0,e.jsx)(E.A,{sx:{width:"100%"},children:o?.length===0&&(0,e.jsx)(I.A,{sx:{height:"20px"},children:"No files exist on this invoice."})})]})})}),b0=rs(({row:t,onClose:n,...s})=>{const{project:o}=(0,De.B)(),[r]=(0,Me.qL)(),[a]=(0,Me.Ie)(),{data:i=[],isFetching:l,refetch:c}=(0,Me.uL)({uid:t.uid,projectId:t.projectId},{refetchOnMountOrArgChange:!0}),u=(0,Me.ss)(),{userHasPermission:p}=(0,Ye.A)(),f=p({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:o?.companyId,projectId:o?.id});return(0,e.jsx)(y0,{...s,title:"Attach Documents",onClose:n,files:i,isFetching:l,createFileUploadUrl:async h=>{const{uploadUrl:b}=await r({uid:t.uid,projectId:t.projectId,fileName:h}).unwrap();return b},deleteFiles:async h=>{await a({uid:t.uid,projectId:t.projectId,fileIds:h}).unwrap()},userCanModifyFiles:f,refetchFiles:c,onFileCountChange:h=>{u({...t,filesCount:h})}})}),v0=()=>(0,e.jsx)(bt.A,{size:24}),pE=({row:t,canUserEditBudget:n})=>{const[s,o]=(0,d.useState)(!1),r=g0(),a=async i=>{i.preventDefault(),i.stopPropagation();try{o(!0),await r(t)}finally{o(!1)}};return(0,e.jsx)(qt.A,{title:"Download Invoice",children:(0,e.jsx)(pt.A,{disabled:s||!n,onClick:a,children:s?(0,e.jsx)(v0,{}):(0,e.jsx)(bc.A,{})})})},mE=({row:t,isConnectedToQb:n})=>{const{project:s}=(0,De.B)(),{company:o}=(0,je.P)(),r=(0,Fe.d)(),[a,{isLoading:i}]=(0,Me.Yr)(),{userHasPermission:l}=(0,Ye.A)(),c=l({tool:D.w5.BUDGET,action:D.a2.SEND_TO_QUICKBOOKS,companyId:o?.id,projectId:s?.id}),u=(0,Me.ss)(),p=async f=>{f.preventDefault(),f.stopPropagation();const h=await a({id:t.internalId,projectId:t.projectId,invoiceNumber:t.invoiceNumber,dueDate:t.dueDate,amount:t.amount,balanceDue:t.balanceDue,invoiceDate:t.completedDate,costCodeId:t.costCodeId,companyId:o?.id});if("error"in h)tE(h).forEach(b=>r.showError({message:b}));else{u({...t,isSentToQuickbooks:!0});const b=t.isSentToQuickbooks?"updated in":"sent to";r.showSuccess({message:`Invoice ${b} Quickbooks`})}};return(0,e.jsx)(qt.A,{title:t.isSentToQuickbooks?"Sent to QuickBooks":"Send to QuickBooks",children:(0,e.jsx)(pt.A,{onClick:p,disabled:!c||i||!n,children:i?(0,e.jsx)(v0,{}):t.isSentToQuickbooks?(0,e.jsx)(eE.A,{}):(0,e.jsx)(m0.A,{})})})},hE=({row:t,isConnectedToQb:n})=>{const{project:s}=(0,De.B)(),[o]=(0,Me.GH)(),[r]=(0,Me.cp)(),{isModalOpen:a,openModal:i,closeModal:l}=ln(),{isModalOpen:c,openModal:u,closeModal:p}=ln(),f=(0,Dt.A)(),h=(0,Fe.d)(),{userHasPermission:b}=(0,Ye.A)(),{company:x}=(0,je.P)(),v=b({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:x?.id,projectId:s?.id}),y=async()=>{try{await r({uid:t.uid,projectId:s?.id,visibleInInvoicesTab:!1,isManual:t.isManual}).unwrap(),h.showSuccess({message:"Expense removed from invoices"})}catch(A){h.showError({message:fn(A)})}},j=async()=>{try{await o({projectId:s?.id,uid:t.uid}).unwrap(),h.showSuccess({message:"Expense deleted successfully"})}catch(A){h.showError({message:fn(A)})}};return(0,e.jsxs)(E.A,{sx:{display:"flex",gap:f.spacing(1),justifyContent:"center",alignItems:"center",height:"100%"},children:[(0,e.jsx)(qt.A,{title:"Delete Invoice",children:(0,e.jsx)(pt.A,{disabled:!t.isManual||!v,onClick:()=>t.purchaseOrderId?y():u(),children:(0,e.jsx)(Is.A,{})})}),t.isManual?(0,e.jsx)(qt.A,{title:"Attach File",children:(0,e.jsx)(pt.A,{onClick:i,children:(0,e.jsx)(er.A,{badgeContent:t.filesCount,color:"primary",children:(0,e.jsx)(vc.A,{})})})}):(0,e.jsx)(pE,{row:t,canUserEditBudget:v}),(0,e.jsx)(mE,{row:t,isConnectedToQb:n}),(0,e.jsx)(b0,{open:a,onClose:l,row:t}),(0,e.jsx)(Zt,{open:c,onClose:p,title:"Delete Expense",content:"You are about to delete this expense. This action cannot be undone, and all related information will be permanently lost. Do you wish to continue?",actions:[{title:"Delete",onClick:j,color:"error"}]})]})};var hl=m(1649),pr=m(99682);const gE=({rowNode:t,isDetailPanelExpanded:n})=>t.type==="group"?t.childrenExpanded?(0,e.jsx)(Na.A,{}):(0,e.jsx)(Fo.A,{}):n?(0,e.jsx)(hl.A,{}):(0,e.jsx)(pr.A,{}),gl=({rowId:t,count:n})=>{const s=(0,Dt.A)(),o=Array.from({length:n},(r,a)=>a);return(0,e.jsx)(e.Fragment,{children:o.map(r=>(0,e.jsx)(E.A,{sx:{marginLeft:"20px",borderLeft:`1px dashed ${s.palette.divider}`,height:Vn,paddingLeft:s.spacing(1)}},`${t}-${r}`))})},fE=({value:t,rowNode:n,row:s})=>{const o=(0,ds.h)(),r=a=>{if(a.preventDefault(),a.stopPropagation(),n.type==="group"){if(o.current?.setRowChildrenExpansion(n.id,!n.childrenExpanded),n.childrenExpanded){const i=o.current?.getRowGroupChildren({groupId:n.id})??[],l=o.current?.getExpandedDetailPanels()??[];o.current?.setExpandedDetailPanels(l.filter(c=>!i.includes(c)))}}else o.current?.toggleDetailPanel(n.id)};return s.isAggregationRow?(0,e.jsx)(I.A,{fontWeight:"bold",variant:"inherit",children:"Totals"}):(0,e.jsxs)(E.A,{sx:{display:"flex"},children:[(0,e.jsx)(gl,{rowId:n.id,count:n.depth}),(0,e.jsxs)(E.A,{children:[n.type!=="pinnedRow"&&(0,e.jsx)(pt.A,{onClick:r,children:(0,e.jsx)(gE,{rowNode:n,isDetailPanelExpanded:t})}),Co(n)]})]})},xE=(0,g.Ay)(Ei.Ay)(({theme:t})=>({fontFamily:t.typography.fontFamily,fontSize:t.typography.fontSize,fontWeight:t.typography.fontWeightRegular,paddingLeft:t.spacing(1),width:"100%"})),ms=({id:t,field:n,hasFocus:s,value:o,allowNegative:r=!0})=>{const a=(0,ds.h)(),[i,l]=(0,d.useState)(o?String(o):"");return(0,e.jsx)(xE,{autoFocus:s,type:"text",value:i,onChange:c=>{const u=c.target.value,p=r?u.replace(/[^0-9.-]/g,""):u.replace(/[^0-9.]/g,"");l(p),a.current.setEditCellValue({id:t,field:n,value:Number(p)})}})},yE=(0,Dd.Z)(),j0=({id:t,field:n,row:s,hasFocus:o,value:r})=>{const a=(0,ds.h)(),i=(0,Dt.A)(),{company:l}=(0,je.P)(),{data:c=[],isLoading:u}=(0,Me.T5)({company:l.id},{skip:!l?.id}),{showError:p}=(0,Fe.d)(),[f]=(0,Me.TQ)(),[h,b]=(0,d.useState)(null),{isModalOpen:x,openModal:v,closeModal:y}=ln(),j=async S=>{let R=null;typeof S=="string"?R=await w(S):S?.id===-1&&S?.valueToCreate?R=await w(S.valueToCreate):S&&(R=S.id),await a.current.setEditCellValue({id:t,field:n,value:R}),a.current.stopCellEditMode({id:t,field:n})},A=S=>c.find(R=>R.name.toLowerCase().trim()===S.toLowerCase().trim()),w=async S=>{if(!S.trim())return null;const R=A(S);if(R)return R.id;const B=await f({company:l.id,name:S.trim(),isBfs:!1});return"error"in B?(p({message:Ya(B)}),null):B.data.id},P=parseInt(r,10),C=(0,d.useMemo)(()=>c.map(S=>({id:S.id,label:S.name})).sort((S,R)=>S.id===P?-1:R.id===P?1:0),[c,P]),k=(0,d.useMemo)(()=>C.find(S=>S.id===P),[C,P]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Gn.A,{openOnFocus:!0,fullWidth:!0,freeSolo:!0,autoHighlight:!0,selectOnFocus:!0,blurOnSelect:!0,handleHomeEndKeys:!0,options:C,componentsProps:{popper:{style:{minWidth:"fit-content"}}},loading:u,value:k,renderInput:S=>(0,e.jsx)(ul,{...S,autoFocus:o}),filterOptions:(S,R)=>{const B=yE(S,R),{inputValue:T}=R,W=S.some(N=>T===N.label);return T.trim()!==""&&!W&&B.push({id:-1,valueToCreate:T,label:`Add "${T}"`}),B},renderOption:({key:S,...R},B,{selected:T})=>(0,e.jsxs)(I.A,{...R,component:"li",sx:{height:"44px",padding:i.spacing(1,2),borderBottom:T?`2px solid ${ke.colors["border-tertiary"].value}`:"none",display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"4px"},children:[(0,e.jsx)(I.A,{fontWeight:T?"bold":"normal",children:B.label}),T&&(0,e.jsx)(I.A,{color:"text.secondary",children:"(Vendor)"})]},S),onKeyDown:S=>{S.key==="Enter"&&S.stopPropagation()},onChange:async(S,R)=>{b(R),"purchaseOrderId"in s&&s.purchaseOrderId?v():await j(R)}}),(0,e.jsx)(Zt,{open:x,onClose:y,title:"Change vendor on invoice with connected purchase order",content:"Changing the vendor on this invoice will remove all connected purchase order information.",actions:[{title:"Change Vendor",onClick:async()=>{try{await j(h),y(),b(null)}catch(S){p({message:String(S)})}},color:"primary"}]})]})},bE=(0,Dd.Z)(),vE=({id:t,field:n,row:s,hasFocus:o,value:r})=>{const a=(0,ds.h)(),i=(0,Dt.A)(),{project:l}=(0,De.B)(),[c]=(0,Me.u$)(),{data:u=[],isLoading:p}=(0,Me.cG)({projectId:l.id},{skip:!l?.id}),{showError:f}=(0,Fe.d)(),h=y=>u.find(j=>j.poRef.toLowerCase().trim()===y.toLowerCase().trim()),b=async y=>{if(!y.trim())return null;const j=h(y);if(j)return j.internalId;const A=await c({projectId:l.id,vendorId:s.vendorId,dateCreated:us(s.completedDate),poRef:y});return"error"in A?(f({message:Ya(A)}),null):A.data.internalId},x=(0,d.useMemo)(()=>u.filter(qh).filter(y=>s.vendorId?y.vendorId===s.vendorId:!0).map(y=>({id:y.internalId,label:`${y.poRef}${!s.vendorId&&y.vendorName?` [${y.vendorName}]`:""}`})).sort((y,j)=>y.id===r?-1:j.id===r?1:0),[u,r]),v=(0,d.useMemo)(()=>x.find(y=>y.id===r),[x,r]);return(0,e.jsx)(Gn.A,{openOnFocus:!0,fullWidth:!0,freeSolo:!0,autoHighlight:!0,selectOnFocus:!0,blurOnSelect:!0,handleHomeEndKeys:!0,options:x,componentsProps:{popper:{style:{minWidth:"fit-content"}}},loading:p,value:v,renderInput:y=>(0,e.jsx)(ul,{...y,autoFocus:o}),filterOptions:(y,j)=>{const A=bE(y,j),{inputValue:w}=j,P=y.some(C=>w===C.label);return w.trim()!==""&&!P&&A.push({id:-1,valueToCreate:w,label:`Add "${w}"`}),A},renderOption:({key:y,...j},A,{selected:w})=>(0,e.jsx)(I.A,{...j,component:"li",sx:{height:"44px",padding:i.spacing(1,2),borderBottom:w?`2px solid ${ke.colors["border-tertiary"].value}`:"none",display:"flex",justifyContent:"flex-start",alignItems:"center",gap:"4px"},children:(0,e.jsx)(I.A,{fontWeight:w?"bold":"normal",children:A.label})},y),onKeyDown:y=>{y.key==="Enter"&&y.stopPropagation()},onChange:async(y,j)=>{let A=null;typeof j=="string"?A=await b(j):j?.id===-1&&j?.valueToCreate?A=await b(j.valueToCreate):j&&(A=j.id),await a.current.setEditCellValue({id:t,field:n,value:A}),a.current.stopCellEditMode({id:t,field:n})}})},jE=({id:t,field:n,hasFocus:s,value:o})=>{const{project:r}=(0,De.B)(),{data:a=[],isLoading:i}=(0,Me.Nc)({project:r?.id},{skip:!r?.id}),l=(0,d.useMemo)(()=>a.find(u=>u.id===o)??null,[o,a]),c=(0,ds.h)();return(0,e.jsx)(Gn.A,{openOnFocus:!0,fullWidth:!0,autoHighlight:!0,selectOnFocus:!0,blurOnSelect:!0,handleHomeEndKeys:!0,value:l,getOptionLabel:({title:u})=>u,options:a,componentsProps:{popper:{style:{minWidth:"fit-content"}}},loading:i,renderInput:u=>(0,e.jsx)(ul,{...u,autoFocus:s}),onChange:async(u,p)=>{await c.current.setEditCellValue({id:t,field:n,value:p?String(p.id):null}),p&&c.current.stopCellEditMode({id:t,field:n})}})},AE=({params:t,costCodeMap:n})=>{const s=t?.row?.costCodeId;if(!s)return(0,e.jsx)("span",{});const o=n.get(String(s))?.codeDescription||"";return(0,e.jsx)("span",{children:o})},A0="MuiDataGrid-cellContent",CE=(0,g.Ay)("div")`
  flex: 1;
  text-align: left;
`,qa=({value:t,children:n,customRenderCellStyles:s,showTooltip:o=!1,tooltipMessage:r="",tooltipPlacement:a="bottom",...i})=>{const l=n??t??"",c=typeof l=="string"?l:"",u=(0,e.jsx)(CE,{className:A0,role:"presentation",sx:{cursor:o?"not-allowed":"default",...s},title:o?"":c,...i,children:l});return o&&r?(0,e.jsx)(qt.A,{title:r,placement:a,children:(0,e.jsx)(E.A,{sx:{width:"100%",height:"100%"},children:u})}):u},fl=({params:t,varianceCodeMap:n})=>{const s=t.row.varianceCodeId;if(!s)return(0,e.jsx)("span",{});const o=n.get(s)?.code||"";return(0,e.jsx)(qa,{children:o})},Xa=()=>{const{project:t}=(0,De.B)(),n=(0,Me.pC)({projectId:t?.id},{skip:!t?.id}),s=(0,d.useMemo)(()=>new Map(n.data?.map(r=>[r.id,r])||[]),[n.data]),o=(0,d.useMemo)(()=>n.data?.reduce((r,a)=>(r[a.category.id]||(r[a.category.id]=[]),r[a.category.id].push(a),r),{})??{},[n.data]);return{...n,varianceCodeMap:s,varianceCodesMappedByCategory:o}},xl=({id:t,field:n,hasFocus:s,value:o})=>{const{varianceCodesMappedByCategory:r}=Xa(),a=(0,ds.h)(),i=(0,d.useMemo)(()=>{const c=[];for(const u of Object.values(r)){if(!u.length)continue;const p=u[0].category;c.push({id:p.id,label:p.name,disabled:!0});for(const f of u)c.push({id:f.id,label:f.code,disabled:!1,marginLeft:"20px"})}return c},[r]),l=(0,d.useMemo)(()=>i.find(c=>c.id===o)||null,[o,i]);return(0,e.jsx)(t0,{options:i,hasFocus:s,value:l,onChange:async(c,u)=>{await a.current.setEditCellValue({id:t,field:n,value:u?Number(u.id):null}),u&&a.current.stopCellEditMode({id:t,field:n})}})},J_=null,yl="budgeted",wc="actuals",Ec="variance",bl="totalAmount",Pc="amountPaid",Ic="balanceDue",C0="vendorId",S0="purchaseOrderId",w0="billType",E0="costCodeId",P0="varianceCodeId",I0="allowanceId",D0="description",SE="invoiceNumber",wE="completedDate",EE="dueDate",PE="amount",IE="paid",DE="balanceDue",kE="_actions",Dc="This field is not able to be edited on a VPO invoice",TE=t=>t.billType&&e0.some(n=>n.value===t.billType)?t.billType:t.variancePurchaseOrderId?fc:t.purchaseOrderId?gc:null,$s={editable:!1,align:"left",headerAlign:"left",flex:1,minWidth:100},vl={...$s,type:"number",align:"right",headerAlign:"right",valueFormatter:vt,renderEditCell:t=>(0,e.jsx)(ms,{...t})},RE=t=>({...Hr.a,renderHeader:()=>(0,e.jsx)(I.A,{fontWeight:"bold",variant:"inherit",className:en.x.columnHeaderTitle,children:t}),width:350,renderCell:fE}),OE=[{groupId:"projectExpenses",headerName:"Project Expenses",children:[{field:yl},{field:wc},{field:Ec}]},{groupId:"projectCashFlow",headerName:"Project Cash Flow",children:[{field:bl},{field:Pc},{field:Ic}]}],Qr={...vl,renderCell:ps(vt)},k0=[E0,P0,I0,D0],ME=[C0,S0,w0],jl=(t,n)=>!!t.variancePurchaseOrderId&&ME.includes(n),T0=(t,n)=>{const{field:s,row:o,colDef:r}=t;return!(!n||!r.editable||!o.isManual&&k0.length>0&&!k0.includes(s)||jl(o,s))},LE=[{...Qr,field:yl,editable:!0,headerName:"Budgeted"},{...Qr,field:wc,headerName:"Actuals"},{...Qr,field:Ec,headerName:"Variance"},{...Qr,field:bl,headerName:"Total Amount"},{...Qr,field:Pc,headerName:"Amount Paid"},{...Qr,field:Ic,headerName:"Balance Due"}],FE=t=>[Zs,{...$s,editable:!0,field:D0,headerName:"Description"},{...$s,editable:!0,field:SE,headerName:"Invoice #"},{...$s,editable:!0,field:S0,headerName:"PO #",renderCell:n=>(0,e.jsx)(qa,{value:n.row.purchaseOrderNumber??"",showTooltip:jl(n.row,n.field),tooltipMessage:Dc}),renderEditCell:n=>(0,e.jsx)(vE,{...n})},{...$s,field:C0,headerName:"Vendor",editable:!0,renderCell:n=>(0,e.jsx)(qa,{value:n.row.vendorName??"",showTooltip:jl(n.row,n.field),tooltipMessage:Dc}),renderEditCell:n=>(0,e.jsx)(j0,{...n})},{...$s,field:w0,editable:!0,headerName:"Expense Type",type:"singleSelect",valueOptions:e0,renderCell:n=>(0,e.jsx)(qa,{value:n.value,showTooltip:jl(n.row,n.field),tooltipMessage:Dc})},{...$s,type:"date",field:wE,editable:!0,headerName:"Issued Date",minWidth:150,valueGetter:n=>n?new Date(n):null},{...$s,type:"date",editable:!0,field:EE,headerName:"Due Date",valueGetter:n=>n?new Date(n):null},{...$s,field:E0,headerName:"Cost Code",editable:!0,renderEditCell:n=>(0,e.jsx)(ur,{...n}),renderCell:n=>(0,e.jsx)(AE,{params:n,costCodeMap:t.costCodeMap})},{...$s,field:P0,headerName:"Variance Code",editable:!0,renderCell:n=>(0,e.jsx)(fl,{params:n,varianceCodeMap:t.varianceCodeMap}),renderEditCell:n=>(0,e.jsx)(xl,{...n})},{...$s,field:I0,headerName:"Allowance",editable:!0,renderCell:({row:n})=>n.allowanceTitle,renderEditCell:n=>(0,e.jsx)(jE,{...n})},{...vl,editable:!0,field:PE,headerName:"Amount"},{...vl,editable:!0,field:IE,headerName:"Paid"},{...vl,field:DE,headerName:"Balance Due"},{...$s,field:kE,headerName:"Actions",minWidth:150,renderCell:n=>(0,e.jsx)(hE,{...n,...t})}];var kc=m(18411);const BE=(t,n)=>t.reduce((s,o)=>(s[n(o)]=o,s),{}),NE=(t,n)=>s=>{iE(s)?Object.entries(s.data).forEach(([o,r])=>{const a=n.find(i=>i.field===o)?.headerName;r.forEach(i=>{t.showError({message:a?`${a}: ${i}`:i})})}):t.showError({message:fn(s)})},_E=t=>t.id,Jn=({rows:t=[],getRowId:n=_E,onRowAdded:s,processRowUpdate:o,defaultSortModel:r=[],onSortModelChange:a,initialState:i,onProcessRowUpdateError:l,columns:c,showLoadingDuringUpdate:u,loading:p,...f})=>{const h=(0,Fe.d)(),[b,x]=Jd(),v=(0,d.useMemo)(()=>NE(h,c),[h,c]),y=(0,Kn.b)(),[j]=(0,d.useState)(t);return(0,d.useImperativeHandle)(f.apiRef,()=>y.current,[]),(0,d.useEffect)(()=>{const A=y.current.getRowModels(),w=BE(t,n),P=Array.from(A.keys()).reduce((C,k)=>(w[k]||(y.current.getExpandedDetailPanels().includes(k)&&y.current.toggleDetailPanel(k),C.push({...A.get(k),_action:"delete"})),C),[]);y.current.updateRows([...t,...P]),s&&t.forEach(C=>{A.has(n(C))||s(C,y.current)})},[t,s]),(0,e.jsx)(kc._,{...f,loading:p||u&&b,columns:c,onProcessRowUpdateError:l??v,processRowUpdate:async(...A)=>{if(o){const C=await x(o)(...A);if(C)return C}const[w]=A,P=y.current?.getRowModels().get(n(w));return P||A[0]},onSortModelChange:A=>{!A.length&&r.length&&y.current.setSortModel(r)},initialState:{sorting:{sortModel:r},...i},getRowId:n,apiRef:y,rows:j})};class UE extends Error{constructor(){super("Something went wrong"),console.error("MissingRowError: Failed to find row")}}const po=(t=5e3)=>{const n=(0,d.useRef)(new Map);return{onRowAdded:(o,r)=>{const a=r.getRowId(o),i=n.current.get(a);i&&(i.resolve(o),clearTimeout(i.rejectTimeout),n.current.delete(a))},waitForRow:async(o,r)=>{if(r?.current&&"getRow"in r.current){const u=r.current.getRow(o);if(u)return u}const a=n.current.get(o);if(a)return a.promise;let i=u=>{},l=u=>{};const c=new Promise((u,p)=>{i=u,l=p});return n.current.set(o,{promise:c,resolve:i,rejectTimeout:setTimeout(()=>{l(new UE),n.current.delete(o)},t)}),c}}},WE=()=>{const{company:t}=(0,je.P)(),{data:n=[],isLoading:s}=ar(t?.id,{skip:!t?.id}),{map:o,list:r}=(0,d.useMemo)(()=>{const a=wo(n);return{list:a,map:new Map(a.map(i=>[String(i.id),i]))}},[n]);return{costCodeMap:o,costCodeList:r,isLoading:s}},zE=t=>t.uid,VE=({rows:t,title:n,totalAmount:s,onAddExpenseClick:o,onExpenseUpdate:r,apiRef:a,onRowMounted:i,isConnectedToQb:l,isStandaloneVpoShell:c,showAddExpenseButton:u})=>{const p=(0,Dt.A)(),f=(0,Kn.b)(),{userHasPermission:h,allRoles:b}=(0,Ye.A)(),{company:x}=(0,je.P)(),{project:v}=(0,De.B)(),{isFlagEnabled:y}=(0,ut.u)(),j=y(D.SX.USE_REVENUE_PAGE),A=y(D.SX.USE_EXPENSES_V2),{costCodeMap:w}=WE(),{varianceCodeMap:P}=Xa(),C=h({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:x?.id,projectId:v?.id});(0,d.useImperativeHandle)(a,()=>f.current,[f]),(0,d.useEffect)(()=>t.forEach(S=>i(S,f.current)),[]);const k=(0,d.useMemo)(()=>FE({isConnectedToQb:l,costCodeMap:w,varianceCodeMap:P}),[l,w,P]);return(0,e.jsx)(E.A,{sx:{padding:"12px",backgroundColor:p.palette.background.tertiary},children:(0,e.jsxs)(Fs.A,{sx:{display:"flex",flexDirection:"column",gap:"12px",padding:"16px"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:p.spacing(1)},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",children:n}),c&&(0,e.jsx)(I.A,{variant:"h6",fontWeight:"light",color:"textSecondary",sx:{ml:1,mr:1},children:"VPO"})]}),(0,e.jsxs)(I.A,{children:[(0,e.jsxs)(I.A,{display:"inline",color:"textSecondary",children:["Total Amount:"," "]}),(0,e.jsx)(I.A,{display:"inline",fontWeight:"bold",children:(0,Ze.up)(s)})]})]}),u&&(0,e.jsx)(sn,{size:"small",variant:"outlined",color:"primary",onClick:()=>o(f),children:"Add Expense"})]}),(0,e.jsx)(Ga,{children:(0,e.jsx)(Jn,{disableColumnMenu:!0,apiRef:f,getRowId:zE,processRowUpdate:(S,R)=>r(S,R),onRowAdded:i,rows:t,columns:k,pagination:!0,defaultSortModel:[{field:zn,sort:"desc"}],initialState:{pagination:{paginationModel:{pageSize:10,page:0}},columns:{columnVisibilityModel:{[zn]:!1,allowanceId:j&&!(0,ct.EL)(b),varianceCodeId:A&&!(0,ct.EL)(b)}}},columnHeaderHeight:Vn,rowHeight:Vn,pageSizeOptions:[10],isCellEditable:S=>T0(S,C),getCellClassName:cs})})]})})},$o=({handleResize:t})=>{(0,d.useEffect)(()=>{const n=(0,H.debounce)(t,100);return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[t])};var mr=m(45061),R0=m(48158),$E=m(53077),bs=m(87331);const HE=({fontSize:t,icon:n,isPending:s})=>(0,e.jsxs)(E.A,{sx:{position:"relative"},children:[(0,e.jsx)(E.A,{sx:[{lineHeight:0},s?{visibility:"hidden"}:{}],children:(0,d.cloneElement)(n,{fontSize:t})}),s&&(0,e.jsx)(E.A,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,e.jsx)(bt.A,{color:"inherit",size:"1.25rem"})})]}),hr=({onClick:t,icon:n,...s})=>{const[o,r]=Jd();return(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(HE,{isPending:o,icon:n}),onClick:t?r(t):void 0,...s})},QE=()=>{const{isModalOpen:t,openModal:n,closeModal:s}=ln(),[o,r]=(0,d.useState)();return(0,d.useMemo)(()=>({isModalOpen:a=>t&&o===a,openModal:a=>{r(a),n()},closeModal:s}),[t,n,s,o,r])},GE=t=>{const{project:n}=(0,De.B)(),[s]=(0,Me.p0)(),[o]=(0,Me.ib)(),{isModalOpen:r,openModal:a,closeModal:i}=QE(),l=(0,Fe.d)(),[c]=(0,Me.ci)();return{groupByKey:"costCode",defaultExpandedRowIds:[jo],getCreateExpenseRequestBody:u=>({costCodeId:typeof u?.id=="number"?u.id:null}),groupExpensesByRow:(u,p)=>p.filter(f=>u.id===jo?!f.costCodeId:f.costCodeId===u.id),getExpenseUpdatedMessage:(u,p)=>{if(u.costCodeId!==p.costCodeId)return`Moved expense to ${F0(u,t)}`},getDetailPanelTitle:u=>`${u.groupingLabel}${u.isMiscellaneousRow?` (${u.costCodeDescription})`:""}`,getRows:({expenses:u,projectCostCodes:p,costCodes:f})=>B0(u,p,f),sortComparator:(u,p,...f)=>cl(u.groupingLabel,p.groupingLabel,...f),onRowUpdate:async u=>{u.projectCostCode?await s({...u.projectCostCode,projectId:n?.id,budgetedAmount:Number(u.budgeted.toFixed(2))}).unwrap():await o({projectId:n?.id,costCodeId:typeof u.id=="number"?u.id:null,budgetedAmount:Number(u.budgeted.toFixed(2)),isPreliminaryBudget:!1}).unwrap()},getActions:({row:u})=>u.isAggregationRow?[]:[(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hr,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:()=>a(u.id),color:"inherit"}),(0,e.jsx)(Zt,{open:r(u.id),onClose:i,title:"Delete cost code",content:u.isDeletable?"This will remove this cost code from your Expenses page. If you created a budget object in the Preliminary Budget page, it will also be removed. You can always add it back later by selecting that cost code for an expense or budget object. Would you like to proceed?":"In order to delete a Cost Code group, it must not have any expenses. Move expenses to another group by selecting a new Cost Code, then try again.",hideCancel:!u.isDeletable,actions:u.isDeletable?[{title:"Delete",onClick:async()=>{try{await c({projectId:n?.id,projectCostCodes:(u.projectCostCode?[u.projectCostCode]:u.descendants).map(({id:p})=>Number(p))}).unwrap(),i()}catch(p){l.showError({message:fn(p)})}},color:"error"}]:[{title:"Okay",onClick:i}]})]})]}},O0=t=>t.purchaseOrderNumber??jo,KE=t=>t.purchaseOrderNumber?t.purchaseOrderTitle?`${t.purchaseOrderTitle} [${t.purchaseOrderNumber}]`:t.purchaseOrderNumber:Ao,YE=()=>({groupByKey:"purchaseOrder",getCreateExpenseRequestBody:t=>({purchaseOrderId:t?.purchaseOrderId??null}),groupExpensesByRow:(t,n)=>n.filter(s=>t.id===O0(s)),getExpenseUpdatedMessage:(t,n)=>{if(t.purchaseOrderId!==n.purchaseOrderId)return`Moved expense to ${t.purchaseOrderNumber??Ao}`},getDetailPanelTitle:t=>t.purchaseOrderNumber,getRows:({expenses:t})=>Array.from(t.reduce((n,s)=>{const o=KE(s),r=O0(s),a=n.get(r)??{id:r,path:[o],purchaseOrderNumber:o,purchaseOrderId:s.purchaseOrderId,budgeted:0,actuals:0,variance:0,totalAmount:0,amountPaid:0,balanceDue:0};return a.actuals+=s.amount,a.balanceDue+=s.balanceDue,a.totalAmount=a.actuals,a.amountPaid+=a.actuals-a.balanceDue,n.set(r,a),n},new Map).values()),sortComparator:(t,n)=>t.purchaseOrderNumber===Ao?-1:n.purchaseOrderNumber===Ao?1:t.purchaseOrderNumber.localeCompare(n.purchaseOrderNumber)}),M0=({vendorId:t,purchaseOrderNumber:n})=>!t&&!n?jo:`${t??$a}${n??Ao}`,qE=()=>({groupByKey:"vendor",getCreateExpenseRequestBody:t=>({purchaseOrderId:t?.purchaseOrderId??null,vendorId:t?.vendorId??null}),groupExpensesByRow:(t,n)=>n.filter(s=>t.id===M0(s)),getExpenseUpdatedMessage:(t,n)=>{if(t.vendorId!==n.vendorId)return`Moved expense to ${t.vendorName??$a}`;if(t.purchaseOrderId!==n.purchaseOrderId)return`Moved expense to ${t.purchaseOrderNumber??Ao}`},getDetailPanelTitle:t=>t.purchaseOrderNumber,getRows:({expenses:t})=>Array.from(t.reduce((n,s)=>{const o=s.vendorName??$a,r=s.purchaseOrderNumber??Ao,a=M0(s),i=n.get(a)??{id:a,path:[o,r],purchaseOrderNumber:r,purchaseOrderId:s.purchaseOrderId,vendorId:s.vendorId,budgeted:0,actuals:0,variance:0,totalAmount:0,amountPaid:0,balanceDue:0};return i.actuals+=s.amount,i.balanceDue+=s.balanceDue,i.totalAmount=i.actuals,i.amountPaid+=i.actuals-i.balanceDue,n.set(a,i),n},new Map).values()),sortComparator:(t,n,s,o)=>{const r=Co(s.rowNode),a=Co(o.rowNode);return r===Ao||r===$a?-1:a===Ao||a===$a?1:r.localeCompare(a)}}),gr=(t,{skip:n}={skip:!1})=>{const[s,o]=(0,d.useState)(!1),{createEvent:r}=(0,io.A)();(0,d.useEffect)(()=>{n||s||(o(!0),r(t))},[s,n,t,r])},Ho=async t=>{const n=await nt.Ay.get(t,{responseType:"blob"}),s=URL.createObjectURL(new Blob([n.data],{type:n.headers["content-type"]})),o=n.headers["content-disposition"]?.match(/filename="(.+?)"/)?.[1];if(!o)throw new Error('Response is missing "filename" in the "Content-Disposition" header');const r=document.createElement("a");r.href=s,r.download=o,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)},L0="invoicesToolbar",Tc="__sort__",Rc=[{field:Tc,sort:"asc"}],XE={id:dr,path:[dr],budgeted:0,actuals:0,variance:0,totalAmount:0,amountPaid:0,balanceDue:0,isAggregationRow:!0},F0=(t,n=[])=>{if(t?.costCodeId){const s=n.find(o=>Number(o.id)===t.costCodeId);if(s?.codeDescription)return s.codeDescription}return lc};class JE{constructor(n,s){this.costCodes=n,this.projectCostCodes=s,this.rows=new Map,this.costCodeAncestors=n.reduce((o,r)=>(o.set(Number(r.id),r.parentPath),o),new Map)}addExpense(n){const s=this.costCodes.find(u=>Number(u.id)===n.costCodeId),o=s?.id?Number(s.id):jo,r=F0(n,this.costCodes),a=this.projectCostCodes.find(u=>u.costCodeId===n.costCodeId),{path:i,isMiscellaneousRow:l}=dc(s,r);this.has(o)||this.set(o,{id:o,groupingLabel:l?lr:r,costCodeDescription:r,budgeted:a?.budgetedAmount??0,actuals:0,variance:0,totalAmount:0,amountPaid:0,balanceDue:0,projectCostCode:a,path:i,isMiscellaneousRow:l,isDeletable:!1,isEditable:!0,descendants:[]});const c=this.rows.get(String(o));return c&&(c.actuals+=n.amount,c.balanceDue+=n.balanceDue,c.totalAmount=c.actuals,c.variance=c.budgeted-c.actuals,c.amountPaid=c.actuals-c.balanceDue),this}has(n){return this.rows.has(String(n))}set(n,s){this.rows.set(String(n),s);const o=s.projectCostCode;if(o?.costCodeId){const r=this.costCodeAncestors.get(o.costCodeId);r?.slice(0,s.isMiscellaneousRow?r.length:-1).forEach(a=>{const i=this.costCodeAncestors.get(Number(a.id))?.map(({codeDescription:p})=>p)??[],l=a.codeDescription,c=`/${i.join("/")}`,u=this.rows.get(c);u?u.descendants.push(o):this.rows.set(c,{id:c,groupingLabel:l,costCodeDescription:l,budgeted:0,actuals:0,variance:0,totalAmount:0,amountPaid:0,balanceDue:0,path:i,isMiscellaneousRow:!1,isDeletable:s.isDeletable,isEditable:!1,descendants:[o]})})}return this}values(){return Array.from(this.rows.values())}}const B0=(t,n,s)=>{const o=t.reduce((r,a)=>r.addExpense(a),new JE(s,n));return n.reduce((r,a)=>{if(!a.costCodeId)return r;const i=s.find(p=>String(p.id)===String(a.costCodeId));if(!i||!a.isPreliminaryBudget||r.has(String(a.costCodeId)))return r;const l=i.codeDescription,{path:c,isMiscellaneousRow:u}=dc(i,l);return r.set(String(a.costCodeId),{id:a.costCodeId,groupingLabel:u?lr:l,costCodeDescription:l,budgeted:a.budgetedAmount,actuals:0,variance:a.budgetedAmount,totalAmount:0,amountPaid:0,balanceDue:0,projectCostCode:a,path:c,isMiscellaneousRow:u,isDeletable:!0,isEditable:!0,descendants:[]}),r},o).values()},ZE=t=>t.path,eP=({getCreateExpenseRequestBody:t,groupExpensesByRow:n,getRows:s,getExpenseUpdatedMessage:o,sortComparator:r,groupByKey:a,getDetailPanelTitle:i,onRowUpdate:l,getActions:c,defaultExpandedRowIds:u=[],costCodes:p})=>{const{project:f}=(0,De.B)(),{company:h}=(0,je.P)(),{userHasPermission:b,allRoles:x}=(0,Ye.A)(),v=b({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:h?.id,projectId:f?.id}),{isConnected:y,fetchQuickbooksConnectionLink:j}=hc(h?.id),{data:A=[]}=(0,Me.cG)({projectId:f?.id},{skip:!f?.id}),w=(0,d.useMemo)(()=>A.reduce((pe,Ee)=>(Ee.internalId&&pe.set(Ee.internalId,{isStandaloneVpoShell:"isStandaloneVpoShell"in Ee?Ee.isStandaloneVpoShell:!1}),pe),new Map),[A]),{data:P=[],isFetching:C,isLoading:k}=(0,Me.A8)({projectId:f?.id},{skip:!f?.id,refetchOnMountOrArgChange:!0}),{data:S=[],isFetching:R,isLoading:B}=(0,Me.xd)({projectId:f?.id,include_vpo_invoices:!0},{skip:!f?.id,refetchOnMountOrArgChange:!0});gr({tool:D.w5.BUDGET,action:S.length?D.H1.OPEN_WITH_DATA:D.H1.OPEN,content_type:"project",object_id:f?.id},{skip:R});const{isFetching:T}=(0,Me.pC)({projectId:f?.id},{skip:!f?.id});(0,Me.T5)({company:h?.id},{skip:!h?.id});const W=C||R||T,N=k||B;(0,d.useEffect)(()=>{h?.id&&j()},[j,h?.id]);const O=(0,Kn.b)(),z=(0,d.useRef)(null),Q=(0,Fe.d)(),re=(0,Kn.b)(),[ue]=(0,Me.Nx)(),[le]=(0,Me.cp)(),{waitForRow:F,onRowAdded:V}=po(),$=(0,d.useCallback)(async(pe,Ee)=>{const Te=await ue({projectId:f?.id,invoiceNumber:"",completedDate:us(new Date().toString()),amount:0,paid:0,balanceDue:0,enteredDate:us(new Date().toString()),dueDate:us(new Date().toString()),isManual:!0,status:cr.Approved,...t(Ee)}).unwrap();if(!Ee||Ee.id===jo){let $e=O.current.getRowNode(jo);for(;$e?.parent&&$e.depth!==0;)O.current?.setRowChildrenExpansion($e.parent,!0),$e=O.current.getRowNode($e.parent);O.current.setExpandedDetailPanels(Array.from(new Set([jo,...O.current.getExpandedDetailPanels()])))}const me=await F(Te.uid,pe);pe.current.setSortModel([]),pe.current.setPage(0),pe.current.startCellEditMode({id:me.uid,field:"description"})},[ue,f?.id,Q,t]),ee=(0,d.useCallback)(async(pe,Ee)=>{const Te=await le({...pe,amount:Number(pe.amount.toFixed(2)),paid:Number(pe.paid.toFixed(2)),dueDate:us(pe.dueDate),completedDate:us(pe.completedDate)}).unwrap(),me=o(Te,Ee);me&&Q.showSuccess({message:me})},[le,o]),X=eo(O),G=(0,d.useMemo)(()=>S.filter(pe=>pe.visibleInInvoicesTab),[S]),Y=(0,d.useMemo)(()=>N?[]:s({expenses:G,projectCostCodes:P,costCodes:p}),[G,P,p,N,s]),he=(0,d.useMemo)(()=>[{field:Tc,type:"custom",valueGetter:(pe,Ee)=>Ee,sortComparator:r},...LE,{field:"actions",type:"actions",width:50,getActions:c??(()=>[])}],[r,c]),ne=cc[a],J=(0,d.useMemo)(()=>RE(ne),[ne]);return $o({handleResize:()=>zo(z.current)}),(0,d.useEffect)(()=>{O.current.setRows(Y),O.current.setExpandedDetailPanels(u),O.current.setSortModel(Rc)},[a]),(0,e.jsxs)(e.Fragment,{children:[v&&!(0,ct.EL)(x)&&(0,e.jsx)(mr.A,{container:()=>document.getElementById(L0),children:(0,e.jsxs)(E.A,{sx:{mx:"8px",display:"flex",gap:"8px"},children:[(0,e.jsx)(sn,{size:"small",variant:"contained",color:"secondary",onClick:()=>Ho(`/budget/v2/project/${f?.id}/expenses/export_csv`),children:"Export Expenses"}),(0,e.jsx)(sn,{variant:"contained",size:"small",onClick:()=>$(re),children:"Add Expense"})]})}),(0,e.jsx)(Vo,{ref:z,columnsWithBorder:[yl,bl],children:(0,e.jsx)(Jn,{apiRef:O,rows:Y,loading:W,slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}},processRowUpdate:l,groupingColDef:J,columns:he,columnGroupingModel:OE,hideFooter:!0,treeData:!0,getTreeDataPath:ZE,onSortModelChange:(pe,Ee)=>{Ee.api.setSortModel(pe.length?pe:Rc)},initialState:{sorting:{sortModel:Rc},columns:{columnVisibilityModel:{[Tc]:!1,[Hr.a.field]:!1}},aggregation:{model:{[yl]:"sum",[wc]:"sum",[Ec]:"sum",[bl]:"sum",[Pc]:"sum",[Ic]:"sum"}}},pinnedRows:{top:[XE]},getDetailPanelHeight:()=>"auto",getDetailPanelContent:({row:pe})=>{const Ee=pe.purchaseOrderId,Te=Ee?w.get(Ee)?.isStandaloneVpoShell??!1:!1;return(0,e.jsx)(VE,{apiRef:pe.id===jo?re:{current:void 0},onAddExpenseClick:me=>$(me,pe),onExpenseUpdate:ee,onRowMounted:V,rows:n(pe,G),title:i(pe),totalAmount:pe.totalAmount,isConnectedToQb:y,isStandaloneVpoShell:Te,showAddExpenseButton:v&&!(0,ct.EL)(x)&&!Te})},getRowClassName:X,getCellClassName:cs,columnHeaderHeight:Vn,rowHeight:Vn,disableVirtualization:!0,isCellEditable:pe=>T0(pe,v),disableColumnMenu:!0})})]})},tP=({value:t,onChange:n})=>{const[s,o]=(0,d.useState)(null),r=!!s,a=c=>{o(c.currentTarget)},i=()=>{o(null)},l=c=>{n(c),i()};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qt.A,{title:"Group by",children:(0,e.jsx)(pt.A,{onClick:a,children:(0,e.jsx)($E.A,{})})}),(0,e.jsxs)(Hn.A,{anchorEl:s,open:r,onClose:i,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[(0,e.jsx)(R0.A,{children:"Group by"}),Object.entries(cc).map(([c,u])=>Nw(c)&&(0,e.jsxs)(it.A,{sx:{width:"256px"},onClick:()=>l(c),children:[(0,e.jsx)(Cn.A,{children:u}),c===t&&(0,e.jsx)(ki.A,{})]},c))]})]})},N0=()=>{const[t,n]=fo("expensesGroupBy",{initialState:"costCode"}),{project:s}=(0,De.B)(),{company:o}=(0,je.P)(),{userHasPermission:r,allRoles:a}=(0,Ye.A)(),i=r({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:o?.id,projectId:s?.id}),{data:l=[]}=ar(s?.companyId,{skip:!s?.companyId}),c=(0,d.useMemo)(()=>wo(l),[l]),u=GE(c),p=YE(),f=qE(),h=[u,p,f].find(({groupByKey:b})=>b===t);if(!h)throw new Error("Invalid grouping model");return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(mr.A,{container:()=>document.getElementById(dl),children:(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,e.jsx)(tP,{value:t,onChange:n}),i&&!(0,ct.EL)(a)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ce.A,{orientation:"vertical",flexItem:!0}),(0,e.jsx)("div",{id:L0})]})]})}),(0,e.jsx)(eP,{...h,costCodes:c})]})},nP=({id:t,field:n,value:s,colDef:o,api:r})=>{const a=(0,d.useRef)(null),[i,l]=(0,d.useState)(!1);return(0,d.useLayoutEffect)(()=>{l(!0)},[]),(0,e.jsx)(E.A,{ref:a,sx:{width:"100%",height:0,margin:"-2px"},children:(0,e.jsx)(_a.A,{open:i,anchorEl:a.current,placement:"bottom-start",children:(0,e.jsx)(Fs.A,{elevation:3,square:!0,sx:c=>({paddingX:"2px",border:1,borderColor:c.palette.primary.main}),children:(0,e.jsx)(Ei.Ay,{autoFocus:!0,minRows:3,multiline:!0,value:s,sx:{minWidth:o.computedWidth,textarea:{resize:"both"}},onChange:c=>r.setEditCellValue({id:t,field:n,value:c.target.value})})})})})},Gr=({row:t})=>{const{company:n}=(0,je.P)(),{data:s=[]}=ar(n?.id,{skip:!n?.id}),r=(0,d.useMemo)(()=>wo(s),[s]).find(({id:a})=>String(a)===String(t.costCodeId)||String(a)===String(t.costCode));return r?(0,e.jsx)(e.Fragment,{children:r.codeDescription}):(0,e.jsx)(e.Fragment,{children:t.costCode??""})},sP=rs(({purchaseOrder:t,onClose:n,...s})=>{const{project:o}=(0,De.B)(),[r]=(0,Me._C)(),[a]=(0,Me.GC)(),{data:i=[],isFetching:l,refetch:c}=(0,Me.KO)({purchaseOrderId:t.internalId,projectId:o?.id},{refetchOnMountOrArgChange:!0,skip:!o?.id}),u=(0,Me.sK)(),{userHasPermission:p}=(0,Ye.A)(),f=p({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:o?.companyId,projectId:o?.id});return(0,e.jsx)(y0,{...s,title:"Attach Purchase Order Documents",onClose:n,files:i,isFetching:l,createFileUploadUrl:async h=>{const{uploadUrl:b}=await a({projectId:o?.id,purchaseOrderId:t.internalId,fileName:h}).unwrap();return b},deleteFiles:async h=>{await r({projectId:o?.id,purchaseOrderId:t.internalId,fileIds:h}).unwrap()},userCanModifyFiles:f,refetchFiles:c,onFileCountChange:h=>{u({...t,filesCount:h})}})}),Oc=()=>{const{project:t}=(0,De.B)(),n=!t?.id,{data:s=[],isFetching:o}=(0,Me.FV)({projectId:t?.id},{skip:n}),{data:r=[],isFetching:a}=(0,Me.QA)({projectId:t?.id},{skip:n}),i=o||a,l=(0,d.useMemo)(()=>[...s].sort((u,p)=>u.label.localeCompare(p.label)),[s]),c=(0,d.useMemo)(()=>[...r].sort((u,p)=>u.label.localeCompare(p.label)),[r]);return{purchaseOrderStatusChoices:l,invoiceStatusChoices:c,isFetching:i}},_0=t=>(0,e.jsx)("div",{...t});var oP=m(42268),Mc=m(66904);function rP(t,n){let s=n,o=1;for(;t.has(s);)s=`${n} (${o})`,o+=1;return s}function U0(t,n,s,o){const r=new Set;for(const a of t){if(o!==void 0&&s&&s(a)===o)continue;const i=n(a);i&&r.add(i)}return r}function W0(t,n,s=o=>o.id??o.internalId??o.rowId){const o=(0,d.useMemo)(()=>U0(t,n),[t,n]);return(0,d.useCallback)((a,i)=>{const l=i==null?o:U0(t,n,s,i);return rP(l,a)},[o,t,n,s])}const aP="Variance",Lc="Project ID and Purchase Order ID are required for this operation.",Fc=({purchaseOrderId:t,isStandalone:n,skipFetching:s=!1}={})=>{const{project:o}=(0,De.B)(),[r]=(0,Me.Rn)(),[a]=(0,Me.uC)(),[i]=(0,Me.Zn)(),l=(0,Fe.d)(),{data:c=[],isLoading:u,refetch:p}=(0,Me.v6)({projectId:o?.id,purchaseOrderId:t,isStandalone:n},{skip:!o?.id||!t||s,refetchOnMountOrArgChange:!0}),f=W0(c,v=>v.title,v=>v.id),h=(0,d.useCallback)(async(v=!1)=>{if(!o?.id||!t){l.showError({message:Lc});return}try{return await r({projectId:o.id,title:"",isStandalone:v,purchaseOrderId:t}).unwrap()}catch(y){console.error("Error creating variance purchase order:",y),l.showError({message:"Failed to create variance purchase order"});return}},[o,t,r,l]),b=(0,d.useCallback)(async(v,y)=>{if(!o?.id||!t)return l.showError({message:Lc}),!1;let j=y.trim();j===""&&(j=f(aP,v));try{return await a({projectId:o.id,id:v,title:j,purchaseOrderId:t}).unwrap(),!0}catch(A){return console.error("Error updating variance purchase order:",A),l.showError({message:"Failed to update variance purchase order"}),!1}},[o,t,a,f,l]),x=(0,d.useCallback)(async v=>{if(!o?.id||!t){l.showError({message:Lc});return}try{await i({projectId:o.id,id:v,purchaseOrderId:t}).unwrap()}catch(y){console.error("Error deleting variance purchase order:",y),l.showError({message:"Failed to delete variance purchase order"})}},[o,t,i,l]);return{existingVPOs:c,createVariancePurchaseOrder:h,updateVariancePurchaseOrderTitle:b,deleteVariancePurchaseOrderById:x,isLoading:u,refetchVPOs:p,generateUniqueVPOTitle:f}};var Ds=m(7425);const iP=rs(({purchaseOrder:t,open:n,onClose:s})=>{const{project:o}=(0,De.B)(),{existingVPOs:r,isLoading:a}=Fc({purchaseOrderId:t.internalId??void 0}),i=(0,Ds.Wx)({initialValues:{printPo:!1,vpoIdsToPrint:[]},onSubmit:async({printPo:f,vpoIdsToPrint:h})=>{const b=h.map(x=>Ho(`/budget/v2/project/${o?.id}/variance-purchase-orders/${x}/render_pdf`));f&&b.push(Ho(`/budget/v2/project/${o?.id}/purchase-orders/${t.internalId}/render_pdf`)),await Promise.allSettled(b),s()}}),l=i.values.vpoIdsToPrint.length+Number(i.values.printPo),c=!a&&!r.length,u=!!(!a&&t.isStandaloneVpoShell&&r[0]);(0,d.useEffect)(()=>{(async()=>u?(await Ho(`/budget/v2/project/${o?.id}/variance-purchase-orders/${r[0].id}/render_pdf`),s()):c&&(await Ho(`/budget/v2/project/${o?.id}/purchase-orders/${t.internalId}/render_pdf`),s()))()},[t,u,r,c]);const p=a||c||u;return(0,e.jsx)(Zt,{title:"Print Purchase Orders",open:n,onClose:s,infoElement:l?(0,e.jsxs)(I.A,{variant:"body2",color:"primary",sx:{pl:"8px"},children:[l," selected"]}):null,actions:[{title:"Print",loading:i.isSubmitting,disabled:p||!l,onClick:()=>i.handleSubmit()}],children:(0,e.jsx)(E.A,{sx:{width:"444px"},children:p?(0,e.jsx)(bt.A,{sx:{display:"block",m:"auto"}}):(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(qn.A,{sx:{px:"8px",pt:0},children:[(0,e.jsx)(_n.Ay,{secondaryAction:(0,e.jsx)(ve.A,{edge:"end",name:"printPo",checked:i.values.printPo,onChange:i.handleChange}),children:(0,e.jsx)(Cn.A,{primary:t.title})}),(0,e.jsx)(Ce.A,{component:"li",sx:{mx:"-8px"}}),r.map(f=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(_n.Ay,{secondaryAction:(0,e.jsx)(ve.A,{edge:"end",name:"vpoIdsToPrint",value:f.id,onChange:i.handleChange}),children:(0,e.jsx)(Cn.A,{primary:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.A,{component:"span",color:"textSecondary",children:"VPO"})," ",f.title]})})},f.id),(0,e.jsx)(Ce.A,{component:"li",sx:{mx:"-8px"}})]}))]})})})})}),Bc=t=>{const n=[];return t.poRef||n.push("PO#"),t.title||n.push("Title"),t.vendorId||n.push("Vendor"),t.dateCreated||n.push("Date Created"),t.totalAmount==null&&n.push("Total Cost"),n.length?`Missing required fields: ${n.join(", ")}`:null},lP=({row:t,gridApiRef:n})=>{const s=(0,Fe.d)(),{project:o}=(0,De.B)(),r=(0,Dt.A)(),[a,i]=se().useState(null),l=se().useRef(null),c=!!a,u=Bc(t),{createVariancePurchaseOrder:p}=Fc({purchaseOrderId:t.internalId??void 0,skipFetching:!0}),{isModalOpen:f,openModal:h,closeModal:b}=ln(),x=()=>{i(l.current)},v=()=>{i(null)},y=async()=>{const j=n?.current;try{if(!j){console.error("Grid API not available in PurchaseOrderActionMenu");return}await p();const A=j.getExpandedDetailPanels();j.setExpandedDetailPanels([...A,t.uid])}catch{s.showError({message:"Failed to create variance purchase order"})}v()};return(0,e.jsxs)(se().Fragment,{children:[(0,e.jsx)(pt.A,{ref:l,onClick:x,"aria-label":"More actions",sx:{visibility:t.isManual?"visible":"hidden"},children:(0,e.jsx)(Mo.A,{})}),(0,e.jsxs)(Hn.A,{id:"purchase-order-action-menu",anchorEl:a,open:c,onClose:v,MenuListProps:{"aria-labelledby":"purchase-order-action-button"},children:[t.isManual&&!t.isStandaloneVpoShell&&(0,e.jsxs)(it.A,{onClick:y,sx:{color:r.palette.text.primary},children:[(0,e.jsx)(oP.A,{sx:{mr:1,color:r.palette.text.secondary}}),"Add Variance"]}),(0,e.jsx)(qt.A,{title:u,children:(0,e.jsx)("span",{children:(0,e.jsxs)(it.A,{onClick:()=>{h()},disabled:!!u,sx:{color:r.palette.text.primary},children:[(0,e.jsx)(Mc.A,{sx:{mr:1,color:r.palette.text.secondary}})," ","Print PDF"]})})},"print-tooltip"),(0,e.jsx)(iP,{open:f,onClose:()=>{b(),v()},purchaseOrder:t})]},"menu")]})};var z0=m(82022);const to=({shape:t,color:n="primary",sx:s,...o})=>(0,e.jsx)(z0.A,{...o,color:n,sx:[t==="square"?{borderRadius:"4px"}:{},n!=="default"?r=>({border:1,color:r.palette[n].main,borderColor:(0,$i.a)(r.palette[n].main,.8),backgroundColor:(0,$i.a)(r.palette[n].main,.95)}):"",...Array.isArray(s)?s:[s]]});var dP=m(90441),Nc=m(28087),cP=m(34536),V0=m(23005);function $0(t){return t?.type==="singleSelect"}function uP(t,n){if(t)return typeof t.valueOptions=="function"?t.valueOptions({field:t.field,...n}):t.valueOptions}function pP(t,n,s){if(n===void 0)return;const o=n.find(r=>{const a=s(r);return String(a)===String(t)});return s(o)}function mP(t){return!!t.key}const H0=t=>{const n=(0,dP.A)(),{id:s,value:o,formattedValue:r,api:a,field:i,row:l,rowNode:c,colDef:u,cellMode:p,isEditable:f,tabIndex:h,className:b,hasFocus:x,isValidating:v,isProcessingProps:y,error:j,onValueChange:A,initialOpen:w=n.editMode===Nc.RL.Cell,renderSelectedOption:P,renderOption:C,...k}=t,S=(0,cP.h)(),R=se().useRef(),B=se().useRef(),[T,W]=se().useState(w),O=(n.slotProps?.baseSelect||{}).native??!1,{MenuProps:z,...Q}=n.slotProps?.baseSelect||{};if(se().useEffect(()=>{x&&B.current?.focus()},[x]),!$0(u))return null;const re=uP(u,{id:s,row:l});if(!re)return null;const ue=u.getOptionValue,le=u.getOptionLabel,F=async ee=>{if(!$0(u)||!re)return;W(!1);const X=ee.target,G=pP(X.value,re,ue);A&&await A(ee,G),await S.current.setEditCellValue({id:s,field:i,value:G},ee),S.current.stopCellEditMode({id:s,field:i})},V=(ee,X)=>{if(n.editMode===Nc.RL.Row){W(!1);return}if(X==="backdropClick"||ee.key==="Escape"){const G=S.current.getCellParams(s,i);S.current.publishEvent("cellEditStop",{...G,reason:ee.key==="Escape"?V0.Q.escapeKeyDown:V0.Q.cellFocusOut})}},$=ee=>{mP(ee)&&ee.key==="Enter"||W(!0)};return!re||!u?null:(0,e.jsx)(n.slots.baseSelect,{ref:R,inputRef:B,value:o,onChange:F,open:T,onOpen:$,MenuProps:{onClose:V,...z},error:j,native:O,fullWidth:!0,renderValue:P?ee=>P(re.find(X=>ue(X)===ee)):void 0,...k,...Q,children:re.map(ee=>{const X=ue(ee);return(0,d.createElement)(n.slots.baseSelectOption,{...n.slotProps?.baseSelectOption||{},native:O,key:X,value:X},C(ee))})})},hP=t=>(0,e.jsx)("div",{...t}),Q0=t=>({getExpenseActions:({row:s})=>{const{isModalOpen:o,openModal:r,closeModal:a}=ln(),{isModalOpen:i,openModal:l,closeModal:c}=ln(),{isModalOpen:u,openModal:p,closeModal:f}=ln(),h=g0(),[b]=(0,Me.cp)(),[x]=(0,Me.GH)(),v=(0,Fe.d)(),y=async j=>{await b({uid:j.uid,projectId:j.projectId,visibleInInvoicesTab:!0,status:j.status===cr.NotApproved?cr.Approved:j.status,isManual:j.isManual,variancePurchaseOrderId:j.variancePurchaseOrderId||void 0,purchaseOrderId:j.purchaseOrderId||void 0,billType:TE({variancePurchaseOrderId:j.variancePurchaseOrderId,purchaseOrderId:j.purchaseOrderId,billType:j.billType||void 0})}).unwrap()};return[(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hr,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",color:"inherit",onClick:l,disabled:!t||!s.isManual}),(0,e.jsx)(Zt,{open:i,onClose:c,title:"Delete invoice?",content:"Deleting this invoice will remove it from all pages. This action cannot be undone",actions:[{title:"Delete",onClick:async()=>{try{await x({projectId:s.projectId,uid:s.uid,variancePurchaseOrderId:s.variancePurchaseOrderId||void 0,purchaseOrderId:s.purchaseOrderId||void 0}).unwrap(),c()}catch(j){v.showError({message:fn(j)})}},color:"error"}]})]}),s.isManual?(0,e.jsx)(hr,{icon:(0,e.jsx)(er.A,{badgeContent:s.filesCount,color:"primary",children:(0,e.jsx)(vc.A,{})}),label:"Attach File",color:"inherit",onClick:p,disabled:!t||!s.isManual}):(0,e.jsx)(hP,{children:(0,e.jsx)(hr,{icon:(0,e.jsx)(bc.A,{}),label:"Download",color:"inherit",onClick:()=>h(s),disabled:!t})}),(0,e.jsx)(qt.A,{title:s.visibleInInvoicesTab?"This invoice is available on the Invoices tab":"",children:(0,e.jsxs)(_0,{children:[(0,e.jsx)(hr,{disabled:s.visibleInInvoicesTab||!t||!s.isManual,icon:(0,e.jsx)(m0.A,{}),onClick:async()=>{if(s.status===cr.NotApproved)r();else try{await y(s)}catch(j){v.showError({message:fn(j)})}},label:"Send to Invoices",color:"inherit"}),(0,e.jsx)(Zt,{open:o,onClose:a,title:"Send to Invoices",content:"This Invoice has not been marked as Approved. Would you like approve payment and send to invoicing?",actions:[{title:"Approve & Send",onClick:async()=>{try{await y(s),a()}catch(j){v.showError({message:fn(j)})}}}]})]})}),(0,e.jsx)(b0,{open:u,onClose:f,row:s})]}}),gP=({open:t,onClose:n,onRemoveJustPO:s,onRemoveEverything:o})=>(0,e.jsx)(Zt,{open:t,onClose:n,title:"Deleting a Purchase Order",content:`Deleting a purchase order will remove the Purchase Order and any
        Variance Purchase Orders (VPOs) associated with the PO. You have the
        option to either remove just the PO record, or remove the PO and all
        associated invoices/bills, payments and change orders. How would you like to proceed?`,actions:[{title:"Cancel",onClick:n,color:"inherit"},{title:"Remove just PO",onClick:s,color:"primary"},{title:"Remove Everything",onClick:o,color:"error"}],hideCancel:!0}),G0={unreleased:"secondary",pending_approval:"warning",declined:"error",approved:"success",open:"info",closed:"secondary"},fP=t=>{const{project:n}=(0,De.B)(),{purchaseOrderStatusChoices:s}=Oc(),o=So(D.w5.BUDGET,D.a2.EDIT_INVOICE);return(0,d.useMemo)(()=>[Zs,{field:"title",headerName:"Title",type:"string",flex:1,minWidth:100,editable:!0},{field:"poRef",headerName:"PO/VPO Ref #",type:"string",flex:1,minWidth:150,editable:!0},{field:"vendorId",headerName:"Vendor",type:"custom",flex:1,minWidth:100,editable:!0,renderCell:r=>r.row.vendorName,renderEditCell:r=>(0,e.jsx)(j0,{...r})},{field:"dateCreated",headerName:"Date Created",type:"date",valueGetter:r=>r?new Date(r):"",flex:1,minWidth:100,editable:!0},{field:"poAmount",headerName:"PO Amount",type:"number",valueFormatter:vt,flex:1,minWidth:100},{field:"varianceAmount",headerName:"Variance Amount",type:"number",valueFormatter:vt,flex:1,minWidth:100},{field:"totalAmount",headerName:"Total Amount",type:"number",valueFormatter:vt,flex:1,minWidth:100},{field:"paid",headerName:"Paid",type:"number",valueFormatter:vt,flex:1,minWidth:100},{field:"balanceDue",headerName:"Balance Due",type:"number",valueFormatter:vt,flex:1,minWidth:100},{field:"scope",headerName:"Scope",type:"string",flex:1,minWidth:100,editable:!0,renderEditCell:r=>(0,e.jsx)(nP,{...r})},{field:"status",headerName:"Status",type:"singleSelect",valueOptions:s,renderCell:({value:r,formattedValue:a})=>(0,e.jsx)(to,{color:G0[r],label:a,shape:"square"}),renderEditCell:r=>(0,e.jsx)(H0,{...r,renderOption:({label:a,value:i})=>(0,e.jsx)(to,{color:G0[i],label:a,shape:"square"})}),flex:1,minWidth:100,editable:!0},{field:"actions",type:"actions",headerName:"Actions",flex:1,minWidth:100,getActions:({row:r})=>{const{isModalOpen:a,openModal:i,closeModal:l}=ln(),[c]=(0,Me.ni)(),{isModalOpen:u,openModal:p,closeModal:f}=ln(),h=(0,Fe.d)(),b=!o||!r.isManual,x=[],v=(0,d.useCallback)(async({cascadeDelete:y})=>{try{await c({internalId:r.internalId,projectId:n?.id,cascadeDelete:y}).unwrap(),l()}catch(j){h.showError({message:String(j)})}},[c,r,n]);return x.push((0,e.jsx)(qt.A,{title:b?"A Purchase Order must not have any Invoices or Payments in order to be deleted.":"",children:(0,e.jsx)(_0,{children:(0,e.jsx)(hr,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:i,color:"inherit",disabled:b})})},"delete")),x.push((0,e.jsx)(hr,{icon:(0,e.jsx)(er.A,{badgeContent:r.filesCount,color:"primary",children:(0,e.jsx)(vc.A,{})}),disabled:!o||!r.isManual,label:"Attachments",onClick:p,color:"inherit"},"attach")),x.push((0,e.jsx)(lP,{row:r,gridApiRef:t},"action-menu")),qh(r)&&x.push((0,e.jsx)(sP,{open:u,onClose:f,purchaseOrder:r},"attach-modal")),x.push((0,e.jsx)(gP,{open:a,onClose:l,onRemoveJustPO:()=>v({cascadeDelete:!1}),onRemoveEverything:()=>v({cascadeDelete:!0})},"delete-modal")),x}}],[s,o,n,t])},xP=Object.entries({canceled:"Canceled",closed:"Closed",delivered:"Delivered",delivery_in_progress:"Delivery In Progress",out_for_delivery:"Out For Delivery",delivery_scheduled:"Delivery Scheduled",order_pending:"Order Pending",pos:"POS",order_processing:"Order Processing",not_scheduled:"Not Scheduled",undeliverable:"Undeliverable",unknown:"Unknown"}).map(([t,n])=>({value:t,label:n})),yP=()=>{const{invoiceStatusChoices:t}=Oc(),n=So(D.w5.BUDGET,D.a2.EDIT_INVOICE),{getExpenseActions:s}=Q0(n);return(0,d.useMemo)(()=>[Zs,{field:"description",headerName:"Description",type:"string",flex:1,minWidth:100,editable:!0},{field:"orderNumber",headerName:"Order #",type:"string",flex:1,minWidth:100,editable:!0},{field:"deliveryNumber",headerName:"Delivery #",type:"string",flex:1,minWidth:100,editable:!0,renderCell:o=>{const{project:r}=(0,De.B)();return o.row.invoiceNumber?null:!o.row.isManual&&o.value?(0,e.jsx)(Rn.A,{component:L.Link,to:`/projects/${r?.id}/materials/deliveries/${o.value}`,children:o.value}):o.value}},{field:"invoiceNumber",headerName:"Invoice #",type:"string",flex:1,minWidth:100,editable:!0,renderCell:o=>{const{project:r}=(0,De.B)();return!o.row.isManual&&o.row.deliveryNumber?(0,e.jsx)(Rn.A,{component:L.Link,to:`/projects/${r?.id}/materials/deliveries/${o.row.deliveryNumber}`,children:o.value}):o.value}},{field:"costCodeId",headerName:"Cost Code",flex:1,minWidth:150,editable:!0,renderCell:o=>(0,e.jsx)(Gr,{...o}),renderEditCell:o=>(0,e.jsx)(ur,{...o})},{field:"completedDate",headerName:"Date Completed",type:"date",flex:1,minWidth:100,editable:!0,valueGetter:o=>o?new Date(o):""},{field:"dueDate",headerName:"Due Date",type:"date",flex:1,minWidth:100,editable:!0,valueGetter:o=>o?new Date(o):""},{field:"amount",headerName:"Amount",type:"number",flex:1,minWidth:100,editable:!0,valueFormatter:vt,renderEditCell:o=>(0,e.jsx)(ms,{...o,allowNegative:!0})},{field:"paid",headerName:"Paid",type:"number",flex:1,minWidth:100,editable:!0,valueFormatter:vt,renderEditCell:o=>(0,e.jsx)(ms,{...o,allowNegative:!1})},{field:"balanceDue",headerName:"Balance Due",type:"number",flex:1,minWidth:100,valueFormatter:vt},{field:"status",headerName:"Status",type:"singleSelect",valueOptions:({row:o})=>o?.bfsType==="order"||o?.bfsType==="delivery"?xP:t,flex:1,minWidth:100,editable:!0},{field:"actions",type:"actions",headerName:"Actions",getActions:s}],[t,n,s])},_c="Purchase order numbers cannot match purchase orders from other vendors.",bP=["costCodeId","varianceCodeId","allowanceId"],vP=(t,n)=>{if(n.find(o=>o.internalId!==t.internalId&&o.poRef===t.poRef))throw new Error(_c)},no=t=>(t instanceof Date?t:new Date(t)).toISOString().slice(0,10);function Z_(t){return!!t.key}const jP=(t,n={})=>{const s={varianceAmount:0,variancePaid:0,varianceBalanceDue:0};return t.map(o=>{const r=o.invoices.reduce((i,l)=>(i.poAmount+=l.amount,i.paid+=l.amount-l.balanceDue,i.balanceDue+=l.balanceDue,i),{poAmount:0,paid:0,balanceDue:0}),a=o.internalId&&o.internalId in n?n[o.internalId]:s;return{...o,poAmount:r.poAmount,varianceAmount:a.varianceAmount,totalAmount:r.poAmount+a.varianceAmount,paid:r.paid+a.variancePaid,balanceDue:r.balanceDue+a.varianceBalanceDue}})},AP=(t,n)=>{if(!n)return!1;const{field:s,row:o,colDef:r}=t;return r.editable?o?.isManual?!0:o?.bfsType==="invoice"?bP.includes(s):!1:!1},CP=t=>`(${new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(t))})`,e8=({value:t})=>{const n=useTheme();return!t||t===0?jsx("span",{children:"-"}):jsx(Box,{sx:{color:n.palette.error.main},children:CP(t)})},SP=()=>{const{invoiceStatusChoices:t}=Oc(),{varianceCodeMap:n}=Xa(),s=So(D.w5.BUDGET,D.a2.EDIT_INVOICE),{getExpenseActions:o}=Q0(s);return(0,d.useMemo)(()=>[Zs,{field:"description",headerName:"Description",type:"string",flex:1,minWidth:150,editable:!0},{flex:1,minWidth:150,field:"varianceCodeId",headerName:"Variance Code",editable:!0,renderCell:r=>(0,e.jsx)(fl,{params:r,varianceCodeMap:n}),renderEditCell:r=>(0,e.jsx)(xl,{...r})},{field:"invoiceNumber",headerName:"Invoice #",type:"string",flex:1,minWidth:100,editable:!0},{field:"costCodeId",headerName:"Cost Code",type:"string",flex:1,minWidth:150,editable:!0,renderCell:r=>(0,e.jsx)(Gr,{...r}),renderEditCell:r=>(0,e.jsx)(ur,{...r})},{field:"dateCompleted",headerName:"Date Completed",type:"date",flex:1,minWidth:130,editable:!0,valueGetter:r=>r?new Date(r):null},{field:"dueDate",headerName:"Due Date",type:"date",flex:1,minWidth:130,editable:!0,valueGetter:r=>r?new Date(r):null},{field:"amount",headerName:"Amount",type:"number",flex:1,minWidth:100,editable:!0,valueFormatter:vt,renderEditCell:r=>(0,e.jsx)(ms,{...r,allowNegative:!0})},{field:"paid",headerName:"Paid",type:"number",flex:1,minWidth:100,editable:!0,valueFormatter:vt,renderEditCell:r=>(0,e.jsx)(ms,{...r,allowNegative:!1})},{field:"balanceDue",headerName:"Balance Due",type:"number",flex:1,minWidth:100,valueFormatter:vt},{field:"status",headerName:"Status",type:"singleSelect",valueOptions:t,flex:1,minWidth:130,editable:!0},{field:"actions",type:"actions",headerName:"Actions",minWidth:100,flex:1,getActions:o}],[t,s,n,o])};var K0=m(28597);const Al=()=>{const[t,n]=(0,d.useState)(null);return(0,d.useMemo)(()=>({anchorEl:t,isOpen:!!t,openMenu:s=>{n(s.currentTarget)},closeMenu:()=>{n(null)}}),[t,n])};var wP=m(48642),EP=m(85366),PP=m(88116);const Y0=[{name:"preventOverflow",options:{boundary:"window",padding:20}}],IP=({title:t,recordTitlePrefix:n,data:s})=>{const o=(0,Dt.A)();return(0,e.jsx)(_n.Ay,{sx:{py:"12px"},children:(0,e.jsxs)(E.A,{sx:{width:"100%",boxSizing:"border-box"},children:[t?(0,e.jsxs)(E.A,{sx:{mb:"12px"},children:[n?(0,e.jsxs)(I.A,{variant:"subtitle1",color:"textSecondary",sx:{display:"inline"},children:[n," "]}):null,(0,e.jsx)(I.A,{variant:"subtitle1",fontWeight:"bold",sx:{display:"inline"},children:t})]}):null,(0,e.jsx)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"12px",border:`1px solid ${o.palette.divider}`,borderRadius:"4px",padding:"12px",width:"100%",boxSizing:"border-box"},children:s.map(({icon:r,entries:a},i)=>{const l=i===0;return(0,e.jsxs)(d.Fragment,{children:[l?null:(0,e.jsx)(Ce.A,{sx:{gridColumn:"span 2"}}),(0,e.jsx)(E.A,{sx:{display:"grid",gap:"4px",gridTemplateColumns:"min-content auto",color:"text.tertiary"},children:a.map(({label:c,value:u},p)=>{const f=p===0;return(0,e.jsxs)(d.Fragment,{children:[f?(0,e.jsx)(E.A,{sx:{mt:"2px"},children:r}):(0,e.jsx)(E.A,{}),(0,e.jsxs)(E.A,{children:[(0,e.jsxs)(I.A,{sx:{display:"inline"},children:[c,":"," "]}),(0,e.jsx)(I.A,{color:"text.primary",sx:{display:"inline"},children:u})]})]},p)})},i)]},i)})})]})})},DP=({title:t,link:n,recordTitlePrefix:s,records:o})=>{const{anchorEl:r,isOpen:a,openMenu:i,closeMenu:l}=Al(),c=(0,Dt.A)();return o.length?(0,e.jsxs)(_n.Ay,{disablePadding:!0,onMouseEnter:i,onMouseLeave:l,secondaryAction:(0,e.jsx)(Fo.A,{fontSize:"small",htmlColor:c.palette.foreground.quaternary}),children:[(0,e.jsx)(xs.A,{children:t}),(0,e.jsx)(_a.A,{sx:{pl:"6px",width:"300px"},placement:"right",anchorEl:r,open:a,transition:!0,modifiers:Y0,children:({TransitionProps:u})=>(0,e.jsx)(Hd.A,{...u,children:(0,e.jsxs)(Fs.A,{elevation:5,children:[(0,e.jsx)(qn.A,{disablePadding:!0,sx:{maxHeight:"50vh",overflowY:"auto",overflowX:"hidden"},children:o.map((p,f)=>{const h=f===0;return(0,e.jsxs)(d.Fragment,{children:[h?null:(0,e.jsx)(Ce.A,{variant:"middle"}),(0,e.jsx)(IP,{recordTitlePrefix:s,...p})]},f)})}),(0,e.jsx)(_n.Ay,{children:(0,e.jsx)(K.A,{component:L.Link,to:n,variant:"outlined",color:"secondary",size:"small",children:"View"})})]})})})]}):null},Cl=({title:t,recordGroups:n})=>{const{anchorEl:s,isOpen:o,openMenu:r,closeMenu:a}=Al(),i=(0,Dt.A)();return n.every(({records:l})=>!l.length)?null:(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center"},onMouseEnter:r,onMouseLeave:a,children:[(0,e.jsx)(wP.A,{fontSize:"small",htmlColor:i.palette.foreground.quaternary}),(0,e.jsx)(_a.A,{sx:{pl:"6px",width:"275px"},anchorEl:s,open:o,placement:"right-start",transition:!0,modifiers:Y0,children:({TransitionProps:l})=>(0,e.jsx)(Hd.A,{...l,children:(0,e.jsx)(Fs.A,{elevation:5,children:(0,e.jsxs)(PP.A,{children:[t&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(_n.Ay,{children:(0,e.jsx)(Cn.A,{primaryTypographyProps:{variant:"h6",fontWeight:"semibold"},children:t})}),(0,e.jsx)(Ce.A,{})]}),(0,e.jsxs)(R0.A,{sx:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,e.jsx)(EP.A,{fontSize:"inherit"}),"Linked to"]}),n.map(c=>(0,e.jsx)(DP,{...c},c.title))]})})})})]})};var Eo=m(38505),fr=m(83920);const kP=({vpo:t,title:n,subtitle:s,totalAmount:o,onUpdateTitle:r,editingEnabled:a})=>{const i=(0,Dt.A)(),[l,c]=(0,d.useState)(!1),[u,p]=(0,d.useState)(n),f=(0,d.useRef)(null);(0,d.useEffect)(()=>{n===""&&a&&c(!0)},[]),(0,d.useEffect)(()=>{l&&f.current&&(f.current.focus(),f.current.scrollIntoView({behavior:"smooth",block:"center"}))},[l]);const h=()=>{l||p(n),c(!l)},b=j=>{p(j.target.value)},x=async()=>{const j=u.trim();j===""||j!==n?(c(!1),await r(j)||p(n)):c(!1)},v=async()=>{await x()},y=async j=>{j.key==="Enter"&&await x()};return(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:i.spacing(1)},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center"},children:[l?(0,e.jsx)(_.A,{inputRef:f,variant:"standard",value:u,onChange:b,onBlur:v,onKeyDown:y,placeholder:"Enter Variance Name",InputProps:{disableUnderline:!0,style:{fontSize:i.typography.h6.fontSize,fontWeight:i.typography.fontWeightMedium,lineHeight:i.typography.h6.lineHeight}},sx:{flexGrow:1,marginRight:i.spacing(1),".MuiInputBase-input":{padding:0,height:"auto"}}}):(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",sx:{flexGrow:1},children:n}),s&&!l&&(0,e.jsx)(I.A,{variant:"h6",fontWeight:"light",color:"textSecondary",sx:{ml:1,mr:1},children:s}),a&&(0,e.jsx)(pt.A,{onClick:h,size:"small",children:(0,e.jsx)(K0.A,{fontSize:"small"})}),(0,e.jsx)(Cl,{title:n,recordGroups:[{title:"Change Order",link:`../../revenue/change-orders?ids=${t.changeOrder?.id}`,records:t.changeOrder?[{title:t.changeOrder.title,data:[{icon:(0,e.jsx)(Eo.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Homebuyer Price",value:(0,Ze.up)(t.changeOrder.homebuyerPrice)},{label:"Builder Cost",value:(0,Ze.up)(t.changeOrder.builderCost)},{label:"Markup",value:uc(t.changeOrder.margin)}]},{icon:(0,e.jsx)(fr.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Approved",value:t.changeOrder.approvalDate}]}]}]:[]}]})]}),(0,e.jsxs)(I.A,{children:[(0,e.jsxs)(I.A,{display:"inline",color:"textSecondary",children:["Total Amount:"," "]}),(0,e.jsx)(I.A,{display:"inline",fontWeight:"bold",children:(0,Ze.up)(o)})]})]})};var TP=m(19145),RP=m(17714),Sl=m(25831);const Ja=t=>(parseFloat(t)||0).toFixed(2),Uc=(t,n)=>t*(1+n/100),OP=(t,n)=>n===0?t:t/(1+n/100),MP=t=>{const n=(0,Ds.Wx)({initialValues:{builderCost:t.builderCost.toFixed(2),markup:t.markup.toFixed(2),changeOrderPrice:Uc(t.builderCost,t.markup).toFixed(2)},onSubmit:()=>{}}),s=(a,i=!1)=>{const l=i?Ja(a):a,c=parseFloat(l)||0,u=parseFloat(n.values.markup)||0,p=Uc(c,u).toFixed(2);n.setValues({...n.values,builderCost:l,changeOrderPrice:i?Ja(p.toString()):p.toString()})},o=(a,i=!1)=>{const l=parseFloat(a)||0,c=parseFloat(n.values.builderCost)||0,u=Uc(c,l).toFixed(2),p=i?l.toFixed(2):a,f=i?Ja(u):u;n.setValues({...n.values,markup:p,changeOrderPrice:f})},r=(a,i=!1)=>{const l=i?Ja(a):a,c=parseFloat(l)||0,u=parseFloat(n.values.markup)||0,p=OP(c,u).toFixed(2);n.setValues({...n.values,changeOrderPrice:l,builderCost:i?Ja(p.toString()):p.toString()})};return{formData:{builderCost:n.values.builderCost,markup:n.values.markup,changeOrderPrice:n.values.changeOrderPrice},handlers:{builderCost:{onChange:a=>s(a,!1),onBlur:a=>s(a,!0)},markup:{onChange:a=>o(a,!1),onBlur:a=>o(a,!0)},changeOrderPrice:{onChange:a=>r(a,!1),onBlur:a=>r(a,!0)}},formik:n}},LP="Failed to create change order. Please try again.",FP="Change Order created successfully",BP=(t,n,s,o,r,a)=>{t.showSuccess({message:r,autoTimeout:5e3,renderAction:i=>(0,e.jsx)(K.A,{variant:"text",size:"small",sx:{color:n.palette.success.dark,fontWeight:"bold",alignSelf:"center"},onClick:()=>{t.closeToast(i),s(`/projects/${o}/budget/revenue/change-orders?ids=${a}`)},children:"View"})})},q0=rs(({initialValues:t,onCreate:n,onClose:s,description:o,successMessage:r,...a})=>{const{project:i}=(0,De.B)(),l=(0,Fe.d)(),c=(0,L.useNavigate)(),u=(0,Dt.A)(),[p,f]=(0,d.useState)(!1),{formData:h,handlers:b,formik:x}=MP(t);if(!i?.id)return null;const v=async()=>{if(!x.isSubmitting){f(!0);try{const{changeOrder:y}=await n({builderCost:parseFloat(h.builderCost)||0,markup:parseFloat(h.markup)||0,changeOrderAmount:parseFloat(h.changeOrderPrice)||0});BP(l,u,c,i.id,r||FP,y.id),s()}catch(y){console.error("Error creating change order:",y),l.showError({message:LP,autoTimeout:3e3})}finally{f(!1)}}};return(0,e.jsx)(Zt,{...a,title:"Create Change Order",onClose:s,maxWidth:"md",actions:[{title:"Create Change Order",onClick:v,disabled:p,loading:p}],children:(0,e.jsxs)(nr.A,{sx:{pt:0,mt:-3},children:[(0,e.jsx)(I.A,{variant:"body2",color:"text.secondary",sx:{mb:3},children:o}),(0,e.jsxs)(E.A,{sx:{display:"flex",gap:2,alignItems:"center",mb:1},children:[(0,e.jsxs)(E.A,{sx:{flex:1},children:[(0,e.jsx)(I.A,{variant:"body1",sx:{mb:1,fontWeight:500},children:"Homebuilder Cost"}),(0,e.jsx)(_.A,{fullWidth:!0,type:"number",value:h.builderCost,onChange:y=>b.builderCost.onChange(y.target.value),onBlur:y=>b.builderCost.onBlur(y.target.value),InputProps:{startAdornment:(0,e.jsx)(Ks.A,{position:"start",children:"$"})},inputProps:{min:0,step:.01}})]}),(0,e.jsx)(I.A,{variant:"body2",color:"text.secondary",sx:{mt:3},children:"*"}),(0,e.jsx)(I.A,{variant:"body2",color:"text.secondary",sx:{mt:3},children:"( 1 +"}),(0,e.jsxs)(E.A,{sx:{minWidth:100},children:[(0,e.jsx)(I.A,{variant:"body1",sx:{mb:1,fontWeight:500},children:"Markup"}),(0,e.jsx)(_.A,{type:"number",value:h.markup,onChange:y=>b.markup.onChange(y.target.value),onBlur:y=>b.markup.onBlur(y.target.value),sx:{width:120},InputProps:{endAdornment:(0,e.jsx)(Ks.A,{position:"end",children:"%"})},inputProps:{min:0,step:.1}})]}),(0,e.jsx)(I.A,{variant:"body2",color:"text.secondary",sx:{mt:3},children:")"}),(0,e.jsx)(I.A,{variant:"body2",color:"text.secondary",sx:{mt:3},children:"="}),(0,e.jsxs)(E.A,{sx:{flex:1},children:[(0,e.jsxs)(I.A,{variant:"body1",sx:{mb:1,display:"flex",alignItems:"center",gap:1,fontWeight:500},children:["Change Order Amount",(0,e.jsx)(qt.A,{title:"This is the same value as Homebuyer Variance.",children:(0,e.jsx)(Sl.A,{fontSize:"small"})})]}),(0,e.jsx)(_.A,{fullWidth:!0,type:"number",value:h.changeOrderPrice,onChange:y=>b.changeOrderPrice.onChange(y.target.value),onBlur:y=>b.changeOrderPrice.onBlur(y.target.value),InputProps:{startAdornment:(0,e.jsx)(Ks.A,{position:"start",children:"$"})},inputProps:{min:0,step:.01}})]})]})]})})}),NP=(0,Wn.A)(sn)`
  min-width: auto;
  padding: 4px;
  gap: 2px;

  .MuiButton-startIcon {
    margin-right: 0;
    margin-left: 0;
  }

  .MuiButton-endIcon {
    margin-left: 0;
    margin-right: 0;
  }

  &:hover {
    border-radius: var(--border-radius, 4px);
  }

  &:focus {
    border-radius: var(--border-radius, 4px);
  }
`,_P=({vpo:t,sendDisabledMessage:n,size:s="medium"})=>{const[o,r]=se().useState(null),a=!!o,{isModalOpen:i,openModal:l,closeModal:c}=ln(),[u]=(0,Me.l)(),{project:p}=(0,De.B)(),f=v=>{r(v.currentTarget)},h=()=>{r(null)},b=()=>{h(),l()},x=async v=>({changeOrder:{id:(await u({projectId:p?.id,vpoId:t.id,title:t.title,builderCost:v.builderCost,margin:v.markup,amountPaid:0}).unwrap()).changeOrder.id}});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(NP,{variant:"text",color:"secondary",size:s,startIcon:(0,e.jsx)(TP.A,{}),endIcon:(0,e.jsx)(RP.A,{}),onClick:f,disabled:!!n,title:n||void 0}),(0,e.jsx)(Hn.A,{anchorEl:o,open:a,onClose:h,children:(0,e.jsx)(it.A,{onClick:b,disabled:!!t.changeOrderId,children:"Create Change Order"})}),(0,e.jsx)(q0,{open:i,onClose:c,initialValues:{builderCost:t.totalAmount,markup:0},onCreate:x,description:"Editing these values will update them on Allowances and Change Orders.",successMessage:"VPO sent to Change Orders."})]})},UP=({vpo:t,onDelete:n,onAddBill:s,onPrint:o,printDisabledMessage:r})=>{const a=(0,Fe.d)(),i=So(D.w5.BUDGET,D.a2.EDIT_INVOICE),{isModalOpen:l,openModal:c,closeModal:u}=ln();return(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:1,height:"34px",justifyContent:"flex-end"},children:[(0,e.jsx)(_P,{vpo:t}),(0,e.jsx)(qt.A,{title:r,children:(0,e.jsx)("span",{children:(0,e.jsx)(pt.A,{"aria-label":"Print",size:"small",onClick:o,disabled:!!r,color:"secondary",children:(0,e.jsx)(Mc.A,{})})})},"print-tooltip"),!t.isStandalone&&i&&(0,e.jsx)(pt.A,{"aria-label":"Delete",size:"small",onClick:c,color:"secondary",children:(0,e.jsx)(Is.A,{})}),(0,e.jsx)(Zt,{open:l,onClose:u,title:"Delete Variance",content:`This will delete all invoices attached to the variance. This action cannot be undone.${t.changeOrder?" Removing a Variance Purchase Order will not delete associated Change Orders.":""}`,actions:[{color:"error",title:"Delete",onClick:async()=>{try{await n(),u()}catch(p){a.showError({message:fn(p)})}}}]}),(0,e.jsx)(Ce.A,{orientation:"vertical",flexItem:!0,variant:"middle",sx:{ml:"4px",mr:"8px"}}),i&&(0,e.jsx)(sn,{size:"small",variant:"outlined",color:"primary",onClick:s,children:"Add Bill"})]})};var WP=m(91616);const zP=({children:t})=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"8px",margin:"auto",textAlign:"center",maxWidth:"320px",oveflow:"hidden"},children:[(0,e.jsx)(E.A,{sx:{display:"flex",width:"64px",height:"64px",padding:"8px",alignItems:"center",justifyContent:"center",borderRadius:"4px",backgroundColor:"background.secondary"},children:(0,e.jsx)(WP.A,{sx:{fontSize:48,color:"text.secondary"}})}),(0,e.jsx)(E.A,{children:(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",children:"No bills to display"})}),t]}),VP=t=>t.uid,$P=({title:t="Variance",subtitle:n="VPO",items:s,totalAmount:o,isLoading:r=!1,onUpdateTitle:a,onDelete:i,onPrint:l,printDisabledMessage:c,onAddBill:u,gridApiRef:p,onRowAdded:f,isStandaloneVpo:h,vpo:b})=>{const x=(0,d.useRef)(null),v=Qa(),y=SP(),{project:j}=(0,De.B)(),[A]=(0,Me.cp)(),w=So(D.w5.BUDGET,D.a2.EDIT_INVOICE),P=async k=>(await A({...k,projectId:j?.id,completedDate:k.completedDate?no(k.completedDate):null,dueDate:k.dueDate?no(k.dueDate):null,amount:Number(k.amount.toFixed(2)),paid:Number(k.paid.toFixed(2))}).unwrap(),k),C=v.includes(String(b.id));return(0,d.useEffect)(()=>{C&&x.current?.scrollIntoView()},[C]),(0,e.jsxs)(Fs.A,{ref:x,sx:[{display:"flex",flexDirection:"column",gap:"12px",padding:"16px",marginTop:"12px"},C&&{backgroundColor:"#FFF2CC"}],children:[(0,e.jsxs)(E.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,e.jsx)(kP,{vpo:b,title:t,subtitle:n,totalAmount:o,onUpdateTitle:a,editingEnabled:w&&!h}),(0,e.jsx)(UP,{vpo:b,onPrint:l,onDelete:i,onAddBill:u,printDisabledMessage:c})]}),(0,e.jsx)(Jn,{autoHeight:!0,apiRef:p,getRowId:VP,rows:s,columns:y,loading:r,pagination:!0,onRowAdded:f,processRowUpdate:P,getCellClassName:cs,defaultSortModel:[{field:zn,sort:"desc"}],initialState:{pagination:{paginationModel:{pageSize:10,page:0}},columns:{columnVisibilityModel:{[zn]:!1}}},pageSizeOptions:[10],sx:{"--DataGrid-overlayHeight":"250px"},slots:{noRowsOverlay:()=>(0,e.jsx)(zP,{children:w&&(0,e.jsx)(K.A,{size:"small",variant:"outlined",color:"primary",onClick:u,children:"Add Bill"})})},slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}}})]})},HP=t=>t.uid,QP=({row:t})=>{const n=(0,Fe.d)(),s=(0,Kn.b)(),{project:o}=(0,De.B)(),{company:r}=(0,je.P)(),{userHasPermission:a}=(0,Ye.A)(),i=a({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:r?.id,projectId:o?.id}),{waitForRow:l,onRowAdded:c}=po(),[u]=(0,Me.Nx)(),[p]=(0,Me.cp)(),f=Bc(t),h=async()=>{try{s.current.setSortModel([]);const y=await u({projectId:o?.id,purchaseOrderId:t.internalId,invoiceNumber:"",completedDate:no(new Date().toString()),amount:0,paid:0,balanceDue:0,enteredDate:no(new Date().toString()),dueDate:no(new Date().toString()),visibleInInvoicesTab:!1,isManual:!0,status:cr.NotApproved}).unwrap(),j=await l(y.uid,s);s.current.startCellEditMode({id:j.uid,field:"description"})}catch(y){n.showError({message:fn(y)})}},b=async y=>{await p({uid:y.uid,projectId:o?.id,isManual:y.isManual,purchaseOrderId:y.purchaseOrderId,description:y.description,orderNumber:y.orderNumber,deliveryNumber:y.deliveryNumber,invoiceNumber:y.invoiceNumber,costCodeId:y.costCodeId,completedDate:y.completedDate?no(y.completedDate):null,dueDate:y.dueDate?no(y.dueDate):null,amount:Number(y.amount.toFixed(2)),paid:Number(y.paid.toFixed(2)),status:y.status}).unwrap()},x=yP(),v=!t.isManual;return(0,e.jsxs)(Fs.A,{sx:{display:"flex",flexDirection:"column",gap:"12px",padding:"16px"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",children:t.title}),(0,e.jsxs)(I.A,{children:[(0,e.jsxs)(I.A,{display:"inline",color:"textSecondary",children:["Total Amount:"," "]}),(0,e.jsx)(I.A,{display:"inline",fontWeight:"bold",children:(0,Ze.up)(t.totalAmount)})]})]}),(0,e.jsxs)(E.A,{sx:{display:"flex"},children:[t.isManual&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qt.A,{title:f,children:(0,e.jsx)("span",{children:(0,e.jsx)(pt.A,{"aria-label":"Print",size:"small",onClick:async()=>{await Ho(`/budget/v2/project/${o?.id}/purchase-orders/${t.internalId}/render_pdf`)},disabled:!!f,color:"secondary",children:(0,e.jsx)(Mc.A,{})})})},"print-tooltip"),(0,e.jsx)(Ce.A,{orientation:"vertical",flexItem:!0,variant:"middle",sx:{ml:"4px",mr:"8px"}})]}),(0,e.jsx)(qt.A,{title:v?"Builders FirstSource Purchase Orders display Orders and Invoices automatically.":"",children:(0,e.jsx)("span",{children:(0,e.jsx)(sn,{onClick:h,size:"small",variant:"outlined",disabled:v,color:"primary",children:"Add Bill"})})})]})]}),(0,e.jsx)(Ga,{children:(0,e.jsx)(Jn,{apiRef:s,getRowId:HP,onRowAdded:c,processRowUpdate:b,rows:t.invoices,columns:x,getCellClassName:cs,isCellEditable:y=>AP(y,i),pagination:!0,defaultSortModel:[{field:zn,sort:"desc"}],initialState:{pagination:{paginationModel:{pageSize:10,page:0}},columns:{columnVisibilityModel:{[zn]:!1}}}})})]})},GP=t=>!t||t.length===0?[]:t.map(n=>{const s=n.invoices?n.invoices.reduce((o,r)=>o+(Number(r.amount)||0),0):0;return{...n,totalAmount:s}}),KP=({row:t})=>{const n=(0,Fe.d)(),s=(0,Dt.A)(),{project:o}=(0,De.B)(),r=(0,Kn.b)(),{waitForRow:a,onRowAdded:i}=po(),[l]=(0,Me.Nx)(),c=Bc(t),u=t.title,p=!!t.isStandaloneVpoShell,{existingVPOs:f,updateVariancePurchaseOrderTitle:h,deleteVariancePurchaseOrderById:b,isLoading:x}=Fc({purchaseOrderId:t.internalId??void 0}),v=se().useMemo(()=>GP(f),[f]),y=(0,d.useCallback)(async j=>{try{r.current.setSortModel([]);const A=await l({projectId:t.projectId,variancePurchaseOrderId:j.id,purchaseOrderId:t.internalId,invoiceNumber:"",completedDate:no(new Date().toString()),amount:0,paid:0,balanceDue:0,enteredDate:no(new Date().toString()),dueDate:no(new Date().toString()),visibleInInvoicesTab:!1,isManual:!0,status:cr.NotApproved}).unwrap();await a(A.uid,r),r.current.startCellEditMode({id:A.uid,field:"description"})}catch(A){n.showError({message:fn(A)})}},[l,r,n,a]);return o?.id?(0,e.jsxs)(E.A,{sx:{padding:"12px",backgroundColor:s.palette.background.tertiary},children:[!p&&(0,e.jsx)(QP,{row:t}),!x&&v.map(j=>(0,e.jsx)($P,{title:p?u:j.title,isStandaloneVpo:p,items:j.invoices,totalAmount:j.totalAmount,isLoading:x,vpo:j,onUpdateTitle:A=>h(j.id,A),onDelete:()=>b(j.id),onAddBill:()=>y(j),printDisabledMessage:c,onPrint:async()=>{await Ho(`/budget/v2/project/${o?.id}/variance-purchase-orders/${j.id}/render_pdf`)},gridApiRef:r,onRowAdded:i},j.id))]}):null};var Wc=m(9483),YP=m(80337),qP=m(31955);const XP=({onAddPurchaseOrder:t,onAddVariance:n})=>{const s=(0,Dt.A)(),[o,r]=(0,d.useState)(null),a=!!o,i=p=>{r(p.currentTarget)},l=()=>{r(null)},c=()=>{l(),t()},u=()=>{l(),n()};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(sn,{variant:"contained",size:"small",startIcon:(0,e.jsx)($d.A,{}),endIcon:(0,e.jsx)(Wc.A,{}),onClick:i,children:"Add New"}),(0,e.jsxs)(Hn.A,{anchorEl:o,open:a,onClose:l,MenuListProps:{"aria-labelledby":"add-new-button"},children:[(0,e.jsxs)(it.A,{onClick:c,sx:{color:s.palette.text.primary},children:[(0,e.jsx)(YP.A,{sx:{mr:1.5,color:s.palette.text.secondary}})," ","Purchase Order"]}),(0,e.jsxs)(it.A,{onClick:u,sx:{color:s.palette.text.primary},children:[(0,e.jsx)(qP.A,{sx:{mr:1.5,color:s.palette.text.secondary}})," ","Variance"]})]})]})},X0="PO#",JP="VPO#",J0=t=>t.uid,ZP=()=>{const{project:t}=(0,De.B)(),{company:n}=(0,je.P)(),{userHasPermission:s,allRoles:o}=(0,Ye.A)(),r=s({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:n?.id,projectId:t?.id}),a=(0,Kn.b)(),i=(0,d.useRef)(null),l=(0,Fe.d)(),{waitForRow:c,onRowAdded:u}=po(),[p]=(0,Me.u$)(),[f]=(0,Me.B4)(),[h]=(0,Me.Nj)(),[b,x]=(0,d.useState)(!1),[v,y]=(0,d.useState)(),[j,A]=(0,d.useState)(null),{data:w=[],isFetching:P}=(0,Me.cG)({projectId:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0}),{data:C={}}=(0,Me.yM)({projectId:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0}),k=(0,d.useMemo)(()=>jP(w,C),[w,C]),S=W0(k,F=>F.poRef,J0),R=async F=>{await f({...F,dateCreated:F.dateCreated?no(F.dateCreated):null,projectId:t?.id}).unwrap()},B=()=>{j&&(a.current.setEditCellValue({id:j,field:"poRef",value:""}),a.current.stopCellEditMode({id:j,field:"poRef",ignoreModifications:!0}),v&&(l.closeToast(v),y(void 0)),A(null)),x(!1)};gr({tool:D.w5.BUDGET,action:w.length?D.H1.OPEN_WITH_DATA:D.H1.OPEN,content_type:"project",object_id:t?.id},{skip:P});const T=async()=>{const F=a.current;try{F.setSortModel([]);const{uid:V}=await p({projectId:t?.id,poRef:S(X0),isStandaloneVpoShell:!1}).unwrap();await c(V,a),F.startCellEditMode({id:V,field:"title"})}catch(V){l.showError({message:String(V)})}},W=async()=>{const F=a.current;try{if(!F||!t?.id){console.error("Grid API or project ID not available for adding variance.");return}F.setSortModel([]);const $=(await h({projectId:t.id,poRef:S(JP),vpoTitle:""}).unwrap()).purchaseOrder.uid;await c($,a),F.startCellEditMode({id:$,field:"title"})}catch(V){console.error("Error in handleAddVarianceClick:",V),l.showError({message:String(V)})}},N=eo(a),O=fP(a),z=async(F,V)=>{(!F.poRef||!F.poRef.trim())&&F.isManual&&(F.poRef=S(X0,F.internalId));try{vP(F,V),await R(F)}catch($){throw $.message===_c&&A(F.uid),$}},Q=(F,V,$,ee)=>{if(F.message===_c){const X=V.showError({message:F.message,onClose:(G,Y)=>{Y==="clickaway"||Y==="escapeKeyDown"||($(!0),ee(X))}})}else V.showError({message:F.toString()})};$o({handleResize:()=>zo(i.current)});const re=Qa(),ue=(0,d.useMemo)(()=>re.reduce((F,V)=>{const $=w.find(({vpoIds:ee})=>ee.includes(Number(V)));return $&&F.push($.uid),F},[]),[w,re]),le=(0,d.useRef)(!1);return(0,d.useEffect)(()=>{!le.current&&ue.length&&(le.current=!0,a.current.setExpandedDetailPanels(ue))},[ue]),(0,e.jsxs)(Vo,{ref:i,children:[(0,e.jsx)(mr.A,{container:()=>document.getElementById(dl),children:r&&!(0,ct.EL)(o)&&(0,e.jsx)(XP,{onAddPurchaseOrder:T,onAddVariance:W})}),(0,e.jsx)(Jn,{processRowUpdate:F=>z(F,k),onProcessRowUpdateError:F=>Q(F,l,x,y),columns:O,rows:k,getRowClassName:N,getRowId:J0,getCellClassName:cs,rowHeight:50,disableColumnMenu:!0,disableVirtualization:!0,hideFooter:!0,loading:P,slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}},onRowAdded:u,apiRef:a,defaultSortModel:[{field:zn,sort:"desc"}],initialState:{columns:{columnVisibilityModel:{[zn]:!1,actions:r}}},getDetailPanelHeight:()=>"auto",getDetailPanelContent:({row:F})=>(0,e.jsx)(KP,{row:F}),isCellEditable:F=>!r||!F.colDef.editable?!1:F.row.isManual?!0:["title","status","scope"].includes(F.field)}),(0,e.jsx)(Zt,{open:b,onClose:()=>{y(void 0),x(!1)},title:"Continue without updating purchase order number",content:"This will remove all data entered in this field.",actions:[{onClick:B,children:"Continue",color:"primary"}]})]})};var Po=m(10423),Z0=m(10118),eg=m(94152),tg=m(17724);const ng=rs(({open:t,onClose:n,changeOrder:s})=>{const o=(0,Dt.A)(),{project:r}=(0,De.B)(),a=(0,Fe.d)(),[i]=(0,Me.bV)(),l=(0,Ds.Wx)({enableReinitialize:!0,initialValues:{expectedAmount:String(s.homebuyerPrice)},onSubmit:async({expectedAmount:p},{setFieldError:f})=>{try{const{paymentRequest:h}=await i({project:r.id,id:s.id,expectedAmount:Number(p)}).unwrap();n(),a.showSuccess({message:"Change Order payment created.",renderAction:b=>(0,e.jsx)(K.A,{component:L.Link,to:`/projects/${r.id}/budget/revenue/payments?ids=${h.id}`,onClick:()=>a.closeToast(b),variant:"text",color:"success",size:"small",sx:{color:o.palette.success.dark,fontWeight:"bold",alignSelf:"center"},children:"View"})})}catch(h){h.status===400?Object.entries(h.data).forEach(([b,x])=>{f(b,x.join(","))}):a.showError({message:fn(h)})}}}),c=Number(l.values.expectedAmount)!==Number(s.homebuyerPrice),u=c?"Value is different from the default. This may cause you to charge more or less than the total value of the materials or services rendered.":"By default this value is equal to the Homebuyer Price.";return(0,e.jsx)(Zt,{fullWidth:!0,open:t,onClose:n,title:"Create Payment Request",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.A,{children:"Expected Amount"}),(0,e.jsx)(_.A,{color:c?"warning":"primary",InputProps:{inputComponent:Kh,startAdornment:(0,e.jsx)(Ks.A,{position:"start",children:c?(0,e.jsx)(tg.A,{color:"warning"}):"$"})},name:"expectedAmount",fullWidth:!0,required:!0,autoFocus:!0,value:l.values.expectedAmount,onChange:l.handleChange,onBlur:l.handleBlur,error:l.touched.expectedAmount&&!!l.errors.expectedAmount,helperText:l.touched.expectedAmount&&l.errors.expectedAmount||u})]}),actions:[{title:"Create Payment",loading:l.isSubmitting,onClick:()=>l.handleSubmit()}]})}),eI=({id:t,row:n})=>{const s=(0,ds.h)(),r=(0,Z0.N)(s,eg.eW).includes(t);return n.payments.length?(0,e.jsx)(pt.A,{size:"small",children:r?(0,e.jsx)(hl.A,{fontSize:"inherit"}):(0,e.jsx)(pr.A,{fontSize:"inherit"})}):null},sg=({value:t,row:n})=>(0,e.jsxs)(E.A,{sx:{height:"100%",display:"flex",alignItems:"center"},children:[(0,e.jsx)(E.A,{sx:{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden"},children:t}),(0,e.jsx)(Cl,{title:t,recordGroups:[{title:"Payments",link:`../payments?ids=${n.payments.map(({id:s})=>s).join(",")}`,records:n.payments.map(s=>({title:s.title,data:[{icon:(0,e.jsx)(Eo.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Expected Amount",value:(0,Ze.up)(s.amount)},{label:"Payor",value:s.payor}]},{icon:(0,e.jsx)(fr.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Created",value:s.dateCreated},{label:"Due",value:s.dueDate}]}]}))},{title:"Variance Purchase Order",recordTitlePrefix:"VPO:",link:`../../expenses/purchase-orders?ids=${n.variancePurchaseOrder?.id}`,records:n.variancePurchaseOrder?[{title:n.variancePurchaseOrder.title,data:[{icon:(0,e.jsx)(Eo.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Total Amount",value:(0,Ze.up)(n.variancePurchaseOrder.totalAmount)},{label:"PO#",value:n.variancePurchaseOrder.purchaseOrderNumber}]},{icon:(0,e.jsx)(fr.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Created",value:n.variancePurchaseOrder.createdAt}]}]}]:[]},{title:"Allowance",recordTitlePrefix:"Allowance:",link:`../allowances?ids=${n.allowance?.id}`,records:n.allowance?[{title:n.allowance?.title,data:[{icon:(0,e.jsx)(Eo.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Buyer Budgeted",value:(0,Ze.up)(n?.allowance?.homebuyerBudgetedAllowance??0)},{label:"Buyer Actual",value:(0,Ze.up)(n.allowance?.homebuyerFinalAmount??0)},{label:"Variance",value:(0,Ze.up)(n.allowance?.homebuyerPriceVariance??0)}]}]}]:[]}]})]}),tI=()=>{const{isFlagEnabled:t}=(0,ut.u)(),n=t(D.SX.USE_EXPENSES_V2),{project:s}=(0,De.B)(),{varianceCodeMap:o}=Xa(),{data:r}=(0,Me.QM)({projectId:s?.id},{skip:!s?.id});return n?[Zs,{...Hr.a,renderCell:a=>(0,e.jsx)(eI,{...a})},{field:"title",headerName:"Title",type:"string",flex:1,minWidth:100,editable:!0,renderCell:a=>(0,e.jsx)(sg,{...a})},{field:"description",headerName:"Description",type:"string",flex:1,minWidth:100,editable:!0},{field:"costCode",headerName:"Cost Code",type:"string",flex:1,minWidth:100,editable:!0,renderCell:a=>(0,e.jsx)(Gr,{...a}),renderEditCell:a=>(0,e.jsx)(ur,{...a})},{field:"varianceCodeId",headerName:"Variance Code",type:"string",flex:1,minWidth:100,editable:!0,renderCell:a=>(0,e.jsx)(fl,{params:a,varianceCodeMap:o}),renderEditCell:a=>(0,e.jsx)(xl,{...a})},{field:"builderCost",headerName:"Builder Cost",type:"number",valueFormatter:vt,renderEditCell:a=>(0,e.jsx)(ms,{...a}),flex:1,minWidth:100,editable:!0},{field:"margin",type:"number",headerName:"Markup",valueFormatter:$r,flex:1,minWidth:100,editable:!0},{field:"homebuyerPrice",type:"number",headerName:"Homebuyer Price",valueFormatter:vt,flex:1,minWidth:100},{field:"paymentsTotalAmount",type:"number",headerName:"Payments Requested",valueFormatter:vt,flex:1,minWidth:100},{field:"approvalDate",type:"date",headerName:"Approved On",valueGetter:a=>a?new Date(a):"",flex:1,minWidth:100,editable:!0,sortComparator:(a,i,l,c)=>{const u=a-i;return u||Number(l.rowNode.id)-Number(c.rowNode.id)}},{field:"invoiceDate",type:"date",headerName:"Date Created",valueGetter:a=>a?new Date(a):"",flex:1,minWidth:100,editable:!0},{field:"status",headerName:"Status",type:"singleSelect",flex:1,minWidth:100,editable:!0,valueOptions:r},{field:"actions",type:"actions",headerName:"",width:50,getActions:({row:a})=>{const{isModalOpen:i,openModal:l,closeModal:c}=ln(),{isModalOpen:u,openModal:p,closeModal:f}=ln(),[h]=(0,Me.uF)(),b=(0,Fe.d)(),{anchorEl:x,isOpen:v,openMenu:y,closeMenu:j}=Al();return[(0,e.jsxs)(e.Fragment,{children:[n?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(bs.Z,{label:"Create Payment",icon:(0,e.jsx)(Mo.A,{}),onClick:y}),(0,e.jsxs)(Hn.A,{anchorEl:x,open:v,onClose:j,children:[(0,e.jsx)(it.A,{onClick:()=>{p(),j()},children:"Create Payment Request"}),(0,e.jsx)(it.A,{onClick:()=>{l(),j()},children:"Delete"})]})]}):(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:l,color:"inherit"}),(0,e.jsx)(ng,{open:u,onClose:f,changeOrder:a}),(0,e.jsx)(Zt,{open:i,onClose:c,title:"Delete change order?",content:"Once deleted you cannot undo this action.",actions:[{title:"Delete",onClick:async()=>{try{await h(a).unwrap(),c()}catch(A){b.showError({message:fn(A)})}},color:"error"}]})]})]}}]:[Zs,{field:"title",headerName:"Title",type:"string",flex:1,minWidth:100,editable:!0,renderCell:a=>(0,e.jsx)(sg,{...a})},{field:"costCode",headerName:"Cost Code",type:"string",flex:1,minWidth:100,editable:!0,renderCell:a=>(0,e.jsx)(Gr,{...a}),renderEditCell:a=>(0,e.jsx)(ur,{...a})},{field:"builderCost",headerName:"Builder Cost",type:"number",valueFormatter:vt,renderEditCell:a=>(0,e.jsx)(ms,{...a}),flex:1,minWidth:100,editable:!0},{field:"margin",type:"number",headerName:"Markup",valueFormatter:$r,flex:1,minWidth:100,editable:!0},{field:"homebuyerPrice",type:"number",headerName:"Homebuyer Price",valueFormatter:vt,flex:1,minWidth:100},{field:"approvalDate",type:"date",headerName:"Approved On",valueGetter:a=>a?new Date(a):"",flex:1,minWidth:100,editable:!0,sortComparator:(a,i,l,c)=>{const u=a-i;return u||Number(l.rowNode.id)-Number(c.rowNode.id)}},{field:"invoiceDate",type:"date",headerName:"Invoice Date",valueGetter:a=>a?new Date(a):"",flex:1,minWidth:100,editable:!0},{field:"dueDate",type:"date",headerName:"Due Date",valueGetter:a=>a?new Date(a):"",flex:1,minWidth:100,editable:!0},{field:"amountPaid",headerName:"Amount Received",type:"number",valueFormatter:vt,renderEditCell:a=>(0,e.jsx)(ms,{...a}),flex:1,minWidth:100,editable:!0},{field:"balanceDue",headerName:"Balance Due",type:"number",valueFormatter:vt,flex:1,minWidth:100},{field:"actions",type:"actions",headerName:"",width:50,getActions:({row:a})=>{const{isModalOpen:i,openModal:l,closeModal:c}=ln(),{isModalOpen:u,openModal:p,closeModal:f}=ln(),[h]=(0,Me.uF)(),b=(0,Fe.d)(),{anchorEl:x,isOpen:v,openMenu:y,closeMenu:j}=Al();return[(0,e.jsxs)(e.Fragment,{children:[n?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(bs.Z,{label:"Create Payment",icon:(0,e.jsx)(Mo.A,{}),onClick:y}),(0,e.jsxs)(Hn.A,{anchorEl:x,open:v,onClose:j,children:[(0,e.jsx)(it.A,{onClick:()=>{p(),j()},children:"Create Payment Request"}),(0,e.jsx)(it.A,{onClick:()=>{l(),j()},children:"Delete"})]})]}):(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:l,color:"inherit"}),(0,e.jsx)(ng,{open:u,onClose:f,changeOrder:a}),(0,e.jsx)(Zt,{open:i,onClose:c,title:"Delete change order?",content:"Once deleted you cannot undo this action.",actions:[{title:"Delete",onClick:async()=>{try{await h(a).unwrap(),c()}catch(A){b.showError({message:fn(A)})}},color:"error"}]})]})]}}]},nI=m.p+"217f9bd811e6770a23a6e9a9016cf6d5.svg",sI=({children:t,canUserEditBudget:n})=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%",padding:"24px",gap:"24px",margin:"auto",textAlign:"center",maxWidth:"240px",oveflow:"hidden"},children:[(0,e.jsx)("img",{src:nI}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",children:"No Change Orders to display."}),n&&(0,e.jsx)(I.A,{variant:"body1",color:"textSecondary",children:"Add Change Orders to document unplanned expenses."})]}),t]}),oI=[Zs,{field:"event",headerName:"Event",type:"string",align:"left",flex:1,minWidth:100,renderCell:t=>{const{project:n}=(0,De.B)();return(0,e.jsx)(Rn.A,{component:L.Link,to:`/projects/${n?.id}/budget/revenue/payments?ids=${t.row.id}`,children:"Payment Request Created"})}},{field:"description",headerName:"Description",type:"string",flex:1,minWidth:100},{field:"dateCreated",type:"date",headerName:"Date Created",valueGetter:t=>t?new Date(t):"",flex:1,minWidth:100},{field:"amount",type:"number",headerName:"Amount",valueFormatter:vt,flex:1,minWidth:100}],rI=({changeOrder:t})=>{const n=(0,Dt.A)(),s=t.payments.reduce((o,r)=>o+r.amount,0);return(0,e.jsx)(E.A,{sx:{padding:"12px",backgroundColor:n.palette.background.tertiary},children:(0,e.jsxs)(Fs.A,{sx:{display:"flex",flexDirection:"column",gap:"12px",padding:"16px"},children:[(0,e.jsx)(E.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:n.spacing(1)},children:[(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center"},children:(0,e.jsxs)(I.A,{variant:"h6",fontWeight:"medium",children:["Payment Requests",t.title?` for ${t.title}`:""]})}),(0,e.jsxs)(I.A,{children:[(0,e.jsxs)(I.A,{display:"inline",color:"textSecondary",children:["Total Payments Requested:"," "]}),(0,e.jsx)(I.A,{display:"inline",fontWeight:"medium",children:(0,Ze.up)(s)})]})]})}),(0,e.jsx)(Ga,{children:(0,e.jsx)(Jn,{defaultSortModel:[{field:zn,sort:"desc"}],initialState:{pagination:{paginationModel:{pageSize:10,page:0}},columns:{columnVisibilityModel:{[zn]:!1}}},getCellClassName:cs,disableColumnMenu:!0,rows:t.payments,columns:oI,pagination:!0,columnHeaderHeight:Vn,rowHeight:Vn,pageSizeOptions:[10],slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"linear-progress"}}})})]})})},aI=()=>{const{project:t}=(0,De.B)(),n=So(D.w5.BUDGET,D.a2.EDIT_INVOICE),s=(0,Kn.b)(),o=(0,Fe.d)(),[r]=(0,Me.dJ)(),[a]=(0,Me.cZ)(),{waitForRow:i,onRowAdded:l}=po(),c=async()=>{s.current.setSortModel([]);try{const{id:x}=await r({project:t?.id,title:""}).unwrap(),v=await i(x,s);s.current.startCellEditMode({id:v.id,field:"title"})}catch(x){o.showError({message:fn(x)})}},{data:u=[],isFetching:p}=(0,Me.fe)({project:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0}),f=tI();gr({tool:D.w5.BUDGET,action:u.length?D.H1.OPEN_WITH_DATA:D.H1.OPEN,content_type:"project",object_id:t?.id},{skip:p}),mc(s);const h=eo(s),b=pc();return(0,e.jsxs)(e.Fragment,{children:[n&&(0,e.jsx)(mr.A,{container:()=>document.getElementById(Ha),children:(0,e.jsx)(sn,{variant:"contained",size:"small",onClick:c,children:"Add Change Order"})}),(0,e.jsx)(Jn,{showLoadingDuringUpdate:!0,processRowUpdate:async x=>{await a({...x,approvalDate:us(x.approvalDate),invoiceDate:us(x.invoiceDate),dueDate:us(x.dueDate),margin:Number(x.margin.toFixed(2)),builderCost:Number(x.builderCost.toFixed(2)),amountPaid:Number(x.amountPaid.toFixed(2)),project:t?.id}).unwrap()},columns:f,rows:u,loading:p,getRowClassName:Gh(b,h),getCellClassName:cs,rowHeight:50,disableColumnMenu:!0,disableVirtualization:!0,hideFooter:!0,onRowAdded:l,apiRef:s,getDetailPanelHeight:()=>"auto",getDetailPanelContent:({row:x})=>(0,e.jsx)(rI,{changeOrder:x}),defaultSortModel:[{field:zn,sort:"desc"}],initialState:{columns:{columnVisibilityModel:{[zn]:!1,actions:n}}},slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}},slots:{noRowsOverlay:()=>(0,e.jsx)(sI,{canUserEditBudget:n,children:n&&(0,e.jsx)(sn,{size:"large",variant:"contained",color:"primary",onClick:c,children:"Add Change Order"})})},isCellEditable:x=>n&&!!x.colDef.editable&&!x.row.isVirtualRow})]})},iI=rs(({open:t,onClose:n,allowance:s})=>{const{project:o}=(0,De.B)(),r=(0,Fe.d)(),[a]=(0,Me.O9)(),i=(0,Ds.Wx)({enableReinitialize:!0,initialValues:{amount:s.homebuyerPriceVariance??0},onSubmit:async({amount:u},{setFieldError:p})=>{try{await a({project:o.id,id:s.id,amount:u}).unwrap(),n(),r.showSuccess({message:"Allowance payment created."})}catch(f){f.status===400?Object.entries(f.data).forEach(([h,b])=>{p(h,b.join(","))}):r.showError({message:fn(f)})}}}),l=Number(i.values.amount)!==Number(s.homebuyerPriceVariance),c=l?"Value is different from the default. This may cause you to charge the homebuyer more or less than the total value of the materials or services rendered.":"By default, this value equals the Homebuyer Price Variance, calculated as the difference between the Homebuyer Final Amount and the Budgeted Allowance.";return(0,e.jsx)(Zt,{fullWidth:!0,open:t,onClose:n,title:"Create Payment",content:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.A,{children:"Amount"}),(0,e.jsx)(_.A,{color:l?"warning":"primary",InputProps:{startAdornment:l?(0,e.jsx)(Ks.A,{position:"start",children:(0,e.jsx)(tg.A,{color:"warning"})}):void 0},name:"amount",fullWidth:!0,required:!0,autoFocus:!0,value:i.values.amount,onChange:i.handleChange,onBlur:i.handleBlur,error:i.touched.amount&&!!i.errors.amount,helperText:i.touched.amount&&i.errors.amount||c})]}),actions:[{title:"Create Payment",loading:i.isSubmitting,onClick:()=>i.handleSubmit()}]})}),og="title",rg="costCode",xr=ps(vt),lI=({value:t,row:n,rowNode:s})=>n.isAggregationRow||"isAutoGenerated"in s&&s.isAutoGenerated?(0,e.jsx)(I.A,{fontWeight:"bold",variant:"inherit",children:t}):(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(E.A,{sx:{height:"100%",display:"flex",alignItems:"center"},children:[(0,e.jsx)(E.A,{sx:{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden"},children:t}),(0,e.jsx)(Cl,{title:t,recordGroups:[{title:"Payments",link:`../payments?ids=${n.payments.map(({id:o})=>o).join(",")}`,records:n.payments.map(o=>({title:o.title,data:[{icon:(0,e.jsx)(Eo.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Expected Amount",value:(0,Ze.up)(o.amount)},{label:"Payor",value:o.payor}]},{icon:(0,e.jsx)(fr.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Created",value:o.dateCreated},{label:"Due",value:o.dueDate}]}]}))}].concat(n.changeOrder?[{title:"Change Order",link:`../change-orders?ids=${n.changeOrder.id}`,records:[{title:n.changeOrder.title,data:[{icon:(0,e.jsx)(Eo.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Amount",value:(0,Ze.up)(n.changeOrder.homebuyerPrice)},{label:"Builder Cost",value:(0,Ze.up)(n.changeOrder.builderCost)},{label:"Markup",value:$r(n.changeOrder.margin)}]},{icon:(0,e.jsx)(fr.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Approval Date",value:n.changeOrder.approvalDate||"Not Approved"}]}]}]}]:[])})]})}),dI=({id:t,row:n,rowNode:s})=>{const o=(0,ds.h)(),a=(0,Z0.N)(o,eg.eW).includes(t);return"isAutoGenerated"in s&&s.isAutoGenerated||!n.payments.length&&!n.changeOrder?null:(0,e.jsx)(pt.A,{size:"small",children:a?(0,e.jsx)(hl.A,{fontSize:"inherit"}):(0,e.jsx)(pr.A,{fontSize:"inherit"})})},cI=[Zs,{...Hr.a,renderCell:t=>(0,e.jsx)(dI,{...t})},{field:og,headerName:"Allowance Title",type:"string",flex:1,minWidth:100,editable:!0,renderCell:t=>(0,e.jsx)(lI,{...t})},{field:rg,headerName:"Cost Code",type:"number",flex:1,minWidth:100,editable:!0,renderCell:t=>(0,e.jsx)(Gr,{...t}),renderEditCell:t=>(0,e.jsx)(ur,{...t})},{field:"builderBudgetedCost",type:"number",headerName:"Builder Budgeted Cost",description:"Enter the estimated cost of materials and labor from the builder's perspective. This will serve as the baseline for your budget calculations",renderEditCell:t=>(0,e.jsx)(ms,{...t}),flex:1,minWidth:100,editable:!0,renderCell:ps(vt)},{field:"markup",type:"number",headerName:"Markup",description:"Specify the markup percentage applied to the builder's budgeted cost. This helps calculate the selling price or forecasted Allowance Budget for the homebuyer.",flex:1,minWidth:100,editable:!0,valueFormatter:$r,renderCell:({row:t,formattedValue:n})=>t.isAggregationRow?"":n},{field:"homebuyerBudgetedAllowance",headerName:"Homebuyer Budgeted Allowance",description:"This is the calculated Budgeted Allowance allocated to the buyer during selections. Calculation: Builder's Budgeted Cost + Markup.",type:"number",flex:1,minWidth:100,renderCell:xr},{field:"homebuyerActualSelection",type:"number",headerName:"Homebuyer Actual Selection",description:"Record the final selections made by the homebuyer. These selections impact the forecasted invoice amount for the builder.",valueFormatter:vt,renderEditCell:t=>(0,e.jsx)(ms,{...t}),flex:1,minWidth:100,editable:!0,renderCell:xr},{field:"forecastBuilderInvoice",headerName:"Forecast Builder Invoice",description:"Calculated using Homebuyer Actual Selections and the Markup percentage.",type:"number",valueFormatter:vt,flex:1,minWidth:100,renderCell:xr},{field:"actualFromExpenses",headerName:"Actual (from Expenses)",description:"Invoices tagged to an allowance will total here. This amount is used to calculate the Homebuyer Final Amount.",type:"number",valueFormatter:vt,flex:1,minWidth:100,renderCell:xr},{field:"homebuyerFinalAmount",headerName:"Homebuyer Final Amount",description:"The final price to the homebuyer, calculated as: 'Actual (From Expenses)' + Markup.",type:"number",valueFormatter:vt,flex:1,minWidth:100,renderCell:xr},{field:"homebuyerPriceVariance",headerName:"Homebuyer Price Variance",description:"This variance represents the difference between the 'Homebuyer Final Amount' and the original 'Homebuyer Budgeted Allowance'.",type:"number",valueFormatter:vt,flex:1,minWidth:100,renderCell:xr},{field:"finalBuilderProfit",headerName:"Final Builder Profit",description:"This is the expected profit for the builder, calculated as: 'Homebuyer Final Amount' - 'Actual (From Expenses)'.",type:"number",valueFormatter:vt,flex:1,minWidth:100,renderCell:xr},{field:"actions",type:"actions",headerName:"",width:50,getActions:({row:t})=>{const n=(0,Fe.d)(),{project:s}=(0,De.B)(),{isModalOpen:o,openModal:r,closeModal:a}=ln(),{isModalOpen:i,openModal:l,closeModal:c}=ln(),{isModalOpen:u,openModal:p,closeModal:f}=ln(),[h]=(0,Me.QP)(),[b]=(0,Me.aO)(),{isFlagEnabled:x}=(0,ut.u)(),v=x(D.SX.USE_EXPENSES_V2),[y,j]=(0,d.useState)(null),A=!!y,w=()=>{j(null)};if(t.isAggregationRow)return[];const P=async C=>{if(!s)throw n.showError({message:"Project not found"}),new Error("Project not found");return{changeOrder:{id:(await b({projectId:s.id,allowanceId:Number(t.id),title:t.title,builderCost:C.builderCost,margin:C.markup,homebuyerPrice:C.changeOrderAmount,...t.costCode&&{costCode:t.costCode},invoiceDate:us(new Date().toString()),amountPaid:0}).unwrap()).changeOrder.id}}};return[(0,e.jsxs)(e.Fragment,{children:[v?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(bs.Z,{label:"Create Payment",icon:(0,e.jsx)(Mo.A,{}),onClick:C=>j(C.currentTarget)}),(0,e.jsxs)(Hn.A,{anchorEl:y,open:A,onClose:w,children:[(0,e.jsx)(it.A,{onClick:()=>{l(),w()},children:"Create Allowance Payment"}),(0,e.jsx)(it.A,{onClick:()=>{p(),w()},disabled:!!t.changeOrder,children:"Create Change Order"}),(0,e.jsx)(it.A,{onClick:()=>{r(),w()},children:"Delete"})]})]}):(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:r,color:"inherit"}),(0,e.jsx)(iI,{open:i,onClose:c,allowance:t}),(0,e.jsx)(q0,{open:u,onClose:f,initialValues:{builderCost:t.homebuyerPriceVariance&&t.markup?t.homebuyerPriceVariance/(1+t.markup/100):t.homebuyerPriceVariance||0,markup:t.markup||0},onCreate:P,description:"Editing these values will update them on Allowances and Change Orders.",successMessage:"Change Order created."}),(0,e.jsx)(Zt,{open:o,onClose:a,title:"Delete allowance?",content:"By deleting this allowance, all references to this allowance will be removed from the Expenses page.  These changes cannot be undone, do you wish to proceed?",actions:[{title:"Delete",onClick:async()=>{try{await h(t).unwrap(),a()}catch(C){n.showError({message:fn(C)})}},color:"error"}]})]})]}}],uI=m.p+"f05dcca6e27e6031b546cf13b34f9018.svg",pI=({children:t})=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%",padding:"24px",gap:"24px",margin:"auto",textAlign:"center",maxWidth:"320px",oveflow:"hidden"},children:[(0,e.jsx)("img",{style:{maxHeight:"50%"},src:uI}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",children:"No Allowances to display."}),(0,e.jsx)(I.A,{variant:"body1",color:"textSecondary",children:"Add buyer allowances to track overages against actual invoiced amounts."})]}),t]}),mI=[Zs,{field:"event",headerName:"Event",type:"string",flex:1,minWidth:100,renderCell:t=>(0,e.jsx)(Rn.A,{component:L.Link,to:t.row.event.link,children:t.row.event.title})},{field:"description",headerName:"Description",type:"string",flex:1,minWidth:100},{field:"dateCreated",type:"date",headerName:"Date Created",valueGetter:t=>t?new Date(t):"",flex:1,minWidth:100},{field:"amount",type:"number",headerName:"Amount",valueFormatter:vt,flex:1,minWidth:100}],hI=({allowance:t})=>{const n=(0,Dt.A)(),{project:s}=(0,De.B)(),o=t.payments.reduce((a,i)=>a+i.amount,0),r=(0,d.useMemo)(()=>{const a=[...t.payments.map(i=>({id:`payment_${i.id}`,event:{link:`/projects/${s?.id}/budget/revenue/payments?ids=${i.id}`,title:"Payment Request Created"},description:i.description,dateCreated:i.dateCreated,amount:i.amount}))];return t.changeOrder&&a.push({id:`change_order_${t.changeOrder.id}`,event:{link:`/projects/${s?.id}/budget/revenue/change-orders?ids=${t.changeOrder.id}`,title:"Change Order Created"},description:t.changeOrder.description,dateCreated:t.changeOrder.invoiceDate,amount:t.changeOrder.homebuyerPrice}),a},[t,s]);return(0,e.jsx)(E.A,{sx:{padding:"12px",backgroundColor:n.palette.background.tertiary},children:(0,e.jsxs)(Fs.A,{sx:{display:"flex",flexDirection:"column",gap:"12px",padding:"16px"},children:[(0,e.jsx)(E.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:n.spacing(1)},children:[(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center"},children:(0,e.jsxs)(I.A,{variant:"h6",fontWeight:"medium",children:["Payment Requests",t.title?` for ${t.title}`:""]})}),(0,e.jsxs)(I.A,{children:[(0,e.jsxs)(I.A,{display:"inline",color:"textSecondary",children:["Total Change Order Amount:"," "]}),(0,e.jsx)(I.A,{display:"inline",fontWeight:"medium",children:(0,Ze.up)(t.changeOrder?.homebuyerPrice??0)})]}),(0,e.jsxs)(I.A,{children:[(0,e.jsxs)(I.A,{display:"inline",color:"textSecondary",children:["Total Payments Requested:"," "]}),(0,e.jsx)(I.A,{display:"inline",fontWeight:"medium",children:(0,Ze.up)(o)})]})]})}),(0,e.jsx)(Ga,{children:(0,e.jsx)(Jn,{defaultSortModel:[{field:zn,sort:"desc"}],initialState:{pagination:{paginationModel:{pageSize:10,page:0}},columns:{columnVisibilityModel:{[zn]:!1}}},getCellClassName:cs,disableColumnMenu:!0,rows:r,columns:mI,pagination:!0,columnHeaderHeight:Vn,rowHeight:Vn,pageSizeOptions:[10],slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"linear-progress"}}})})]})})},gI={id:dr,project:-1,createdAt:"",title:"Totals",costCode:null,builderBudgetedCost:0,markup:0,homebuyerActualSelection:0,homebuyerBudgetedAllowance:0,forecastBuilderInvoice:0,actualFromExpenses:0,homebuyerFinalAmount:0,homebuyerPriceVariance:0,finalBuilderProfit:0,changeOrder:null,isAggregationRow:!0,payments:[]},fI=()=>{const{project:t}=(0,De.B)(),n=So(D.w5.BUDGET,D.a2.EDIT_INVOICE),s=(0,Kn.b)(),o=(0,Fe.d)(),{waitForRow:r,onRowAdded:a}=po(),[i]=(0,Me.Ph)(),[l]=(0,Me.o8)(),{data:c=[],isFetching:u}=(0,Me.Nc)({project:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0}),p=(0,d.useMemo)(()=>c.map(x=>({...x,isAggregationRow:!1})),[c]);gr({tool:D.w5.BUDGET,action:c.length?D.H1.OPEN_WITH_DATA:D.H1.OPEN,content_type:"project",object_id:t?.id},{skip:u});const f=async()=>{s.current.setSortModel([]);try{const{id:x}=await i({project:t?.id,title:"",costCode:null,markup:0,builderBudgetedCost:0,homebuyerActualSelection:0,forecastBuilderInvoice:0,homebuyerBudgetedAllowance:0}).unwrap(),v=await r(x,s);s.current.startCellEditMode({id:v.id,field:"title"})}catch(x){o.showError({message:fn(x)})}},h=eo(s),b=pc();return mc(s),(0,e.jsxs)(e.Fragment,{children:[n&&(0,e.jsx)(mr.A,{container:()=>document.getElementById(Ha),children:(0,e.jsx)(sn,{variant:"contained",size:"small",onClick:f,children:"Add Allowance"})}),(0,e.jsx)(Jn,{processRowUpdate:async x=>{x.isAggregationRow||await l(x).unwrap()},columns:cI,rows:p,showLoadingDuringUpdate:!0,columnHeaderHeight:60,rowHeight:Vn,getRowClassName:Gh(b,h),getCellClassName:cs,disableColumnMenu:!0,disableVirtualization:!0,hideFooter:!0,apiRef:s,onRowAdded:a,loading:u,defaultSortModel:[{field:zn,sort:"desc"}],getDetailPanelHeight:()=>"auto",getDetailPanelContent:({row:x})=>x.isAggregationRow?null:(0,e.jsx)(hI,{allowance:x}),initialState:{columns:{columnVisibilityModel:{[zn]:!1,actions:n}},aggregation:{model:{builderBudgetedCost:"sum",homebuyerActualSelection:"sum",homebuyerBudgetedAllowance:"sum",forecastBuilderInvoice:"sum",actualFromExpenses:"sum",homebuyerFinalAmount:"sum",homebuyerPriceVariance:"sum",finalBuilderProfit:"sum"}},pinnedColumns:{left:[Hr.U,og,rg]}},slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}},slots:{noRowsOverlay:()=>(0,e.jsx)(pI,{children:n&&(0,e.jsx)(sn,{size:"large",variant:"contained",color:"primary",onClick:f,children:"Add Allowance"})})},pinnedRows:{top:[gI]},isCellEditable:x=>n&&!!x.colDef.editable&&!x.row.isAggregationRow})]})};var xI=m(20319);const ag={paid:"success",not_paid:"info"},yI=[{field:"type",headerName:"Type",type:"string",flex:1,minWidth:100,editable:!0},{field:"expected",headerName:"Expected",type:"number",valueFormatter:vt,flex:1,minWidth:100,editable:!0},{field:"paid",headerName:"Paid",type:"number",valueFormatter:vt,flex:1,minWidth:100,editable:!0},{field:"due",headerName:"Due",type:"number",valueFormatter:vt,flex:1,minWidth:100,editable:!0}],bI=({value:t,row:n})=>(0,e.jsxs)(E.A,{sx:{height:"100%",display:"flex",alignItems:"center"},children:[(0,e.jsx)(E.A,{sx:{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden"},children:t}),(0,e.jsx)(Cl,{title:t,recordGroups:[{title:"Allowance",link:`../allowances?ids=${n.allowance?.id}`,records:n.allowance?[{title:n.allowance.title,data:[{icon:(0,e.jsx)(Eo.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Buyer Budgeted",value:n.allowance.homebuyerBudgetedAllowance?(0,Ze.up)(n.allowance.homebuyerBudgetedAllowance):""},{label:"Buyer Actual",value:n.allowance.homebuyerFinalAmount?(0,Ze.up)(n.allowance.homebuyerFinalAmount):""},{label:"Variance",value:n.allowance.homebuyerPriceVariance?(0,Ze.up)(n.allowance.homebuyerPriceVariance):""}]}]}]:[]},{title:"Change Order",link:`../change-orders?ids=${n.changeOrder?.id}`,records:n.changeOrder?[{title:n.changeOrder.title,data:[{icon:(0,e.jsx)(Eo.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Homebuyer Price",value:(0,Ze.up)(n.changeOrder.homebuyerPrice)},{label:"Builder Cost",value:(0,Ze.up)(n.changeOrder.builderCost)},{label:"Markup",value:uc(n.changeOrder.margin)}]},{icon:(0,e.jsx)(fr.A,{fontSize:"inherit",color:"inherit"}),entries:[{label:"Approved",value:n.changeOrder.approvalDate}]}]}]:[]}]})]}),vI=()=>{const{project:t}=(0,De.B)(),{varianceCodeMap:n}=Xa(),{data:s}=(0,Me.Xp)({projectId:t?.id},{skip:!t?.id}),[o]=(0,Me.DA)();return[Zs,{field:"title",headerName:"Title",type:"string",flex:1,minWidth:100,editable:!0,renderCell:r=>(0,e.jsx)(bI,{...r})},{field:"payor",headerName:"Payor",type:"string",flex:1,minWidth:100,editable:!0},{field:"description",headerName:"Description",type:"string",flex:1,minWidth:100,editable:!0},{field:"costCodeId",headerName:"Cost Code",editable:!0,renderCell:r=>(0,e.jsx)(Gr,{...r}),renderEditCell:r=>(0,e.jsx)(ur,{...r})},{flex:1,minWidth:150,field:"varianceCodeId",headerName:"Variance Code",editable:!0,renderCell:r=>(0,e.jsx)(fl,{params:r,varianceCodeMap:n}),renderEditCell:r=>(0,e.jsx)(xl,{...r})},{field:"dateCreated",type:"date",headerName:"Created",valueGetter:r=>r?new Date(r):null,flex:1,minWidth:100,editable:!0},{field:"dueDate",type:"date",headerName:"Due",valueGetter:r=>r?new Date(r):null,flex:1,minWidth:100,editable:!0},{field:"amount",type:"number",headerName:"Expected",valueFormatter:vt,renderEditCell:r=>(0,e.jsx)(ms,{...r}),flex:1,minWidth:100,editable:!0},{field:"amountPaid",type:"number",headerName:"Paid",valueFormatter:vt,renderEditCell:r=>(0,e.jsx)(ms,{...r}),flex:1,minWidth:100,editable:!0},{field:"balanceDue",type:"number",headerName:"Balance Due",valueFormatter:vt,flex:1,minWidth:100},{field:"status",headerName:"Status",type:"singleSelect",editable:!0,valueOptions:s,renderCell:({value:r,formattedValue:a})=>(0,e.jsx)(to,{color:ag[r],label:a,shape:"square"}),renderEditCell:r=>(0,e.jsx)(xI.D,{...r,renderOption:({label:a,value:i})=>(0,e.jsx)(to,{color:ag[i],label:a,shape:"square"})})},{field:"actions",type:"actions",headerName:"",width:50,getActions:({row:r})=>{const{isModalOpen:a,openModal:i,closeModal:l}=ln(),c=(0,Fe.d)();return[(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:i,color:"inherit"}),(0,e.jsx)(Zt,{open:a,onClose:l,title:"Delete Payment?",content:"Once deleted you cannot undo this action.",actions:[{title:"Delete",onClick:async()=>{try{await o({id:r.id,projectId:t.id}).unwrap(),l()}catch(u){c.showError({message:fn(u)})}},color:"error"}]})]})]}}]},zc=({icon:t,title:n,description:s,children:o})=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"80%",padding:"24px",gap:"24px",margin:"auto",textAlign:"center",maxWidth:"280px",overflow:"hidden"},children:[(0,e.jsx)(E.A,{sx:r=>({fontSize:"48px",color:r.palette.foreground.quaternary}),children:t}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"subtitle2",fontWeight:"semibold",sx:{mb:"4px"},children:n}),(0,e.jsx)(I.A,{variant:"body2",color:"textSecondary",children:s})]}),o]});var jI=m(39934),AI=m(56707);const CI=t=>t.id==="draw"?(0,e.jsx)(SI,{...t}):t.id==="allowance"?(0,e.jsx)(wI,{...t}):(0,e.jsx)(EI,{...t}),Vc=({id:t,type:n,payments:s,isLoading:o,apiRef:r,onRowAdded:a,emptyOverlay:i})=>{const{project:l}=(0,De.B)(),[c]=(0,Me.nZ)(),u=(0,Dt.A)(),p=(0,Kn.b)(),f=vI(),h=So(D.w5.BUDGET,D.a2.EDIT_INVOICE);(0,d.useImperativeHandle)(r,()=>p.current,[p]),mc(p);const b=pc();return(0,e.jsx)(E.A,{sx:{padding:"12px",backgroundColor:u.palette.background.tertiary},children:(0,e.jsxs)(Fs.A,{sx:{display:"flex",flexDirection:"column",gap:"12px",padding:"16px"},children:[(0,e.jsx)(E.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:u.spacing(1)},children:[(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center"},children:(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",children:n})}),(0,e.jsx)(I.A,{children:(0,e.jsxs)(I.A,{display:"inline",color:"textSecondary",children:["Total Amount:"," "]})})]})}),(0,e.jsx)(Ga,{children:(0,e.jsx)(Jn,{sx:!o&&!s.length?{height:"400px"}:{},loading:o,processRowUpdate:async x=>{const v=await c({...x,amountPaid:Number(x.amountPaid.toFixed(2)),amount:Number(x.amount.toFixed(2)),dueDate:us(x.dueDate),dateCreated:us(x.dateCreated),projectId:l.id}).unwrap();return{...x,...v}},initialState:{pagination:{paginationModel:{pageSize:10,page:0}},columns:{columnVisibilityModel:{[zn]:!1,varianceCodeId:t!=="draw",actions:h}}},defaultSortModel:[{field:zn,sort:"desc"}],getCellClassName:cs,getRowClassName:b,onRowAdded:a,disableColumnMenu:!0,apiRef:p,rows:s,columns:f,pagination:!0,columnHeaderHeight:Vn,rowHeight:Vn,pageSizeOptions:[10],slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"linear-progress"}},slots:{noRowsOverlay:()=>i}})})]})})},SI=t=>{const{project:n}=(0,De.B)(),s=(0,Fe.d)(),o=(0,Kn.b)(),[r]=(0,Me.IZ)(),a=So(D.w5.BUDGET,D.a2.EDIT_INVOICE),{waitForRow:i,onRowAdded:l}=po(),c=(0,d.useCallback)(async()=>{try{o.current.setSortModel([]);const u=await r({projectId:n.id,paymentType:"draw",dueDate:us(new Date)}).unwrap(),p=await i(u.id,o);o.current.startCellEditMode({id:p.id,field:"title"})}catch(u){s.showError({message:fn(u)})}},[r,s,i,n]);return(0,e.jsxs)(e.Fragment,{children:[a&&(0,e.jsx)(mr.A,{container:()=>document.getElementById(Ha),children:(0,e.jsx)(sn,{variant:"contained",size:"small",onClick:c,children:"Add Payment"})}),(0,e.jsx)(Vc,{...t,apiRef:o,onRowAdded:l,emptyOverlay:(0,e.jsx)(zc,{icon:(0,e.jsx)(jI.A,{sx:{fontSize:"inherit"}}),title:"No Draw Payments to display.",description:"Add draw payments to track payment details and dates received.",children:(0,e.jsx)(sn,{variant:"contained",size:"small",onClick:c,children:"Add Draw Payment"})})})]})},wI=t=>(0,e.jsx)(Vc,{...t,emptyOverlay:(0,e.jsx)(zc,{icon:(0,e.jsx)(Eo.A,{sx:{fontSize:"inherit"}}),title:"No Allowances sent to Payments.",description:"Create allowance payments on Allowances to track due dates and amounts paid.",children:(0,e.jsx)(K.A,{component:L.Link,to:"../allowances",variant:"outlined",color:"secondary",children:"View Allowances"})})}),EI=t=>(0,e.jsx)(Vc,{...t,emptyOverlay:(0,e.jsx)(zc,{icon:(0,e.jsx)(AI.A,{sx:{fontSize:"inherit"}}),title:"No Change Orders sent to Payments.",description:"Create change order payments on Change Orders to track due dates and amounts paid.",children:(0,e.jsx)(K.A,{component:L.Link,to:"../change-orders",variant:"outlined",color:"secondary",children:"View Change Orders"})})}),PI=()=>{const{project:t}=(0,De.B)(),n=(0,Kn.b)(),s=eo(n),{data:o=[],isFetching:r}=(0,Me.Wy)({projectId:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0}),{data:a=[],isFetching:i}=(0,Me.Nc)({project:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0}),l=r||i,c=(0,d.useMemo)(()=>a.reduce((h,b)=>(h.set(b.id,b),h),new Map),[a]),u=(0,d.useMemo)(()=>{const{draw:h,allowance:b,change_order:x}=o.reduce((v,y)=>{const j=v[y.paymentType];return l||j.payments.push({...y,allowance:y.allowanceId?c.get(y.allowanceId)??null:null}),j.expected+=y.amount,j.paid+=y.amountPaid,j.due+=y.balanceDue,v},{draw:{id:"draw",type:"Draw Schedule",payments:[],expected:0,paid:0,due:0},allowance:{id:"allowance",type:"Allowances",payments:[],expected:0,paid:0,due:0},change_order:{id:"change_order",type:"Change Orders",payments:[],expected:0,paid:0,due:0}});return[h,b,x]},[o,c,l]),p=Qa(),f=(0,d.useMemo)(()=>o.find(({id:h})=>p.includes(String(h))),[o,p]);return Qh(n,f?.paymentType??"",{skip:l}),(0,e.jsx)(Jn,{loading:l,columns:yI,rows:u,columnHeaderHeight:Vn,rowHeight:Vn,getRowClassName:s,disableColumnMenu:!0,disableVirtualization:!0,hideFooter:!0,apiRef:n,slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}},initialState:{detailPanel:{expandedRowIds:u.map(({id:h})=>h)}},getDetailPanelHeight:()=>"auto",getDetailPanelContent:({row:h})=>(0,e.jsx)(CI,{isLoading:l,...h})})},Za={WIDTH:264,GAP:16,PADDING:20,BORDER_RADIUS:4},II=(0,g.Ay)(E.A,{shouldForwardProp:t=>t!=="variant"})(({theme:t,variant:n})=>({display:"flex",minWidth:`${Za.WIDTH}px`,padding:`${Za.PADDING}px`,flexDirection:"column",alignItems:"flex-start",gap:"12px",borderRadius:`${Za.BORDER_RADIUS}px`,backgroundColor:t.palette.background.default,border:`1px solid ${t.palette.divider}`,...n==="profit"&&{background:"linear-gradient(180deg, #2E3032 2.73%, #636769 118.64%)",border:`1px solid ${t.palette.divider}`}})),DI=(0,g.Ay)(Sl.A,{shouldForwardProp:t=>t!=="variant"})(({theme:t,variant:n})=>({fontSize:"1rem",color:t.palette.text.secondary,...n==="profit"&&{color:t.palette.common.white}})),ig=({title:t,amount:n,helperText:s,isLoading:o=!1,variant:r="default"})=>{const a=r==="profit";return(0,e.jsxs)(II,{variant:r,children:[(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:"4px"},children:[(0,e.jsx)(I.A,{variant:"body2",fontWeight:"medium",color:a?"white":"text.secondary",children:t}),s&&(0,e.jsx)(qt.A,{arrow:!0,title:s,PopperProps:{sx:{"& .MuiTooltip-tooltip":{whiteSpace:"nowrap !important",maxWidth:"none !important",width:"max-content !important"}}},children:(0,e.jsx)(DI,{variant:r})})]}),(0,e.jsx)(I.A,{variant:"h3",fontWeight:"semibold",color:a?"white":"inherit",children:o?(0,e.jsx)(Mn.A,{}):(0,Ze.up)(n)})]})},kI=(0,g.Ay)(E.A)(({theme:t})=>({position:"relative",width:"100%"})),TI=(0,g.Ay)(E.A)(({theme:t})=>({display:"flex",gap:t.spacing(2),overflowX:"auto",overflowY:"hidden",width:"100%",scrollSnapType:"x mandatory",scrollBehavior:"smooth",scrollbarWidth:"none",msOverflowStyle:"none","&::-webkit-scrollbar":{display:"none"}})),RI=(0,g.Ay)(E.A)(()=>({display:"flex",gap:"inherit",minWidth:"fit-content",flex:1})),OI=(0,g.Ay)(E.A)({flex:1,scrollSnapAlign:"start"}),lg=(0,g.Ay)(pt.A)(({visible:t,position:n,theme:s})=>({position:"absolute",top:"50%",transform:"translateY(-50%)",[n]:"8px",zIndex:1,visibility:t?"visible":"hidden",minWidth:"40px",minHeight:"40px",backgroundColor:s.palette.background.paper,border:`1px solid ${s.palette.divider}`,borderRadius:s.shape.borderRadius,boxShadow:"0px 1px 3px 0px rgba(0, 0, 0, 0.10), 0px 1px 2px 0px rgba(0, 0, 0, 0.06)","&:hover":{backgroundColor:s.palette.grey[200]},"&:active":{backgroundColor:s.palette.background.paper},"&:focus":{backgroundColor:s.palette.background.paper}})),dg=({items:t,showNavigation:n=!0})=>{const s=(0,d.useRef)(null),[o,r]=(0,d.useState)(!1),[a,i]=(0,d.useState)(!1),l=(0,d.useCallback)(()=>{if(!s.current)return;const{scrollLeft:h,scrollWidth:b,clientWidth:x}=s.current;r(h>0),i(h+x<b-1)},[]);(0,d.useEffect)(()=>{l()},[t.length,l]),(0,d.useEffect)(()=>{const h=s.current;if(h)return h.addEventListener("scroll",l),window.addEventListener("resize",l),()=>{h.removeEventListener("scroll",l),window.removeEventListener("resize",l)}},[l]);const c=Za.WIDTH+Za.GAP,u=()=>{s.current?.scrollBy({left:c,behavior:"smooth"})},p=()=>{s.current?.scrollBy({left:-c,behavior:"smooth"})},f=n&&t.length>1;return(0,e.jsxs)(kI,{children:[f&&o&&(0,e.jsx)(lg,{position:"left",onClick:p,disabled:!o,visible:o,children:(0,e.jsx)(kh.A,{})}),(0,e.jsx)(TI,{ref:s,children:(0,e.jsx)(RI,{children:t.map((h,b)=>(0,e.jsx)(OI,{children:h},b))})}),f&&a&&(0,e.jsx)(lg,{position:"right",onClick:u,disabled:!a,visible:a,children:(0,e.jsx)(Th.A,{})})]})},MI=({data:t,isLoading:n=!1,showNavigation:s=!0})=>{const{totalCost:o,baseHomePrice:r,allowanceRevenue:a,changeOrderRevenue:i}=t,l=r+a+i,p=[{title:"Profit",helperText:"Final Home Price - Total Cost",amount:l-o,variant:"profit"},{title:"Total Cost",helperText:"Sum of all Invoices on the Invoices page",amount:o},{title:"Final Home Price",helperText:"Base Home Price + Allowance Revenue + Change Order Revenue",amount:l},{title:"Base Home Price",helperText:"Sum of all Draw Payments on the Payments page",amount:r},{title:"Allowance Revenue",helperText:"Sum of all Expected Amounts for Allowance payments",amount:a},{title:"Change Order Revenue",helperText:"Sum of all Expected Amounts for Change Order payments",amount:i}].map(f=>(0,e.jsx)(ig,{...f,isLoading:n},f.title));return(0,e.jsx)(dg,{items:p,showNavigation:s})},LI=m.p+"71270bc514527b302023feede13c0e6d.svg",FI=({children:t})=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%",padding:"24px",gap:"24px",margin:"auto",textAlign:"center",maxWidth:"320px",overflow:"hidden"},children:[(0,e.jsx)("img",{src:LI}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",children:"No Draw Schedule to display."}),(0,e.jsx)(I.A,{variant:"body1",color:"textSecondary",children:"Add draw payments to track payment details and dates received."})]}),t]}),BI=({onDeleteClick:t})=>[Zs,{field:"title",headerName:"Title",type:"string",flex:1,minWidth:100,editable:!0},{field:"payor",headerName:"Payor",type:"string",flex:1,minWidth:100,editable:!0},{field:"description",headerName:"Description",type:"string",flex:1,minWidth:100,editable:!0},{field:"amount",type:"number",headerName:"Expected",valueFormatter:vt,renderEditCell:n=>(0,e.jsx)(ms,{...n}),flex:1,minWidth:100,editable:!0},{field:"dueDate",type:"date",headerName:"Due Date",valueGetter:n=>new Date(n),flex:1,minWidth:100,editable:!0,sortComparator:(n,s,o,r)=>{const a=n-s;return a||Number(o.rowNode.id)-Number(r.rowNode.id)}},{field:"amountPaid",type:"number",headerName:"Received",valueFormatter:vt,renderEditCell:n=>(0,e.jsx)(ms,{...n}),flex:1,minWidth:100,editable:!0},{field:"balanceDue",type:"number",headerName:"Balance Due",valueFormatter:vt,flex:1,minWidth:100},{field:"actions",type:"actions",headerName:"",width:50,getActions:({row:n})=>{const{isModalOpen:s,openModal:o,closeModal:r}=ln(),a=(0,Fe.d)();return[(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:o,color:"inherit"}),(0,e.jsx)(Zt,{open:s,onClose:r,title:"Delete draw payment?",content:"Once deleted you cannot undo this action.",actions:[{title:"Delete",onClick:async()=>{try{await t(n),r()}catch(i){a.showError({message:fn(i)})}},color:"error"}]})]})]}}],NI=()=>{const{project:t}=(0,De.B)(),{company:n}=(0,je.P)(),{userHasPermission:s}=(0,Ye.A)(),o=s({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:n?.id,projectId:t?.id}),r=(0,Kn.b)(),a=(0,Fe.d)(),[i]=(0,Me.IZ)(),[l]=(0,Me.nZ)(),[c]=(0,Me.DA)(),{waitForRow:u,onRowAdded:p}=po(),f=async()=>{try{r.current.setSortModel([]);const y=await i({projectId:t.id,dueDate:us(new Date)}).unwrap(),j=await u(y.id,r);r.current.startCellEditMode({id:j.id,field:"title"})}catch(y){a.showError({message:fn(y)})}},{data:h=[],isFetching:b}=(0,Me.Wy)({projectId:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0});gr({tool:D.w5.BUDGET,action:D.H1.OPEN,content_type:"project",object_id:t?.id},{skip:!t?.id||h.length===0});const x=eo(r),v=(0,d.useMemo)(()=>BI({onDeleteClick:y=>c({id:y.id,projectId:t.id}).unwrap()}),[c,t]);return(0,e.jsxs)(e.Fragment,{children:[o&&(0,e.jsx)(mr.A,{container:()=>document.getElementById(Ha),children:(0,e.jsx)(sn,{variant:"contained",size:"small",onClick:f,children:"Add Payment"})}),(0,e.jsx)(Jn,{processRowUpdate:y=>l({...y,amountPaid:Number(y.amountPaid.toFixed(2)),amount:Number(y.amount.toFixed(2)),dueDate:us(y.dueDate),projectId:t.id}).unwrap(),columns:v,rows:h,columnHeaderHeight:Vn,rowHeight:Vn,getRowClassName:x,getCellClassName:cs,disableColumnMenu:!0,disableVirtualization:!0,hideFooter:!0,loading:b,apiRef:r,onRowAdded:p,defaultSortModel:[{field:zn,sort:"desc"}],initialState:{columns:{columnVisibilityModel:{[zn]:!1,actions:o}}},slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}},slots:{noRowsOverlay:()=>(0,e.jsx)(FI,{children:o&&(0,e.jsx)(sn,{size:"large",variant:"contained",color:"primary",onClick:f,children:"Add Payment"})})},isCellEditable:y=>o&&!!y.colDef.editable&&!y.row.isVirtualRow})]})},cg=t=>(0,e.jsx)(Po.A,{sx:{textTransform:"none"},component:L.Link,...t}),ug=()=>{const{isFlagEnabled:t}=(0,ut.u)(),n=t(D.SX.USE_EXPENSES_V2);return ic([{key:"payments",to:"payments",text:"Funds Received",element:(0,e.jsx)(PI,{}),hidden:!n},{key:"payments",to:"payments",text:"Draw Schedule",element:(0,e.jsx)(NI,{}),hidden:n},{key:"change-orders",to:"change-orders",text:"Change Orders",element:(0,e.jsx)(aI,{})},{key:"allowances",to:"allowances",text:"Allowances",element:(0,e.jsx)(fI,{})}])},pg=0,_I=()=>{const{project:t}=(0,De.B)(),n=(0,Dt.A)(),s=(0,L.useResolvedPath)(""),o=(0,L.useLocation)(),r=(0,d.useRef)(null),{isFlagEnabled:a}=(0,ut.u)(),i=a(D.SX.USE_EXPENSES_V2),{routes:l}=ug(),{data:c=[],isLoading:u}=(0,Me.Wy)({projectId:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0}),{data:p=[],isLoading:f}=(0,Me.xd)({projectId:t?.id,include_vpo_invoices:!0},{skip:!t?.id||!i,refetchOnMountOrArgChange:!0}),{data:h=[],isLoading:b}=(0,Me.fe)({project:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0}),x=u||b||f,v=(0,d.useMemo)(()=>{const[k]=o.pathname.slice(s.pathname.length+1).split("/"),S=l.findIndex(({to:R})=>R===k);return S===-1?pg:S},[o,s,l]),y=l[v],j=(0,d.useMemo)(()=>c.reduce((k,{paymentType:S,amount:R})=>(k.paymentsAmounts+=R,S==="allowance"&&(k.allowanceRevenue+=R),S==="change_order"&&(k.changeOrderRevenue+=R),k),{paymentsAmounts:0,allowanceRevenue:0,changeOrderRevenue:0}),[c]),A=(0,d.useMemo)(()=>h.reduce((k,{homebuyerPrice:S})=>k+S,0),[h]),w=(0,d.useMemo)(()=>p.filter(k=>k.visibleInInvoicesTab).reduce((k,{amount:S})=>k+S,0),[p]),P=(0,d.useMemo)(()=>[{title:"Receipts",amount:j.paymentsAmounts},{title:"Change Orders",amount:A},{title:"Final Price",amount:j.paymentsAmounts+A,helperText:"Final Price = Draw Receipts + Change Orders"}],[j,A]),C=(0,d.useMemo)(()=>({totalCost:w,baseHomePrice:j.paymentsAmounts,allowanceRevenue:j.allowanceRevenue,changeOrderRevenue:j.changeOrderRevenue}),[j,w]);return $o({handleResize:()=>zo(r.current)}),(0,e.jsxs)(E.A,{sx:{padding:n.spacing(2),display:"flex",gap:n.spacing(2),flexDirection:"column"},children:[(0,e.jsx)(I.A,{variant:"h4",component:"h1",fontWeight:"medium",children:y.text}),i?(0,e.jsx)(MI,{data:C,isLoading:x}):(0,e.jsx)(E.A,{sx:k=>({display:"flex",gap:k.spacing(2)}),children:P.map(k=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:n.spacing(1),padding:n.spacing(2),backgroundColor:n.palette.background.default,flex:1,border:`1px solid ${n.palette.divider}`,borderRadius:1},children:[(0,e.jsxs)(I.A,{variant:"body2",color:"textSecondary",fontWeight:"medium",sx:{display:"flex",alignItems:"center",gap:"4px"},children:[k.title,k.helperText&&(0,e.jsx)(qt.A,{arrow:!0,title:k.helperText,children:(0,e.jsx)(Sl.A,{sx:{fontSize:"1rem"}})})]}),(0,e.jsx)(I.A,{variant:"h3",fontWeight:"semibold",children:x?(0,e.jsx)(Mn.A,{}):(0,Ze.up)(k.amount)})]},k.title))}),(0,e.jsxs)(Vo,{ref:r,sx:{backgroundColor:"white"},children:[(0,e.jsxs)(E.A,{sx:{border:`1px solid ${n.palette.divider}`,paddingRight:n.spacing(1.5),borderBottom:0,borderTopLeftRadius:n.shape.borderRadius,borderTopRightRadius:n.shape.borderRadius,display:"flex",alignItems:"center"},children:[(0,e.jsx)(ir.A,{value:v,sx:{flex:1},children:l.map(k=>(0,e.jsx)(cg,{to:k.to,label:k.text},k.key))}),(0,e.jsx)("div",{id:Ha})]}),(0,e.jsxs)(L.Routes,{children:[l.map(k=>(0,e.jsx)(L.Route,{path:k.to,element:k.element},k.key)),(0,e.jsx)(L.Route,{path:"*",element:(0,e.jsx)(L.Navigate,{to:l[pg].to,replace:!0})})]})]})]})},ei=[{key:"invoices",to:"invoices",text:"Invoices",element:(0,e.jsx)(N0,{})},{key:"purchase-orders",to:"purchase-orders",text:"Purchase Orders",element:(0,e.jsx)(ZP,{})}],mg=()=>{const t=(0,Dt.A)(),n=(0,L.useResolvedPath)(""),s=(0,L.useLocation)(),{company:o,companyLoading:r}=(0,je.P)(),{project:a}=(0,De.B)(),{canUseFocus:i}=(0,_t.A)(),l=i(_t.O.BUILDER_TOOLS),c=()=>{const p=new URL(`/${_t.O.BUILDER_TOOLS}/${a?.companyId}/statements`,window.location.origin);p.searchParams.append("externalProjectId",a?.onlineJobId||""),a&&window.open(p.toString(),"_blank","noopener,noreferrer")},u=(0,d.useMemo)(()=>{const[p]=s.pathname.slice(n.pathname.length+1).split("/"),f=ei.findIndex(({to:h})=>h===p);return f===-1?0:f},[s,n]);return(0,e.jsxs)(E.A,{sx:{padding:t.spacing(2),display:"flex",gap:t.spacing(2),flexDirection:"column"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex"},children:[(0,e.jsx)(I.A,{variant:"h4",component:"h1",fontWeight:"medium",sx:{flex:1},children:"Expenses"}),l&&!r&&!o?.isPoCustomer&&(0,e.jsx)(sn,{variant:"outlined",color:"secondary",onClick:c,children:"Pay BFS Invoices"})]}),(0,e.jsxs)(E.A,{sx:{backgroundColor:"white"},children:[(0,e.jsxs)(E.A,{sx:{border:`1px solid ${t.palette.divider}`,paddingRight:t.spacing(1.5),borderBottom:0,borderTopLeftRadius:t.shape.borderRadius,borderTopRightRadius:t.shape.borderRadius,display:"flex",alignItems:"center"},children:[(0,e.jsx)(ir.A,{value:u,sx:{flex:1},children:ei.map(p=>(0,e.jsx)(cg,{to:p.to,label:p.text},p.key))}),(0,e.jsx)("div",{id:dl})]}),(0,e.jsxs)(L.Routes,{children:[ei.map(p=>(0,e.jsx)(L.Route,{path:p.to,element:p.element},p.key)),(0,e.jsx)(L.Route,{path:"*",element:(0,e.jsx)(L.Navigate,{to:ei[0].to,replace:!0})})]})]})]})},hg=()=>{const t=(0,Dt.A)(),{company:n,companyLoading:s}=(0,je.P)(),{project:o}=(0,De.B)(),{canUseFocus:r}=(0,_t.A)(),a=r(_t.O.BUILDER_TOOLS),{userHasPermission:i,allRoles:l}=(0,Ye.A)(),c=i({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:n?.id,projectId:o?.id}),u=()=>{const p=new URL(`/${_t.O.BUILDER_TOOLS}/${o?.companyId}/statements`,window.location.origin);p.searchParams.append("externalProjectId",o?.onlineJobId||""),o&&window.open(p.toString(),"_blank","noopener,noreferrer")};return(0,e.jsxs)(E.A,{sx:{padding:t.spacing(2)},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",paddingBottom:t.spacing(2)},children:[(0,e.jsx)(I.A,{variant:"h4",component:"h1",fontWeight:"medium",sx:{flex:1},children:"Expenses"}),a&&!s&&!n?.isPoCustomer&&(0,e.jsx)(sn,{variant:"outlined",color:"secondary",sx:{backgroundColor:"white"},onClick:u,children:"Pay BFS Invoices"})]}),(0,e.jsxs)(E.A,{children:[c&&!(0,ct.EL)(l)&&(0,e.jsx)(E.A,{sx:{backgroundColor:"white",display:"flex",justifyContent:"flex-end",padding:t.spacing(1,1.5),border:`1px solid ${t.palette.grey[300]}`,borderBottom:0,borderTopLeftRadius:t.shape.borderRadius,borderTopRightRadius:t.shape.borderRadius},children:(0,e.jsx)("div",{id:dl})}),(0,e.jsx)(N0,{})]})]})};var wl=m(3959);const UI=async()=>{const n=await(await fetch(d0)).arrayBuffer(),s=wl.LF(n,{type:"array"}),o=s.SheetNames[0],r=s.Sheets[o],a=wl.Wp.sheet_to_json(r);return c0(a)};function gg(t){const[n,s]=(0,d.useState)(!1),[o,r]=(0,d.useState)(!1),[a]=Rw(),{showError:i}=(0,Fe.d)(),[l,c]=(0,d.useState)([]),[u,p]=(0,d.useState)([]),f=(0,d.useCallback)(async()=>{const x=await UI();c(x),r(!0),s(!1)},[]),h=(0,d.useCallback)(async()=>{if(!t){console.error("No company ID provided to fetch cost codes.");return}try{s(!0);const x=await a(t);x.data&&x.data.length>0?c(x.data):f()}catch(x){const v="Failed to fetch cost codes.";console.error(v,x),i({message:v})}finally{s(!1)}},[i,f,a,t]),b=(0,d.useCallback)(async()=>{try{s(!0);const x=await nt.Ay.get(`/budgeting/company/${t}/quickbooks_costcodes`);x.data.results&&x.data.results.length>0&&p(x.data.results.map(v=>({value:v.id,label:v.text,type:v.qb_item_type})))}catch(x){const v="Failed to fetch QB codes.";console.error(v,x),i({message:v})}finally{s(!1)}},[i,t]);return{loading:n,fetchCostCodes:h,forceCostCodesToBeFetchedFromFile:f,isDataFetchedFromFile:o,costCodesList:l,fetchQBCodes:b,setCostCodesList:c,setIsDataFetchedFromFile:r,setLoading:s,qbCodesList:u}}const WI=rs(({open:t,onClose:n})=>{const s=(0,L.useNavigate)(),{company:o}=(0,je.P)(),{project:r}=(0,De.B)(),{showError:a,showSuccess:i}=(0,Fe.d)(),{costCodesList:l,forceCostCodesToBeFetchedFromFile:c,loading:u}=gg(),f=(0,L.useLocation)().key!=="default",[h]=zh(),b=(v,y)=>{y!=="backdropClick"&&s(f?-1:`/projects/${r?.id}/documents`)},x=async()=>{try{if("error"in await h({companyId:o.id,costCodeList:u0(wo(l,{processCostCodePathEntry:({codeDescription:y})=>y})),shouldResetCostCodes:!1,costCodeIdsToDelete:[]}))throw new Error("Failed to save cost codes");i({message:"Cost codes saved successfully"}),n()}catch(v){console.error(v),a({message:String(v)})}};return(0,d.useEffect)(()=>{l.length||c()},[l.length,c]),(0,e.jsx)(Zt,{open:t,title:"Cost Code Management",onClose:b,content:"There are no saved cost codes associated with this account. To get started, you can use the default NAHB cost code list, or manage your own cost codes.",hideCancel:!0,actions:[{title:"Manage Cost Codes",variant:"text",onClick:()=>s(`/companies/${o?.id}/profile/cost_codes`),sx:{marginRight:"auto"}},{title:"Go back",onClick:b,color:"secondary",variant:"outlined"},{title:"Use NAHB Cost Codes",onClick:x,disabled:u}]})}),yr="__new_budget_item__",ti={id:yr,title:"",description:"",budgeted:0,markup:0,estimatedHomebuyerPrice:0,margin:0,estimatedBuilderProfit:0,path:[yr],costCodeLabel:yr,costCodeId:null,isMiscellaneousRow:!1,isMissingCostCode:!0,isVirtualRow:!1,descendants:[]},El="__missing_cost_code__",fg=`${El} ${El}`,Pl={id:El,codeDescription:El,children:[],isActive:!0},zI=({row:t,rowNode:n})=>{const s=(0,ds.h)(),o=a=>{if(a.preventDefault(),a.stopPropagation(),n.type==="group"){if(s.current?.setRowChildrenExpansion(n.id,!n.childrenExpanded),n.childrenExpanded){const i=s.current?.getRowGroupChildren({groupId:n.id})??[],l=s.current?.getExpandedDetailPanels()??[];s.current?.setExpandedDetailPanels(l.filter(c=>!i.includes(c)))}}else s.current?.toggleDetailPanel(n.id)};if(t.isAggregationRow)return(0,e.jsx)(I.A,{fontWeight:"bold",variant:"inherit",children:"Totals"});const r=n.type==="group";return(0,e.jsxs)(E.A,{sx:{display:"flex"},children:[(0,e.jsx)(gl,{rowId:n.id,count:n.depth}),(0,e.jsxs)(E.A,{sx:r?{}:{paddingLeft:"12px"},children:[r&&(0,e.jsx)(pt.A,{onClick:o,children:n.childrenExpanded?(0,e.jsx)(Na.A,{}):(0,e.jsx)(Fo.A,{})}),t.costCodeLabel||Co(n)]})]})},VI=({row:t})=>{const n=(0,ds.h)(),{project:s}=(0,De.B)(),{data:o=[]}=(0,Me.A8)({projectId:s?.id},{skip:!s?.id,refetchOnMountOrArgChange:!0}),r=(0,d.useMemo)(()=>new Set(o.filter(({isPreliminaryBudget:i})=>i).map(({costCodeId:i})=>String(i))),[o]),a=t.id===yr;return(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"stretch"},children:[!a&&(0,e.jsx)(gl,{rowId:t.id,count:1}),(0,e.jsx)(E.A,{sx:{flex:1},children:(0,e.jsx)(p0,{hasFocus:a,placeholder:a?"":"Select a cost code",getOptionDisabled:i=>!i.isActive||r.has(String(i.id)),onChange:async(i,l)=>{l&&(n.current.getCellMode(t.id,Kr)===Nc.bs.View&&n.current.startCellEditMode({id:t.id,field:Kr}),await new Promise(c=>setTimeout(c)),n.current.setEditCellValue({id:t.id,field:Kr,value:String(l.id)}),n.current.stopCellEditMode({id:t.id,field:Kr}))}})})]})},$I={headerName:"Cost Code",minWidth:100,flex:1,renderCell:t=>t.row.isMissingCostCode?(0,e.jsx)(VI,{...t}):(0,e.jsx)(zI,{...t})},Kr="costCodeId",HI=({onDeleteClick:t})=>[{...zw,sortComparator:(n,s,o,r)=>{const a=Co(o.rowNode),i=Co(r.rowNode);return a===yr?-1:i===yr?1:a===fg?-1:i===fg?1:cl(n,s,o,r)}},{field:Kr,headerName:"Cost Code",type:"string",editable:!0},{field:"title",headerName:"Title",type:"string",editable:!0,flex:1,minWidth:100},{field:"description",headerName:"Description",type:"string",editable:!0,flex:1,minWidth:100},{field:"budgeted",type:"number",headerName:"Budgeted",renderEditCell:n=>(0,e.jsx)(ms,{...n}),editable:!0,flex:1,minWidth:100,renderCell:ps(vt)},{field:"markup",headerName:"Markup",type:"number",editable:!0,flex:1,minWidth:100,valueFormatter:$r,renderCell:({row:n,formattedValue:s})=>n.isAggregationRow||n.isVirtualRow?"":s},{field:"estimatedHomebuyerPrice",headerName:"Estimated Homebuyer Price",type:"number",flex:1,minWidth:100,renderCell:ps(vt)},{field:"margin",headerName:"Margin",type:"number",flex:1,minWidth:100,valueFormatter:$r,renderCell:({row:n,formattedValue:s})=>n.isAggregationRow||n.isVirtualRow?"":s},{field:"estimatedBuilderProfit",headerName:"Estimated Builder Profit",type:"number",flex:1,minWidth:100,renderCell:ps(vt)},{field:"actions",type:"actions",headerName:"",width:50,getActions:({id:n,row:s})=>{const{isModalOpen:o,openModal:r,closeModal:a}=ln(),i=(0,Fe.d)();return s.isAggregationRow?[]:[(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:n===yr?()=>t(s):r,color:"inherit"}),(0,e.jsx)(Zt,{open:o,onClose:a,title:"Delete budget item",content:"Deleting budget items will remove the budgeted amounts for parent and child cost codes in the Expenses page. Cost codes without invoices will be removed from the Expenses page.",actions:[{title:"Delete",onClick:async()=>{try{await t(s),a()}catch(l){i.showError({message:String(l)})}},color:"error"}]})]})]}}],QI=m.p+"d9d7df1a4defe35b9c4587d517b3316e.svg",GI=({children:t})=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%",padding:"24px",gap:"24px",margin:"auto",textAlign:"center",maxWidth:"400px",overflow:"hidden"},children:[(0,e.jsx)("img",{style:{maxHeight:"50%"},src:QI}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",children:"Create a Budget and keep your spending on track!"}),(0,e.jsx)(I.A,{variant:"body1",color:"textSecondary",children:"Use budget items to set spending targets for cost codes, then track your expenses against them. Keeping a project on budget has never been easier."})]}),t]}),KI=({targetedExpenses:t,targetedBuilderProfit:n,targetSalesPrice:s,isLoading:o})=>{const r=(0,d.useMemo)(()=>[{title:"Targeted Expenses",amount:t},{title:"Targeted Builder Profit",amount:n},{title:"Targeted Sale Price",amount:s}],[t,n,s]);return(0,e.jsx)(dg,{items:r.map(a=>(0,e.jsx)(ig,{...a,isLoading:o},a.title))})},xg=[{field:"costCodeLabel",sort:"asc"}],YI=t=>t.path,qI={id:dr,title:"",description:"",budgeted:0,markup:0,estimatedHomebuyerPrice:0,margin:0,estimatedBuilderProfit:0,costCodeLabel:dr,costCodeId:null,path:[dr],isMiscellaneousRow:!1,isMissingCostCode:!1,isVirtualRow:!0,descendants:[],isAggregationRow:!0},XI=wo([Pl])[0],JI=()=>{const t=(0,Kn.b)(),n=(0,d.useRef)(null),s=(0,Dt.A)(),{project:o}=(0,De.B)(),{company:r}=(0,je.P)(),{userHasPermission:a}=(0,Ye.A)(),i=a({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:r?.id,projectId:o?.id}),l=(0,Fe.d)(),[c]=(0,Me.ib)(),[u]=(0,Me.p0)(),[p]=(0,Me.tN)(),[f]=(0,Me.ci)(),{waitForRow:h,onRowAdded:b}=po(),[x,v]=(0,d.useState)(!1),{data:y=[],isLoading:j}=(0,Me.A8)({projectId:o?.id},{skip:!o?.id,refetchOnMountOrArgChange:!0});gr({tool:D.w5.BUDGET,content_type:"project",object_id:o?.id,action:y.length?D.H1.OPEN_WITH_DATA:D.H1.OPEN},{skip:j});const{data:A=[],isLoading:w,isFetching:P}=ar(o?.companyId,{skip:!o?.companyId}),C=j||w,k=j||P,S=eo(t),R=(0,d.useMemo)(()=>wo(A),[A]),B=(0,d.useMemo)(()=>{if(C)return[];const O=R.reduce((z,Q)=>(z[Q.id]=Q.parentPath,z),{[Pl.id]:[Pl]});return Array.from(y.reduce((z,Q)=>{if(!Q.isPreliminaryBudget)return z;const re=R.find(ee=>ee.id===Q.costCodeId)??XI,ue=re.id===Pl.id,le=re.codeDescription,{path:F,isMiscellaneousRow:V}=dc(re,le);z.set(Q.id,{id:Q.id,title:Q.title??"",description:Q.description??"",budgeted:Q.budgetedAmount,markup:Q.markup,estimatedHomebuyerPrice:Q.estimatedHomebuyerPrice,margin:Q.margin,estimatedBuilderProfit:Q.estimatedBuilderProfit,path:ue?F.concat(String(Q.id)):F,costCodeLabel:V?lr:le,costCodeId:ue?null:Number(re.id),isMiscellaneousRow:V,isMissingCostCode:ue,isVirtualRow:!1,descendants:[]});const $=O[re.id];return $.slice(0,V||ue?$.length:-1).forEach(ee=>{const X=O[ee.id].map(({codeDescription:he})=>he),G=`/${X.join("/")}`,Y=z.get(G);Y?Y.descendants.push(Q):z.set(G,{id:G,title:"",description:"",budgeted:0,markup:0,estimatedHomebuyerPrice:0,margin:0,estimatedBuilderProfit:0,path:X,costCodeLabel:ue?"Missing cost codes":ee.codeDescription,costCodeId:null,isMiscellaneousRow:!1,isMissingCostCode:!1,isVirtualRow:!0,descendants:[Q]})}),z},x?new Map([[ti.id,ti]]):new Map).values())},[x,y,R,C]);$o({handleResize:()=>zo(n.current)});const T=async()=>{if(x){const O=document.querySelector(`#${ti.id}`);O&&O instanceof HTMLInputElement&&O.click()}else t.current.setSortModel(xg),v(!0)},W=(0,d.useMemo)(()=>HI({onDeleteClick:async O=>{O.id===ti.id?v(!1):O.isVirtualRow?await f({projectId:o?.id,projectCostCodes:O.descendants.map(({id:z})=>z)}).unwrap():typeof O.id=="number"&&await p({projectId:o?.id,id:O.id}).unwrap()}}),[l,v,p,o]),N=(0,d.useMemo)(()=>y.reduce((O,z)=>(O.targetedExpenses+=z.budgetedAmount,O.targetedBuilderProfit+=z.estimatedBuilderProfit,O.targetSalesPrice+=z.estimatedHomebuyerPrice,O),{targetedExpenses:0,targetedBuilderProfit:0,targetSalesPrice:0}),[y]);return(0,e.jsxs)(E.A,{sx:{padding:s.spacing(2),display:"flex",gap:s.spacing(2),flexDirection:"column"},children:[(0,e.jsx)(E.A,{children:(0,e.jsx)(I.A,{variant:"h4",component:"h1",fontWeight:"medium",children:"Preliminary Budget"})}),(0,e.jsx)(KI,{...N,isLoading:C}),(0,e.jsxs)(Vo,{ref:n,children:[i&&(0,e.jsxs)(E.A,{sx:{backgroundColor:"white",display:"flex",justifyContent:"flex-end",paddingX:s.spacing(1.5),paddingY:s.spacing(1),border:`1px solid ${s.palette.divider}`,borderBottom:0,gap:"12px",borderTopLeftRadius:s.shape.borderRadius,borderTopRightRadius:s.shape.borderRadius},children:[(0,e.jsx)(sn,{size:"small",variant:"contained",color:"secondary",onClick:()=>Ho(`/budget/v2/project/${o?.id}/project-cost-codes/export_csv`),children:"Export Budget"}),(0,e.jsx)(sn,{size:"small",variant:"contained",color:"primary",onClick:T,children:"Add Budget Item"})]}),(0,e.jsx)(Jn,{processRowUpdate:async(O,z)=>{if(O.id===ti.id)if(O.costCodeId){const Q=await(async()=>{const F=y.find(({costCodeId:V})=>V===Number(O.costCodeId));return F?await u({id:F.id,projectId:o?.id,budgetedAmount:Number(O.budgeted.toFixed(2)),markup:Number(O.markup.toFixed(2)),costCodeId:Number(O.costCodeId),title:O.title,description:O.description,isPreliminaryBudget:!0}).unwrap():await c({projectId:o?.id,costCodeId:Number(O.costCodeId),budgetedAmount:Number(O.budgeted.toFixed(2)),markup:Number(O.markup.toFixed(2)),title:O.title,description:O.description,isPreliminaryBudget:!0}).unwrap()})(),re=await h(Q.id,t);v(!1);let ue="";for(const F of re.path.slice(0,-1))ue+=`/${F}`,t.current.setRowChildrenExpansion(ue,!0);await new Promise(F=>setTimeout(F,100));const le=t.current.getRowIndexRelativeToVisibleRows(re.id);return le&&t.current.scrollToIndexes({rowIndex:le}),t.current.startCellEditMode({id:re.id,field:"title"}),{...O,_action:"delete"}}else return O;else if(typeof O.id=="number"){const Q=await u({projectId:o?.id,id:O.id,budgetedAmount:Number(O.budgeted.toFixed(2)),markup:Number(O.markup.toFixed(2)),costCodeId:Number(O.costCodeId),title:O.title,description:O.description,isPreliminaryBudget:!0}).unwrap();if(Q.costCodeId&&Q.costCodeId!==z.costCodeId){const re=R.find(({id:ue})=>ue===Q.costCodeId);re&&l.showSuccess({message:`Moved budget item to ${re.codeDescription}`})}}},getRowClassName:S,getCellClassName:cs,onRowAdded:b,columns:W,rows:B,groupingColDef:$I,columnHeaderHeight:Vn,rowHeight:Vn,disableColumnMenu:!0,disableVirtualization:!0,getTreeDataPath:YI,hideFooter:!0,loading:k,apiRef:t,treeData:!0,initialState:{sorting:{sortModel:xg},aggregation:{model:{budgeted:"sum",estimatedHomebuyerPrice:"sum",estimatedBuilderProfit:"sum"}},columns:{columnVisibilityModel:{[Hh]:!1,[Kr]:!1,actions:i}}},slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}},slots:{noRowsOverlay:()=>(0,e.jsx)(GI,{children:i&&(0,e.jsx)(sn,{size:"large",variant:"contained",color:"primary",onClick:T,children:"Add Budget Item"})})},pinnedRows:{top:[qI]},isCellEditable:O=>i&&!!O.colDef.editable&&!O.row.isVirtualRow})]})]})},ZI=m.p+"747332d97fa584a55caa7f54ad1e3ef2.svg",eD=({children:t})=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%",padding:"24px",gap:"24px",margin:"auto",textAlign:"center",maxWidth:"340px",overflow:"hidden"},children:[(0,e.jsx)("img",{style:{maxHeight:"50%"},src:ZI}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"h6",fontWeight:"medium",children:"No Revenue or Expenses data to display"}),(0,e.jsx)(I.A,{variant:"body1",color:"textSecondary",children:"Your P&L statement can only be generated after Expenses and Revenue data for your project have been entered."})]}),t]}),tD=({row:t,rowNode:n})=>{const s=(0,ds.h)(),o=u=>{if(u.preventDefault(),u.stopPropagation(),n.type==="group"){if(s.current?.setRowChildrenExpansion(n.id,!n.childrenExpanded),n.childrenExpanded){const p=s.current?.getRowGroupChildren({groupId:n.id})??[],f=s.current?.getExpandedDetailPanels()??[];s.current?.setExpandedDetailPanels(f.filter(h=>!p.includes(h)))}}else s.current?.toggleDetailPanel(n.id)};if(t.isAggregationRow)return(0,e.jsx)(I.A,{fontWeight:"bold",variant:"inherit",children:"Totals"});const r=n.type==="group",a=t.isGroupingRow,l=r&&n.isAutoGenerated&&String(n.parent).includes("expenses")?Co(n):"",c=t.description||l;return(0,e.jsxs)(E.A,{sx:{display:"flex"},children:[(0,e.jsx)(gl,{rowId:n.id,count:n.depth}),(0,e.jsxs)(E.A,{sx:r?{}:{paddingLeft:"12px"},children:[r&&(0,e.jsx)(pt.A,{onClick:o,children:n.childrenExpanded?(0,e.jsx)(Na.A,{}):(0,e.jsx)(Fo.A,{})}),(0,e.jsx)(qa,{customRenderCellStyles:{display:"inline",fontWeight:a?"bold":""},title:c,children:c})]})]})},nD={...Hr.a,headerName:"Description",width:350,renderHeader:()=>(0,e.jsx)(I.A,{fontWeight:"bold",variant:"inherit",className:en.x.columnHeaderTitle,children:"Description"}),renderCell:tD},sD=[{groupId:"revenue",headerName:"Revenue",children:[{field:"revenueBudget"},{field:"revenueActual"},{field:"revenueVariance"}]},{groupId:"expenses",headerName:"Expenses",children:[{field:"expensesBudget"},{field:"expensesActual"},{field:"expensesVariance"}]},{groupId:"income",headerName:"Income",children:[{field:"incomeBudget"},{field:"incomeActual"},{field:"incomeVariance"}]}],$c="__sort__",oD=[{field:$c,type:"custom",valueGetter:(t,n)=>n,sortComparator:(t,n,s,o)=>String(s.rowNode.parent).includes("base-house/expenses")&&String(o.rowNode.parent).includes("base-house/expenses")?cl(t.description,n.description,s,o):t.createdAt&&n.createdAt?n.createdAt-t.createdAt:t.createdAt?1:n.createdAt?-1:0},{editable:!1,flex:1,minWidth:100,field:"revenueBudget",headerName:"Budget",type:"number",renderCell:ps(vt)},{editable:!1,flex:1,minWidth:100,field:"revenueActual",headerName:"Actual",type:"number",renderCell:ps(vt)},{editable:!1,flex:1,minWidth:100,field:"revenueVariance",headerName:"Variance",type:"number",renderCell:ps(vt)},{editable:!1,flex:1,minWidth:100,field:"expensesBudget",headerName:"Budget",type:"number",renderCell:ps(vt)},{editable:!1,flex:1,minWidth:100,field:"expensesActual",headerName:"Actual",type:"number",renderCell:ps(vt)},{editable:!1,flex:1,minWidth:100,field:"expensesVariance",headerName:"Variance",type:"number",renderCell:ps(vt)},{editable:!1,flex:1,minWidth:100,field:"incomeBudget",headerName:"Budget",type:"number",renderCell:ps(vt)},{editable:!1,flex:1,minWidth:100,field:"incomeActual",headerName:"Actual",type:"number",renderCell:ps(vt)},{editable:!1,flex:1,minWidth:100,field:"incomeVariance",headerName:"Variance",type:"number",renderCell:ps(vt)}],rD=t=>t.path,aD=[{id:"base-house",description:"Base House",path:["base-house"],isGroupingRow:!0},{id:"base-house/draw-payments",description:"Draw Payments",path:["base-house","draw-payments"],isGroupingRow:!0},{id:"base-house/expenses",description:"Expenses",path:["base-house","expenses"],isGroupingRow:!0},{id:"allowances",description:"Allowances",path:["allowances"],isGroupingRow:!0},{id:"change-orders",description:"Change Orders",path:["change-orders"],isGroupingRow:!0}],Yr=t=>({...t,incomeBudget:(t.revenueBudget??0)-(t.expensesBudget??0),incomeActual:(t.revenueActual??0)-(t.expensesActual??0),incomeVariance:(t.revenueVariance??0)-(t.expensesVariance??0)}),iD={path:[],id:dr,description:"",isAggregationRow:!0},yg=(t,n)=>n[String(t)]?n[String(t)].codeDescription:"",lD=()=>{const{project:t}=(0,De.B)(),n=(0,Kn.b)(),s=(0,d.useRef)(null),o=(0,Dt.A)(),{data:r,isFetching:a}=(0,Me.gR)({projectId:t?.id},{skip:!t?.id,refetchOnMountOrArgChange:!0}),{data:i=[],isFetching:l}=ar(t?.companyId,{skip:!t?.companyId}),c=a||l,{costCodes:u,costCodesMappedById:p}=(0,d.useMemo)(()=>{const b=wo(i),x=b.reduce((v,y)=>({...v,[y.id]:y}),{});return{costCodes:b,costCodesMappedById:x}},[i]);gr({tool:"budget",action:r?.allowances.length||r?.changeOrders.length||r?.invoices.length||r?.projectCostCodes.length||r?.scheduledPayments.length?D.H1.OPEN_WITH_DATA:D.H1.OPEN,content_type:"project",object_id:t?.id},{skip:a});const f=(0,d.useMemo)(()=>{if(c||!r?.allowances.length&&!r?.changeOrders.length&&!r?.invoices.length&&!r?.projectCostCodes.length&&!r?.unlinkedChangeOrderPayments.length&&!r?.unlinkedAllowancePayments.length&&!r?.scheduledPayments.length)return[];const b=B0(r.invoices,r.projectCostCodes,u);return[...aD,...r.scheduledPayments.map(x=>Yr({id:`base-house/draw-payments/${x.id}`,createdAt:new Date(x.createdAt),description:x.title,path:["base-house","draw-payments",x.id],revenueBudget:x.amount,revenueActual:x.amountPaid,revenueVariance:x.amountPaid-x.amount})),...b.map(x=>Yr({id:`base-house/expenses/${x.id}`,description:x.groupingLabel,path:["base-house","expenses",...x.path],expensesBudget:x.budgeted,expensesActual:x.actuals,expensesVariance:x.actuals-x.budgeted})),...r.allowances.map(x=>Yr({id:`allowances/${x.id}`,description:`${x.title}${yg(x.costCode,p)} `,path:["allowances",String(x.id)],revenueBudget:x.paymentsBudgetAmount,revenueActual:x.paymentsActualAmount,revenueVariance:x.paymentsVarianceAmount,expensesBudget:x.builderBudgetedCost??0,expensesActual:x.actualFromExpenses??0,expensesVariance:(x.actualFromExpenses??0)-(x.builderBudgetedCost??0)})),...r.unlinkedAllowancePayments.map(x=>Yr({id:`allowances/payments/${x.id}`,description:x.title,path:["allowances",`payment_${x.id}`],revenueBudget:x.amount,revenueActual:x.amountPaid,revenueVariance:x.amountPaid-x.amount})),...r.changeOrders.map(x=>Yr({id:`change-orders/${x.id}`,description:`${x.title}${yg(x.costCode,p)}`,path:["change-orders",x.id],revenueBudget:x.paymentsBudgetAmount,revenueActual:x.paymentsActualAmount,revenueVariance:x.paymentsVarianceAmount,expensesBudget:0,expensesActual:x.builderCost,expensesVariance:x.builderCost})),...r.unlinkedChangeOrderPayments.map(x=>Yr({id:`change-orders/payments/${x.id}`,description:x.title,path:["change-orders",`payment_${x.id}`],revenueBudget:x.amount,revenueActual:x.amountPaid,revenueVariance:x.amountPaid-x.amount}))]},[c,r,u,p]),h=eo(n);return $o({handleResize:()=>zo(s.current)}),(0,e.jsxs)(E.A,{sx:{padding:o.spacing(2)},children:[(0,e.jsx)(E.A,{sx:{paddingBottom:o.spacing(2)},children:(0,e.jsx)(I.A,{variant:"h4",component:"h1",fontWeight:"medium",children:"Profit and Loss"})}),(0,e.jsx)(Vo,{ref:s,columnsWithBorder:["revenueBudget","expensesBudget","incomeBudget"],children:(0,e.jsx)(Jn,{getRowClassName:h,getCellClassName:cs,columns:oD,rows:f,groupingColDef:nD,columnGroupingModel:sD,columnHeaderHeight:Vn,rowHeight:Vn,disableColumnMenu:!0,disableVirtualization:!0,getTreeDataPath:rD,hideFooter:!0,apiRef:n,treeData:!0,defaultSortModel:[{field:$c,sort:"asc"}],initialState:{aggregation:{model:{revenueBudget:"sum",revenueActual:"sum",revenueVariance:"sum",expensesBudget:"sum",expensesActual:"sum",expensesVariance:"sum",incomeBudget:"sum",incomeActual:"sum",incomeVariance:"sum"}},columns:{columnVisibilityModel:{[$c]:!1}}},loading:c,slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}},slots:{noRowsOverlay:()=>(0,e.jsx)(eD,{children:(0,e.jsxs)(E.A,{sx:{display:"flex",gap:"12px"},children:[(0,e.jsx)(K.A,{component:L.Link,to:"../revenue",color:"secondary",variant:"contained",children:"Manage Revenue"}),(0,e.jsx)(K.A,{component:L.Link,to:"../expenses",variant:"contained",children:"Enter Expenses"})]})})},pinnedRows:{top:[iD]}})})]})},dD=()=>{const t=(0,L.useResolvedPath)(""),n=(0,L.useLocation)(),[s,o]=fo(t.pathname,{browserStorage:sessionStorage});return(0,d.useEffect)(()=>{const[r]=n.pathname.slice(t.pathname.length+1).split("/");o(r)},[t.pathname,n.pathname,o]),s},cD=()=>{const{isFlagEnabled:t}=(0,ut.u)(),n=t(D.SX.USE_PRELIMINARY_BUDGET_PAGE),s=t(D.SX.USE_REVENUE_PAGE),o=t(D.SX.USE_PROFIT_AND_LOSS_PAGE),r=t(D.SX.USE_EXPENSES_V2),{allRoles:a}=(0,Ye.A)(),{routes:i}=ug(),{routes:l}=ic([{to:"preliminary-budget",icon:(0,e.jsx)(Ow.A,{}),text:"Preliminary Budget",element:(0,e.jsx)(JI,{}),key:"preliminary-budget",hidden:!n||(0,ct.EL)(a)},{key:"expenses",to:"expenses",icon:(0,e.jsx)(Vh.A,{}),text:"Expenses",element:(0,e.jsx)(mg,{}),children:ei,hidden:!r},{key:"expenses",to:"expenses",icon:(0,e.jsx)(Vh.A,{}),text:"Expenses",element:(0,e.jsx)(hg,{}),hidden:r},{icon:(0,e.jsx)(Mw.A,{}),text:"Revenue",key:"revenue",to:"revenue",element:(0,e.jsx)(_I,{}),hidden:!s||(0,ct.EL)(a),children:i},{icon:(0,e.jsx)(Lw.A,{}),text:"Profit and Loss",key:"profit-and-loss",to:"profit-and-loss",element:(0,e.jsx)(lD,{}),hidden:!o||(0,ct.EL)(a)}]),c=dD();return l.length>1?(0,e.jsx)(Ua,{persistKey:Nn.Rh.budgetSidebar,width:"250px",sidebarContent:(0,e.jsx)(Hi,{items:l}),children:(0,e.jsxs)(L.Routes,{children:[(0,e.jsx)(L.Route,{path:"",element:(0,e.jsx)(L.Navigate,{to:c||"expenses",replace:!0})}),l.map(u=>(0,e.jsx)(L.Route,{path:`${u.to}${u.children?"/*":""}`,element:u.element}))]})}):r?(0,e.jsx)(mg,{}):(0,e.jsx)(hg,{})},uD=()=>{const{isLoading:t}=(0,ut.u)(),{isModalOpen:n,closeModal:s,openModal:o}=ln(),{project:r}=(0,De.B)(),{canViewPage:a}=(0,$n.s)({tool:D.w5.BUDGET,action:D.a2.VIEW_BUDGET,companyId:r?.companyId,projectId:r?.id},[r?.id,r?.companyId]),{userHasPermission:i}=(0,Ye.A)(),l=i({tool:D.w5.BUDGET,action:D.a2.EDIT_INVOICE,companyId:r?.companyId,projectId:r?.id}),{data:c=[],isFetching:u,refetch:p,isUninitialized:f}=ar(r?.companyId,{skip:!r?.companyId}),h=async()=>{await p(),s()};return(0,d.useEffect)(()=>{!u&&!f&&l&&c.length===0&&o()},[c,u,f,o,l]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(is,{children:(0,e.jsxs)(kn,{sx:b=>({backgroundColor:b.palette.background.secondary}),children:[t&&(0,e.jsx)(os,{}),!t&&a&&(0,e.jsx)(cD,{}),(0,e.jsx)(WI,{open:n,onClose:h})]})})]})};function bg(t){return t.status==="activate-customer"||t.status==="activate"}function vg(t){return t.status==="navigate"}var pD=(t=>(t.SALES="SALES",t.NONE="NONE",t))(pD||{}),Sn=(t=>(t.MODELING="MODELING",t.SYSTEM="SYSTEM",t.USER="USER",t.QUOTE="QUOTE",t))(Sn||{}),mD=(t=>(t.BLUEPRINT="blueprint",t.SPECSHEET="specsheet",t.BROCHURE="brochure",t.MARKED_UP_PLAN="marked up plan",t.OTHER="other",t.THUMBNAIL="thumbnail",t.PART_LIST="part list",t.UNMAPPED_PART_LIST="unmapped part list",t.WINDOW_SCHEDULE="window schedule",t.ROOF_TRUSS_LAYOUT="roof truss layout",t.FLOOR_TRUSS_LAYOUT="floor truss layout",t.WALL_PANEL_LAYOUT="wall panel layout",t.ENGINEERED_LAYOUT="engineered layout",t.PURCHASE_ORDER="purchase order",t.FRAME_PREVIEW="frame preview",t))(mD||{});const hD=(0,d.lazy)(()=>m.e(674).then(m.t.bind(m,85674,23)).then(t=>({default:t.CustomerSearch})).catch(()=>({default:Es}))),gD=({handleSelectCustomer:t})=>{const[n,s]=(0,d.useState)(!1),{accessToken:o}=(0,Pt.A)(),{showError:r}=(0,Fe.d)();return(0,Yd.P)(async a=>{if(bg(a)){s(!0);try{await t(a.customerNumber,Aa(a.erpSystem))}catch(i){console.error("BFS customer search activation error",i),r({message:"There was an error switching to the customer."}),s(!1)}}}),n?(0,e.jsx)(os,{}):(0,e.jsx)(hD,{accessToken:o})},fD=(0,g.Ay)(_.A)`
  width: 480px;
  text-align: center;
  background-color: var(--common-white-100-p);
  border-radius: 4px;
  border: 1px var(--common-white-30-p);
`,jg=(0,g.Ay)("div")`
  background-color: var(--common-white-100-p);
  justify-content: flex-start;
  border-radius: 0.5rem;
  align-items: center;
  padding: 24px 20px;
  min-width: 900px;
`,Ag=(0,g.Ay)("div")`
  margin-right: 24px;
  margin-left: 24px;
  padding-top: 24px;
`,xD=({handleSelectCustomer:t})=>{const[n,s]=(0,d.useState)(""),{searchCustomers:o,customersList:r,fetchingCustomersList:a,showSearchError:i}=(0,Ii.A)(),l=[{field:"accountNumber",headerName:"Account #",flex:1},{field:"name",headerName:"Name",flex:2},{field:"address",headerName:"Address",flex:2},{field:"contact",headerName:"Contact",flex:2},{field:"creditLocation",headerName:"Credit Location",flex:2},{field:"market",headerName:"Market",flex:2},{field:"system",headerName:"System",flex:2}],c=u=>{u.key==="Enter"&&o(n)};return(0,e.jsxs)(Ag,{children:[(0,e.jsxs)(jg,{children:[(0,e.jsxs)(Ge,{justifyContent:"flex-start",alignItems:"center",children:[(0,e.jsx)(fD,{autoFocus:!0,id:"customer-search",label:"Find a customer...",onChange:u=>s(u.target.value),onKeyDown:c,value:n}),(0,e.jsx)(Y4,{handleClick:()=>o(n),loadingState:a,text:"Find",size:"small",styles:{marginLeft:"24px"}})]}),i&&(0,e.jsx)(I.A,{sx:{marginTop:"1rem",color:"#e30014"},children:"Please enter 3 or more characters to search customers"})]}),(0,e.jsxs)(E.A,{sx:{height:"75vh",minWidth:"900px"},children:[r&&r.length===0&&(0,e.jsx)("b",{children:"No results match your search."}),r&&r.length>0&&(0,e.jsx)(kc._,{sx:{"& .MuiDataGrid-row:hover":{cursor:"pointer"}},rows:r,columns:l,initialState:{pagination:{paginationModel:{pageSize:100}}},onRowClick:u=>t(u.row.accountNumber,u.row.erpSystem,u.row),pageSizeOptions:[100],disableRowSelectionOnClick:!0})]})]})},yD=()=>{const{isFlagEnabled:t}=(0,ut.u)(),{createEvent:n}=(0,io.A)(),s=()=>!!localStorage.getItem("paradigmAccessToken"),o=Ap(),{canViewPage:r}=(0,$n.s)({tool:D.w5.CUSTOMERS,action:D.a2.VIEW_CUSTOMERS,companyId:void 0,projectId:void 0});return(0,d.useEffect)(()=>{n({content_type:null,object_id:null,tool:"customers"})},[n]),r?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(kn,{children:s()&&t(D.SX.CUSTOMER_SEARCH_FEDERATED_MODULE)?(0,e.jsx)(vo,{children:(0,e.jsx)(gD,{handleSelectCustomer:o})}):(0,e.jsx)(xD,{handleSelectCustomer:o})})]}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(hn,{})})};var Tt=m(3624);const bD=({cancelCreation:t,refreshData:n,setMessage:s})=>{const{company:o}=(0,je.P)(),{createScheduleTemplate:r}=(0,Xs.P)(),a=(0,d.useRef)(null),[i,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(""),[p,f]=(0,d.useState)(null),h=async()=>{const x=new FormData;o?.id&&x.append("company",o.id.toString()),x.append("name",c.trim()),p&&x.append("template_file",p),l(!0);const v=await r(x);v.data?(s("Success",v.data.data,"success"),n(),l(!1),t()):(s("Error",v.error,"error"),l(!1)),a.current&&(a.current.value="")},b=(0,e.jsx)(r0,{href:Tt.U$,children:"download our sample template"});return(0,e.jsxs)("div",{style:{padding:"10px"},children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},"data-testid":"create-temp-page",children:[(0,e.jsx)(Qw,{"data-testid":"create-temp-title",children:"Create New Schedule Template"}),(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"end"},children:[(0,e.jsx)(Ka,{onClick:t,"data-testid":"create-cancel-button",children:"Cancel"}),(0,e.jsx)(Gw,{disabled:!c.trim(),"data-testid":"create-save-button",onClick:h,children:"Save Template"})]})]}),(0,e.jsxs)("div",{className:"create-template-form-area",children:[(0,e.jsx)(yc,{children:"Template Name"}),(0,e.jsx)(_.A,{label:"Enter a name for this template",sx:Kw,size:"small","data-testid":"template-name-field",value:c,onChange:x=>{u(x.target.value)},variant:"outlined"}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[(0,e.jsx)(yc,{children:"File Upload"}),(0,e.jsx)("div",{style:{paddingLeft:"10px"},children:"(Optional)"})]}),(0,e.jsxs)(i0,{children:[(0,e.jsxs)(Yw,{children:[(0,e.jsxs)("label",{style:{flexGrow:1},onClick:()=>{a?.current?.click()},children:[" ",p?p.name:"Select template"]}),p&&(0,e.jsx)(Ss.A,{onClick:()=>{a.current&&(a.current.value=""),f(null)},sx:a0})]}),(0,e.jsx)("input",{hidden:!0,ref:a,"data-testid":"template-file-field",type:"file",accept:"*.xlsx",onChange:x=>{x?.target?.files&&f(x?.target?.files[0])}}),(0,e.jsx)(Ka,{onClick:()=>a?.current?.click(),children:"Select File"})]}),(0,e.jsx)(i0,{children:(0,e.jsxs)("p",{style:{fontSize:"15px"},"data-testid":"template-note-area",children:["Note: We may have trouble aligning custom spreadsheets with our scheduling system. Please ",b," to help get started"]})})]}),(0,e.jsx)(rr.A,{open:i,invisible:!0,sx:{zIndex:x=>x.zIndex.drawer+1},children:(0,e.jsx)(bt.A,{})})]})},Hc=(0,g.Ay)("div")`
  background-color: var(--bfs-primary-true-white);
  padding: 16px;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  border-radius: 8px;
  min-height: 112px;
  box-sizing: border-box;
  align-items: center;
`,vD=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  max-width: 600px;
`,Qc=(0,g.Ay)("h1")`
  margin: 0;
  font-size: 24px;
  font-weight: 600;
`,Gc=(0,g.Ay)("div")`
  font-size: 12px;
`,Kc=(0,g.Ay)("div")`
  display: flex;
`,Yc=(0,g.Ay)("div")`
  width: 100%;
  background-color: var(--bfs-primary-true-white);
  border-radius: 8px;
  min-width: 400px;
`,Cg=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  max-width: 640px;
`,jD=(0,g.Ay)("div")`
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-width: 200px;
`,AD=(0,g.Ay)("div")`
  background-color: transparent;
  border: 1px solid rgba(0, 0, 0, 0.23);
  flex-grow: 1;
  display: flex;
  border-radius: 4px;
  color: #716f6f;
  padding: 10px 12px;
`,CD=(0,g.Ay)("span")({display:"flex"}),SD=(0,g.Ay)("h1")`
  margin: 0;
  font-size: 16px;
  font-weight: 600;
`,wD=(0,g.Ay)("div")`
  font-size: 11px;
`,ED=(0,g.Ay)("div")`
  max-width: 50%;
  padding-right: 40px;
`,qr=({title:t,body:n,renderAction:s})=>(0,e.jsxs)(Hc,{children:[(0,e.jsxs)(vD,{children:[(0,e.jsx)(Qc,{children:t}),(0,e.jsx)(Gc,{children:n})]}),s&&(0,e.jsx)(Kc,{children:s()})]});var Il=m(21951),Xr={};Xr.styleTagTransform=zs(),Xr.setAttributes=Us(),Xr.insert=_s().bind(null,"head"),Xr.domAPI=Ns(),Xr.insertStyleElement=Ws();var t8=Bs()(Il.A,Xr);const n8=Il.A&&Il.A.locals?Il.A.locals:void 0;var PD=m(67034);const ID=({setVisibleCustomMenu:t,customMenuTopDist:n,customMenuLeftDist:s,currentTaskInfo:o,setMessage:r,ganttRef:a,handleDeleteTodoTaskFromParent:i})=>{const[l,c]=(0,d.useState)(!1),{project:u}=(0,De.B)(),{deleteTask:p}=(0,Xs.P)(u?.id),f=v=>{v.target.classList?.contains("custom_taskMenu")&&t(!1)},h=["Are you sure you want to delete these Task?","Do you wish to continue?"],b=async()=>{c(!1),a.current?.instance.taskStore.remove([o?._data?.id]),t(!1)},x=()=>{a.current.instance.editTask(o)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Uo,{title:`${o?.originalData?.taskType==="TODO"?"This To-Do task will be deleted":"This task will be deleted"}`,message:h,open:l,onClose:()=>c(!1),onConfirm:b,loading:!1,closeButtonText:"Go Back",submitButtonText:"Delete"}),(0,e.jsx)("div",{className:"custom_taskMenu",onClick:v=>f(v),children:(0,e.jsxs)("ul",{className:"list_wrap",style:{top:`${n.toString()}px`,left:`${s.toString()}px`},children:[(0,e.jsxs)("li",{className:"menu_list",onClick:x,children:[(0,e.jsx)(K0.A,{})," Edit"]}),(0,e.jsxs)("li",{className:"menu_list",onClick:()=>c(!0),children:[(0,e.jsx)(PD.A,{})," Delete"]})]})})]})};var Dl=m(61965),Jr={};Jr.styleTagTransform=zs(),Jr.setAttributes=Us(),Jr.insert=_s().bind(null,"head"),Jr.domAPI=Ns(),Jr.insertStyleElement=Ws();var o8=Bs()(Dl.A,Jr);const r8=Dl.A&&Dl.A.locals?Dl.A.locals:void 0;function DD({isDataChanged:t,setIsDataChanged:n,templateId:s,ganttRef:o,setMessage:r,setEditingTemplate:a}){const[i,l]=(0,d.useState)({startDate:Tt.hS,endDate:He()(Tt.hS).add(Tt.zi.viewEndDay,"days").toDate(),tasks:[],dependencies:[],dependencyStoreClass:n0}),{getSchedulerTemplateTask:c}=(0,Xs.P)(),[u,p]=(0,d.useState)(),[f,h]=(0,d.useState)(!1),[b,x]=(0,d.useState)(0),[v,y]=(0,d.useState)(0),[j,A]=(0,d.useState)(!1),[w,P]=(0,d.useState)(He()(Tt.hS).subtract(Tt.zi.viewStartDay,"days").toDate()),C={zoomOnTimeAxisDoubleClick:!1,zoomLevel:3,scrollable:!0,zoomOnMouseWheel:!0,viewPreset:Tt.K0,presets:[Tt.K0,Tt.Mg,Tt.YY],dependencyIdField:"id",columns:(0,Tt.s2)(x,y,h,p),fixedRowHeight:!1,barMargin:10,durationDisplayPrecision:1,enableDeleteKey:!1,syncMask:null},k=async()=>{A(!0);const V=await c(s),$=[];if(V.data){V.data.tasks.forEach(Y=>{$.push({id:Y.id,name:Y.Task_Description,buildDay:Number(Y.Build_Day),startDate:(0,Tt.Vb)(Number(Y.Build_Day)),duration:Y.Duration,constraintType:"startnoearlierthan",constructionPhase:Y.Construction_Phase,sequence:Y.Task_Sequence,isParent:!Y.Task_Description,parentId:Y.Construction_Phase,predecessorSequence:Y.Predecessor_Sequence,successorSequence:Y.Successor_Sequence})});const ee=V.data.dependencies,X=(0,Tt.Hw)($);let G=(0,Tt.Js)($);l({startDate:Tt.hS,endDate:He()(G).add(Tt.zi.viewEndDay,"days").toDate(),tasks:X,dependencies:ee,dependencyStoreClass:n0}),A(!1)}else V.status==400||(a(void 0),r("Error",V.error,"error")),A(!1)};(0,d.useEffect)(()=>{n(!1),k()},[]);const S=()=>{let V=o?.current?.instance?.tasks?.filter(ee=>ee._data.isParent),$=V.length>0?V[V.length-1]:void 0;(0,Tt.uv)($,"phase",o)},R={paint({firstPaint:V,source:$}){V&&il.fsz.on({element:$.element,delegate:"button.addnewPhase",capture:!0,click:ee=>{ee.stopPropagation(),S()}})},beforeDependencyCreateFinalize:({source:V,target:$,valid:ee})=>{(V._data.isParent||$._data.isParent)&&(ee=!1)},beforeShowTerminals:({source:V})=>{if(V._data.isParent)return!1}},B=V=>{if(V.editorContext._columnIndex==Tt.iA.buildDay){const $=V.editorContext.value;o.current?.instance.taskStore.getById(V.editorContext._id).set({startDate:(0,Tt.Vb)($),buildDay:$})}},T=V=>{if(V.editorContext.record?._data.isParent&&(V.editorContext._columnIndex==Tt.iA.buildDay||V.editorContext._columnIndex==Tt.iA.duration))return!1;V.editorContext._columnIndex==Tt.iA.buildDay&&(V.editorContext.value=(0,Tt.ZM)(V.editorContext.value))},W=V=>{o.current?.instance.taskStore.getById(V.taskRecord?._data.id)?.set({startDate:(0,Tt.Vb)(V.taskRecord._data.buildDay),parentId:V.taskRecord?._data.parentId})},N=V=>{V.editor?.widgetMap.predecessorsTab.taskCombo.store.filter(Y=>!Y._data.isParent),V.editor?.widgetMap.successorsTab.taskCombo.store.filter(Y=>!Y._data.isParent);const $=o.current?.instance.tasks.filter(Y=>Y._data.isParent);h(!1);const ee=V.editor?.widgetMap,X=V?.taskRecord?._data,G=$.map(Y=>({value:Y._data.id,text:Y._data.name}));ee.phase.items=G,ee.phase.value=G.find(Y=>Y.value==X?.parentId),X?.startDate&&(ee.buildDay.value=(0,Tt.ZM)(X.startDate))},O=V=>{if(V.taskRecord?._data.isParent)return!1},z=V=>{const $=V.context?.startRecord._data,ee=V.context?.parent._data;if(!$?.isParent&&!ee?.isParent||$?.isParent&&ee?.isParent)return!1},Q=V=>{o.current?.instance.taskStore.getById(V.context?.record._data.id).set({buildDay:(0,Tt.ZM)(V.context?.record._data.startDate)})},re=()=>{o.current?.instance.taskStore.remove(u?._data?.id),r("Success","Task deleted successfully","success"),h(!1)},ue={tooltip:{getHtml(V){return(0,Tt.FO)(o,V)}}},le=({taskRecord:V})=>{if(V._data.isParent)return!1},F=V=>{const $=(0,Tt.Js)(o.current.instance.tasks);o.current.instance.endDate=He()($).add(Tt.zi.viewEndDay,"days").toDate(),V.store._id=="dependencies"&&V.action=="update"&&V.records.forEach(ee=>{let X=new Date;const G=ee._data.lag,Y=o.current?.instance.taskStore.getById(ee._data.to??ee._data.toEvent?._data.id),he=o.current?.instance.taskStore.getById(ee._data.from??ee._data.fromEvent?._data.id)?._data;if(he){switch(ee._data.type){case Tt.QN.StartToStart:X=He()(he.startDate).add(G,"days").toDate();break;case Tt.QN.StartToEnd:X=He()(he.startDate).add(G-1,"days").toDate();break;case Tt.QN.EndToStart:X=He()(he.endDate).add(G,"days").toDate();break;case Tt.QN.EndToEnd:X=He()(he.endDate).add(G-1,"days").toDate();break;default:break}Y&&Y.set({constraintDate:X,buildDay:(0,Tt.ZM)(X)})}}),t||n(!0)};return(0,e.jsxs)(e.Fragment,{children:[f&&(0,e.jsx)(ID,{setVisibleCustomMenu:h,customMenuTopDist:b,customMenuLeftDist:v,currentTaskInfo:u,setMessage:r,ganttRef:o,handleDeleteTodoTaskFromParent:re}),j?(0,e.jsx)(rr.A,{open:j,invisible:!0,sx:{zIndex:V=>V.zIndex.drawer+1},children:(0,e.jsx)(bt.A,{})}):(0,e.jsx)(sc._Z,{onBeforeTaskDrag:O,onBeforeTaskEditShow:N,onBeforeTaskEdit:O,onAfterTaskEdit:W,onBeforeCellEditStart:T,cellEditFeature:Tt.Qk,onFinishCellEdit:B,ref:o,headerMenuFeature:!1,timeAxisHeaderMenuFeature:!1,...C,timeRangesFeature:Tt.g3,project:i,columnReorderFeature:!1,taskMenuFeature:Tt.Ho,taskEditFeature:Tt.B7,onGridRowBeforeDropFinalize:z,taskResizeFeature:Tt.JB,taskDragFeature:Tt.JB,sortFeature:!1,onAfterTaskDrop:Q,visibleDate:w,rowCopyPasteFeature:!1,taskCopyPasteFeature:!1,onDataChange:F,dependenciesFeature:ue,taskTooltipFeature:Tt.lX,labelsFeature:Tt.cl,listeners:R,onBeforeTaskResize:le,dependencyEditFeature:Tt.ID,zoomKeepsOriginalTimespan:!0})]})}const kD=({editedTemplateName:t,isDataChanged:n,setEditedTemplateName:s,setEditingTemplate:o,editingTemplate:r,handleUpdateTemplate:a})=>{const i=l=>{const c=l.target.value;s(c)};return(0,e.jsxs)("div",{className:"template-action-area",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(yc,{children:"Template Name"}),(0,e.jsx)(_.A,{className:"edit-template-name-field",label:"Enter a name for this template",size:"small",onChange:i,"data-testid":"edit-template-name-field",variant:"outlined",defaultValue:r?.templateName,inputProps:{maxLength:100}})]}),(0,e.jsxs)("div",{className:"template-buttons-area",children:[(0,e.jsx)(Ka,{onClick:()=>{o(void 0)},"data-testid":"cancel-edit-button",children:"Cancel"}),(0,e.jsx)(xc,{"data-testid":"update-template-button",onClick:a,disabled:!t?.trim()||!n,children:"Update Template"})]})]})},TD=Lr()(()=>m.e(459).then(m.bind(m,19459)),{ssr:!1}),RD=()=>{const{project:t}=(0,De.B)(),n=(0,d.useRef)(),s=(0,d.useRef)(),[o,r]=(0,d.useState)([]),[a,i]=(0,d.useState)(!1),[l,c]=(0,d.useState)(!1),[u,p]=(0,d.useState)(void 0),[f,h]=(0,d.useState)(void 0),{userHasPermission:b}=(0,Ye.A)(),{company:x}=(0,je.P)(),[v,y]=(0,d.useState)([]),[j,A]=(0,d.useState)(),{loading:w,fetchScheduleTemplatesForProfile:P,deleteTemplate:C,getSchedulerTemplateTask:k,updateScheduledTemplate:S}=(0,Xs.P)(),[R,B]=(0,d.useState)(!1),[T,W]=(0,d.useState)(null),[N,O]=(0,d.useState)(!1);function z(Y,he,ne){r([...o,{title:Y,message:he,severity:ne,key:new Date().getTime()}]),i(!0)}const Q=async()=>{const Y=await P(x?.id);if(Y.data){const he=Y.data.map(ne=>({id:ne.id,templateName:ne.name,buildDays:ne.total_build_days,dateCreated:ne.created_at}));y(he)}else y([])},re=async()=>{B(!1);const Y=await C(T);Y.data?(z("Success",Y.data.data,"success"),Q()):z("Error","Something went wrong.","error")};(0,d.useEffect)(()=>{o.length&&!f?(h({...o[0]}),r(Y=>Y.slice(1)),i(!0)):o.length&&f&&a&&setTimeout(()=>{i(!1)},4e3)},[o,a,f]),(0,d.useEffect)(()=>{Q()},[]),(0,d.useEffect)(()=>{u&&A(u.templateName)},[u]);const ue=async Y=>{const he=await k(Y.id);he.data?(0,Tt.NU)(he.data.tasks,Y.templateName):z("Error",he.error?he.error:"Something went wrong.","error")},le={dependencyIdField:"id",columns:(0,Tt.DV)(W,B,ue,p),barMargin:10,enableDeleteKey:!1,taskEditFeature:!1,cellEditFeature:!1},F=()=>{O(!0)},V=()=>{O(!1)},$=()=>(0,e.jsxs)(xc,{"data-testid":"create-template-button",onClick:F,children:["Create New Template"," "]}),ee=b({tool:D.w5.SCHEDULE,action:D.a2.CREATE_SCHEDULE_TEMPLATES,companyId:x?.id,projectId:t?.id}),X={paint({firstPaint:Y,source:he}){Y&&il.fsz.on({element:he.element,delegate:"i.downloadTemplate",capture:!0,click:ne=>{ne.stopPropagation();const J=he.getRecordFromElement(ne.target);J&&ue(J)}})}},G=async()=>{const he={...j?.trim()!==u?.templateName?{template_name:j?.trim()}:{},...l?{template_data:(0,Tt.BR)(s)}:{}},ne=await S(he,u?.id,x.id);ne.data?(z("Success",ne.data.message,"success"),p(void 0),Q()):z("Error",ne.error,"error")};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Uo,{"data-testid":"template-delete-modal",title:"Delete Template",message:["You have chosen to delete this template.","Would you like to proceed?"],open:R,onClose:()=>{B(!1),W(null)},onConfirm:async()=>{re()},loading:!1,closeButtonText:"Cancel",submitButtonText:"Delete"}),(0,e.jsx)(kr.A,{"data-testid":"error",open:a,autoHideDuration:2e3,TransitionProps:{onExited:()=>{h(void 0)}},onClose:()=>{i(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},message:f?f.message:void 0,children:(0,e.jsxs)(Rs.A,{severity:f?.severity,children:[(0,e.jsx)(Tr.A,{children:f?.title})," ",f?.message]})},f?f.key:void 0),(0,e.jsx)(qr,{"data-testid":"schedule-template-header",title:"Schedule Template Manager",body:"Below you can create, edit and remove Schedule Templates to be used with your Projects.",renderAction:()=>{if(!u&&!N&&ee)return $();if(u)return(0,e.jsx)(kD,{editedTemplateName:j,isDataChanged:j?.trim()!==u?.templateName||l,setEditedTemplateName:A,setEditingTemplate:p,editingTemplate:u,handleUpdateTemplate:G})}}),(0,e.jsxs)("div",{className:"schedule-template-outer",children:[!w&&!N&&!u&&(0,e.jsx)("div",{className:"schedule-templates-grid",children:(0,e.jsx)(TD,{gridConfig:le,gridRef:n,listTemplates:v,listeners:X})}),N&&(0,e.jsx)("div",{className:"schedule-templates-create",children:(0,e.jsx)(bD,{cancelCreation:V,refreshData:Q,setMessage:z})}),u&&(0,e.jsx)("div",{className:"schedule-templates-gantt","data-testid":"schedule-templates-gantt",children:(0,e.jsx)(DD,{isDataChanged:l,setIsDataChanged:c,templateId:u.id,ganttRef:s,setMessage:z,setEditingTemplate:p})}),(0,e.jsx)(rr.A,{open:w,invisible:!0,sx:{zIndex:Y=>Y.zIndex.drawer+1},children:(0,e.jsx)(bt.A,{})})]})]})},OD=({onReset:t})=>{const[n,s]=(0,d.useState)(!1);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Uo,{"data-testid":"reset-confirmation-modal",title:"Reset Cost Codes",message:["This will erase all existing cost codes, and will replace with NAHB Generic Cost Codes.","Any Invoice with a selected Cost Code and all QuickBooks mappings will also be removed. ","Do you wish to proceed?"],open:n,onClose:()=>{s(!1)},onConfirm:async()=>{t(),s(!1)},loading:!1,closeButtonText:"Cancel",submitButtonText:"Reset Codes"}),(0,e.jsx)(Ka,{"data-testid":"reset-costcodes-button",onClick:()=>{s(!0)},disabled:!1,children:"Reset Cost Codes"})]})},MD=({label:t,description:n,handleFileUpload:s,onCloseClick:o,selectedFile:r,setSelectedFile:a})=>{const i=(0,d.useRef)(null);return(0,e.jsx)("div",{style:{padding:"16px"},children:(0,e.jsxs)(jD,{children:[(0,e.jsxs)(ED,{children:[(0,e.jsx)(SD,{"data-testid":"upload-title",children:t}),(0,e.jsx)(wD,{"data-testid":"upload-subTitle",children:n})]}),(0,e.jsxs)(CD,{children:[(0,e.jsxs)(AD,{children:[(0,e.jsxs)("label",{style:{flexGrow:1,minWidth:"200px"},onClick:()=>{i?.current?.click()},children:[" ",r?r.name:"Select file"]}),r&&(0,e.jsx)(Ss.A,{onClick:()=>{i.current&&(i.current.value=""),a(null),o?.()},sx:a0})]}),(0,e.jsx)("input",{hidden:!0,ref:i,"data-testid":"input-file-field",type:"file",accept:".xlsx, .xls, .csv",onChange:s}),(0,e.jsx)(Ka,{onClick:()=>i?.current?.click(),children:"Select File"})]})]})})},LD=({isDataFetchedFromFile:t,setCostCodesList:n,fetchCostCodes:s,setLoading:o,setIsDataFetchedFromFile:r})=>{const{showError:a}=(0,Fe.d)(),[i,l]=(0,d.useState)(null);(0,d.useEffect)(()=>{t||l(null)},[t]);const c=u=>{if(u?.target?.files){const p=u?.target?.files[0],f=new FileReader;f.onloadstart=h=>{o(!0)},f.onload=h=>{if(h.target?.result){const b=new Uint8Array(h.target.result),x=wl.LF(b,{type:"array"}),v=x.Sheets[x.SheetNames[0]],y=wl.Wp.sheet_to_json(v,{header:1,blankrows:!1});if(Zw(y,a)){l(p),r(!0);const A=y[0],w=y.slice(1).map(C=>{let k={};return C.forEach((S,R)=>{k[A[R]]=S}),k}),P=c0(w);n(P),o(!1)}else o(!1);u.target.value=""}},f.onloadend=h=>{o(!1)},f.readAsArrayBuffer(p)}};return(0,e.jsx)(MD,{selectedFile:i,setSelectedFile:l,label:"",description:"",onCloseClick:()=>{r(!1),n([]),s()},handleFileUpload:c})};var FD=m(67110);const BD=({api:t,row:n,processRowUpdate:s})=>{const{showError:o}=(0,Fe.d)(),r=(0,d.useRef)(null),[a,i]=(0,d.useState)(!1),[l,c]=(0,d.useState)(!1),u=n.parentPath.length===2,p=()=>{const h={...n,_action:"delete"},b=[],x=pl(t);for(const v of x)if(v.parentPath.includes(h.codeDescription)&&v.codeDescription!==h.codeDescription){const y={...v,parentPath:v.parentPath.filter(j=>j!==h.codeDescription)};b.push(y)}t.updateRows([...b,h]);for(const v of b)s(v);s(h)},f=()=>{const h=pl(t);if(h.some(y=>y.codeDescription==="")){o({message:"You already have an empty code in the grid. Please fill in the code for that row before adding another."}),i(!1);return}const b=u?n.parentPath.slice(0,1):n.parentPath,x={codeDescription:"",isActive:!0,sortOrder:n.sortOrder+1,parent:u?n.parent:n.id,parentPath:[...b,""],childrenCount:0,id:Ac()},v=h.filter(y=>y.sortOrder>=x.sortOrder).map(y=>({...y,sortOrder:y.sortOrder+1}));t.updateRows([x,...v]),s(x);for(const y of v)s(y);i(!1)};return(0,e.jsxs)("div",{ref:r,style:{width:"40px"},children:[(0,e.jsx)(pt.A,{onClick:()=>i(!0),children:(0,e.jsx)(Mo.A,{})}),(0,e.jsxs)(Hn.A,{anchorEl:r.current,open:a,onClose:()=>i(!1),children:[(0,e.jsxs)(it.A,{onClick:()=>c(!0),children:[(0,e.jsx)(Un.A,{children:(0,e.jsx)(FD.A,{})}),"Delete Cost Code"]}),(0,e.jsxs)(it.A,{onClick:f,children:[(0,e.jsx)(Un.A,{children:(0,e.jsx)(pr.A,{})}),"Add Cost Code"]})]}),(0,e.jsx)(Qn,{open:l,title:"Delete Cost Code",submitText:"Delete Cost Code",cancelText:"Cancel",onSubmit:p,onClose:()=>c(!1),children:(0,e.jsx)(I.A,{children:"You have chosen to delete this cost code. Any invoice that references this Cost Code will have the code removed. Would you like to proceed?"})})]})};var Sg=m(10885);const ND=({row:t,dropdownOptions:n,processRowUpdate:s})=>{const[o,r]=(0,d.useState)(null),[a,i]=(0,d.useState)(!1),l=(0,ds.h)();(0,d.useEffect)(()=>{t.qbItemId&&r(n.find(h=>h.value===t.qbItemId))},[n,t.qbItemId]);const c=()=>{i(!0)},u=(h,b)=>{r(b),p(b)},p=h=>{const b={...t,qbItemId:h?h.value:null,qbItemName:h?h.label:null};l.current?.updateRows([b]),s(b),i(!1)},f=h=>{i(!1)};return(0,e.jsx)("div",{onDoubleClick:c,style:{width:"100%",height:"100%"},children:a?(0,e.jsx)(Gn.A,{value:o,onChange:u,options:n,getOptionLabel:h=>h.label,autoHighlight:!0,fullWidth:!0,open:a,onBlur:f,getOptionDisabled:h=>h.type==="Category",renderInput:h=>(0,e.jsx)(Ei.Ay,{autoFocus:!0,fullWidth:!0,inputProps:{...h.inputProps},...h.InputProps})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(qw,{style:{color:o?"black":"gray"},children:[o?.label||"Select Equivalent from QuickBooks",(0,e.jsx)(Sg.A,{})]})})})},kl={codeDescription:500,qbCode:250,isActive:200,actions:60},_D=({processRowUpdate:t,qbCodesList:n})=>[{field:"qbCode",flex:1,width:kl.qbCode,headerName:"QuickBooks Products/Service",editable:!1,sortable:!1,renderCell:s=>(0,e.jsx)(ND,{...s,processRowUpdate:t,dropdownOptions:n})},{field:"isActive",headerName:"Is Active in myBLDR.com",type:"boolean",width:kl.isActive,editable:!0,sortable:!1},{field:"actions",headerName:"",width:kl.actions,sortable:!1,editable:!1,renderCell:s=>(0,e.jsx)(BD,{...s,processRowUpdate:t})},{field:"sortOrder",headerName:"",sortable:!0,hideable:!1}],qc=({shouldBlockNavigation:t,message:n,handleSaveChanges:s,handleProceed:o,component:r})=>{const a=(0,d.useCallback)(({currentLocation:h,nextLocation:b})=>t&&h.pathname!==b.pathname,[t]),i=(0,L.useBlocker)(a),l=i.state==="blocked",c=i.state==="proceeding",u=(0,d.useCallback)(h=>(h.preventDefault(),n),[n]);(0,d.useEffect)(()=>(l&&!t?(window.removeEventListener("beforeunload",u),i.reset?.()):t&&window.addEventListener("beforeunload",u),()=>{window.removeEventListener("beforeunload",u)}),[i,l,t,u]);const p=async()=>{await s()},f=()=>i.proceed?.();return r?r({open:l||c,onProceed:()=>{o(),f()},onReset:()=>i.reset?.(),onSubmit:p}):(0,e.jsx)(Qn,{title:"Unsaved Changes",open:l||c,onClose:f,onSubmit:p,cancelText:"Don't Save",submitText:"Save Changes",children:(0,e.jsx)(I.A,{children:n})})};var UD=m(71147);const WD=({row:t,rowNode:n,api:s,processRowUpdate:o,setRowIdsWithErrors:r})=>{const a=(0,Dt.A)(),[i,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(t.codeDescription),[p,f]=(0,d.useState)(!1),h=(0,ds.h)(),b=()=>{f(!0)},x=A=>{u(A.target.value)},v=A=>{A.preventDefault(),A.stopPropagation(),n.type==="group"&&h.current?.setRowChildrenExpansion(n.id,!n.childrenExpanded)},y=()=>{const A=String(t.id),w=pl(s);if(w.find(R=>R.id!==t.id&&R.codeDescription===c)){l(!0),r(R=>R.includes(A)?R:[...R,A]);return}l(!1),r(R=>[...R.filter(B=>B!==A)]);const C=t.parentPath.map(R=>R===t.codeDescription?c:R),k={...t,codeDescription:c,parentPath:C},S=[];for(const R of w){const B=R.parentPath.indexOf(t.codeDescription);if(B!==-1&&R.codeDescription!==t.codeDescription){const T=[...R.parentPath];T[B]=c;const W={...R,parentPath:T};S.push(W)}}h.current?.updateRows([k,...S]),o(k),f(!1)},j=A=>{if(A.key==="Enter"){y();return}else if(A.key==="Escape"){u(t.codeDescription),f(!1);return}else A.stopPropagation()};return(0,e.jsx)(E.A,{style:{marginLeft:p?void 0:(t.parentPath?.length-1)*10},onDoubleClick:b,children:p?(0,e.jsxs)(E.A,{sx:{display:"flex",justifyContent:"flex-start",alignItems:"center",height:"50px",gap:a.spacing(1)},children:[i&&(0,e.jsx)(qt.A,{title:"Please ensure that all cost codes are unique.",placement:"top",children:(0,e.jsx)(UD.A,{sx:{color:"red"}})}),(0,e.jsx)(_.A,{onChange:x,value:c,variant:"standard",InputProps:{disableUnderline:!0,sx:{fontSize:"14px"}},onKeyDown:j,autoFocus:!0,onBlur:y,fullWidth:!0})]}):(0,e.jsxs)("div",{children:[(0,e.jsx)(pt.A,{sx:{visibility:n.type==="group"?"visible":"hidden"},onClick:v,children:n.type==="group"&&n.childrenExpanded?(0,e.jsx)(Na.A,{}):(0,e.jsx)(Fo.A,{})}),c]})})},zD=({gridApiRef:t,costCodeTree:n,qbCodesList:s,isConnectedToQB:o,isSaveButtonEnabled:r,setDeletedRowIds:a,setChangedRowIds:i,setCreatedRowIds:l,setRowIdsWithErrors:c,onSave:u})=>{const{showError:p}=(0,Fe.d)(),f=(0,d.useMemo)(()=>wo(n,{processCostCodePathEntry:({codeDescription:y})=>y}),[n]),h=(0,d.useCallback)(y=>{const j=String(y.id);if(y._action==="delete")return a(P=>[...P,j]),y;const A=f.find(P=>P.id===y.id);if(!A)return l(P=>[...P,j]),y;const w=y.isActive!==A.isActive||y.codeDescription!==A.codeDescription||y.parentPath!==A.parentPath||y.sortOrder!==A.sortOrder||o&&y.qbItemId!==A.qbItemId;return i(w?P=>P.includes(j)?P:[...P,j]:P=>[...P.filter(C=>C!==j)]),y},[f,o,i,l,a]),b=(0,d.useMemo)(()=>({headerName:"myBLDR Cost Codes",flex:1,width:kl.codeDescription,renderCell:y=>(0,e.jsx)(WD,{...y,processRowUpdate:h,setRowIdsWithErrors:c})}),[h,c]),x=(0,d.useMemo)(()=>_D({processRowUpdate:h,qbCodesList:s}),[h,s]),v=(0,d.useCallback)(y=>y.parentPath,[]);return n.length===0?null:(0,e.jsxs)(E.A,{sx:{padding:"0 16px 10px 16px"},"data-testid":"cost-code-edit-grid",children:[(0,e.jsx)(qc,{shouldBlockNavigation:r,message:"You have made edits to your Cost Codes.  Would you like to save the changes before leaving this page?",handleSaveChanges:u}),(0,e.jsx)(kc._,{apiRef:t,initialState:{columns:{columnVisibilityModel:{sortOrder:!1}},sorting:{sortModel:[{field:"sortOrder",sort:"asc"}]}},treeData:!0,getTreeDataPath:v,rows:f,groupingColDef:b,columns:x,hideFooter:!0,disableColumnMenu:!0,disableColumnFilter:!0,disableColumnSelector:!0,processRowUpdate:h,columnVisibilityModel:{qbCode:o,sortOrder:!1},onProcessRowUpdateError:y=>{console.error("Error occurred while updating the cost code grid data",y),p({message:"Cost code changes did not properly save. Please try again."})},defaultGroupingExpansionDepth:-1,autoHeight:!0})]})},wg=({isSaveButtonEnable:t,onClickSaveButton:n})=>(0,e.jsx)(xc,{"data-testid":"save-costcodes-button",onClick:n,disabled:!t,children:"Save Changes"}),VD=()=>{const{company:t}=(0,je.P)(),n=(0,Kn.b)(),[s]=zh(),{showError:o,showSuccess:r}=(0,Fe.d)(),{loading:a,fetchCostCodes:i,isDataFetchedFromFile:l,costCodesList:c,setCostCodesList:u,setLoading:p,setIsDataFetchedFromFile:f,forceCostCodesToBeFetchedFromFile:h,fetchQBCodes:b,qbCodesList:x}=gg(t?.id),[v,y]=(0,d.useState)([]),[j,A]=(0,d.useState)([]),[w,P]=(0,d.useState)([]),[C,k]=(0,d.useState)([]),[S,R]=(0,d.useState)(!1),[B,T]=(0,d.useState)(!1),{isConnected:W,fetchQuickbooksConnectionLink:N}=hc(t?.id),O=async()=>{if(!t?.id){console.error("Cannot save changes without a company id");return}T(!0);const F=l?void 0:[...v,...w],V=Jw(n.current,F),$={companyId:t.id,shouldResetCostCodes:S||l,costCodeList:V,costCodeIdsToDelete:j.filter(ee=>!isNaN(Number(ee))).map(ee=>Number(ee))};try{if("error"in await s($)){o({message:"An error occurred when trying to save changes."});return}await i(),r({message:"Successfully saved cost code changes."}),P([]),A([]),y([]),R(!1),f(!1)}finally{T(!1)}},z=async()=>{await h(),R(!0)},Q=(0,d.useCallback)(async()=>{await N(),await i(),W&&b()},[i,b,N,W]);(0,d.useEffect)(()=>{Q()},[Q]);const re=C.length===0,ue=w.length>0||v.length>0||j.length>0||S||l,le=re&&ue&&!B;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qr,{"data-testid":"costcodes-template-header",title:"Cost Code Manager",body:"Manage your own cost codes here. These cost codes are used within the Budget tab to help you manage your project spend. If you have QuickBooks setup, then you will also be able to map your cost codes to the equivalent QuickBooks Product/Service."}),(0,e.jsxs)(Yc,{children:[(0,e.jsxs)(Hc,{children:[(0,e.jsxs)(Cg,{children:[(0,e.jsx)(Qc,{"data-testid":"sub-header-title",children:"Upload your own Cost Codes"}),(0,e.jsxs)(Gc,{"data-testid":"sub-header-body",children:["Your account is already setup with the NAHB Cost Codes. If you have your own cost codes you use for your business, then you can upload your own by modifying the default NAHB template. You can"," ",Xw,", edit, and upload below. Additionally, you can manually add Cost Codes by clicking the three dots next to each Cost Code."]})]}),(0,e.jsxs)(Kc,{children:[(0,e.jsx)(OD,{onReset:z}),(0,e.jsx)(wg,{isSaveButtonEnable:le,onClickSaveButton:O})]})]}),(0,e.jsx)(Ce.A,{style:{margin:"0 16px"}}),(0,e.jsx)(LD,{isDataFetchedFromFile:l,setCostCodesList:u,fetchCostCodes:i,setLoading:p,setIsDataFetchedFromFile:f}),(0,e.jsxs)("div",{children:[(0,e.jsx)(zD,{gridApiRef:n,qbCodesList:x,costCodeTree:c,isSaveButtonEnabled:le,isConnectedToQB:W,setDeletedRowIds:A,setChangedRowIds:y,setCreatedRowIds:P,setRowIdsWithErrors:k,onSave:O}),(0,e.jsx)(rr.A,{open:a||B,invisible:!0,sx:{zIndex:F=>F.zIndex.drawer+1},children:(0,e.jsx)(bt.A,{sx:l0})})]})]})]})};var $D=m(1935);const HD=(0,g.Ay)("button")`
  flex-grow: 0;
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
  align-items: center;
  gap: 10px;
  padding: 12px 16px;
  margin-left: 20px;
  border: none;
  border-radius: 4px;
  color: white;
  opacity: ${t=>t.disabled?.3:1};
  cursor: ${t=>t.disabled?"not-allowed":"pointer"};
  font-size: 15px;
  font-weight: 600;
  font-stretch: normal;
  font-style: normal;
`,Xc=(0,g.Ay)("div")`
  padding-right: 10px;
`,Jc=(0,g.Ay)("h1")`
  margin: 0;
  font-size: 16px;
  font-weight: 600;
`,Zc=(0,g.Ay)("div")`
  font-size: 11px;
`,Eg=(0,g.Ay)("p")`
  font-size: 13px;
  padding: 0;
  margin: 0;
  font-weight: 600;
  color: #000000;
`,eu=(0,g.Ay)("div")`
  max-width: 700px;
  padding: 16px 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-width: 200px;
`,QD=(0,g.Ay)("span")`
  font-size: 13px;
  padding: 0 24px;
  margin: 0;
  cursor: pointer;
  color: #368eff;
`,Pg=(0,g.Ay)("div")`
  max-width: 700px;
  padding: 5px 24px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  min-width: 200px;
`,a8=(0,g.Ay)("div")`
  width: 45%;
  padding: 10px 10px;
  border: 1px solid #9e9e9e;
  border-radius: 4px;
`,GD="Connect your QuickBooks Account",KD="Your myBLDR.com Account is Connected to QuickBooks!",YD="To begin, click the 'Connect to QuickBooks' button to start the process of connecting your myBLDR and Quickbooks accounts",qD="Map your Account, Vendors, and Projects below, which are required to send invoices to your QuickBooks account. No longer want myBLDR to be connected to your QuickBooks account? You can disconnect your account to the right. You can always reconnect when the time is right.",XD=["Your QuickBooks account will NOT be affected, but you will no longer be able to send myBLDR invoices over to your QuickBooks account. No data will be stored, and you can always reconnect in future."],JD=({isConnected:t,isButtonDisabled:n,connectionClickHandler:s})=>{const[o,r]=(0,d.useState)(!1);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Uo,{titleBackgroundColor:"red",loading:!1,onClose:()=>{r(!1)},open:o,onConfirm:()=>{s(),r(!1)},closeButtonText:"Cancel",submitButtonText:"Disconnect Account",title:"Disconnect Account From QuickBooks?",subTitle:"This action cannot be undone.",message:XD,modalWidth:"520px"}),(0,e.jsxs)(Hc,{children:[(0,e.jsxs)(Cg,{children:[(0,e.jsx)(Qc,{"data-testid":"quickbooks-sub-header-title",children:t?KD:GD}),(0,e.jsx)(Gc,{"data-testid":"quickbooks-sub-header-body",children:t?qD:YD})]}),(0,e.jsx)(Kc,{children:(0,e.jsx)(HD,{sx:{backgroundColor:t?"red":"#7acc11"},onClick:()=>{t?r(!0):s()},disabled:n,children:t?"Disconnect From QuickBooks":"Connect To QuickBooks"})})]}),t&&(0,e.jsx)(Ce.A,{style:{margin:"0px 16px 12px 16px"}})]})},Tl=({dropDownItems:t,placeholder:n,selectedValue:s,onSelect:o,onClear:r,showErrors:a,errorText:i,onInputChange:l,isFetchingResults:c})=>{const[u,p]=(0,d.useState)(!1),f=s&&s.value&&t&&t.length>0?t.filter(v=>v.value===s.value)[0]:null,h=(v,y)=>{y&&o(t.filter(j=>j.label===y.label)[0])},b=(v,y)=>{u&&l?.(y)},x=(0,e.jsx)("span",{children:(0,e.jsx)(pt.A,{onClick:()=>{l?.(""),r(s)},children:(0,e.jsx)(co.A,{fontSize:"small"})})});return(0,e.jsx)(Gn.A,{options:t,value:f||null,getOptionLabel:v=>v.label,onChange:h,style:{width:"48%"},clearIcon:x,onInputChange:b,onFocus:()=>p(!0),onBlur:()=>{p(!1),l?.("")},renderInput:v=>(0,e.jsx)(_.A,{...v,placeholder:n,InputProps:{...v.InputProps,style:{padding:"2px"},endAdornment:u&&c&&!f?(0,e.jsx)(bt.A,{size:16,sx:{marginRight:"4px"}}):v.InputProps.endAdornment},error:a,helperText:a?i:""})})};var ZD=m(27008);const ek=(t,n)=>t&&n.mybldrItemId&&n.mybldrItemName&&!t.find(s=>s.value===n.mybldrItemId)?[{value:n.mybldrItemId,label:n.mybldrItemName},...t]:t,Ig=({title:t,subtitle:n,dropDownMybldrTitle:s,dropDownQBTitle:o,type:r,mappingList:a,mybldrList:i,qbList:l,onAddOtherItem:c,onItemSelect:u,onClear:p,showErrors:f,onBldrInputChange:h,isLoadingProjects:b})=>{const x=(j,A)=>{if(j){if(j.value===A.mybldrItemId)return;u(r,A.id,j.value,j.label,A.qbItemId,A.qbItemName)}},v=(j,A)=>{j&&u(r,A.id,A.mybldrItemId,A.mybldrItemName,j.value,j.label)},y=r==="PROJECT"?"Project":"Vendor";return(0,e.jsxs)("div",{style:{paddingBottom:"20px"},children:[(0,e.jsx)(eu,{children:(0,e.jsxs)(Xc,{children:[(0,e.jsx)(Jc,{children:t}),(0,e.jsx)(Zc,{children:n})]})}),(0,e.jsxs)(Pg,{children:[(0,e.jsxs)(Eg,{children:[" ",s]}),(0,e.jsxs)(Eg,{children:[" ",o]})]}),a.map((j,A)=>{const w=ek(i,j);return(0,e.jsxs)(Pg,{children:[(0,e.jsx)(Tl,{"data-testid":`${y.toLowerCase()+A}-mapping-field`,dropDownItems:w&&w.filter(P=>!a.some(C=>C.mybldrItemId===P.value)||P.value===j.mybldrItemId),placeholder:`MYBLDR ${y}`,selectedValue:{value:j.mybldrItemId,label:j.mybldrItemName},onSelect:P=>x(P,j),onClear:()=>{p(j.id,y.toLowerCase())},onInputChange:h,isFetchingResults:r==="PROJECT"&&b,showErrors:!!(f&&j.qbItemId&&!j.mybldrItemId),errorText:`Please select MyBLDR ${y.toLowerCase()}`}),(0,e.jsx)(ZD.Z0P,{color:"gray",style:{marginTop:"10px"}}),(0,e.jsx)(Tl,{dropDownItems:l,placeholder:`QB ${y}`,selectedValue:{value:j.qbItemId,label:j.qbItemName},onSelect:P=>v(P,j),onClear:()=>{p(j.id,"qb")},showErrors:!!(f&&j.mybldrItemId&&!j.qbItemId),errorText:`Please select QB vendor ${y.toLowerCase()}`})]},A)}),(0,e.jsxs)(QD,{"data-testid":`btn-add-${y.toLowerCase()}-mapping`,onClick:c,children:["+ Add another ",y," mapping"]})]})},tk=({projectMappingList:t,vendorMappingList:n,mappedAccount:s,mappedBFSVendor:o,accountList:r,bfsVendorsList:a,qbCustomersList:i,vendorList:l,onAddOtherVendor:c,onAddAnotherProject:u,onItemSelect:p,onAccountSelect:f,onBfsVendorSelect:h,onItemClear:b,showErrors:x,projectList:v,setProjectSearch:y,isLoadingProjects:j})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(eu,{children:[(0,e.jsxs)(Xc,{children:[(0,e.jsx)(Jc,{"data-testid":"qb-account-title",children:"QuickBooks Account"}),(0,e.jsx)(Zc,{"data-testid":"qb-account-subTitle",children:"Choose which account you want to send bills to"})]}),(0,e.jsx)(Tl,{dropDownItems:r,placeholder:"QuickBooks Account",selectedValue:s,onSelect:A=>{A.value&&A.label&&f(A.value,A.label)},onClear:()=>{b("ACCOUNT")}})]}),(0,e.jsxs)(eu,{children:[(0,e.jsxs)(Xc,{children:[(0,e.jsx)(Jc,{"data-testid":"bfs-vendor-title",children:"Select Builders FirstSource Vendor"}),(0,e.jsx)(Zc,{"data-testid":"bfs-vendor-subTitle",children:"Choose which vendor you use in QuickBooks for BFS"})]}),(0,e.jsx)(Tl,{dropDownItems:a,placeholder:"Builders FirstSource Vendor",selectedValue:o,onSelect:A=>{h(A.value,A.label)},onClear:()=>{b("BFS_VENDOR")}})]}),(0,e.jsx)(Ig,{title:"Other Vendor Mappings",subtitle:"Map other Vendors being used to their equivalent vendor in QuickBooks",dropDownMybldrTitle:"myBLDR Vendor",dropDownQBTitle:"QuickBooks Vendor",type:"VENDOR",mappingList:n,mybldrList:l,qbList:a,onAddOtherItem:c,onItemSelect:p,onClear:(A,w)=>{b("VENDOR",A,w)},showErrors:x}),(0,e.jsx)(Ig,{title:"QuickBooks Project Mapping",subtitle:"Map your myBLDR.com projects to their equivalent Customer/Project in QuickBoooks",dropDownMybldrTitle:"myBLDR Project",dropDownQBTitle:"QuickBooks Customer/Project",type:"PROJECT",mappingList:t,mybldrList:v,qbList:i,onItemSelect:p,onClear:(A,w)=>{b("PROJECT",A,w)},onAddOtherItem:u,onBldrInputChange:y,isLoadingProjects:j,showErrors:x})]}),nk=(t,n,s,o,r)=>{const a=[],i=[],l=[],c=[],u=[],p=[],f=[{qb_account_id:n?.value,qb_account_name:n?.label}],h=[{qb_vendor_id:s?.value,qb_vendor_name:s?.label}];return t.account_mapping.length>0&&(f[0].id=t.account_mapping[0].id),t.qb_vendor_mapping.length>0&&(h[0].id=t.qb_vendor_mapping[0].id),o.forEach(b=>{if(!b.updated)return;const x={mybldr_project_id:b.mybldrItemId,mybldr_project_name:b.mybldrItemName,qb_customer_id:b.qbItemId,qb_customer_name:b.qbItemName};if(typeof b.id=="number"){const v={...x,id:b.id};b.mybldrItemId&&b.qbItemId?i.push(v):l.push(b.id)}else b.qbItemId&&a.push(x)}),r.forEach(b=>{if(!b.updated)return;const x={mybldr_vendor_id:b.mybldrItemId,mybldr_vendor_name:b.mybldrItemName,qb_vendor_id:b.qbItemId,qb_vendor_name:b.qbItemName};typeof b.id=="number"?b.mybldrItemId&&b.qbItemId?u.push({...x,id:b.id}):p.push(b.id):b.mybldrItemId&&c.push(x)}),{inserted:{...a.length>0&&{project_customer_mapping:a},...c.length>0&&{vendor_mapping:c},...!f[0].id&&f[0].qb_account_id&&{account_mapping:f},...!h[0].id&&h[0].qb_vendor_id&&{qb_vendor_mapping:h}},updated:{...i.length>0&&{project_customer_mapping:i},...u.length>0&&{vendor_mapping:u},...f[0].id&&f[0].qb_account_id!==t.account_mapping[0].qb_account_id&&{account_mapping:f},...h[0].id&&h[0].qb_vendor_id!==t.qb_vendor_mapping[0].qb_vendor_id&&{qb_vendor_mapping:h}},deleted:{...l.length>0&&{project_customer_mapping:l},...p.length>0&&{vendor_mapping:p}}}},sk=()=>{window.opener&&window.opener.postMessage({type:"url-change",href:window.location.href},"*")};window.addEventListener("load",sk);const ok="Now that your accounts are linked, set your account mappings below to start sending invoices to QuickBooks.",rk="Connect your myBLDR account to QuickBooks Online to start sending invoices from myBLDR.com to QuickBooks as bills.",tu={id:"generated_1",mybldrItemId:void 0,mybldrItemName:void 0,qbItemId:void 0,qbItemName:void 0,updated:!1},ak=()=>{const{company:t}=(0,je.P)(),n=(0,Dt.A)(),[s,o]=(0,d.useState)(),{showError:r}=(0,Fe.d)(),{loading:a,fetchQuickbooksConnectionLink:i,disconnectFromQuickbooks:l,setupQuickBooksConnection:c,getQuickBookEntities:u,getVendors:p,redirectUri:f,authUrl:h,isConnected:b,qbMapping:x,getQuickBookMapping:v,accountList:y,bfsVendorsList:j,qbCustomersList:A,vendorList:w,saveQuickBookSettings:P}=hc(t?.id),[C,k]=(0,d.useState)(!1),[S,R]=(0,d.useState)([tu]),[B,T]=(0,d.useState)([tu]),[W,N]=(0,d.useState)(""),O=(0,d.useMemo)(()=>(0,$D.A)(N,500),[]),{projectList:z,isFetching:Q}=(0,Ys.Y)({searchTerm:W,showErrorMessage:!0,shouldRefetch:!0}),[re,ue]=(0,d.useState)(),[le,F]=(0,d.useState)(),[V,$]=(0,d.useState)(!1);(0,d.useEffect)(()=>{i()},[i]),(0,d.useEffect)(()=>{if(s){const Ue=async lt=>{if(lt.data.type==="url-change"){const ge=lt.data.href;try{const We=new URL(ge),At=new URLSearchParams(We.search),xn=At.get("error");if(xn)throw Error(xn);const on=At.get("state"),Xe=At.get("realmId"),dt=At.get("code");if(ge.startsWith(f))if(on&&dt&&Xe)s&&!s.closed&&s.close(),c({state:on,realmId:Xe,code:dt});else throw Error("Connection failed, some parameters are missing.")}catch(We){console.error(We),s.close(),r({message:"Connection failed. try again."})}}};return window.addEventListener("message",Ue),()=>{window.removeEventListener("message",Ue)}}},[s,f,c,r]);const ee=(0,d.useCallback)(async()=>{v(),u(),p()},[v,p]);(0,d.useEffect)(()=>{if(b)if(!h)ee();else{const Ue=ne();o(Ue)}},[h,ee,b]);const X=(0,d.useCallback)(()=>{x&&x.account_mapping&&x.account_mapping.length>0&&ue({value:x.account_mapping[0].qb_account_id,label:x.account_mapping[0].qb_account_name}),x&&x.qb_vendor_mapping&&x.qb_vendor_mapping.length>0&&F({value:x.qb_vendor_mapping[0].qb_vendor_id,label:x.qb_vendor_mapping[0].qb_vendor_name}),x&&x.vendor_mapping&&x.vendor_mapping.length>0&&R(x?.vendor_mapping.map((Ue,lt)=>({id:Ue.id,mybldrItemId:Ue.mybldr_vendor_id,mybldrItemName:Ue.mybldr_vendor_name,qbItemId:Ue.qb_vendor_id,qbItemName:Ue.qb_vendor_name,updated:!1})))},[x]),G=(0,d.useMemo)(()=>z.map(Ue=>({value:Ue.projectExternalId,label:Ue.projectName}))||[],[z]),Y=(0,d.useCallback)(()=>{x&&x.project_customer_mapping&&x.project_customer_mapping.length>0?T(x.project_customer_mapping.map(Ue=>({id:Ue.id,mybldrItemId:Ue.mybldr_project_id,mybldrItemName:Ue.mybldr_project_name,qbItemId:Ue.qb_customer_id,qbItemName:Ue.qb_customer_name,updated:!1}))):T([tu])},[x]);(0,d.useEffect)(()=>{X(),k(!1)},[x,X]),(0,d.useEffect)(()=>{Y()},[x,Y]);const he=async()=>{if(b)l();else{const Ue=ne();o(Ue)}},ne=()=>{const ge=window.innerWidth/2-400,We=window.innerHeight/2-600/3;return window.open(h,"QuickBooksLogin",`width=800,height=600,top=${We},left=${ge},scrollbars=no`)},J=async()=>{const Ue=S.filter(ge=>ge.mybldrItemId&&!ge.qbItemId||!ge.mybldrItemId&&ge.qbItemId).length>0,lt=B.filter(ge=>ge.mybldrItemId&&!ge.qbItemId||!ge.mybldrItemId&&ge.qbItemId).length>0;if(Ue||lt)$(!0),k(!1),r({message:"Please resolve errors."});else{let ge=nk(x,re,le,B,S);P(ge),$(!1)}},pe=()=>{R(Ue=>[...Ue,{id:`generated_${S.length+1}`,mybldrItemId:void 0,mybldrItemName:void 0,qbItemId:void 0,qbItemName:void 0,updated:!1}])},Ee=()=>{T(Ue=>[...Ue,{id:`generated_${B.length+1}`,mybldrItemId:void 0,mybldrItemName:void 0,qbItemId:void 0,qbItemName:void 0,updated:!1}])},Te=(Ue,lt)=>{ue({value:Ue,label:lt}),k(!0)},me=(Ue,lt)=>{F({value:Ue,label:lt}),k(!0)},$e=(Ue,lt,ge,We,At,xn)=>{if(Ue==="VENDOR")R(S.map(on=>on.id===lt?{...on,mybldrItemId:ge,mybldrItemName:We,qbItemId:At,qbItemName:xn,updated:!!(ge&&At)}:on));else if(Ue==="PROJECT"){const on=B.map(Xe=>Xe.id===lt?{id:lt,mybldrItemId:ge,mybldrItemName:We,qbItemId:At,qbItemName:xn,updated:!0}:Xe);T(on)}k(!0)},gt=(Ue,lt)=>{const ge=S.map(We=>We.id===Ue?lt==="vendor"?{...We,mybldrItemId:void 0,mybldrItemName:void 0,updated:!0}:lt==="qb"?{...We,qbItemId:void 0,qbItemName:void 0,updated:!0}:We:We);R(ge)},Rt=(Ue,lt)=>{const ge=B.map(We=>We.id===Ue?{id:We.id,mybldrItemId:lt==="project"?void 0:We.mybldrItemId,mybldrItemName:lt==="project"?void 0:We.mybldrItemName,qbItemId:lt==="qb"?void 0:We.qbItemId,qbItemName:lt==="qb"?void 0:We.qbItemName,updated:!0}:We);T(ge)},rt=(Ue,lt,ge)=>{switch(Ue){case"VENDOR":gt(lt,ge);break;case"PROJECT":Rt(lt,ge);break;case"ACCOUNT":ue(void 0);break;case"BFS_VENDOR":F(void 0);break;default:break}k(!0)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qc,{shouldBlockNavigation:C,message:"You have made edits to your QuickBooks setup, would you like to save these changes?",handleSaveChanges:J}),(0,e.jsx)(qr,{"data-testid":"quickbooks-setup-header",title:"QuickBooks Setup",body:b?ok:rk,renderAction:()=>(0,e.jsx)(wg,{isSaveButtonEnable:C,onClickSaveButton:J})}),(0,e.jsxs)(Yc,{children:[(0,e.jsx)(JD,{isConnected:b,connectionClickHandler:he,isButtonDisabled:a}),b&&(0,e.jsx)(tk,{projectMappingList:B,vendorMappingList:S,onAddOtherVendor:pe,mappedAccount:re,mappedBFSVendor:le,onItemSelect:$e,onAccountSelect:Te,onBfsVendorSelect:me,onItemClear:rt,accountList:y,bfsVendorsList:j,qbCustomersList:A,vendorList:w,showErrors:V,onAddAnotherProject:Ee,projectList:G,setProjectSearch:O,isLoadingProjects:Q})]}),(0,e.jsx)(rr.A,{open:a,invisible:!0,sx:{zIndex:n.zIndex.drawer+1},children:(0,e.jsx)(bt.A,{sx:l0})})]})},ik=(0,g.Ay)("div")`
  font-size: 18px;
  font-weight: normal;
  line-height: 1;
  letter-spacing: normal;
  color: var(--graythorne-grays-gray-5);
`,lk=(0,g.Ay)("p")`
  font-size: 14px;
  font-weight: 300;
  line-height: 1.2;
  letter-spacing: normal;
  color: var(--graythorne-grays-gray-5);
`,c8=(0,g.Ay)("label")`
  opacity: 0;
`,dk=(0,g.Ay)("div")`
  position: absolute;
  bottom: 0;
  right: 0;
  left: 0;

  padding: 2rem;

  background-color: var(--bfs-11-22-body-background);

  pointer-events: none;

  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;

  // give space for the nav bar above the overlay
  top: 62px;
  ${t=>t.theme.breakpoints.up("lg")} {
    top: 80px;
  }
  ${t=>t.theme.breakpoints.up("xl")} {
    top: 111px;
  }
`,Dg=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;

  border: solid 3px var(--graythorne-grays-gray-5);
  border-style: dotted;
`,ck=(0,g.Ay)(Dg)`
  background-color: var(--common-white-100-p);
  height: 100%;
  width: 100%;
`,kg=(0,g.Ay)(Dg)`
  padding: 2rem 1.5rem;
  border-color: var(--graythorne-blues-blue-4);
  height: 266px;
  width: 237px;
`,uk=(0,g.Ay)("img")`
  height: 44px;
  width: 34px;
`,pk=(0,g.Ay)(I.A)`
  font-size: 20px;
  line-height: 1;
  color: var(--light-text-primary);
`,mk=(0,g.Ay)(I.A)`
  font-size: 12px;
  font-weight: 300;
  line-height: 1;
  letter-spacing: 0.4px;
  text-align: center;
  color: var(--graythorne-grays-gray-3);
`,hk=m.p+"0317b5f3f5388f77e2d6c6b43066d3f5.svg",Tg=({children:t,uploadFiles:n,project:s,enabled:o,showOverlay:r=!0})=>{const[a,i]=(0,d.useState)(!1),l=(0,d.useRef)(null),c=f=>{o&&(i(!1),n(f))},u=()=>{o&&i(!0)},p=f=>{f?.relatedTarget!==l?.current&&o&&i(!1)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ml.Ay,{onDrop:c,onDragEnter:u,onDragLeave:p,multiple:!0,noClick:!0,children:({getRootProps:f,getInputProps:h})=>(0,e.jsxs)("div",{"data-testid":"dropzone-div",...f({style:{height:"100%",width:"100%"}}),children:[(0,e.jsx)("input",{...h(),hidden:!0}),t]})}),a&&o&&r&&(0,e.jsx)(dk,{ref:l,children:(0,e.jsxs)(ck,{children:[(0,e.jsx)(uk,{src:hk}),(0,e.jsx)(pk,{variant:"body2",style:{margin:"1rem 0 0.5rem"},children:"Drop files anywhere"}),(0,e.jsx)(mk,{children:"pdf, jpg, png, xlsx, docx, pptx"})]})})]})},gk=()=>{const{allRoles:t}=(0,we.Sk)(),n=(0,ct.Cy)(t);return(0,e.jsxs)(e.Fragment,{children:[n?(0,e.jsx)(_d,{}):(0,e.jsx)(lm,{}),(0,e.jsx)("div",{"data-testid":"select-project-page"})]})},fk=m.p+"9cd28b69b9138e3143139345b9499a50.svg",xk=m.p+"95c49e2b40d02fa0a2aee108e430c3de.svg",Rg=({onClickSelect:t,hasOverlay:n,inputOrCard:s="card",dragAndDropText:o="Drop files anywhere",uploadButtonText:r="Upload Files",uploadButtonStyle:a})=>{const i=(0,d.useRef)(null),l=(0,d.useRef)(null);return(0,e.jsxs)(kg,{ref:i,className:"FilesDragAndDrop","data-testid":"dragndrop-drop-area",style:s==="input"?{flexDirection:"row",width:"100%",height:"100%",padding:"16px 0px",borderRadius:"var(--borderRadius, 4px)",border:"1px dashed var(--Colors-Border-border-secondary, #C3C6CC)",background:"var(--Colors-Background-bg-primary, #FFF)"}:{},children:[(0,e.jsx)("img",{src:s==="input"?xk:fk,alt:"Upload blueprint",style:s==="card"?{paddingTop:"1em",paddingBottom:"0.5rem"}:{}}),(0,e.jsx)(ik,{children:o}),s==="card"&&(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,e.jsx)("div",{style:{width:"42px",height:"1px",flexGrow:0,backgroundColor:"#979493",margin:"1em 2em"}}),(0,e.jsx)(lk,{children:"OR"}),(0,e.jsx)("div",{style:{width:"42px",height:"1px",flexGrow:0,backgroundColor:"#979493",margin:"1em 2em"}})]}),(0,e.jsx)(K.A,{"data-testid":"dragndrop-file-select-button",variant:"contained",onClick:()=>l?.current?.click(),sx:a,children:r}),(0,e.jsx)("input",{hidden:!0,multiple:!0,ref:l,type:"file",accept:"*.pdf",onChange:t,"data-testid":"dragndrop-file-selector"})]})};function yk(t){return(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,e.jsx)(E.A,{sx:{width:"100%",mr:1},children:(0,e.jsx)(Od.A,{variant:"determinate",...t})}),(0,e.jsx)(E.A,{sx:{minWidth:35},children:(0,e.jsx)(I.A,{variant:"body2",color:"text.secondary",children:`${Math.round(t.value)}%`})})]})}const bk=({progress:t=0,fullWidth:n})=>(0,e.jsx)(kg,{style:{width:n?"initial":"245px",padding:20,margin:"auto",height:"220px"},children:(0,e.jsx)(yk,{value:t})}),u8={name:"",street:"",city:"",state:"",zip:""};var Og=m(30038),Yn=(t=>(t.REQUESTED="REQUESTED",t.PUBLISHED="PUBLISHED",t.DELIVERED="DELIVERED",t.EXPIRED="EXPIRED",t.CREATED="CREATED",t.SELLER_DRAFT="SELLER_DRAFT",t.SELLER_SUBMITTED="SELLER_SUBMITTED",t.BUYER_ORDERED="BUYER_ORDERED",t))(Yn||{});function vk(t){return t.quoteId!==void 0&&t.elevationName!==void 0&&t.optionNames!==void 0}function jk(t){return t.quoteId!==void 0}const Ak=t=>t.type==="send-invite"&&t.roleId!==void 0&&t.email!==void 0&&t.firstName!==void 0&&t.lastName!==void 0;var Ck=(t=>(t.PROCESSING="PROCESSING",t.COMPLETED="COMPLETED",t.FAILED="FAILED",t.REJECTED="REJECTED",t))(Ck||{});function Sk(t){return t.type==="order_update"&&"quoteId"in t.payload}const p8={COMMENT:"CO",STOCK:"ST",NONSTOCK:"N"};function nu(t){if(!t)return!1;if(!t.groupedItemOptions||t.groupedItemOptions.length===0)return!0;let n=!0;for(let s of t.groupedItemOptions){let o=!1;for(let r of s.lineItems)if(r.isItemConfirmed){o=r.isItemConfirmed;break}if(n=n&&o,!n)break}return n}const Rl=t=>{const n=t?.find(s=>s.isItemSelected);return!n&&t&&t?.length>0?t[0]:n};function su(t){if(!t)return"";let n=0,s=0;return t.singleLineItems&&t.singleLineItems.forEach(o=>{o.price!==null&&(n+=o.price*o.quantity,s+=o.price*o.quantity)}),t.groupedItemOptions&&t.groupedItemOptions.forEach(o=>{let r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;o.lineItems.forEach(i=>{i.price!==null&&(r=Math.min(r,i.price*i.quantity),a=Math.max(a,i.price*i.quantity))}),n+=r!==Number.POSITIVE_INFINITY?r:0,s+=a!==Number.NEGATIVE_INFINITY?a:0}),`${(0,Ze.up)(n)} - ${(0,Ze.up)(s)}`}const as=t=>t&&"bidPackId"in t?`bid-${t.bidPackId}`:t&&"deliveryId"in t?`delivery-${t.deliveryId}`:t&&"orderId"in t?`order-${t.orderId}`:null,Ol=t=>t&&"bidPackId"in t?t:null,wk=t=>t&&"orderId"in t&&!("deliveryId"in t)?t:null,Zr=t=>{if(t&&"deliveryId"in t&&"orderId"in t)return t;if(!t||!("deliveries"in t))return null;const n=t.deliveries;return!n.length||n[0].deliveryId.trim()===""?null:{...t.deliveries[0]}},Ek=(t,n)=>n.some(s=>s.invoice_number===t.deliveryId),ea=t=>t?new Date>=new Date(t):!1,so=t=>{switch(!0){case t===null:return null;case!!t.bidPackId:return"bid";case!!t.deliveryId:return"delivery";case!!t.orderId:return"order";default:return null}},Pk=t=>t.invoices?.length>0,Mg=(t,n)=>{if(!n||!t.lineItems)return t;let s=t.invoices.map(r=>r.invoiceId),o=[...t.lineItems];return s.forEach(r=>{let a=n[r];a!==void 0&&(o=o.map(i=>({...i,quantity:(()=>{const l=a[i.sku];return l?Number(l):i.quantity})()})))}),{...t,lineItems:o}},br=t=>t.transactionType==="CO"||t.lineTypeId==="3"||t.lineTypeCode==="CO",Ik=t=>t?"bidPackId"in t?`/bids/${t.bidPackId}`:"orderId"in t&&!("deliveryId"in t)?`/orders/${t.orderId}`:"deliveryId"in t?`/deliveries/${t.deliveryId}`:"/":"",m8=t=>{const s=t.replace(/\/projects\/\d+\/materials/,"").match(/\/(bids|orders|deliveries)\/(\w+)(\/)?/);return s?{type:s[1],id:s[2]}:null},Dk=(t,n)=>{switch(so(t)){case"bid":return t.singleLineItems;case"order":return t.lineItems;case"delivery":return Mg(t,n).lineItems;default:return[]}},ou=(t,n)=>{if(!t.groupedItemOptions||so(t)!=="bid")return[];const s=[];return t.groupedItemOptions.forEach(o=>{s.push({itemSelectionGroupName:o.itemSelectionGroupName,lineItems:o.lineItems,isFromOrderPack:!1,onClick:n?()=>n(o):void 0})}),s},Ml=(t,n)=>{const s=[];if(t===null)return s;let o=!1;return so(t)==="order"&&t.preferUnconverted&&(o=!0),Dk(t,n)?.forEach((r,a)=>{s.push({lineItem:r,isFromOrderPack:so(t)==="order",showUnconverted:o})}),s},ni=(t,n)=>{switch(t){case js.BID_EXPIRED:return{backgroundColor:`${n?"var(--chip-error-background)":"black"}`,text:"Expired",color:`${n?"var(--chip-error-text)":"white"}`};case js.READY_FOR_ORDER:return{backgroundColor:`${n?"var(--chip-success-background)":"var(--graythorne-greens-green-3)"}`,text:"Ready to Order",color:`${n?"var(--chip-success-text)":"white"}`};case un.ORDER_PENDING:return{backgroundColor:`${n?"var(--chip-secondary-background)":"var(--light-secondary-light)"}`,text:"Order Pending",color:`${n?"var(--chip-secondary-text)":"black"}`};case un.DELIVERY_IN_PROGRESS:return{backgroundColor:`${n?"var(--chip-warning-background)":"var(--light-warning-main)"}`,text:"Delivery In Progress",color:`${n?"var(--chip-warning-text)":"black"}`};case un.OPEN:return{backgroundColor:`${n?"var(--chip-warning-background)":"var(--light-warning-main)"}`,text:"Open",color:`${n?"var(--chip-warning-text)":"black"}`};case un.DELIVERY_SCHEDULED:return{backgroundColor:`${n?"var(--chip-secondary-background)":"var(--light-secondary-light)"}`,text:"Delivery Scheduled",color:`${n?"var(--chip-secondary-text)":"black"}`};case un.OUT_FOR_DELIVERY:return{backgroundColor:`${n?"var(--chip-warning-background)":"var(--light-warning-main)"}`,text:"Out for Delivery",color:`${n?"var(--chip-warning-text)":"black"}`};case un.DELIVERED:return{backgroundColor:`${n?"var(--chip-info-background)":"var(--light-info-main)"}`,text:"Delivered",color:`${n?"var(--chip-info-text)":"white"}`};case un.ORDER_PROCESSING:return{backgroundColor:`${n?"var(--chip-secondary-background)":"var(--light-secondary-light)"}`,text:"Order Processing",color:`${n?"var(--chip-secondary-text)":"black"}`};case un.CANCELLED:return{backgroundColor:`${n?"var(--chip-error-background)":"var(--light-error-main)"}`,text:"Cancelled",color:`${n?"var(--chip-error-text)":"white"}`};case un.CANCELED:return{backgroundColor:`${n?"var(--chip-secondary-background)":"black"}`,text:"Canceled",color:`${n?"var(--chip-secondary-text)":"white"}`};case un.POS:return{backgroundColor:`${n?"var(--chip-info-background)":"var(--light-info-main)"}`,text:"POS",color:`${n?"var(--chip-info-text)":"white"}`};case un.UNDELIVERABLE:return{backgroundColor:`${n?"var(--chip-error-background)":"var(--light-error-main)"}`,text:"Undeliverable",color:`${n?"var(--chip-error-text)":"white"}`};case un.NOT_SCHEDULED:return{backgroundColor:`${n?"var(--chip-secondary-background)":"var(--light-secondary-light)"}`,text:"Not Scheduled",color:`${n?"var(--chip-secondary-text)":"black"}`};case un.CLOSED:return{backgroundColor:`${n?"var(--chip-secondary-background)":"black"}`,text:"Closed",color:`${n?"var(--chip-secondary-text)":"white"}`};case un.UNKNOWN:default:return{backgroundColor:"black",text:"Unknown Status",color:"white"}}},kk=(t,n,s)=>!n||!t?!1:s?t.quantityRemaining!=null:t.quantity!=null,Tk=(t,n,s)=>!n||!t?!1:t.price!=null&&!s,si=(t,n)=>{let{quantity:s,unconvertedQuantity:o,extendedPrice:r}=t,a,i;return a=vr(t,n),n?i=o:i=s,r?(0,Ze.up)(r):a&&i?(0,Ze.up)(a*i):(0,Ze.up)(0)},Lg=t=>t.replace(/\b0*([1-9][0-9]*|0)\b/g,"$1").replace(/,/g,", ").trim(),Fg=t=>Lg(t),oi=t=>Lg(t).split(" "),Rk=t=>t.some(n=>n.elevationName||n.optionName),vr=(t,n)=>{if(!t)return 0;let{price:s,unconvertedPrice:o}=t;return n&&o!==null&&Number(o)!==0?Number(o):Number(s)},ru=(t,n)=>{if(!t)return"";let{unitOfMeasurement:s,pricingUnitOfMeasure:o,unconvertedUnitOfMeasurement:r,unconvertedPrice:a}=t;return n&&a!==null?r:!n&&o?o:s},vs={getTypedPackId:as,getBidPack:Ol,getOrderPack:wk,getDeliveryPack:Zr,isDeliveryInvoiced:Ek,isPackExpired:ea,getPackType:so,assignInvoiceQuantitiesToPack:Mg,getSelectedGroupItem:Rl,lineItemHasComment:br,generatePackUrl:Ik,showQuantity:kk,showPrice:Tk,getLineItemFullPrice:si,parseTallyMeasurements:Fg,parseTallyMeasurementsForArray:oi,containsElevationOptions:Rk,getLineItemPrice:vr,getUnitOfMeasure:ru},g8=t=>t.quotePublishedDate?t.quoteExpiration&&dayjs(t.quoteExpiration).isBefore(dayjs())?QuoteStatus.EXPIRED:QuoteStatus.PUBLISHED:QuoteStatus.REQUESTED,Ok=(t,n)=>{switch(t){case Yn.REQUESTED:return{text:"In Progress",backgroundColor:"var(--chip-secondary-background)",color:"var(--chip-secondary-text)"};case Yn.PUBLISHED:return n?{text:`Expires ${iu(n)}`,backgroundColor:"var(--chip-error-background)",color:"var(--chip-error-text)"}:{text:"Published",backgroundColor:"var(--chip-info-background)",color:"var(--chip-info-text)"};case Yn.SELLER_SUBMITTED:return{text:"Published",backgroundColor:"var(--chip-info-background)",color:"var(--chip-info-text)"};case Yn.EXPIRED:return{text:"Expired",backgroundColor:"var(--chip-error-background)",color:"var(--chip-error-text)"};case Yn.DELIVERED:return{text:"Delivered",backgroundColor:"var(--chip-info-background)",color:"var(--chip-info-text)"};case Yn.CREATED:return{text:"Created",backgroundColor:"var(--chip-secondary-background)",color:"var(--chip-secondary-text)"};case Yn.SELLER_DRAFT:return{text:"Quote Requested",backgroundColor:"var(--chip-secondary-background)",color:"var(--chip-secondary-text)"};case Yn.BUYER_ORDERED:return{text:"Order Submitted",backgroundColor:"var(--chip-info-background)",color:"var(--chip-info-text)"};default:return{text:"",backgroundColor:"var(--chip-secondary-background)",color:"var(--chip-secondary-text)"}}},au=t=>t.reduce((n,s)=>s.extendedPrice?n+s.extendedPrice:s.price&&s.quantity?n+(s.price??0)*s.quantity:n,0),Mk=t=>{const n=[...t.singleLineItems,...t.groupedItemOptions?.flatMap(s=>s.lineItems.filter(o=>o.isItemSelected))??[]];return au(n)},Bg=t=>(t.quotePacks?.forEach(n=>{if(n.totalPrice=Mk(n),!ri(n.status))if(!n.expirationDate)n.status=js.READY_FOR_ORDER;else{const s=dn()(n.expirationDate),o=dn()();s.isBefore(o)?n.status=js.BID_EXPIRED:n.status=js.READY_FOR_ORDER}}),t),iu=t=>dn()(t).format("MM/DD/YYYY"),Ll=(t,n)=>{const s=t.singleLineItems.filter(a=>!br(a)),o=t.groupedItemOptions?.flatMap(a=>a.lineItems.filter(i=>i.isItemSelected))??[],r=[...s,...o];return{bidPackId:Number(t.bidPackId),bidPack:t,lineItems:n?Object.fromEntries(r.map(a=>[a.lineItemId,a])):{},totalOrderableLineItems:r.length,totalPrice:n?au(r):0}},Lk=t=>Object.keys(t.lineItems).length<t.totalOrderableLineItems,ri=t=>t===js.ORDER_PROCESSING,Fk={showGridView:!0,showCustomerView:void 0,packsForOrder:{},selectedPack:null,bidPacks:{},orderPacks:{},showLineItemPricing:!1,showQuantity:!1},Ng=t=>au(Object.values(t.lineItems)),_g=(0,Og.Z0)({name:"materials",initialState:Fk,reducers:{setCustomerView:(t,n)=>{t.showCustomerView=n.payload.value},flipGridView:t=>{t.showGridView=!t.showGridView},setGridView:(t,n)=>{t.showGridView=n.payload},addPackToOrder:(t,n)=>{const{projectId:s,pack:o}=n.payload,r=t.packsForOrder[s]??{};r[o.bidPackId]=Ll(o,!0),t.packsForOrder[s]=r},addAllPacksToOrder:(t,n)=>{const{projectId:s,packs:o}=n.payload;t.packsForOrder[s]=Object.fromEntries(o.filter(r=>!ri(r.status)).map(r=>[r.bidPackId,Ll(r,!0)]))},removePackFromOrder:(t,n)=>{const{projectId:s,bidPackId:o}=n.payload;t.packsForOrder[s][o]&&delete t.packsForOrder[s][o]},addLineItemToOrder:(t,n)=>{const{projectId:s,pack:o,lineItemId:r}=n.payload,{bidPackId:a}=o;t.packsForOrder[s]=t.packsForOrder[s]??{},t.packsForOrder[s][a]||(t.packsForOrder[s][a]=Ll(o,!1));const i=t.packsForOrder[s][a];if(!i.lineItems[r]){const l=o.singleLineItems.find(c=>c.lineItemId===r)??o.groupedItemOptions?.flatMap(c=>c.lineItems).find(c=>c.lineItemId===r);l&&(i.lineItems[r]=l),i.totalPrice=Ng(i)}},removeLineItemFromOrder:(t,n)=>{const{projectId:s,pack:o,lineItemId:r}=n.payload,a=Number(o.bidPackId);if(t.packsForOrder[s]&&t.packsForOrder[s][a]){const i=t.packsForOrder[s][a];i.lineItems[r]&&(delete i.lineItems[r],Object.keys(i.lineItems).length===0?delete t.packsForOrder[s][a]:i.totalPrice=Ng(i))}},resetSelectedPacks:(t,n)=>{const{projectId:s}=n.payload;t.packsForOrder[s]={}},updateSelectedPack:(t,n)=>{t.selectedPack=n.payload},updateBidPacks:(t,n)=>{const{projectId:s,bidPacks:o}=n.payload;t.bidPacks[s]=o},updateOrderPacks:(t,n)=>{const{projectId:s,orderPacks:o}=n.payload;t.orderPacks[s]=o},updateShowQuantity:(t,n)=>{t.showQuantity=n.payload},updateShowLineItemPricing:(t,n)=>{t.showLineItemPricing=n.payload}}}),{flipGridView:Bk,setGridView:Nk,setCustomerView:_k,addPackToOrder:Uk,removePackFromOrder:Wk,resetSelectedPacks:Ug,updateSelectedPack:zk,updateBidPacks:Wg,updateOrderPacks:zg,updateShowLineItemPricing:Vk,updateShowQuantity:$k,addAllPacksToOrder:Hk,addLineItemToOrder:Qk,removeLineItemFromOrder:Gk}=_g.actions,Kk=_g.reducer;function Yk(){const t=(0,Pn.wA)();function n(o){t(zk(o))}return[(0,Pn.d4)(o=>o.materials.selectedPack),n]}function lu(t){const{project:n}=(0,De.B)(),s=(0,Pn.wA)(),o=(0,Pn.d4)(p=>p.materials.bidPacks),r=(0,Pn.d4)(p=>p.materials.orderPacks),a=n?o[n.id]:[],i=n?r[n.id]:[];return{bidPacks:a,setBidPacks:(p,f)=>{s(Wg({projectId:p,bidPacks:f}))},orderPacks:i,setOrderPacks:(p,f)=>{const h=Vg(f,t);s(zg({projectId:p,orderPacks:h}))},resetMaterialsPageState:p=>{s(Ug({projectId:p})),s(Wg({projectId:p,bidPacks:[]})),s(zg({projectId:p,orderPacks:[]}))}}}function Vg(t,n){return t.map(o=>{let r=o.lineItems.filter(a=>a.quantityRemaining!==0);return r.every(a=>n?.erpSystem===An.v.ONLINE?a.transactionType==="CO"||a.transactionType==="S":a.transactionType==="CO")&&(r=[]),(o.status===un.CANCELED||o.status===un.CANCELLED)&&r.push(...o.lineItems),{...o,lineItems:r}})}function Fl(){const t=(0,Pn.wA)();function n(){t(Bk())}function s(p){t(_k({value:p}))}const o=(0,d.useCallback)(p=>{t(Nk(p))},[t]),r=(0,Pn.d4)(p=>p.materials.showCustomerView),a=(0,Pn.d4)(p=>p.materials.showGridView),i=(0,Pn.d4)(p=>p.materials.showQuantity),l=(0,Pn.d4)(p=>p.materials.showLineItemPricing);return{isGridView:a,updatePackGridView:n,isCustomerView:r,updateCustomerView:s,setInitialGridView:o,showQuantity:i,showLineItemPricing:l,setShowLineItemPricing:p=>{t(Vk(p))},setShowQuantity:p=>{t($k(p))}}}const ta=()=>{const{isFlagEnabled:t,isLoading:n,fetched:s}=(0,ut.u)();return{isQuotesEnabled:t(D.SX.USE_MATERIALS_QUOTES),featureFlagsLoading:n,featureFlagsFetched:s}},na=(0,Lo.xP)({baseQuery:(0,Zo.S)({baseUrl:"/api/projects"}),reducerPath:"quotes",tagTypes:["Quotes","QuoteDetails","OrderDetails","MarketCategories","OrderTransactions"],keepUnusedDataFor:0,endpoints:t=>({getQuotesSummary:t.query({query:({projectId:n,includeDigital:s=!1})=>s?{url:`/${n}/quotes/summary?includeDigitalTools=true`}:{url:`/${n}/quotes/summary`},providesTags:["Quotes"]}),getInvoicedDeliveriesLineItemsQuantities:t.query({query:({projectId:n,invoiceIds:s})=>({url:`/${n}/quotes/invoices`,method:"POST",data:{invoiceIds:s}}),providesTags:["OrderDetails"]}),getThirdPartyQuotesSummary:t.query({query:n=>({url:`/${n}/quotes/third_party_summary`}),providesTags:["Quotes"]}),getQuoteDetails:t.query({query:({projectId:n,quoteId:s,is3pQuote:o})=>o?{url:`/${n}/quotes/${s}/third_party_details`}:{url:`/${n}/quotes/${s}`},transformResponse:n=>Bg(n),providesTags:["QuoteDetails"]}),getQuoteDetailsBatch:t.query({queryFn:async({projectId:n,quoteIds:s})=>{const o=async r=>{const{data:a}=await nt.Ay.get(`/api/projects/${n}/quotes/${r}`);return a};try{return{data:(await Promise.all(s.map(a=>o(a)))).map(a=>Bg(a))}}catch(r){return{error:r}}}}),getMarketCategories:t.query({query:({projectId:n})=>({url:`/${n}/market_categories`}),transformResponse:n=>{function s(o,r){return o.sortOrder>r.sortOrder?1:o.sortOrder<r.sortOrder?-1:0}return n.forEach(o=>o.checked=!1),n.sort(s),n},providesTags:["MarketCategories"]}),submit3pQuote:t.mutation({query:({projectId:n,categories:s,notes:o,requestDate:r})=>({url:`/${n}/third_party_quote_request`,method:"POST",data:{quoteCategories:s,notes:o,requestDate:r}})}),getShoppableStatus:t.query({query:n=>({url:`/${n}/get_shoppable_status`})}),getConfigureSelections:t.query({query:n=>({url:`/${n}/configure_selections`})}),updateMaterialList:t.mutation({query:({exteriorLineId:n,exteriorQuoteId:s,projectId:o})=>({url:`/${o}/request_take_off`,method:"POST",data:{exLineId:n,exQuoteId:s}}),transformResponse:(n,s,o)=>n.data}),submitOrderAsync:t.mutation({query:n=>({url:`/${n.projectId}/packs/order/async`,method:"POST",data:{packIds:n.packIds,partialPacks:n.partialPacks,deliveryDate:n.deliveryDate?.format("YYYY-MM-DD"),poNumber:n.poNumber,comment:n.comment,quoteId:Number(n.quoteId),receiveConfirmationEmail:n.emailConfirmationPreference}}),invalidatesTags:["OrderTransactions"]}),getActiveOrderTransactions:t.query({query:({projectId:n})=>({url:`/${n}/transactions`}),providesTags:["OrderTransactions"]}),getQuoteViewStatus:t.query({queryFn:async n=>{try{const{data:s}=await nt.Ay.get(`/api/quotes/${n}/view_status`);return{data:s}}catch(s){return{error:{status:s?.response?.status??500,data:s?.response?.data??"Failed to load quote view status"}}}},keepUnusedDataFor:60})})}),{useGetQuotesSummaryQuery:qk,useGetInvoicedDeliveriesLineItemsQuantitiesQuery:Xk,useGetThirdPartyQuotesSummaryQuery:Jk,useGetQuoteDetailsQuery:Zk,useGetQuoteDetailsBatchQuery:e2,useGetMarketCategoriesQuery:t2,useSubmit3pQuoteMutation:n2,useGetShoppableStatusQuery:s2,useUpdateMaterialListMutation:$g,useGetConfigureSelectionsQuery:o2,useSubmitOrderAsyncMutation:r2,useGetActiveOrderTransactionsQuery:a2,useGetQuoteViewStatusQuery:i2,useLazyGetQuoteViewStatusQuery:f8}=na,l2=()=>{const[t,{isLoading:n,error:s}]=n2(),{showError:o}=(0,Fe.d)();return{submit3pQuote:async(a,i,l,c)=>{try{return await t({projectId:a,categories:i,notes:l,requestDate:c}).unwrap()}catch{o({message:"There was an error requesting a partner quote. Please try again in a few minutes."})}},isLoading:n,error:s}};function sa(){const{setBidPacks:t,setOrderPacks:n}=lu(),{setShowQuantity:s,setShowLineItemPricing:o}=Fl(),[r,a]=(0,d.useState)(null),[i,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!1),[p,f]=(0,d.useState)(!1),[h,b]=(0,d.useState)(null),[x,v]=(0,d.useState)(null),{showError:y}=(0,Fe.d)(),{isQuotesEnabled:j}=ta(),{allRoles:A}=(0,we.Sk)(),w=(0,L.useNavigate)(),{submit3pQuote:P}=l2(),[C]=$g(),[k,S]=Yk(),[R,B]=(0,d.useState)(!1),T=async(le,F=!1)=>{try{const V=`/api/projects/${le}/packs`,$=(await nt.Ay.get(V))?.data,ee=$?.orderPacks,X=$?.bidPacks,G=$?.bidStarted,Y=$?.bidId,he=$?.isPublished,ne=$?.bidSummaryHtml,J=$?.bidSummaryTotal,pe=$?.showQuantity??!1,Ee=$?.showLineItemPricing??!1;if(a(Y),l(he),u(G),t(le.toString(),X),n(le.toString(),ee),b(ne),v(J),o(Ee),s(pe),k)"bidPackId"in k&&X?S(X?.find(Te=>Te.bidPackId===k?.bidPackId)||null):"orderId"in k&&ee&&S(ee?.find(Te=>Te.orderId===k?.orderId)||null);else if(X?.length>0&&F)S(X.some(Te=>Te.status!=="BID_EXPIRED")?null:X[0]);else if(ee?.length>0&&F){const Te=ee[0];Te.status===un.DELIVERED?S(Te.deliveries[0]):S(Te)}return{bidPacks:X,orderPacks:ee}}catch(V){console.error("Failed to fetch packs from project",V)}return{bidPacks:[],orderPacks:[]}},W=async({projectId:le,packIds:F,deliveryDate:V,poNumber:$,comment:ee,quoteId:X,third_party:G,emailConfirmationPreference:Y,partialPacks:he=[]})=>{if(F.length===0&&he.length===0)return{error:!0,message:"No packs were selected",orders:[]};let ne=`/api/projects/${le}/packs/order`;G&&(ne+="/third_party");try{const J=await nt.Ay.post(ne,{packIds:F,partialPacks:he,deliveryDate:V?.format("YYYY-MM-DD"),poNumber:$,comment:ee,quoteId:X,receiveConfirmationEmail:Y}),{message:pe,orders:Ee}=J.data;return{message:pe,orders:Ee}}catch(J){return J.message?{message:J.response.data.message,orders:[]}:{message:"Error communicating with the server. Please try again",orders:[]}}},N=async(le,F)=>{const V=`/api/projects/${le}/pack_option`,$=vs.getBidPack(k);if(!$?.bidPackId){console.error("Pack ID is missing from selected pack");return}let ee=[];try{B(!0),await nt.Ay.put(V,{selections:F}),ee=(await T(le)).bidPacks}catch(G){console.error(G?.message)}const X=ee.find(G=>G.bidPackId===$.bidPackId);X?S(X):(console.error(`Failed to update packs with new selection. Project Id: ${le}`),y({message:"Failed to update product selection. Please try again later."}),S(null)),B(!1)},O=(le,F,V)=>{!F||!V||C({projectId:String(le),exteriorLineId:F,exteriorQuoteId:V})};return{bidId:r,isPublished:i,bidStarted:c,fetchPacks:T,submitOrders:W,submitLineItemSelection:N,requestBid:async(le,F,V,$,ee,X,G,Y,he)=>{const ne=`/api/projects/${le}/bid_request`;try{if(f(!0),await nt.Ay.post(ne,{notes:$,bidCategories:V,neededByDate:F}),ee.length>0&&(await P(le,ee,Y,he),O(le,X,G)),j){const J=(0,ct.EL)(A)?`/projects/${le}/materials/edit_bid`:`/projects/${le}/materials`;w(J,{replace:!0})}else T(le,!1)}catch{y({message:"There was an error requesting a new bid. Please try again in a few moments."})}f(!1)},requestQuote:async(le,F,V,$,ee,X,G,Y)=>{const he=`/api/projects/${le}/quote_request`;try{if(f(!0),await nt.Ay.post(he,{quoteRequestId:F,bidCategories:V}),$.length>0&&(await P(le,$,G,Y),O(le,ee,X)),j){const ne=(0,ct.EL)(A)?`/projects/${le}/materials/edit_bid`:`/projects/${le}/materials`;w(ne,{replace:!0})}else T(le,!1)}catch{y({message:"There was an error requesting a new quote. Please try again in a few moments."})}f(!1)},bidRequested:p,waitingForSelection:R,bidSummaryHtml:h,fetchBidSummaryPdf:async le=>{const F=`/api/projects/${le}/bid_summary`;try{return(await nt.Ay.get(F))?.data}catch{y({message:"There was an error generating your PDF. Please try again in a few moments."})}},bidSummaryTotal:x,fetchQuotePdf:async le=>{const F=`/api/quotes/${le}/pdf_download`;try{return(await nt.Ay.get(F))?.data}catch{y({message:"There was an error generating your PDF. Please try again in a few moments."})}}}}let Hg=()=>(0,e.jsx)("div",{});Hg=(0,d.lazy)(()=>m.e(680).then(m.t.bind(m,14680,23)).then(t=>({default:t.BidDetails})).catch(t=>(console.error("Error occurred during module federation import",t),{default:Es})));const d2=({company:t,quoteRequestId:n})=>{const{accessToken:s}=(0,Pt.A)();return(0,e.jsx)(d.Suspense,{fallback:(0,e.jsx)(os,{}),children:(0,e.jsx)(Hg,{accessToken:s??"",customerNumber:t.accountNumber,sourceSystem:t.erpSystem,bidId:n.toString()})})},Qg=(t,n=!1)=>n?t:`https://${window.location.host.toLowerCase()==="mybldr.com"||window.location.host.toLowerCase()==="www.mybldr.com"?"mybfs.bldr.com":"stg-mybfs.bldr.com"}/${t}`;function jr(t){const{showError:n}=(0,Fe.d)(),[s,o]=(0,d.useState)(""),[r,a]=(0,d.useState)(!t.overrideBase);return(0,d.useEffect)(()=>{o(Qg(t.urlPath,t.overrideBase))},[t.urlPath,t.overrideBase]),(0,d.useEffect)(()=>{let i;const l=c=>{c.data.status==="ready"?(clearTimeout(i),a(!1)):c.data.status==="error"&&(clearTimeout(i),a(!1),n({title:"Page could not be loaded.",message:"We\u2019re sorry! Please refresh this page, or contact Customer Support if the problem persists."}))};return i=setTimeout(()=>{a(!1)},1e4),window.addEventListener("message",l),()=>{window.removeEventListener("message",l)}},[]),(0,e.jsxs)(e.Fragment,{children:[r&&(0,e.jsx)(ls,{showLoadingScreen:r,dataTestId:"iframe-loading"}),(0,e.jsx)("div",{style:{flex:1,overflowY:"hidden",display:"flex",...t.containerStyle},children:(0,e.jsx)("iframe",{"data-testid":t.dataTestId,src:s,style:r?{display:"none"}:{overflowY:"hidden",...t.iframeStyle},height:"100%",width:"100%",title:t.title},s)})]})}const Gg=(t,n)=>`${An.s[t.erpSystem]}/${t.accountNumber}/plans-projects/view-biddetails?serviceRequestId=${n}&redirect=false&mybldr=true`;function c2(t){const{isFlagEnabled:n}=(0,ut.u)(),{company:s,fetchCompany:o,companyLoading:r}=(0,je.P)();return(0,d.useEffect)(()=>{s?.id===t.companyId||r||o(t.companyId,!0)},[t.companyId,s,r,o]),r||!s?null:n(D.SX.EDIT_BID_FEDERATED_MODULE)?(0,e.jsx)(vo,{children:(0,e.jsx)(d2,{company:s,quoteRequestId:t.quoteRequestId})}):(0,e.jsx)(jr,{urlPath:Gg(s,t.quoteRequestId),dataTestId:"edit-bid-iframe",title:"Edit Bid"})}let Kg=()=>(0,e.jsx)("div",{});Kg=(0,d.lazy)(()=>m.e(680).then(m.t.bind(m,14680,23)).then(t=>({default:t.CustomerSummary})).catch(()=>({default:Es})));const u2=({bidId:t,quoteId:n})=>{const{accessToken:s}=(0,Pt.A)(),{company:o}=(0,je.P)();return o?(0,e.jsx)(vo,{children:(0,e.jsx)(d.Suspense,{fallback:(0,e.jsx)(os,{}),children:(0,e.jsx)(Kg,{bidId:t.toString(),quoteId:n,accessToken:s,customerNumber:o.accountNumber,erpSystem:o.erpSystem})})}):(console.error("Unable to render the CustomerSummary module without company data"),null)},x8=()=>{const{projectId:t}=useParams(),{fetchPacks:n,submitOrders:s,bidId:o,bidStarted:r,isPublished:a,bidSummaryHtml:i,bidSummaryTotal:l}=useMaterialsApi(),{bidPacks:c,orderPacks:u,selectProjectPacksForOrder:p,selectPacksForOrder:f}=usePacks(),{project:h}=useProject(),[b,x]=useSelectedPack(),{showSuccess:v,showError:y}=useToast(),{createEvent:j}=useEventLog(),{userPermissions:A,fetchUserPermissions:w,allRoles:P}=usePermissions(),C=useNavigate(),k=useLocation(),{isCustomerView:S,showLineItemPricing:R,showQuantity:B}=useMaterialsSetting(),{userHasPermission:T,isUserPermissionsLoading:W}=useUserPermissions(),{user:N}=useAuth(),{canViewPage:O}=usePageGuard({tool:ToolName.MATERIALS,action:ActionName.VIEW_BID_ORDERS_AND_DELIVERIES,companyId:h?.companyId,projectId:h?.id},[h?.id,h?.companyId]),z=isSalesUser(P),[Q,re]=useState(!1),[ue,le]=useState(!0),[F,V]=useState(LoadingStates.FIRST_TIME_LOADING),[$,ee]=useState(!1),X=!!c?.length||!!u?.length,[G,Y]=useState(S!==void 0?S:!z),he=T({tool:ToolName.MATERIALS,action:ActionName.VIEW_BID_ORDERS_AND_DELIVERIES,companyId:h?.companyId,projectId:h?.id});useEffect(()=>{if(!W&&Object.keys(A).length===0){w();return}W||h?.companyId===void 0||t&&(he||(setTimeout(()=>{y({message:"You do not have permission to view this page."})},0),C("/select_project")))},[t,W,A,w]),useEffect(()=>{h&&j({content_type:"project",object_id:h.id,tool:"materials"})},[h]),useEffect(()=>{ee(!!o&&o!==1)},[o]);const[ne]=usePersistedState(`receivePurchaseConfirmationEmailPreference_${N?.email}`,{initialState:!0}),J=async(rt,Ue,lt,ge)=>{if(!t||!rt)return;V(LoadingStates.SUBMITTING_ORDER);const We=utils.getBidPack(b),{message:At,orders:xn}=await s({projectId:+t,packIds:Ue?f[t].map(In=>In.bidPackId):We?[We.bidPackId]:[],deliveryDate:rt,poNumber:lt,comment:ge,emailConfirmationPreference:ne}),on=xn.filter(In=>In.orderId==="error");let Xe=!0;if(on?.length===0)Xe=!1,y({message:At});else if(on?.length===1){const In=Ue?f[t].find(Ct=>Ct.bidPackId===on[0]?.packId)?.packName:We?.packName;Xe=!1,y({message:`We're sorry! We could not order ${In}. Here's what we know: ${At}. Please try again and contact Customer Support if the problem persists.`})}else on?.length>1?(Xe=!1,y({message:`We're sorry! We could not order ${on?.length} of your requested packs. Here's what we know: ${At}.
          Please try again and contact Customer Support if the problem persists.`})):v({message:At});const{orderPacks:dt}=await n(+t);if(!Ue&&xn&&xn[0]?.orderId!=="error"){const In=xn[0]?.orderId,Ct=dt?.find(Mt=>Mt.orderId===In);Ct&&x(Ct)}V(LoadingStates.LOADED),re(!1),Xe&&C(`/projects/${t}/materials`,{replace:!0})};useEffect(()=>{const rt=async Ue=>{Ue===LoadingStates.FIRST_TIME_LOADING?(await n(+t,!0),V(LoadingStates.FIRST_TIME_LOADED)):Ue===LoadingStates.SWITCH_PAGE_VIEW&&(V(LoadingStates.LOADING),await n(+t),V(LoadingStates.LOADED))};t&&rt(F)},[t,G]),useEffect(()=>{if(F!==LoadingStates.FIRST_TIME_LOADED||(z&&S===void 0&&u?.some(We=>We.status===OrderPackStatusEnum[OrderPackStatusEnum.ORDER_PENDING]||We.status===OrderPackStatusEnum[OrderPackStatusEnum.ORDER_PROCESSING]||We.status===OrderPackStatusEnum[OrderPackStatusEnum.DELIVERY_SCHEDULED]||We.status===OrderPackStatusEnum[OrderPackStatusEnum.OUT_FOR_DELIVERY]||We.status===OrderPackStatusEnum[OrderPackStatusEnum.DELIVERED]||We.status===OrderPackStatusEnum[OrderPackStatusEnum.UNDELIVERABLE])&&Y(!0),c.length===0&&u.length===0))return;const rt=parsePackFromUrl(k.pathname);if(!rt)return;let Ue,lt="";switch(rt.type){case"bids":lt="bid",Ue=c.find(ge=>ge.bidPackId===rt.id);break;case"orders":lt="order",Ue=u.find(ge=>ge.orderId===rt.id);break;case"deliveries":lt="delivery";for(const ge of u){const We=ge.deliveries.find(At=>At.deliveryId===rt.id);if(We){Ue=We;break}}break}Ue?x(Ue):(y({message:`There was an error retrieving ${lt} #${rt.id}. That ${lt} does not exist in our system.`}),C(`/projects/${t}/materials`,{replace:!0}))},[u,c,F]);const pe=rt=>{Y(rt.target.checked),V(LoadingStates.SWITCH_PAGE_VIEW)},Ee=F===LoadingStates.FIRST_TIME_LOADING||F===LoadingStates.LOADING&&G,Te=()=>{if(Ee)return!1;const rt=!!u&&u.length>0;return!rt&&!r&&!a||!r&&!a&&rt&&!G?!0:rt&&!r&&!a&&!!z&&!G},me=useMemo(()=>utils.containsElevationOptions(c??[]),[c]);function $e(rt){re(!0),le(rt)}const gt=!G&&!Ee&&$&&h,Rt=me&&G&&!Ee&&!Te();return jsxs(Fragment,{children:[jsx(DynamicHeader,{}),O&&jsxs(Fragment,{children:[jsx(LoadingScreen,{showLoadingScreen:Ee}),jsxs(PageContainer,{style:{overflow:"hidden"},children:[jsx(CustomerViewToggle,{visible:z&&($||X),isCustomerViewOn:G,quoteRequestId:o,handleChange:pe}),Te()&&h&&jsx(RequestBid,{project:h}),gt&&jsx(EditBidFrame,{quoteRequestId:o,companyId:h.companyId}),G&&!Ee&&!Te()&&!Rt&&jsxs(MaterialsContainer,{children:[X&&!Te()&&h&&jsx(Packs,{project:h,bidPacks:c,orderPacks:u,openModal:$e,selectedPack:b,setSelectedPack:x,bidSummaryHtml:i,bidSummaryTotal:l,loadingState:F,showLineItemPricing:R,showQuantity:B}),!X&&r&&jsx(BidInProgress,{}),Q&&jsx(PurchasePackModal,{open:Q,closeModal:()=>re(!1),data:{handlePurchasePack:J,loadingState:F,selectedBidPacksToOrder:ue?[b]:p(t),isFromMultiPackSelect:!ue}})]}),Rt&&o&&jsx(ElevationModule,{bidId:o})]})]})]})};var du=m(43756);const Yg=(0,g.Ay)("div")`
  position: relative;
  display: flex;
  flex-direction: column;
  border-radius: 8px;
  overflow: hidden;
`,p2=(0,g.Ay)("div")`
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
  border-bottom: 1px solid black;
`,m2=(0,g.Ay)("div")`
  display: flex;
  margin-bottom: 8px;
  margin-right: 10px;
`,h2=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  gap: 24px;
  align-items: center;
`,y8=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 0;
  align-items: flex-end;
`,b8=(0,g.Ay)(I.A)`
  font-size: 12px;
`,qg=(0,g.Ay)(K.A)`
  background-color: #808180;
  border-radius: 8px;
  font-size: 14px;
  padding: 10px 16px 11px;
  font-family: 'Roboto';
  height: 38px;
  justify-content: center;
  align-items: center;
`,g2=(0,g.Ay)(I.A)`
  font-size: 24px;
  font-weight: 700;
  line-height: 18px;
  color: #333333;
  margin-top: 20px;
`,f2=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  padding: 24px;
  background-color: #fff;
  min-height: 70px;
  flex-wrap: wrap;
  border-radius: 4px;
`,Xg=(0,g.Ay)(I.A)`
  font-size: 20px;
  font-weight: 700;
  font-family: Roboto;
`,cu=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  gap: 8px;
`,x2=(0,g.Ay)(I.A)`
  font-size: 14px;
  font-weight: 400;
`,y2=(0,g.Ay)("ul")`
  list-style-type: disc;
  font-size: 14px;
  font-weight: 400;
  margin: 0;
  max-width: 350px;
`,b2=(0,g.Ay)("ul")`
  list-style: none;
  overflow-y: scroll;
  margin-top: 0;
  width: auto;
`,Jg=(0,g.Ay)(du.A)`
  transform: scale(0.85);
  transform-origin: bottom right;
  border-radius: 0;
  padding: 4px 4px 0 8px;
  height: 50px;
  zindex: 9999;
  align-self: flex-end;
`,v2=(0,g.Ay)("div")`
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 16px;
`,j2=({projectId:t,orderId:n,deliveryId:s,numPhotos:o})=>{const{fetchDeliveryPhotos:r}=(0,On.HO)(),[a,i]=(0,d.useState)([{orderId:"",photos:[],numPhotos:null,firstLoadComplete:!1}]),[l,c]=(0,d.useState)(!1),[u,p]=(0,d.useState)(-1),[f,h]=(0,d.useState)(!1),b=async()=>{h(!0),t&&n&&a[0].photos.length===0&&(i([...a,{orderId:n,photos:[],numPhotos:null,firstLoadComplete:!1}]),await r(t,n,a,i,5e3,s)),h(!1),x(0)},x=y=>{c(!0),p(y)},v=()=>{c(!1),setTimeout(()=>{p(-1)},150)};return o?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Xg,{sx:{alignSelf:"flex-start"},children:"Delivery Photos"}),f?(0,e.jsx)(bt.A,{"data-testid":"delivery-photos-spinner"}):(0,e.jsxs)(cw,{onClick:()=>b(),"data-testid":"delivery-photos-view-button",children:["View Delivery Photos (",o," Total)"]}),a[0].photos&&(0,e.jsx)(Oh,{deliveryPhotos:a.find(y=>y.orderId===n)?.photos,imageIndex:u,setImageIndex:p,isModalOpen:l,closeModal:v})]}):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("p",{children:"No Delivery Photos are available."})})};var A2=m(84743),Zg=m.n(A2);const Qo=(t,n=!1)=>{if(!t)return t;let s;return n?s=Zg()(t,"YYYY-MM-DD"):s=Zg().utc(t).local(),s.isValid()?n?s.format("MM/DD/YYYY"):s.format("MM/DD/YYYY hh:mm A"):t},C2=(0,g.Ay)("div",{shouldForwardProp:t=>t!=="subheaderPresent"})`
  display: flex;
  flex-direction: column;
  text-align: right;
  gap: inherit;
  border-radius: 4px;
`,S2=(0,g.Ay)(I.A)`
  font-size: 16pt;
  font-weight: 600;
`,w2=(0,g.Ay)(I.A)`
  font-size: 14px;
  font-weight: 400;
`,E2=(0,g.Ay)(I.A)`
  font-size: 14px;
  font-weight: 400;
  line-height: normal;
`,uu=t=>{if(!t)return"";const n=dn()(t),s=n.format("MMM").length===3?"dddd, MMM D YYYY":"dddd, MMM. D YYYY";return n.format(s)},P2=(t,n,s)=>{const{status:o}=t,r=vs.getBidPack(t),a=vs.getDeliveryPack(t);function i(l){const c=new Date;return new Date(l)<=c?`Expired ${Qo(l,!0)}`:`Expires ${Qo(l,!0)}`}switch(o){case js.READY_FOR_ORDER:let l="";return r&&nu(r)&&!s?l=r?.totalPrice?(0,Ze.up)(r?.totalPrice):"":r&&!s&&(l=su(r)),{title:l,subheader:l&&!s?"Estimated Price":"",text:r?.expirationDate?i(r?.expirationDate):null,redText:!0};case un.ORDER_PENDING:return{title:"Next Steps",text:"Your order is waiting to be processed by your sales representative."};case un.ORDER_PROCESSING:return{text:"Your order is being processed. Once all procurement activities are complete, you will see the scheduled delivery date appear here."};case un.DELIVERY_IN_PROGRESS:return{text:"Your order is in the process of being delivered. All items listed below are still awaiting delivery. Contact your sales representative with any questions or issues related to this order."};case un.DELIVERY_SCHEDULED:const u=a?a.scheduledDeliveryAt:"";return{title:uu(u),subheader:"Scheduled Delivery Date",text:"Make sure jobsite is ready for delivery."};case un.OUT_FOR_DELIVERY:const p=a?a.scheduledDeliveryAt:"";return{title:uu(p),subheader:"Scheduled Delivery Date",text:"Please make sure the jobsite is ready for delivery."};case un.DELIVERED:let f="";const h=vs.getOrderPack(t);return a?f=a.actualDeliveryAt:h&&h.deliveries&&h.deliveries.length>0&&(f=h.deliveries[0].actualDeliveryAt),{title:uu(f),text:n?"This order has been delivered. Please contact your sales rep with any issues related to this delivery.":"This order has been delivered but not yet invoiced. Quantities are subject to change. Contact your sales representative with any issues related to this delivery."};case js.BID_EXPIRED:return{title:"Submit Order",text:"Contact your sales rep to Refresh your Bid"};case un.CANCELLED:return{title:"Submit Order",text:"Contact your sales rep for details"};case un.UNDELIVERABLE:return{title:"Submit Order",text:"Contact your sales rep for details"};case un.UNKNOWN:default:return{title:"Submit Order",text:"Contact your sales rep for details"}}},I2=({selectedPack:t,grandTotalOnly:n=!1})=>{if(!t)return null;const o=vs.getPackType(t)==="delivery"&&t?.invoices?.length>0,r=P2(t,o,n),{title:a,subheader:i,text:l,redText:c}=r,u=c?{color:"var(--graythorne-reds-red-3)"}:{};return(0,e.jsxs)(C2,{"data-testid":"delivery-status-content",subheaderPresent:!!i,style:{marginRight:"5px"},children:[(0,e.jsx)(S2,{variant:"h5",children:a}),i&&(0,e.jsx)(w2,{children:i}),l&&(0,e.jsx)(E2,{sx:u,children:l})]})};var ef=m(93234);const D2=m.p+"ef1efefa0345d404bd39b588edcc7c2f.svg",tf=(0,g.Ay)("span")`
  font-size: 16px;
  line-height: 16px;
  padding-bottom: 8px;
  color: white;
  font-weight: bold;
  text-align: left;
`,nf=(0,g.Ay)("span")`
  font-size: 12px;
  line-height: 12px;
  color: white;
  text-align: left;
`,k2=(0,g.Ay)(K.A)`
  background-color: gray;
  color: white;
  width: 60%;
  align-self: center;
`,T2=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  padding: 20px;
  background-color: var(--bfs-11-22-nav-background-gray);
  gap: 20px;
`,sf=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
`,R2=()=>(0,e.jsxs)(T2,{children:[(0,e.jsx)("img",{style:{width:"100%"},src:D2,alt:"Stacked Lumber"}),(0,e.jsxs)(sf,{children:[(0,e.jsx)(tf,{children:"Ordering and Scheduling your materials"}),(0,e.jsx)(nf,{children:"Please select a preferred delivery date for the material packs shown. Your OSR will contact you if further clarification on your order is needed."})]}),(0,e.jsxs)(sf,{children:[(0,e.jsx)(tf,{children:"Questions? We\u2019re here to help!"}),(0,e.jsx)(nf,{children:"Our team is always available to assist you at every step of the way, and we are fully committed to providing you with excellent customer service."})]}),(0,e.jsx)(k2,{href:"/help",children:"Get Help"})]}),O2=(0,g.Ay)("p")`
  color: red;
  width: 100%;
  margin: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
`,Io=(0,g.Ay)("span")`
  font-size: 12px;
  font-weight: bold;
  line-height: 1;
  margin-bottom: 4px;
`,M2=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
`,L2=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-self: center;
  gap: 8px;
  width: 100%;
  padding-bottom: 0;
`,F2=(0,g.Ay)("div")`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  border-collapse: collapse;
  padding-bottom: 8px;
  max-height: 200px;
  overflow-y: auto;
`,of=(0,g.Ay)("div")`
  color: #f00;
  font-family: acumin-pro;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: normal;
  align-self: stretch;
`;var ai=m(601);const B2=({open:t,dateError:n,selectedBidPacksToOrder:s,estimatedTotal:o,grandTotalOnly:r,handleDateChange:a,selectedDate:i,isDatePickerOpen:l,setIsDatePickerOpen:c,poNumber:u,setPoNumber:p,notes:f,setNotes:h,maxPOLength:b,getIsQuoteExpired:x,getNoteMaxLength:v,onCloseHandler:y,handleSubmit:j,handleClose:A,allRoles:w,prefersConfirmationEmail:P,saveConfirmationEmailPreference:C,loadingState:k})=>{if(!t)return null;const S=k===ro.FIRST_TIME_LOADING||k===ro.SUBMITTING_ORDER;return(0,e.jsx)(Qn,{open:t,onClose:A,onSubmit:j,modalWidth:"100%",contentHeight:"100dvh",titleBackgroundColor:"transparent",closeButtonColor:"var(--bfs-primary-true-black)",dialogContentPadding:"0 20px 0",title:"Order Summary",titleColor:"var(--bfs-primary-true-black)",fullScreen:!0,titleStyles:{height:"40px",padding:"40px 0",paddingLeft:"18px"},overRideDialogStyles:{"& .MuiDialogActions-root":{borderTop:"1px solid lightgray",justifyContent:"space-around"}},roundedCorners:!0,customFooter:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(K.A,{variant:"outlined",fullWidth:!0,color:"secondary",onClick:y,disabled:S,children:"Cancel"}),(0,e.jsx)(K.A,{variant:"contained",fullWidth:!0,color:"primary",onClick:j,disabled:n||S,children:S?(0,e.jsx)(bt.A,{size:20}):"Finalize Order"})]}),children:(0,e.jsxs)(is,{children:[(0,e.jsx)(E.A,{sx:{borderBottom:"1px solid lightgray",marginBottom:"16px"},children:s.map((R,B)=>(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"15px"},children:[(0,e.jsx)(I.A,{variant:"body1",color:"var(--chip-secondary-text)",children:R.bidPack.packName}),(0,e.jsx)(I.A,{variant:"body1",fontWeight:500,children:r?null:(0,Ze.up)(R.totalPrice)})]},B))}),(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"25px"},children:[(0,e.jsx)(I.A,{variant:"body1",fontSize:20,fontWeight:500,color:"var(--chip-secondary-text)",children:"Estimated Total"}),(0,e.jsx)(I.A,{variant:"body1",fontSize:20,fontWeight:500,children:(0,Ze.up)(o)})]}),(0,e.jsx)(E.A,{children:(0,e.jsxs)(Be.A,{"data-testid":"delivery-date-picker",fullWidth:!0,required:!0,sx:{height:"48px",padding:0,marginBottom:"35px"},children:[(0,e.jsx)(Io,{sx:{fontWeight:500,fontSize:"16px",marginBottom:"10px"},children:"Requested Delivery Date*"}),(0,e.jsx)(Xn.LocalizationProvider,{dateAdapter:ai.R,children:(0,e.jsx)(Xn.DatePicker,{onChange:a,value:i,open:l,onClose:()=>c(!1),views:["day"],disablePast:!0,desktopModeMediaQuery:"(min-width:0px)",slots:{openPickerIcon:Nr.A},slotProps:{textField:{sx:{".MuiInputBase-input":{height:"7px"}},variant:"outlined",onClick:R=>{c(!0)}}}})})]})}),(0,e.jsx)(E.A,{children:(0,e.jsxs)(Be.A,{fullWidth:!0,sx:{height:"48px",padding:0,marginBottom:"20px"},children:[(0,e.jsx)(Io,{sx:{fontWeight:500,fontSize:"16px",marginBottom:"10px"},children:"Purchase Order #"}),(0,e.jsx)(_.A,{id:"po-number","data-testid":"po-number-textbox",variant:"outlined",placeholder:"Enter a PO for reference",value:u,onChange:R=>p(R.target.value.toUpperCase()),InputLabelProps:{style:{marginLeft:"1rem"}},inputProps:{sx:{height:"7px"},maxLength:b},error:u.length>=b,helperText:u.length>=b?"Max characters reached":""})]})}),(0,e.jsxs)(Be.A,{"data-testid":"notes-textfield",sx:{gap:"8px",margin:"16px 0"},fullWidth:!0,children:[x()&&(0,e.jsx)(of,{children:"The requested delivery date selected is past the quote expiration. Pricing may need to be adjusted and confirmed. You will be contacted by your Sales Rep if any adjustments are required."}),(0,e.jsx)(Io,{sx:{fontWeight:500,fontSize:"16px"},children:"Notes"}),(0,e.jsx)(_.A,{id:"notes",placeholder:"Include any notes to expedite your request and assist with delivery.",multiline:!0,variant:"outlined",rows:4,value:f,onChange:R=>h(R.target.value),inputProps:{maxLength:v()},error:f.length>=v(),helperText:f.length>=v()?"Max characters reached":""})]}),(0,ct.EL)(w)&&(0,e.jsxs)(Be.A,{sx:{display:"flex",gap:"8px",flexDirection:"row",alignItems:"center"},children:[(0,e.jsx)(Io,{sx:{fontWeight:500,fontSize:"16px"},children:"Copy me on the order confirmation email"}),(0,e.jsx)(ve.A,{id:"confirmation-email-preference",defaultChecked:!0,checked:P,onChange:R=>C(R.target.checked)})]})]})})},N2=({visible:t})=>t?(0,e.jsx)(Rs.A,{severity:"info",sx:{backgroundColor:"#E9F5FB",color:"#176F98",marginTop:"16px",marginBottom:"16px","& .MuiAlert-icon":{color:"#176F98"},"& .MuiAlert-message":{lineHeight:"20px",fontFamily:"Roboto",fontSize:"14px"}},children:"This order contains partial packs. Please review your order carefully before submitting."}):null,Bl=({children:t,gridPosition:n,row:s=0})=>(0,e.jsx)(I.A,{flex:1,padding:"8px",variant:"body1",align:n===0?"left":"right",sx:{border:"solid 1px #c8c8c8",borderRight:n===0?"none":void 0,borderTop:s===0?void 0:"none"},style:{lineHeight:"1.1",gridColumn:n===0?1/2:2/3,flexDirection:"column",gap:"8px",display:"flex"},children:t}),_2=({selectedPacksToOrder:t,grandTotalOnly:n,estimatedTotal:s})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Io,{children:"Order Summary"}),(0,e.jsxs)(F2,{children:[t.map((o,r)=>{const a=Object.keys(o.lineItems).length,i=a!==o.totalOrderableLineItems;return(0,e.jsxs)(se().Fragment,{children:[(0,e.jsxs)(Bl,{gridPosition:0,row:r,children:[o?.bidPack.packName,i&&(0,e.jsx)(I.A,{sx:{fontSize:"12px",fontWeight:600,color:"#5D6062"},children:`Partial Pack (${a}/${o.totalOrderableLineItems})`})]}),(0,e.jsx)(Bl,{gridPosition:1,row:r,children:n?null:(0,Ze.up)(o?.totalPrice)})]},`purchase-bid-item-${o?.bidPackId}`)}),(0,e.jsx)(Bl,{gridPosition:0,row:t.length+1,children:"Estimated Total"}),(0,e.jsx)(Bl,{gridPosition:1,row:t.length+1,children:(0,Ze.up)(s)})]})]}),U2=({handleSubmit:t,handleClose:n,open:s,dateError:o,modalWidth:r,loadingState:a,purchaseHelpContent:i,selectedBidPacksToOrder:l,hasPartialPackOrders:c,grandTotalOnly:u,estimatedTotal:p,handleDateChange:f,selectedDate:h,isDatePickerOpen:b,setIsDatePickerOpen:x,poNumber:v,setPoNumber:y,maxPOLength:j,getIsQuoteExpired:A,notes:w,setNotes:P,getNoteMaxLength:C,allRoles:k,prefersConfirmationEmail:S,saveConfirmationEmailPreference:R})=>(0,e.jsx)(Qn,{onSubmit:t,onClose:n,open:s,hasCloseButton:!0,testId:"purchase-packs-modal",submitText:"Submit Order",disabled:o,modalWidth:r,loading:a===ro.FIRST_TIME_LOADING||a===ro.SUBMITTING_ORDER,SideContent:i,hideCloseButton:!0,titleBackgroundColor:"transparent",closeButtonColor:"var(--bfs-primary-true-black)",dialogContentPadding:"0 20px 0",flexrowStyle:{overflow:"hidden"},children:(0,e.jsxs)(M2,{children:[(0,e.jsxs)(L2,{children:[(0,e.jsxs)(E.A,{"data-testid":"purchase-header",children:[(0,e.jsx)(I.A,{align:"center",variant:"h6",fontWeight:"normal",children:"Schedule Delivery for"}),(0,e.jsx)(I.A,{"data-testid":"pack-order-title",padding:"0 0 20px 0",align:"center",variant:"h5",fontWeight:"bold",children:l.length===1?l[0]?.bidPack.packName:"Multiple Packs"})]}),(0,e.jsx)(E.A,{children:(0,e.jsx)(N2,{visible:c})}),(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,e.jsx)("div",{style:{flex:2,paddingRight:"40px",display:"flex",flexDirection:"column"},children:(0,e.jsx)(_2,{selectedPacksToOrder:l,grandTotalOnly:u,estimatedTotal:p})}),(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",width:"200px"},children:[(0,e.jsx)(Io,{children:"Requested Delivery Date*"}),(0,e.jsx)(Be.A,{"data-testid":"delivery-date-picker",fullWidth:!0,required:!0,sx:{height:"48px",padding:0},style:{padding:0,width:"100%"},children:(0,e.jsx)(Xn.LocalizationProvider,{dateAdapter:ai.R,children:(0,e.jsx)(Xn.DatePicker,{onChange:f,value:h,open:b,onClose:()=>x(!1),views:["day"],disablePast:!0,components:{OpenPickerIcon:Nr.A},slotProps:{textField:{sx:{".MuiInputBase-input":{height:"7px"}},variant:"outlined",InputLabelProps:{style:{marginLeft:"1rem"}},onClick:B=>{x(!0)}}}})})}),(0,e.jsx)(Io,{children:"Purchase Order #"}),(0,e.jsx)(_.A,{id:"po-number","data-testid":"po-number-textbox",variant:"outlined",placeholder:"Enter a PO for reference",value:v,onChange:B=>y(B.target.value.toUpperCase()),InputLabelProps:{style:{marginLeft:"1rem"}},inputProps:{sx:{height:"7px"},maxLength:j},error:v.length>=j,helperText:v.length>=j?"Max characters reached":""})]})]}),(0,e.jsxs)(Be.A,{"data-testid":"notes-textfield",sx:{gap:"8px",marginTop:"16px"},children:[A()&&(0,e.jsx)(of,{children:"The requested delivery date selected is past the quote expiration. Pricing may need to be adjusted and confirmed. You will be contacted by your Sales Rep if any adjustments are required."}),(0,e.jsx)(Io,{children:"Notes"}),(0,e.jsx)(_.A,{id:"notes",label:"Include any notes to expedite your request and assist with delivery.",placeholder:"",multiline:!0,variant:"outlined",rows:2,value:w,onChange:B=>P(B.target.value),inputProps:{maxLength:C()},error:w.length>=C(),helperText:w.length>=C()?"Max characters reached":"",sx:{"& .MuiFormHelperText-root":{marginLeft:0}}})]}),(0,ct.EL)(k)&&(0,e.jsxs)(Be.A,{sx:{display:"flex",gap:"8px",flexDirection:"row",alignItems:"center"},children:[(0,e.jsx)(Io,{children:"Copy me on the order confirmation email"}),(0,e.jsx)(ve.A,{id:"confirmation-email-preference",defaultChecked:!0,checked:S,onChange:B=>R(B.target.checked)})]})]}),(0,e.jsx)(O2,{children:a===ro.SUBMITTING_ORDER?(0,e.jsx)(e.Fragment,{children:"Please wait while your order is processing. This can take up to 60 seconds."}):(0,e.jsx)("br",{})})]})}),oa=()=>{const t=(0,Pn.wA)(),{project:n}=(0,De.B)(),s=(0,Pn.d4)(u=>u.materials.packsForOrder);return{selectedPacksForOrder:(0,d.useMemo)(()=>n?.id?s[n?.id]:void 0,[n?.id,s]),addProjectPacksToOrder:(u,p)=>{t(Hk({projectId:u,packs:p}))},addToPacksForOrder:(u,p)=>{t(Uk({projectId:u,pack:p}))},removeFromPacksForOrder:(u,p)=>{t(Wk({projectId:u,bidPackId:p}))},resetSelectedPacksForOrder:u=>{t(Ug({projectId:u}))},selectLineItemToOrder:(u,p,f,h)=>{t(h==="add"?Qk({projectId:u,pack:p,lineItemId:f}):Gk({projectId:u,pack:p,lineItemId:f}))}}},W2=({open:t,closeModal:n,data:s,grandTotalOnly:o})=>{const r=(0,Dt.A)(),{company:a}=(0,je.P)(),{user:i}=(0,Pt.A)(),{allRoles:l}=(0,Ye.A)(),[c,u]=(0,d.useState)(""),[p,f]=(0,d.useState)(null),[h,b]=(0,d.useState)(!0),[x,v]=(0,d.useState)(!1),[y,j]=(0,d.useState)(""),A=(0,No.A)(r.breakpoints.down("md")),{resetSelectedPacksForOrder:w}=oa(),{project:P}=(0,De.B)(),C=P?.id?String(P.id):void 0,[k,S]=fo(`receivePurchaseConfirmationEmailPreference_${i?.email}`,{initialState:!0}),{loadingState:R,handlePurchasePack:B,selectedBidPacksToOrder:T,isFromMultiPackSelect:W}=s,{width:N}=(0,ef.A)(),O=T.reduce((G,Y)=>G+Number(Y?.totalPrice),0),z=(0,d.useMemo)(()=>T.some(G=>Object.keys(G.lineItems).length!==G.totalOrderableLineItems),[T]),Q=G=>{const Y=dn()(dn()().format("YYYY-MM-DD"));(G?.isSame(Y)||G?.isAfter(Y))&&G?.isValid()?b(!1):b(!0),f(G),v(!1)},re=()=>{C&&w(C),v(!1),f(null),n()};if((0,d.useEffect)(()=>{R===ro.LOADED&&f(null)},[R]),!T||T.length===0)return null;const ue=N&&N>1199?"890px":"510px",le=()=>{if(p)return T.filter(Y=>Y).some(Y=>dn()(Y.bidPack.expirationDate).isBefore(p))},F=()=>{let G=!1,Y=200;return T.every(he=>he.bidPack.erpSystem===null)?(G=a?.erpSystem===An.v.AS400,G?Y=24:Y=200):(G=T.every(he=>he.bidPack.erpSystem?.toUpperCase().includes(An.v.AS400.valueOf())),G?Y=24:Y=200),Y},V=G=>{S(G)},$=a?.erpSystem===An.v.SAPS4HANA?35:16,ee=async()=>{await B(p,W,c===""?void 0:c,y===""?void 0:y,k),re()},X=()=>R===ro.SUBMITTING_ORDER?()=>{}:re;return A?(0,e.jsx)(B2,{open:t,dateError:h,selectedBidPacksToOrder:T,estimatedTotal:O,grandTotalOnly:o,handleDateChange:Q,selectedDate:p,isDatePickerOpen:x,setIsDatePickerOpen:v,poNumber:c,setPoNumber:u,notes:y,setNotes:j,maxPOLength:$,getIsQuoteExpired:le,getNoteMaxLength:F,prefersConfirmationEmail:k,onCloseHandler:re,handleSubmit:ee,handleClose:X(),allRoles:l,saveConfirmationEmailPreference:V,loadingState:R}):(0,e.jsx)(U2,{handleSubmit:ee,handleClose:X(),open:t,dateError:h,modalWidth:ue,loadingState:R,purchaseHelpContent:R2,selectedBidPacksToOrder:T,hasPartialPackOrders:z,grandTotalOnly:o,estimatedTotal:O,handleDateChange:Q,selectedDate:p,isDatePickerOpen:x,setIsDatePickerOpen:v,poNumber:c,setPoNumber:u,maxPOLength:$,getIsQuoteExpired:le,notes:y,setNotes:j,getNoteMaxLength:F,allRoles:l,prefersConfirmationEmail:k,saveConfirmationEmailPreference:V})},z2=({selectedPack:t})=>{const n=(0,d.useMemo)(()=>t?Ml(t).filter(r=>br(r.lineItem)&&r.lineItem.description).map(r=>r.lineItem.description+(r.lineItem.comments?` ${r.lineItem.comments?.join(" ")}`:"")):[],[t]);return(0,e.jsxs)(cu,{children:[(0,e.jsx)(Xg,{children:"Comments"}),n.length>0?(0,e.jsx)(y2,{children:n.map((s,o)=>(0,e.jsx)("li",{children:s},o))}):(0,e.jsx)(x2,{children:"None"})]})},V2=({selectionsNeeded:t,selectedPack:n,company:s,openOrderModal:o,allowedToPurchase:r,grandTotalOnly:a=!1})=>{const{isFlagEnabled:i}=(0,ut.u)(),l=()=>{n?.status===js.READY_FOR_ORDER&&o(!0)},{isQuotesEnabled:c}=ta(),u=n?.expirationDate,p=t||ea(u)||!r;return(0,e.jsxs)(p2,{children:[(0,e.jsxs)(m2,{children:[(0,e.jsx)(g2,{role:"heading",children:n?.packName}),i(D.SX.TAX_DETAILS)&&n?.taxDetails&&(0,e.jsx)("pre",{children:JSON.stringify(n?.taxDetails,null,2)})]}),(0,e.jsx)(h2,{children:s&&(0,e.jsx)(RO,{status:n?.status,onClick:l,disablePurchase:p,grandTotalOnly:a})})]})},pu=()=>{const[t,n]=fo("isQuoteGridView",{initialState:!1}),{updatePackGridView:s,setInitialGridView:o,isGridView:r}=Fl();(0,d.useEffect)(()=>{o(t)},[o]);const a=(0,d.useCallback)(i=>{s(),n(i)},[s,n]);return{isGridView:r,handleIconClick:a}},$2=({handleOpenModal:t,selectedPack:n,project:s,grandTotalOnly:o=!1})=>{const{company:r,fetchCompany:a}=(0,je.P)(),{isFlagEnabled:i}=(0,ut.u)(),{userHasPermission:l}=(0,Ye.A)(),{isGridView:c}=pu(),u=()=>s?!l({tool:D.w5.MATERIALS,action:D.a2.PURCHASE,companyId:s.companyId,projectId:s.id}):!1;(0,d.useEffect)(()=>{!r&&s&&a(s.companyId)},[s]);const p=()=>{if(!n)return!1;const b=vs.getBidPack(n),x=b?b?.groupedItemOptions:[];for(let v=0;v<(x?.length||0);v++)if(!x?.[v].lineItems?.some(j=>j.isItemConfirmed))return!0;return!1},f=()=>{const b=vs.getDeliveryPack(n);return b&&b.orderId&&b.status===un.DELIVERED?(0,e.jsx)(j2,{projectId:s?.id,orderId:b?.orderId,deliveryId:b?.deliveryId,numPhotos:b?.numPhotos}):null},h=p();return n&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Yg,{children:[(0,e.jsx)(V2,{selectionsNeeded:h,selectedPack:n,company:r,allowedToPurchase:!u(),grandTotalOnly:o,openOrderModal:t}),i(D.SX.TAX_DETAILS)&&n?.taxDetails&&(0,e.jsx)("pre",{children:JSON.stringify(n?.taxDetails,null,2)}),(0,e.jsxs)(f2,{children:[c&&(0,e.jsx)(z2,{selectedPack:n}),(0,e.jsx)(cu,{sx:{alignItems:"center",textAlign:"left"},children:(0,e.jsx)(f,{})}),(0,e.jsxs)(cu,{sx:{alignItems:"flex-end",maxWidth:265,minWidth:100},children:[(0,e.jsx)(I2,{selectedPack:n,grandTotalOnly:o}),(0,e.jsx)("div",{style:{height:20}})]})]})]}),h&&(0,e.jsx)(QS,{"data-testid":"packSelectionsNeededBanner",children:"Alternate products exist for this pack. Please review and select your preferred products."})]})};var H2=m(35273);const S8=(0,g.Ay)("div")`
  width: 40%;
  height: 30%;
  backgroundcolor: lightgrey;
  margin: auto;
`,Q2=(0,g.Ay)("article")`
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
`,G2=(0,g.Ay)("p")`
  width: 470px;
  flex-grow: 0;
  font-family: acumin-pro;
  font-size: 18px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  margin: 0 auto 24px;
  text-align: center;
  color: var(--common-black-100-p);
`,K2=(0,g.Ay)("div")`
  position: relative;
`,Y2=(0,g.Ay)("div")`
  position: absolute;
  top: 0;
  left: 0;
  width: 40px;
  height: 30px;
  background-color: var(--graythorne-blues-blue-1);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1;
`,q2=(0,g.Ay)(H2.A)`
  color: white;
`,X2=({isOpen:t,closeModal:n,alternateProductGroup:s})=>{const{project:o}=(0,De.B)(),{submitLineItemSelection:r,waitingForSelection:a}=sa(),[i,l]=(0,d.useState)(s?.lineItems?s?.lineItems?.find(p=>p&&p.isItemConfirmed)||s?.lineItems?.find(p=>p&&p.isItemSelected)||s?.lineItems?.[0]:null);if(!i)return null;const c=p=>{l(p)},u=async()=>{if(!o||!i)return;const p=s.lineItems.map(f=>{const h=f.lineNumber===i.lineNumber;return{lineNumber:f.lineNumber,isItemSelected:h,isItemConfirmed:h}});try{await r(o.id,p)}catch(f){console.error("Could not submit selections, ",f)}n()};return(0,e.jsx)(Qn,{testId:"alternate-products-modal",open:t,onClose:n,title:"Alternate Product Choices",loading:a,modalWidth:"980px",customFooter:(0,e.jsx)("div",{style:{margin:"auto",paddingBottom:"24px"},children:(0,e.jsx)(K.A,{variant:"contained",onClick:u,children:a?(0,e.jsx)(bt.A,{}):"Use Selected"})}),children:(0,e.jsxs)("section",{style:{padding:"24px 24px 0"},children:[(0,e.jsx)(G2,{children:"Select your preferred product from the alternates below."}),(0,e.jsx)(Q2,{children:s.lineItems.map(p=>(0,e.jsxs)(K2,{"data-testid":`line-item-alternate-option-${p.lineNumber}`,children:[(0,e.jsx)(mu,{lineItem:p,isFromOrderPack:!1,onClick:()=>c(p)}),p.lineNumber===i.lineNumber&&(0,e.jsx)(Y2,{children:(0,e.jsx)(q2,{})})]},`line-item-alternate-option-${p.lineNumber}`))})]})})};var xt=m(70691);const J2=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  flex-direction: horizontal;
  padding: 0px 24px 0 24px;
  align-items: stretch;
  overflow: hidden;
`,rf=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  gap: 4px;
  overflow-y: auto;

  @media (max-width: 899px) {
    width: 100%;
    gap: 16px;
    scrollbar-width: none;
    overflow-y: unset;
  }
`,af=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  padding: 16px 24px;
  gap: 12px;
  justify-content: space-between;

  @media (max-width: 899px) {
    width: 100%;
    box-sizing: border-box;
    padding: 12px 16px;
    gap: 12px;
    border-radius: 4px;
    border: 1px solid var(--Colors-Border-border-secondary, #eff0f0);
    background: var(--Colors-Background-bg-primary, #fff);
  }
`,lf=(0,g.Ay)("div")`
  font-family: 'Roboto', sans-serif;
  font-size: 16px;
  font-weight: 500;
  color: #5d6062;
  line-height: 24px;

  @media (max-width: 899px) {
    font-size: 12px;
    font-weight: 500;
    line-height: 16px;
    font-style: normal;
  }
`,w8=(0,g.Ay)(K.A)`
  color: #bdbdbd;
  text-decoration: underline;
  text-decoration-color: #bdbdbd;
  text-decoration-style: solid;
  cursor: pointer;
`,Ar=(0,g.Ay)(xt.A)`
  background-color: black;
  color: white;
  border-bottom: none;

  @media (max-width: 899px) {
    background-color: #fafafa;
    color: var(--Colors-Text-text-tertiary, #636769);
    font-feature-settings: 'liga' off, 'clig' off;
    font-size: 12px;
    font-style: normal;
    font-weight: 400;
    line-height: 16px;
    padding: 0px;
  }
`,ii=(0,g.Ay)(xt.A)`
  background-color: black;
  color: white;
  border-bottom: none;
  text-align: right;

  @media (max-width: 899px) {
    background-color: #fafafa;
    color: var(--Colors-Text-text-primary, #0b0c0d);
    font-feature-settings: 'liga' off, 'clig' off;
    font-size: 12px;
    font-style: normal;
    font-weight: 400;
    line-height: 16px;
    padding: 0px;
  }
`,df=(0,g.Ay)("div")`
  font-family: 'Roboto', sans-serif;
  font-size: 30px;
  font-weight: 700;
  line-height: 36px;

  @media (max-width: 899px) {
    font-size: 24px;
    font-weight: 600;
    line-height: 32px;
    letter-spacing: 0.25px;
  }
`,cf=(0,g.Ay)(K.A)`
  display: flex;
  height: 36px;
  width: 100%;
  font-size: 14px;
  flex-grow: 0;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 8px;
  padding: 0 16px;
  border-radius: 4px;
  color: var(--bfs-primary-true-white);
  background-color: #1d6bcd;
  font-weight: 500;

  &:hover {
    background-color: #1d6bcd;
  }

  @media (max-width: 899px) {
    width: auto;
  }
`,Z2=(0,g.Ay)("div")`
  font-family: 'Roboto', sans-serif;
  font-size: 16px;
  font-weight: 500;
  line-height: 24px;
  color: #5d6062;
  margin-bottom: 8px;
`,uf=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  padding: 0 24px;
  gap: 8px;

  @media (max-width: 899px) {
    padding: 0;
    gap: 0px;
    border: 1px solid var(--light-secondary-light);
    border-radius: 4px;
    overflow: hidden;
    /* &:first-child {
      border-top-left-radius: 4px;
      border-top-right-radius: 4px;
    }
    &:last-child {
      border-bottom-left-radius: 4px;
      border-bottom-right-radius: 4px;
    } */
  }
`,pf=(0,g.Ay)("div")`
  flex: 1;
  overflow-y: auto;
`,E8=(0,g.Ay)("div")`
  grid-column: 2 / 13;
  grid-row: 1 / 2;
`,eT=(0,g.Ay)("div")`
  box-sizing: border-box;
  grid-column: 2 / 13;
  grid-row: 2 / 3;
  background-color: #f1f2f2;
  padding: 30px;
  overflow: auto;
  margin-top: 15px;
  border-radius: 4px;
  border: 1px solid #e3e4e5;
`,tT=(0,g.Ay)("div")`
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 24px;
  grid-auto-rows: minmax(200px, auto);

  @media (max-width: 1538px) {
    grid-template-columns: repeat(4, 1fr);
  }

  @media (max-width: 1199px) {
    grid-template-columns: repeat(3, 1fr);
  }
  @media (max-width: 916px) {
    grid-template-columns: repeat(2, 1fr);
  }
  @media (max-width: 599px) {
    grid-template-columns: repeat(1, 1fr);
  }
`;var nT=(t=>(t.IL="IL",t.LC="LC",t.IS="IS",t.IC="IC",t.FC="FC",t.CO="CO",t))(nT||{});function sT(t){const[n,s]=(0,d.useState)(!0);return(0,d.useEffect)(()=>{const o=["IL","LC","IS","IC","FC","CO"],r=t.selectedPack?t.selectedPack.DocType:null;o.includes(r)?s(!1):s(!0)},[t]),(0,e.jsx)(e.Fragment,{children:n&&(0,e.jsx)(eT,{"data-testid":"pack-order-line-items-grid-container",children:(0,e.jsxs)(tT,{children:[(0,e.jsx)(rT,{groupedLineItems:t.groupedLineItems,showLineItemPricing:t.showLineItemPricing,showQuantity:t.showQuantity,isLineItemSelected:t.isLineItemSelected,toggleLineItem:t.toggleLineItem,partialPackOrderEnabled:t.partialPackOrderEnabled}),(0,e.jsx)(aT,{singleLineItems:t.singleLineItems,showLineItemPricing:t.showLineItemPricing,showQuantity:t.showQuantity,invoiceQuantitiesLoading:t.invoiceQuantitiesLoading,isLineItemSelected:t.isLineItemSelected,toggleLineItem:t.toggleLineItem,partialPackOrderEnabled:t.partialPackOrderEnabled})]})})})}function oT(t,n){return t.filter(s=>n?!br(s):!0)}function rT({groupedLineItems:t,showLineItemPricing:n,showQuantity:s,partialPackOrderEnabled:o=!1,isLineItemSelected:r,toggleLineItem:a}){const i=[];return t.forEach(l=>{const c=l.lineItems.some(u=>r(u));i.push((0,e.jsx)(mu,{itemSelectionGroupName:l.itemSelectionGroupName,lineItems:oT(l.lineItems,l.isFromOrderPack),isFromOrderPack:!1,onClick:l.onClick,showLineItemPricing:n,showQuantity:s,isSelected:c,showSelectToggle:o,toggleLineItem:a},l.itemSelectionGroupName))}),(0,e.jsx)(e.Fragment,{children:i})}function aT({singleLineItems:t,showLineItemPricing:n,showQuantity:s,invoiceQuantitiesLoading:o,isLineItemSelected:r,toggleLineItem:a,partialPackOrderEnabled:i}){const l=[];return t.filter(u=>!br(u.lineItem)).forEach(({lineItem:u,isFromOrderPack:p,showUnconverted:f},h)=>{l.push((0,e.jsx)(mu,{lineItem:u,isFromOrderPack:p,showUnconverted:f,showLineItemPricing:n,showQuantity:s,invoiceQuantitiesLoading:o,isSelected:r(u),showSelectToggle:i,toggleLineItem:a},`${u.sku}-${h}`))}),(0,e.jsx)(e.Fragment,{children:l})}var ra=m(64137),iT=m(16023),li=m(43884),di=m(96627),Zn=m(86798);function lT(t){const s=t.packType==="bid"?6:5;return(0,e.jsxs)(Zn.A,{children:[t.showSelectToggle&&(0,e.jsx)(xt.A,{sx:{width:"50px"}}),(0,e.jsx)(xt.A,{component:"th",scope:"row",children:t.lineItem.description}),(0,e.jsx)(xt.A,{component:"td",colSpan:s,children:t.lineItem.comments?.map((o,r)=>(0,e.jsx)("div",{children:o},r))})]})}function dT(t){const n=t.packType==="bid",s=br(t.lineItem),o=t.mode===Sr.DRAWER,r=vr(t.lineItem,t.showUnconverted);let a;t.isFromOrderPack?a=t.lineItem.quantityRemaining:t.showUnconverted?a=t.lineItem.unconvertedQuantity:a=t.lineItem.quantity;let i;t.lineItem.unitOfMeasure?i=t.lineItem.unitOfMeasure:t.lineItem.unitOfMeasurement&&(i=t.lineItem.unitOfMeasurement);let l=null;return t.lineItem.sku===null?l=null:l=ru(t.lineItem,t.showUnconverted),s?(0,e.jsx)(lT,{...t}):(0,e.jsxs)(Zn.A,{children:[t.showSelectToggle&&(0,e.jsx)(xt.A,{sx:{width:"50px"},children:t.showSelectToggle&&(0,e.jsx)(ve.A,{checked:t.isSelected??!1,onChange:()=>t.toggleLineItem&&t.toggleLineItem(t.lineItem)})}),(0,e.jsx)(xt.A,{children:t.lineItem.sku}),(0,e.jsxs)(xt.A,{children:[(0,e.jsx)("div",{style:{fontWeight:400,fontSize:"14px",lineHeight:"20px"},children:t.lineItem.description}),Array.isArray(t.lineItem.comments)&&t.lineItem.comments?.map((c,u)=>(0,e.jsx)("div",{children:c},u)),t.lineItem.tallyMeasurements?(0,e.jsx)("div",{style:{display:"flex"},children:oi(t.lineItem.tallyMeasurements).map((c,u)=>(0,e.jsxs)("div",{style:{fontSize:"12px",color:"#3E4041"},children:[c,"\xA0"]},u))}):null]}),n&&!o&&t.showAlternateProducts&&(0,e.jsx)(xt.A,{children:"-"}),!t.isQuantityHidden&&(0,e.jsx)(xt.A,{children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[t.invoiceQuantitiesLoading?(0,e.jsx)(Mn.A,{variant:"text",sx:{width:"15px"}}):(0,e.jsx)("span",{children:a}),i&&(0,e.jsxs)("span",{children:["/",i]})]})}),!t.isPriceHidden&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(xt.A,{children:[(0,Ze.up)(r),l&&(0,e.jsxs)("span",{children:["/",l]})]}),(0,e.jsx)(xt.A,{children:t.lineItem.price!=null?si(t.lineItem,t.showUnconverted):""})]})]})}function P8(t,n){const o=n===ListViewRenderMode.DRAWER?"#F7F7F7":"#F3f3f3";return t%2===0?"inherit":o}function cT(t){const n=t.mode===Sr.DRAWER,s=Rl(t.lineItems),o=t.showAltProducts?{text:"Additional Choices",style:{color:"#3183FE",textDecoration:"underline"}}:{text:"Selection Required",style:{color:"#FF0000",textDecoration:"underline"}},r=vr(s,t.showUnconverted);return(0,e.jsxs)(Zn.A,{onClick:t.onClick,children:[t.showSelectToggle&&(0,e.jsx)(xt.A,{sx:{width:"50px"},children:(0,e.jsx)(ve.A,{checked:t.isSelected??!1,onChange:()=>t.toggleLineItem&&s&&t.toggleLineItem(s),onClick:a=>a.stopPropagation()})}),(0,e.jsx)(xt.A,{component:"th",scope:"row",children:s?.sku}),(0,e.jsxs)(xt.A,{align:"left",children:[(0,e.jsx)("div",{style:{fontWeight:700,fontSize:"14px",lineHeight:"16.41px"},children:s?.description}),s?.comments?.map((a,i)=>(0,e.jsx)("div",{children:a},i)),s?.tallyMeasurements?(0,e.jsx)("div",{style:{display:"flex"},children:oi(s?.tallyMeasurements).map((a,i)=>(0,e.jsxs)("div",{style:{fontSize:"12px",color:"#3E4041"},children:[a,"\xA0"]},i))}):null]}),(0,e.jsx)(xt.A,{style:o.style,sx:{"&:hover":{cursor:"pointer"}},children:o.text}),!t.isQuantityHidden&&(0,e.jsx)(xt.A,{children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[t.showUnconverted?s?.unconvertedQuantity:t.invoiceQuantitiesLoading?(0,e.jsx)(Mn.A,{variant:"text",sx:{width:"15px"}}):(0,e.jsx)("span",{children:s?.quantity??""}),s?.unitOfMeasure&&(0,e.jsxs)("span",{children:["/",s?.unitOfMeasure]})]})}),!t.isPriceHidden&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(xt.A,{children:[(0,Ze.up)(r),s?.pricingUnitOfMeasure&&(0,e.jsxs)("span",{children:["/",s?.pricingUnitOfMeasure]})]}),(0,e.jsx)(xt.A,{children:s?.price!=null&&s?.price!==void 0?si(s,t.showUnconverted):"N/A"})]})]},`${t.itemSelectionGroupName}-${t.index}`)}var uT=(t=>(t.IL="IL",t.LC="LC",t.IS="IS",t.IC="IC",t.FC="FC",t.CO="CO",t))(uT||{});function mf(t){const{company:n}=(0,je.P)(),s=!!n?.isPoCustomer,o=(0,d.useRef)(-1);o.current=-1;const r=t.mode===Sr.DRAWER,[a,i]=(0,d.useState)(!0),l=t.groupedLineItems.length>0&&t.groupedLineItems.some(h=>h.lineItems.some(b=>b.isItemConfirmed===!0)),c=t.showPriceSetting??!0,u=t.showQuantitySetting??!0,p=!!(s||!c),f=!u;return(0,d.useEffect)(()=>{const h=["IL","LC","IS","IC","FC","CO"],b=t.selectedPack?t.selectedPack.DocType:null;h.includes(b)?i(!1):i(!0)},[t]),(0,e.jsx)("div",{"data-testid":"pack-order-line-items-list-container",style:{backgroundColor:"var(--bfs-primary-true-white)",padding:r?0:"15px",marginTop:r?0:"15px",overflowY:"scroll",borderRadius:"4px"},children:a&&(0,e.jsxs)(ra.A,{sx:r?{[`& .${iT.A.root}`]:{borderBottom:"none"}}:void 0,children:[(0,e.jsx)(pT,{packType:t.packType,showAltProducts:l,mode:t.mode,isPriceHidden:p,isQuantityHidden:f,partialPackOrderEnabled:t.partialPackOrderEnabled}),(0,e.jsxs)(li.A,{children:[t.groupedLineItems.map(h=>{o.current++;const b=h.lineItems.some(x=>t.isLineItemSelected(x));return(0,e.jsx)(cT,{itemSelectionGroupName:h.itemSelectionGroupName,showAltProducts:l,lineItems:h.lineItems,isFromOrderPack:h.isFromOrderPack,onClick:h.onClick,index:o.current,mode:t.mode,isPriceHidden:p,isQuantityHidden:f,invoiceQuantitiesLoading:t.invoiceQuantitiesLoading,isSelected:b,showSelectToggle:t.partialPackOrderEnabled,toggleLineItem:t.toggleLineItem},`${h.itemSelectionGroupName}-${o.current}`)}),t.singleLineItems.map(h=>(o.current++,(0,e.jsx)(dT,{lineItem:h.lineItem,showUnconverted:h.showUnconverted,showAlternateProducts:l,isFromOrderPack:h.isFromOrderPack,packType:t.packType,index:o.current,mode:t.mode,isPriceHidden:p,isQuantityHidden:f,invoiceQuantitiesLoading:t.invoiceQuantitiesLoading,isSelected:t.isLineItemSelected?t.isLineItemSelected(h.lineItem):!1,showSelectToggle:t.partialPackOrderEnabled,toggleLineItem:t.toggleLineItem},`${h.lineItem.sku}-${o.current}`)))]})]})})}const Cr=(0,g.Ay)(xt.A)({fontWeight:"bold",paddingTop:"0px",paddingBottom:"12px"});function pT({packType:t,showAltProducts:n,mode:s,isPriceHidden:o,isQuantityHidden:r,partialPackOrderEnabled:a}){const i=s===Sr.DRAWER;return(0,e.jsx)(di.A,{children:(0,e.jsxs)(Zn.A,{sx:i?{backgroundColor:"#F7F7F7"}:void 0,children:[a&&(0,e.jsx)(Cr,{sx:{width:"50px"}}),(0,e.jsx)(Cr,{children:"SKU"}),(0,e.jsx)(Cr,{children:"Item Description"}),t==="bid"&&!i&&n&&(0,e.jsx)(Cr,{children:"Alternate Products"}),!r&&(0,e.jsx)(Cr,{children:"QTY/Unit"}),!o&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Cr,{children:"Price/Unit"}),(0,e.jsx)(Cr,{children:"Total"})]})]})})}const hf=(t,n,s=!1)=>{let o=n?.flatMap(u=>u.invoices?.map(p=>p.invoiceId)||[])||[];const{data:r,error:a,isLoading:i,isFetching:l,refetch:c}=Xk({projectId:t,invoiceIds:o},{skip:o.length===0||!t||s});return{invoicedDeliveriesLineItems:r,error:a,isLoading:i,isFetching:l,refreshInvoicedDeliveries:c}},mT=({selectedPack:t,project:n,showLineItemPricing:s,showQuantity:o,partialPackOrderEnabled:r=!1,grandTotalOnly:a=!1})=>{const[i,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(null),{allRoles:p}=(0,we.Sk)(),{userHasPermission:f}=(0,Ye.A)(),{isGridView:h}=Fl(),{selectedPacksForOrder:b,selectLineItemToOrder:x}=oa(),v=so(t)==="bid",y=N=>{if(!N.lineItemId||!n?.id||!v)return!1;const O=t.bidPackId;return!!b?.[O]?.lineItems[N.lineItemId]},j=N=>{if(!n?.id||!v||!N?.lineItemId)return;const{lineItemId:O}=N,z=y(N)?"remove":"add";x(n.id,t,O,z)},A=()=>n?.id?f({tool:D.w5.MATERIALS,action:D.a2.PURCHASE,companyId:n.companyId,projectId:n.id}):(0,ct.pX)(p,[we.wy.OSR,we.wy.BFSComponentDesign,we.wy.CompanyManager]),w=Zr(t)?[t]:[],{invoicedDeliveriesLineItems:P,isLoading:C}=hf(n?.id.toString(),w),k=()=>{let N=Zr(t);return C&&N?.invoices&&N?.invoices?.length>0},S=N=>{l(!0),u({selectedGroup:N})},R=()=>{l(!1),u(null)},B=Ml(t,P),T=A()?S:void 0,W=ou(t,T);return t?(0,e.jsxs)(e.Fragment,{children:[i&&c&&(0,e.jsx)(X2,{isOpen:i,closeModal:R,alternateProductGroup:c.selectedGroup}),h&&(0,e.jsx)(sT,{singleLineItems:B,groupedLineItems:W,selectedPack:t,showQuantity:o,invoiceQuantitiesLoading:k(),showLineItemPricing:s,partialPackOrderEnabled:r&&v&&!a,toggleLineItem:j,isLineItemSelected:y}),!h&&(0,e.jsx)(mf,{singleLineItems:B,invoiceQuantitiesLoading:k(),groupedLineItems:W,packType:so(t),selectedPack:t,showQuantitySetting:o,showPriceSetting:s,partialPackOrderEnabled:r&&v&&!a,toggleLineItem:j,isLineItemSelected:y})]}):null},I8=m.p+"f33bf563cd59b60cac223555afff8f57.png",D8=({purchasedOnDate:t})=>{const{project:n}=useProject(),{company:s}=useCrewInfo(n?.id,n?.companyId);return jsx(GridPackInfo,{children:jsxs(CenteredFlexDiv,{children:[jsx(StyledH5,{variant:"h5",children:"Your Bid Request is in progress"}),jsxs(StyledH6,{variant:"h6",children:["Requested on ",t?.format("M/D/YY")]}),jsx(ImageContainer,{src:NoBidPlaceholder,alt:"Order successfully placed placeholder image"}),jsx(StyledH6,{variant:"h6",children:"The BFS team is working on preparing your takeoff."}),jsx(StyledH6,{variant:"h6",children:"We'll notify you once it's ready."}),s&&s.osrEmail&&jsx(ContactOSRButton,{href:`mailto:${s.osrEmail}`})]})})},gf=m.p+"e1764bf73f633af8cb84ce4a080066bd.png",mu=({lineItems:t,lineItem:n,itemSelectionGroupName:s,onClick:o,isFromOrderPack:r,showUnconverted:a,showLineItemPricing:i,showQuantity:l,invoiceQuantitiesLoading:c=!1,showSelectToggle:u=!1,isSelected:p=!1,toggleLineItem:f})=>{const{company:h}=(0,je.P)(),b=h?.isPoCustomer,x=t?.some(S=>S.isItemConfirmed===!0),y=!!n?n:Rl(t),j=x?`${t?.length} Options`:"Selection Required",A=vs.showQuantity(n,l,r);let w;y&&(y&&r?w=y.quantityRemaining:a?w=y.unconvertedQuantity:w=y.quantity);const P=vs.showPrice(n,i,!!b),C=vr(n,a),k=S=>{!f||!y||f(y)};return y?(0,e.jsx)($S,{"data-testid":`line-items-${t?.[0].sku||n?.sku}`,onClick:o,isClickable:!!o,children:(0,e.jsxs)(zS,{children:[u&&(0,e.jsx)(ve.A,{checked:p,sx:{position:"absolute",right:10,top:10},onChange:k,onClick:S=>S.stopPropagation()}),(0,e.jsx)(OS,{children:(0,e.jsx)(RS,{src:y.imageUrls?.thumbnail||gf,alt:"Line Item Image",onError:({currentTarget:S})=>{S.onerror=null,S.src=gf}})}),(0,e.jsxs)(MS,{children:[(0,e.jsx)(LS,{variant:"body1",children:y.description}),(0,e.jsxs)(FS,{variant:"body2",children:["SKU ",y.sku]}),(0,e.jsx)(BS,{children:y.tallyMeasurements?Fg(y.tallyMeasurements):""})]}),(0,e.jsxs)(Ge,{children:[(0,e.jsxs)(WS,{sx:{gap:"4px"},children:[A&&(0,e.jsxs)(NS,{variant:"body2",children:["Qty:"," ",y.invoiceId&&c?(0,e.jsx)(Mn.A,{variant:"text",sx:{width:"15px"}}):(0,e.jsx)("span",{children:w})]}),P&&(0,e.jsx)(_S,{variant:"body2",children:`${(0,Ze.up)(C)} ${vs.getUnitOfMeasure(y,a)??""}`})]}),P&&(0,e.jsx)(US,{variant:"h6",children:vs.getLineItemFullPrice(y,a)})]}),t&&t?.length>0&&(0,e.jsx)(VS,{isConfirmed:x,"data-testid":`sku-overlay-${s}`,children:j})]})}):(0,e.jsx)(e.Fragment,{})},ff=({packStatusEnum:t,styles:n,dataTestId:s})=>{if(!t)return null;const{backgroundColor:o,color:r,text:a}=ni(t);return(0,e.jsx)("div",{"data-testid":s,style:{backgroundColor:o,color:r,...n},children:a})},hT=(0,g.Ay)("div")`
  display: flex;
  justify-content: space-between;
`,xf=(0,g.Ay)("span")`
  font-size: 18px;
  font-weight: ${t=>t.fontWeight};
  font-family: Roboto;
  line-height: 1.2;
  font-style: normal;
  color: ${t=>t.color};
`,ci=({selected:t,packName:n,cardText:s,status:o,deliveryStatus:r,bottomRightComponent:a,bottomCenterComponent:i})=>{const l=(0,d.useRef)(null);return(0,d.useEffect)(()=>{if(t&&l.current){const c=l.current,u=c.parentElement;u&&(c.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{u.scrollBy(0,-50)},100))}},[t]),(0,e.jsxs)("div",{ref:l,children:[(0,e.jsxs)(hT,{children:[(0,e.jsx)(xf,{color:"var(--light-text-primary)",fontWeight:400,children:n}),(0,e.jsx)(xf,{color:"var(--light-text-primary)",fontWeight:400,"data-testid":"pack-order-status-card-text",children:s})]}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,e.jsx)(ff,{dataTestId:"basePackListItemStatus",packStatusEnum:o,styles:{width:"fit-content",fontSize:"12px",letterSpacing:"0.16px",marginTop:"8px",padding:"2px 6px"}}),r,i,a]})]})},gT=({bidPack:t,selected:n,updatePacksToPurchase:s,showPackTotals:o,isChecked:r,grandTotalOnly:a,totalLineItems:i,orderedLineItems:l,partialPackOrderEnabled:c})=>{const{company:u}=(0,je.P)();let p="";const f=Ol(t),h=nu(f),b=!a;h&&b||h&&o&&t.is3pQuote?p=t.totalPrice!=null?(0,Ze.up)(t.totalPrice):"":b&&(p=su(f));function x(k){const S=new Date;return new Date(k)<=S?`Expired ${Qo(k,!0)}`:`Expires ${Qo(k,!0)}`}const v=ea(t.expirationDate),y=v?js.BID_EXPIRED:t.status,j=t.expirationDate?x(t.expirationDate):"",A=t.is3pQuote,w=()=>!c||i===0?p:(0,e.jsxs)(E.A,{sx:{display:"flex",gap:"4px",flexDirection:"column"},children:[(0,e.jsx)(E.A,{children:p}),(0,e.jsx)(I.A,{sx:{fontFamily:"Roboto",textAlign:"right",color:"#1D6BCD"},children:`${l}/${i}`})]}),P=()=>c&&r&&l<i,C=()=>u?.erpSystem!==An.v.AS400&&!a&&!A&&!ri(y);return(0,e.jsx)(ci,{selected:n,packName:t.packName,cardText:w(),status:y,deliveryStatus:null,bottomCenterComponent:(0,e.jsx)("div",{style:{width:"fit-content",fontSize:"12px",letterSpacing:"0.16px",marginTop:"8px",padding:"2px 6px"},children:j}),bottomRightComponent:C()?(0,e.jsx)("div",{"data-testid":`bidPackListItemCheckbox-${t.bidPackId}`,onClick:k=>{k.stopPropagation()},style:{paddingTop:"5px"},children:(0,e.jsx)(ve.A,{sx:{position:"relative",left:"9px"},checked:r,indeterminate:P(),disabled:v||!h,onChange:k=>{s&&s(t,k.target.checked?"Add":"Remove")}})}):null})},yf=({orderPack:t,selected:n})=>{const s=t.packName;return(0,e.jsx)(ci,{selected:n,packName:s,cardText:`#${t.orderId}`,status:t.status})};var fT=m(59644);const xT=(0,g.Ay)("a")`
  text-decoration: underline;
  color: white;
  &:visited {
    color: white;
  }
  margin-right: 0.25rem;
`,bf=(0,g.Ay)("span")`
  display: flex;
  align-items: center;
`,yT=({company:t,quoteRequestId:n})=>{const{isFlagEnabled:s}=(0,ut.u)();return(0,e.jsx)(e.Fragment,{children:t&&n&&!s(D.SX.SUNSET_BFS)&&(0,e.jsxs)(bf,{children:[(0,e.jsx)(xT,{target:"_blank",href:Qg(Gg(t,n)),rel:"noreferrer","data-testid":"mbb-link",children:"Open in MyBFSBuilder"}),(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",paddingTop:"0.25rem"},children:(0,e.jsx)(fT.JvP,{size:24})})]})})},vf=({visible:t,isCustomerViewOn:n,quoteRequestId:s,handleChange:o})=>{const{company:r}=(0,je.P)(),{isCustomerView:a,updateCustomerView:i}=Fl(),{isQuotesEnabled:l}=ta(),c=p=>{i(p.target.checked),o(p)},u=()=>l||a===void 0?n:a;return(0,e.jsx)(e.Fragment,{children:t&&(0,e.jsxs)(GS,{"data-testid":"toggle-container",isCustomPreviewOn:n,children:[(0,e.jsxs)(bf,{children:[(0,e.jsx)("span",{children:"Edit"}),(0,e.jsx)(Ri.A,{size:"small","data-testid":"toggle-switch",color:"default",checked:u(),onChange:c}),(0,e.jsx)("span",{children:"Customer View"})]}),!n&&s&&(0,e.jsx)(yT,{company:r,quoteRequestId:s})]})})},jf=m.p+"8c2851a94ad33eff33983a5bcc0705b4.svg",Af=m.p+"cb76cde0c7669b08e117ea8190835be9.svg",Cf=m.p+"9bea79fc2c638b215e0f7c59558668d7.svg",Sf=m.p+"3aac121da718542c1c45edd1550d5fcd.svg";var bT=m(29682),vT=m(92183);const hu=(0,g.Ay)("div")`
  width: 4px;
  height: 4px;
  aspect-ratio: 1/1;
  border-radius: 9999px;
  background: var(--Colors-border-border-primary, #d8d9da);
`;function jT(t){return(0,e.jsx)(E.A,{id:"single-row-container",sx:{display:"flex",padding:"12px 16px 0px 12px",alignItems:"center",gap:"4px",alignSelf:"stretch",border:"none",background:"#FFF"},children:(0,e.jsx)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"flexStart",gap:"4px",flex:"1 0 0",paddingLeft:"28px"},children:(0,e.jsxs)(E.A,{id:"single-comment-row",sx:{display:"flex",alignItems:"center",gap:"12px",alignSelf:"stretch"},children:[(0,e.jsx)(I.A,{style:{fontWeight:400,fontSize:"14px",lineHeight:"24px",color:"text.primary"},children:t.lineItem.description}),t.lineItem.comments?.map((n,s)=>(0,e.jsx)("div",{children:n},s))]})})})}function AT(t){const n=t.packType==="bid",s=br(t.lineItem),o=t.mode===Sr.DRAWER,r=vr(t.lineItem,t.showUnconverted);let a;t.isFromOrderPack?a=t.lineItem.quantityRemaining:t.showUnconverted?a=t.lineItem.unconvertedQuantity:a=t.lineItem.quantity;let i;t.lineItem.unitOfMeasure?i=t.lineItem.unitOfMeasure:t.lineItem.unitOfMeasurement&&(i=t.lineItem.unitOfMeasurement);let l=null;return t.lineItem.sku===null?l=null:l=ru(t.lineItem,t.showUnconverted),s?(0,e.jsx)(jT,{...t}):(0,e.jsx)(E.A,{sx:{display:"flex",padding:"12px 16px",alignItems:"center",gap:"4px",alignSelf:"stretch",borderRadius:"4px",borderTop:"1px solid #EFF0F0",borderBottom:t.displayBottomBorder?"1px solid #EFF0F0":"none",background:"#FFF"},children:(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"flexStart",gap:"4px",flex:"1 0 0",paddingLeft:"28px"},children:[(0,e.jsx)(E.A,{sx:{display:"flex",height:"24px",alignItems:"center",gap:"12px",alignSelf:"stretch"},children:(0,e.jsx)(I.A,{style:{fontWeight:400,fontSize:"14px",lineHeight:"24px",color:"text.primary"},children:t.lineItem.description})}),(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:"8px",alignSelf:"stretch",flexDirection:"row",color:"text.secondary",fontWeight:400},children:["SKU: ",t.lineItem.sku,(0,e.jsx)(hu,{}),n&&!o&&t.showAlternateProducts&&(0,e.jsx)(E.A,{children:"-"}),!t.isQuantityHidden&&(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[t.invoiceQuantitiesLoading?(0,e.jsx)(Mn.A,{variant:"text",sx:{width:"15px"}}):(0,e.jsx)("span",{children:a}),i&&(0,e.jsxs)("span",{children:["/",i]})]}),!t.isPriceHidden&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hu,{}),(0,Ze.up)(r),l&&`/${l}`]})]}),t.lineItem.price!=null&&!t.isPriceHidden&&(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:"8px",alignSelf:"stretch",flexDirection:"row",color:"text.secondary",fontWeight:500},children:["Total: ",si(t.lineItem,t.showUnconverted)]}),t.lineItem.tallyMeasurements?(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center",gap:"8px",alignSelf:"stretch",flexDirection:"row",color:"text.secondary",fontWeight:400},children:(0,e.jsx)("div",{style:{display:"flex"},children:oi(t.lineItem.tallyMeasurements).map((c,u)=>(0,e.jsxs)("div",{style:{fontSize:"12px",color:"#3E4041"},children:[c,"\xA0"]},u))})}):null,t.lineItem.comments&&(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center",gap:"8px",alignSelf:"stretch",flexDirection:"row"},children:(0,e.jsx)(E.A,{sx:{display:"flex",flexDirection:"column"},children:t.lineItem.comments?.map((c,u)=>(0,e.jsx)("div",{children:c},u))})})]})})}function CT(t){const n=Rl(t.lineItems),s=t.showAltProducts?{text:"Additional Choices",style:{color:"#3183FE",textDecoration:"underline"}}:{text:"Selection Required",style:{color:"#FF0000",textDecoration:"underline"}},o=vr(n,t.showUnconverted);return(0,e.jsxs)(E.A,{onClick:t.onClick,children:[(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:"8px",alignSelf:"stretch",flexDirection:"row",color:"text.secondary",fontWeight:400},children:["SKU: ",n?.sku,(0,e.jsx)(hu,{}),!t.isQuantityHidden&&(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[t.showUnconverted?n?.unconvertedQuantity:t.invoiceQuantitiesLoading?(0,e.jsx)(Mn.A,{variant:"text",sx:{width:"15px"}}):(0,e.jsx)("span",{children:n?.quantity??""}),n?.unitOfMeasure&&(0,e.jsxs)("span",{children:["/",n?.unitOfMeasure]})]}),!t.isPriceHidden&&(0,e.jsxs)(e.Fragment,{children:[(0,Ze.up)(o),n?.pricingUnitOfMeasure&&(0,e.jsxs)("span",{children:["/",n?.pricingUnitOfMeasure]}),n?.price!=null&&n?.price!==void 0?si(n,t.showUnconverted):"N/A"]})]}),n?.tallyMeasurements?(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center",gap:"8px",alignSelf:"stretch",flexDirection:"row",color:"text.secondary",fontWeight:400},children:(0,e.jsx)("div",{style:{display:"flex"},children:oi(n?.tallyMeasurements).map((r,a)=>(0,e.jsxs)("div",{style:{fontSize:"12px",color:"#3E4041"},children:[r,"\xA0"]},a))})}):null,(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:"8px",alignSelf:"stretch",flexDirection:"column"},children:[(0,e.jsx)(E.A,{children:n?.description}),n?.comments?.map((r,a)=>(0,e.jsx)("div",{children:r},a))]}),(0,e.jsx)(E.A,{style:s.style,sx:{"&:hover":{cursor:"pointer"}},children:s.text})]},`${t.itemSelectionGroupName}-${t.index}`)}var ST=(t=>(t.IL="IL",t.LC="LC",t.IS="IS",t.IC="IC",t.FC="FC",t.CO="CO",t))(ST||{});const wT=["IL","LC","IS","IC","FC","CO"];function ET({priceSetting:t,quantitySetting:n,groupedLineItems:s}){const{company:o}=(0,je.P)(),r=!!o?.isPoCustomer,a=t??!0,i=n??!0,l=!!(r||!a),c=!i,u=s.length>0&&s.some(p=>p.lineItems.some(f=>f.isItemConfirmed===!0));return{isPriceHidden:l,isQuantityHidden:c,showAltProducts:u}}function PT(t){const n=(0,d.useRef)(-1);n.current=-1;const[s,o]=(0,d.useState)(!0),{isPriceHidden:r,isQuantityHidden:a,showAltProducts:i}=ET({priceSetting:t.showPriceSetting,quantitySetting:t.showQuantitySetting,groupedLineItems:t.groupedLineItems});return(0,d.useEffect)(()=>{const l=t.selectedPack?t.selectedPack.DocType:null;wT.includes(l)?o(!1):o(!0)},[t]),(0,e.jsx)("div",{"data-testid":"pack-line-items-list-container",children:s&&(0,e.jsx)(E.A,{children:(0,e.jsxs)(E.A,{children:[t.groupedLineItems.map(l=>{n.current++;const c=l.lineItems.some(u=>t.isLineItemSelected(u));return(0,e.jsx)(CT,{itemSelectionGroupName:l.itemSelectionGroupName,showAltProducts:i,lineItems:l.lineItems,isFromOrderPack:l.isFromOrderPack,onClick:l.onClick,index:n.current,mode:t.mode,isPriceHidden:r,isQuantityHidden:a,invoiceQuantitiesLoading:t.invoiceQuantitiesLoading,isSelected:c,showSelectToggle:t.partialPackOrderEnabled,toggleLineItem:t.toggleLineItem},`${l.itemSelectionGroupName}-${n.current}`)}),t.singleLineItems.map((l,c)=>(n.current++,(0,e.jsx)(AT,{lineItem:l.lineItem,showUnconverted:l.showUnconverted,showAlternateProducts:i,isFromOrderPack:l.isFromOrderPack,packType:t.packType,index:n.current,mode:t.mode,isPriceHidden:r,isQuantityHidden:a,invoiceQuantitiesLoading:t.invoiceQuantitiesLoading,isSelected:t.isLineItemSelected?t.isLineItemSelected(l.lineItem):!1,showSelectToggle:t.partialPackOrderEnabled,toggleLineItem:t.toggleLineItem,displayBottomBorder:!(c===t.singleLineItems.length-1||t.singleLineItems.length===0)},`${l.lineItem.sku}-${n.current}`)))]})})})}const IT=({selectedPack:t,project:n,showLineItemPricing:s,showQuantity:o,partialPackOrderEnabled:r=!1,grandTotalOnly:a=!1})=>{const[i,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(null),{allRoles:p}=(0,we.Sk)(),{userHasPermission:f}=(0,Ye.A)(),{selectedPacksForOrder:h,selectLineItemToOrder:b}=oa(),x=so(t)==="bid",v=W=>{if(!W.lineItemId||!n?.id||!x)return!1;const N=t.bidPackId;return!!h?.[N]?.lineItems[W.lineItemId]},y=W=>{if(!n?.id||!x||!W?.lineItemId)return;const{lineItemId:N}=W,O=v(W)?"remove":"add";b(n.id,t,N,O)},j=()=>n?.id?f({tool:D.w5.MATERIALS,action:D.a2.PURCHASE,companyId:n.companyId,projectId:n.id}):(0,ct.pX)(p,[we.wy.OSR,we.wy.BFSComponentDesign,we.wy.CompanyManager]),A=Zr(t)?[t]:[],{invoicedDeliveriesLineItems:w,isLoading:P}=hf(n?.id.toString(),A),C=()=>{let W=Zr(t);return P&&W?.invoices&&W?.invoices?.length>0},k=W=>{l(!0),u({selectedGroup:W})},S=()=>{l(!1),u(null)},R=Ml(t,w),B=j()?k:void 0,T=ou(t,B);return t?(0,e.jsx)(PT,{singleLineItems:R,invoiceQuantitiesLoading:C(),groupedLineItems:T,packType:so(t),selectedPack:t,showQuantitySetting:o,showPriceSetting:s,partialPackOrderEnabled:r&&x&&!a,toggleLineItem:y,isLineItemSelected:v}):(0,e.jsx)(e.Fragment,{})};var DT=m(57708),wf=m(27562);const kT=(t,n,s)=>{const o=nu(t),r=!n,a=!!t.is3pQuote;return o&&r||o&&s&&a?t.totalPrice!=null?(0,Ze.up)(t.totalPrice):"":r?su(t):""},Nl=({item:t,project:n,index:s,idKey:o,showLineItemPricing:r,showQuantity:a,grandTotalOnly:i=!1,showPackTotals:l=!1,isSelectedForPurchase:c=!1,updatePacksToPurchase:u})=>{const[p,f]=(0,d.useState)(!1),h=String(t[o]),b=t.packName,x=Zr(t),v=Ol(t),y=x&&(x.actualDeliveryAt||x.requestedDeliveryAt||x.scheduledDeliveryAt),j=v?kT(v,i,l):"",w=(()=>{if(!v)return ni(t.status,!0);const C=ea(v.expirationDate);return ni(C?js.BID_EXPIRED:v.status,!0)})(),P=()=>!v||!u?!1:!ea(v.expirationDate)&&n?.erpSystem!==An.v.AS400&&!i&&!v.is3pQuote;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(E.A,{sx:{borderTop:s===0?"none":"1px solid var(--light-secondary-light)",padding:".75rem 1rem",display:"flex",alignItems:"center",gap:"8px",backgroundColor:"white"},className:"responsive-pack-header",onClick:()=>{f(!p)},children:[p?(0,e.jsx)(Wc.A,{fill:"#75787B"}):(0,e.jsx)(wf.A,{fill:"#75787B"}),(0,e.jsxs)(E.A,{display:"flex",flex:1,flexDirection:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"space-between",children:[(0,e.jsxs)(E.A,{children:[(0,e.jsx)(E.A,{component:"span",sx:{maxWidth:"150px",overflow:"hidden",whiteSpace:"nowrap"},children:(0,e.jsx)(I.A,{variant:"body1",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"300px",fontWeight:500,marginBottom:".25rem"},children:b})}),(0,e.jsxs)(E.A,{sx:{display:"flex",gap:".5rem",alignItems:"center"},children:[(0,e.jsx)(I.A,{variant:"caption",sx:{color:"var(--light-secondary-main)"},children:v?(0,e.jsx)(e.Fragment,{children:j}):(0,e.jsxs)(e.Fragment,{children:["#",h," ",y&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(E.A,{component:"span",sx:{width:"4px",height:"4px",color:"var(--light-secondary-light)",marginX:"3px"},children:"\u25CF"})," ",iu(y)]})]})}),(0,e.jsx)(to,{label:w.text,size:"small",shape:"square",sx:{color:w.color,backgroundColor:w.backgroundColor,marginTop:"-2px",height:"1rem",border:"none","& .MuiChip-label":{fontSize:".625rem",fontWeight:500}}}),x&&x.invoices.length>0&&(0,e.jsx)(to,{label:"Invoiced",size:"small",shape:"square",sx:{color:"var(--chip-secondary-text)",backgroundColor:"var(--chip-secondary-background)",marginTop:"-2px",height:"1rem",border:"none","& .MuiChip-label":{fontSize:".625rem",fontWeight:500}}})]})]}),P()&&(0,e.jsx)(TT,{item:v,updatePacksToPurchase:u,isSelectedForPurchase:c})]})]},h),(0,e.jsx)(ho.A,{in:p,children:(0,e.jsx)(IT,{selectedPack:t,project:n,showLineItemPricing:r,showQuantity:a,grandTotalOnly:i,partialPackOrderEnabled:!1})})]})},TT=({isSelectedForPurchase:t,updatePacksToPurchase:n,item:s})=>{const o=t?(0,e.jsx)(DT.A,{color:"inherit"}):(0,e.jsx)($d.A,{}),r={height:"28px",padding:"6px 8px"},a=t?{...r,borderColor:"border.primary",color:"text.secondary"}:{...r};return(0,e.jsx)(K.A,{variant:"outlined",sx:a,onClick:i=>{i.stopPropagation(),t?n(s,"Remove"):n(s,"Add")},startIcon:o,children:(0,e.jsx)(I.A,{fontSize:"12px",color:t?"text.secondary":"primary",fontWeight:"semibold",children:t?"Remove":"Add To Order"})})};function Ef(t){const n=[],s=t.isResponsive??!1;return t.bidPacks.forEach((o,r)=>{const a=as(o),i=t.packsToPurchase?.[o.bidPackId],l=i!==void 0,c=i?.totalOrderableLineItems??0,u=i?Object.keys(i?.lineItems).length:0;s?n.push((0,e.jsx)(Nl,{index:r,idKey:"bidPackId",item:o,project:t.project,showLineItemPricing:t.showLineItemPricing??!0,showQuantity:t.showQuantity??!0,grandTotalOnly:t.grandTotalOnly,updatePacksToPurchase:t.updatePacksToPurchase,isSelectedForPurchase:l},o.bidPackId)):n.push((0,e.jsx)(L.Link,{role:"button",className:"packs-items",onClick:p=>{p.preventDefault(),t.handlePackClick(o,!1)},to:"",children:(0,e.jsx)(Wo,{sx:t.selectedId===a?or:{},children:(0,e.jsx)(gT,{bidPack:o,isChecked:l,selected:t.selectedId===a,updatePacksToPurchase:t.updatePacksToPurchase,showPackTotals:t.showPackTotals,grandTotalOnly:t.grandTotalOnly,partialPackOrderEnabled:t.partialPackOrderEnabled??!1,totalLineItems:c,orderedLineItems:u})})},a))}),(0,e.jsx)(e.Fragment,{children:n})}const RT=(0,g.Ay)("span")`
    font-size: 12px;
    line-height: 1.2;
    letter-spacing: 0.4px;
    text-align: left;
    color: ${t=>t.selected?"black":"var(--light-text-primary)"};
  `;function OT(t){return(0,e.jsx)(ci,{selected:t.isSelected,packName:"Bid Summary",cardText:t.bidSummaryTotal?(0,Ze.up)(t.bidSummaryTotal):"",deliveryStatus:(0,e.jsx)("div",{style:{width:"fit-content",marginTop:"8px",padding:"2px 6px",letterSpacing:"0.16px",fontSize:"12px",backgroundColor:"var(--light-secondary-light)"},children:(0,e.jsx)(RT,{selected:t.isSelected,children:"Active"})})})}const Pf=({delivery:t,selected:n})=>{const s=Pk(t),o=t.packName,r=(0,g.Ay)("span")`
    margin-top: 8px;
    margin-left: 10px;
    font-size: 12px;
    line-height: 1.2;
    letter-spacing: 0.4px;
    text-align: left;
    color: ${a=>a.selected?"white":"var(--light-text-primary)"};
  `;return(0,e.jsx)(ci,{selected:n,packName:o,cardText:`#${t.deliveryId}`,status:t.status,deliveryStatus:s?(0,e.jsx)(r,{selected:n,children:"Invoiced"}):null})};function If(t){const n=t.isResponsive??!1,s=t.showLineItemPricing??!0,o=t.showQuantity??!0,r=t.grandTotalOnly??!1,a=l=>{const c=[];return l.deliveries.forEach((u,p)=>{const f=as(u);n?c.push((0,e.jsx)(Nl,{index:p,item:u,idKey:"deliveryId",showLineItemPricing:s,showQuantity:o,grandTotalOnly:r,project:t.project},f)):c.push((0,e.jsx)(L.Link,{role:"button",className:"packs-items",onClick:h=>{h.preventDefault(),t.handlePackClick(u,!1,f)},to:"",children:(0,e.jsx)(Wo,{sx:t.selectedId===f?or:{},children:(0,e.jsx)(Pf,{delivery:u,selected:t.selectedId===f})})},f))}),c},i=[];return t.orderPacks.forEach((l,c)=>{const u=as(l);l.status!==un.DELIVERED&&l.lineItems.length>0&&(n?i.push((0,e.jsx)(Nl,{item:l,idKey:"orderId",showLineItemPricing:s,showQuantity:o,grandTotalOnly:r,project:t.project,index:c},u)):i.push((0,e.jsx)(L.Link,{role:"button",className:"packs-items",onClick:p=>{p.preventDefault(),t.handlePackClick(l,!1,u)},to:"",children:(0,e.jsx)(Wo,{sx:t.selectedId===u?or:{},children:(0,e.jsx)(yf,{orderPack:l,selected:t.selectedId===u})})},u))),i.push(...a(l))}),(0,e.jsx)(e.Fragment,{children:i})}const MT=(0,g.Ay)("div",{shouldForwardProp:t=>t!=="visible"})(({visible:t,isResponsive:n})=>n?{position:"fixed",bottom:"0",left:"0",right:"0",zIndex:t?1e3:-1e3,backgroundColor:"#FFF",borderTop:"1px solid var(--Colors-Border-border-secondary, #EFF0F0)",padding:"12px 16px",display:"flex",flexDirection:"column",alignItems:"center",gap:"12px",visibility:t?"visible":"hidden"}:{position:"fixed",bottom:"25px",left:"48px",zIndex:t?1e3:-1e3,backgroundColor:"#343434",padding:"5px",width:"346px",boxSizing:"border-box",height:"90px",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"4px",borderTopLeftRadius:"0px",borderTopRightRadius:"0px",visibility:t?"visible":"hidden"});function Df({visible:t,onSubmit:n,onRemoveAll:s,total:o,isResponsive:r=!1}){return(0,e.jsx)(MT,{visible:t,isResponsive:r,children:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column-reverse",flexWrap:"wrap",width:"100%",alignItems:"center",gap:"12px",...r?{}:{flexDirection:"row",justifyContent:"space-around"}},children:[(0,e.jsxs)("div",{style:r?{display:"flex",flexDirection:"row-reverse",width:"100%",gap:"8px"}:{},children:[(0,e.jsx)(K.A,{variant:"contained",size:"large","data-testid":"multiPackPurchaseButton",color:"success",onClick:n,sx:r?{display:"flex",height:"40px",padding:"8px 16px",justifyContent:"center",alignItems:"center",gap:"6px",flex:"1 0 0",borderRadius:"4px",background:"#1D6BCD",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"}:{marginRight:"24px"},children:"Submit Order"}),r&&(0,e.jsx)(K.A,{variant:"contained",size:"large",sx:{display:"flex",height:"40px",padding:"8px 16px",justifyContent:"center",alignItems:"center",gap:"6px",flex:"1 0 0",borderRadius:"4px",border:"1px solid #D8D9DA",background:"#FFF",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",color:"#3E4041",fontSize:"16px",fontStyle:"normal",fontWeight:600,lineHeight:"24px"},onClick:s,children:"Remove All"})]}),(0,e.jsxs)("div",{style:r?{display:"flex",height:"24px",width:"100%",alignItems:"center",justifyContent:"space-between",gap:"8px",flex:"1 0 0"}:{display:"flex",flexDirection:"column"},children:[(0,e.jsx)("div",{children:(0,e.jsx)(I.A,{variant:"body1",style:r?{color:"#3E4041",fontSize:"16px",fontStyle:"normal",fontWeight:400,lineHeight:"24px"}:{fontWeight:"bold",color:"#FFFFFF",fontSize:"18px"},children:"Subtotal"})}),(0,e.jsx)("div",{children:(0,e.jsx)(I.A,{variant:"h6",style:r?{color:"#3E4041",fontSize:"18px",fontStyle:"normal",fontWeight:600,lineHeight:"28px"}:{color:"#FFFFFF",fontSize:"18px"},children:(0,Ze.up)(o)})})]})]})})}var LT=m(20973),kf=m(1275);function Tf({buttonText:t,buttonStyle:n,popupContent:s,popperStyle:o,icon:r}){const[a,i]=(0,d.useState)(!1),l=(0,d.useRef)(null),c=()=>{i(u=>!u)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(K.A,{variant:"contained",ref:l,onMouseOver:()=>i(!0),onMouseLeave:()=>i(!1),onClick:c,style:{display:"inline-flex",alignItems:"center",gap:"4px",textTransform:"none",...n},children:[r&&(0,e.jsx)("span",{style:{display:"flex",alignItems:"center"},children:r}),t]}),(0,e.jsx)(_a.A,{open:a,anchorEl:l.current,style:o,modifiers:[{name:"arrow",enabled:!0,options:{element:l.current}}],transition:!0,children:({TransitionProps:u})=>(0,e.jsx)(kf.x,{onClickAway:()=>{i(!1)},children:(0,e.jsx)(LT.A,{...u,timeout:350,children:(0,e.jsx)("div",{children:s})})})})]})}var gu=m(33198),FT=m(10474);const BT=(0,Ud.A)({components:{MuiTableBody:{styleOverrides:{root:{"& .MuiTableRow-root:not(:last-child) .MuiTableCell-root":{paddingBottom:"12px"}}}},MuiTableContainer:{styleOverrides:{root:{width:"auto",display:"flex",padding:"16px",flexDirection:"column",alignItems:"flex-start",alignSelf:"stretch",borderRadius:"4px",border:"1px solid #EFF0F0",background:"#FAFAFA"}}}}});function Rf({subtotal:t,taxes:n,fees:s,discounts:o,grandTotal:r,isResponsive:a=!1,isErpTaxes:i=!1}){const l=(0,e.jsx)(gu.A,{component:Fs.A,sx:a?{padding:"16px",borderRadius:"4px",border:"1px solid #EFF0F0",background:"#FAFAFA",boxSizing:"border-box",boxShadow:"none"}:{backgroundColor:"black"},children:(0,e.jsxs)(ra.A,{children:[(0,e.jsxs)(li.A,{sx:a?{"& .MuiTableRow-root:not(:last-child) .MuiTableCell-root":{paddingBottom:"12px"}}:{},children:[(0,e.jsxs)(Zn.A,{children:[(0,e.jsx)(Ar,{size:"small",children:"Subtotal:"}),(0,e.jsx)(ii,{size:"small",children:(0,Ze.up)(t)})]}),(0,e.jsxs)(Zn.A,{children:[(0,e.jsx)(Ar,{size:"small",children:"Taxes:"}),(0,e.jsx)(ii,{size:"small",children:(0,Ze.up)(n)})]}),s>0&&i&&(0,e.jsxs)(Zn.A,{children:[(0,e.jsx)(Ar,{size:"small",children:"Fees:"}),(0,e.jsx)(ii,{size:"small",children:(0,Ze.up)(s)})]}),o>0&&(0,e.jsxs)(Zn.A,{children:[(0,e.jsx)(Ar,{size:"small",children:"Discounts:"}),(0,e.jsx)(ii,{size:"small",children:(0,Ze.up)(o)})]})]}),(0,e.jsxs)(FT.A,{children:[(0,e.jsx)(Zn.A,{children:(0,e.jsx)(Ar,{colSpan:2,sx:{padding:0,border:"none",background:"transparent"},children:(0,e.jsx)("div",{className:".MuiTablePagination-spacer",style:a?{height:"1px",margin:"16px 0",background:"var(--Colors-Border-border-primary, #D8D9DA)"}:{height:"1px",backgroundColor:"grey"}})})}),(0,e.jsxs)(Zn.A,{children:[(0,e.jsx)(Ar,{size:"small",sx:{fontWeight:"bold"},children:"Grand Total"}),(0,e.jsx)(ii,{size:"small",sx:{fontWeight:"bold"},children:`${(0,Ze.up)(r)}`})]}),(0,e.jsx)(Zn.A,{sx:{"& .MuiTableCell-root":{padding:"8px 16px"}},children:(0,e.jsx)(Ar,{colSpan:2,align:"center",children:(0,e.jsx)(I.A,{variant:"body2",style:{color:a?"text.secondary":"var(--bfs-primary-true-white)",textAlign:"left"},children:"*Totals are not final and subject to change"})})})]})]})});return a?(0,e.jsx)(Wd.A,{theme:BT,children:l}):l}const Of=({bidPacks:t,orderPacks:n,projectId:s,selectedId:o,bidSummaryTotal:r,handlePackClick:a,loadingState:i,openModal:l,project:c,showPackTotals:u,quoteTotal:p,grandTotalOnly:f,totalInfo:h,partialPackOrderEnabled:b=!1,isResponsive:x=!1,showLineItemPricing:v=!1,showQuantity:y=!1})=>{const{isFlagEnabled:j}=(0,ut.u)(),A=j("MaterialPageMultiPackSelect"),{userHasPermission:w}=(0,Ye.A)(),{isQuotesEnabled:P}=ta(),{selectedPacksForOrder:C,addToPacksForOrder:k,removeFromPacksForOrder:S,addProjectPacksToOrder:R,resetSelectedPacksForOrder:B}=oa(),T=C?Object.values(C).reduce((X,G)=>X+G.totalPrice,0):0;function W(X,G){if(G==="Add")k(s,X);else if(G==="Remove")S(s,X.bidPackId);else throw new Error("Invalid action")}const N=()=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{marginBottom:"20px"},children:(0,e.jsx)(Wo,{role:"button",sx:o===null?or:{},onClick:()=>a(null),children:(0,e.jsx)(OT,{isSelected:o===null,bidSummaryTotal:r})})}),(0,e.jsx)(I.A,{variant:"h5",fontSize:"20px",children:"Available"})]}),O=t.some(X=>X.status!==js.BID_EXPIRED),Q=c?!w({tool:D.w5.MATERIALS,action:D.a2.PURCHASE,companyId:c.companyId,projectId:c.id}):!0,re=C?Object.keys(C).length>0:!1,ue=()=>{R(s,t),l()},le=()=>f?(0,Ze.up)(p??0):(0,Ze.up)(h?.total??0),F={width:"16px",height:"16px"},[V,$]=(0,d.useState)(!1),ee=()=>{const X=t.filter(G=>!ea(G.expirationDate)&&!ri(G.status));return c.erpSystem!==An.v.AS400&&X.length>0};return x?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(rf,{"data-testid":"materials-sidebar-packs-list",children:[O&&!P&&(0,e.jsx)(N,{}),(0,e.jsxs)(af,{children:[(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"8px",alignSelf:"stretch",justifyContent:"space-between"},children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:(0,e.jsx)(lf,{children:h?.erpTaxes?"Grand Total":"Quote Total"})}),(0,e.jsx)(df,{children:le()}),!f&&(0,e.jsxs)(K.A,{sx:{color:"#1D6BCD",backgroundColor:"transparent",textTransform:"none",cursor:"pointer",padding:"0px",fontSize:"12px",fontWeight:400,lineHeight:"16px",height:"auto",gap:"4px",display:"flex",alignItems:"center",alignSelf:"center"},onClick:()=>{$(!V)},children:["Taxes and Fees",V?(0,e.jsx)(bT.A,{sx:F}):(0,e.jsx)(vT.A,{sx:F})]})]}),ee()&&(0,e.jsx)(cf,{sx:{alignSelf:"center"},onClick:ue,children:"Order All"})]}),!f&&(0,e.jsx)(ho.A,{in:V,children:(0,e.jsx)(Rf,{subtotal:h?.totalBeforeTax??0,taxes:h?.taxCost??0,fees:h?.estimatedFees??0,discounts:h?.discounts??0,grandTotal:h?.total??0,isResponsive:!0,isErpTaxes:!!h?.erpTaxes})})]}),(0,e.jsxs)(uf,{sx:{marginBottom:re?"116px !important":"16px !important","& .responsive-pack-header":{borderTop:"1px solid var(--light-secondary-light)","&:first-child":{borderTop:"none"}}},children:[(0,e.jsx)(Ef,{bidPacks:t,selectedId:o,handlePackClick:a,packsToPurchase:C,showPackTotals:u,updatePacksToPurchase:A?W:void 0,grandTotalOnly:f,partialPackOrderEnabled:b,showLineItemPricing:v,showQuantity:y,isResponsive:!0,project:c}),(0,e.jsx)(If,{orderPacks:n,selectedId:o,handlePackClick:a,showLineItemPricing:v,showQuantity:y,isResponsive:!0,project:c})]})]}),!Q&&!f&&(0,e.jsx)(Df,{total:T,onSubmit:()=>{l()},onRemoveAll:()=>B(s),visible:re,isResponsive:x})]}):(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",paddingBottom:re?102:void 0,backgroundColor:"white",marginRight:24,borderRadius:4,borderWidth:1,borderStyle:"solid",borderColor:"#E3E4E5",minWidth:344},children:[(0,e.jsxs)(rf,{"data-testid":"materials-sidebar-packs-list",children:[O&&!P&&(0,e.jsx)(N,{}),(0,e.jsxs)(af,{children:[(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[(0,e.jsx)(lf,{children:"Quote Total:"}),!f&&(0,e.jsx)(Tf,{buttonText:"Taxes and Fees",buttonStyle:{color:"#bdbdbd",backgroundColor:"transparent",textDecoration:"underline",textDecorationColor:"#bdbdbd",textDecorationStyle:"solid",textTransform:"none",cursor:"pointer",padding:"0px",height:"100%"},popupContent:(0,e.jsx)(Rf,{subtotal:h?.totalBeforeTax??0,taxes:h?.taxCost??0,fees:h?.estimatedFees??0,discounts:h?.discounts??0,grandTotal:h?.total??0,isErpTaxes:!!h?.erpTaxes}),popperStyle:{width:200}})]}),(0,e.jsx)(df,{children:le()})]}),f&&t.length>0&&(0,e.jsx)(cf,{onClick:ue,children:"Purchase Quote"})]}),(0,e.jsxs)(uf,{children:[(0,e.jsx)(Z2,{children:"Packs"}),(0,e.jsx)(Ef,{bidPacks:t,selectedId:o,handlePackClick:a,packsToPurchase:C,showPackTotals:u,updatePacksToPurchase:A?W:void 0,grandTotalOnly:f,partialPackOrderEnabled:b,isResponsive:!1,project:c}),(0,e.jsx)(If,{orderPacks:n,selectedId:o,handlePackClick:a,isResponsive:!1,project:c})]})]}),!Q&&!f&&(0,e.jsx)(Df,{total:T,onSubmit:()=>l(),visible:re,onRemoveAll:()=>B(s)})]})},_l=({selectedPack:t,openModal:n,project:s,showLineItemPricing:o,showQuantity:r,grandTotalOnly:a=!1,partialPackOrderEnabled:i=!1})=>(0,e.jsxs)(pf,{children:[(0,e.jsx)($2,{handleOpenModal:n,selectedPack:t,project:s,grandTotalOnly:a}),(0,e.jsx)(mT,{selectedPack:t,project:s,showLineItemPricing:o,showQuantity:r,grandTotalOnly:a,partialPackOrderEnabled:i})]}),ui=(t,n=!1)=>{const{isLoggedIn:s}=(0,Pt.A)(),{data:o,isFetching:r,isLoading:a,error:i,refetch:l}=t2({projectId:t},{skip:!t||n||!s});return{data:o,isFetching:r,isLoading:a,error:i,refreshCategoryMaterials:l}},oo=(t,n=!1,s=!1,o=!1)=>{const{isLoggedIn:r}=(0,Pt.A)(),{data:a,error:i,isLoading:l,isFetching:c,refetch:u}=qk({projectId:t,includeDigital:o},{skip:!t||!r||s,refetchOnMountOrArgChange:n});return{quoteSummary:a,error:i,isLoading:l,isFetching:c,refreshQuoteSummary:u}},Do=(t,n=!1,s=!1)=>{const{data:o}=ui(t),{isLoggedIn:r}=(0,Pt.A)(),a=o?.some(f=>f.sellerName)??!1,{data:i,error:l,isLoading:c,isFetching:u,refetch:p}=Jk(t,{skip:!t||s||!a||!r,refetchOnMountOrArgChange:n});return{thirdPartyQuoteSummary:i,error:l,isLoading:c,isFetching:u,refresh3pQuoteSummary:a?p:()=>{}}},NT=(0,g.Ay)("div")`
  box-sizing: border-box;
  justify-content: space-between;
  padding: 24px;
  display: flex;
  flex-direction: row;
  width: 100%;
  justify-content: space-between;
  align-items: center;
  background-color: var(--bfs-primary-true-white);
`,_T=(0,g.Ay)(K.A)`
  background-color: var(--light-primary-dark);
  width: 150px;
  margin-top: 1em;
`;function UT(t){const{fetchBidSummaryPdf:n}=sa(),[s,o]=(0,d.useState)(!1),{company:r}=(0,je.P)(),{quoteId:a}=(0,L.useParams)(),{thirdPartyQuoteSummary:i}=Do(t.projectId.toString()),l=!!i?.thirdPartyQuotes.find(u=>u.quoteId.toString()===a);async function c(){o(!0);const u=await n(t.projectId),p=window.atob(u),f=p.length,h=new Uint8Array(f);for(let y=0;y<f;y++)h[y]=p.charCodeAt(y);const b=new Blob([h],{type:"application/pdf"}),x=window.URL.createObjectURL(b),v=document.createElement("a");v.href=x,v.download=`${t.projectName}-BidSummary.pdf`,document.body.appendChild(v),v.click(),window.URL.revokeObjectURL(x),document.body.removeChild(v),o(!1)}return(0,e.jsx)(Yg,{children:(0,e.jsxs)(NT,{children:[(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",height:"100%",gap:8},children:[(0,e.jsx)(I.A,{variant:"h6",sx:{fontSize:"22px"},children:t.projectName})," ",(0,e.jsx)(I.A,{variant:"body1",color:"var(--graythorne-grays-gray-4)",sx:{fontSize:"16px"},children:t.projectAddress})," ",(0,e.jsx)(_T,{variant:"contained",onClick:c,disabled:s||l,children:s?(0,e.jsx)(bt.A,{size:36}):"Download PDF"})]}),(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-end",height:"100%",gap:8},children:[(0,e.jsx)(I.A,{variant:"h6",sx:{fontSize:"22px"},children:"Questions?"}),(0,e.jsx)(I.A,{variant:"body1",color:"var(--graythorne-grays-gray-4)",sx:{fontSize:"16px"},children:"We\u2019re always here to help!"}),!!r?.osrEmail&&(0,e.jsx)(qg,{variant:"contained",href:`mailto:${r?.osrEmail}`,sx:{marginTop:"1em"},children:"Contact Sales Rep"})]})]})})}function WT(t){return t?`${t.streetOne} ${t.city}, ${t.state} ${t.zip}`:""}function zT(t){const n=(0,d.useRef)(null);return(0,d.useEffect)(()=>{if(n.current&&t.bidSummaryHtml){const s=n.current.attachShadow({mode:"closed"});s.innerHTML=t.bidSummaryHtml}else n.current&&t.bidSummaryHtml&&(n.current.innerHTML=t.bidSummaryHtml)},[t.bidSummaryHtml]),(0,e.jsxs)(pf,{"data-testid":"bid-summary",children:[(0,e.jsx)(UT,{projectId:t.projectId,projectName:t.projectName,projectAddress:WT(t.projectAddress),osrEmail:t.osrEmail}),(0,e.jsx)("div",{style:{display:"flex",flex:1,overflow:"hidden",marginTop:20,backgroundColor:"var(--bfs-primary-true-white)",borderRadius:"8px"},children:(0,e.jsx)("div",{ref:n,style:{paddingLeft:"24px",paddingRight:"24px",overflowX:"hidden",width:"100%"}})})]})}const T8=(0,g.Ay)("div")`
  display: flex;
  padding: 0px 24px;
  flex-direction: column;
  align-items: flex-start;
  gap: 8px;
  align-self: stretch;
  width: 100%;
  align-content: flex-end;
`,R8=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  align-self: stretch;
  border-radius: 4px;
  border: 1px solid #e3e4e5;
`,O8=(0,g.Ay)("div")`
  display: flex;
  padding: 16px;
  align-items: center;
  gap: 6px;
  align-self: stretch;
  flex-direction: row;
`,VT=(0,g.Ay)("div")`
  display: flex;
  padding: 8px 24px 16px 24px;
  align-items: flex-start;
  align-content: flex-start;
  gap: 24px;
  align-self: stretch;
  flex-wrap: wrap;
  border-radius: 0px 0px 4px 4px;
  border-radius: 5px;
  border: 1.25px solid #e3e4e5;
  background: #fff;
`,$T=(0,g.Ay)(I.A)`
  color: #17181a;
  font-family: Roboto;
  font-size: 16px;
  font-style: normal;
  font-weight: 700;
  line-height: 32px;
  letter-spacing: 0.25px;
`,HT=(0,g.Ay)(I.A)`
  color: #5d6062;
  font-family: Roboto;
  font-size: 20px;
  font-style: normal;
  font-weight: 400;
  line-height: 30px;
`,QT=(0,g.Ay)("div")`
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1 0 0;
`,GT=(0,g.Ay)("div")`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  flex: 1 0 0;
  height: 200px;
  max-width: 200px;
  border-radius: 5px;
  border: 1px solid #e3e4e5;
  background: #f8f8f8;
  cursor: pointer;
`,KT=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  flex: 1 0 0;
  max-width: 200px;
  height: 248px;
`,YT=(0,g.Ay)("div")`
  display: flex;
  padding: 3.75px 0px 6.25px 0px;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  align-self: stretch;
  border-radius: 5px;
  border: 1.25px solid #e3e4e5;
  background: #fff;
  height: 190px;
  max-width: 200px;
`,qT=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  align-self: stretch;
`,XT=(0,g.Ay)("div")`
  display: flex;
  align-items: center;
  gap: 8px;
  align-self: stretch;
  min-height: 24px;
`,JT=(0,g.Ay)("div")`
  display: flex;
  align-items: flex-start;
  gap: var(--spacing-md, 8px);
  flex: 1 0 0;
  cursor: pointer;
  text-decoration: underline;
  color: rgba(29, 107, 205, 1);
`,ZT=(0,g.Ay)("a")`
  display: flex;
  padding: 4px;
  justify-content: center;
  align-items: center;
  gap: 6px;
  border-radius: 4px;
  border: 1px solid rgba(255, 255, 255, 0);
  background: rgba(255, 255, 255, 0);
`,eR=(0,g.Ay)("div")`
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  align-self: stretch;
`,M8=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 2px;
  flex: 1 0 0;
`,tR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
`,nR=(0,g.Ay)(I.A)`
  color: var(--Colors-Text-text-secondary, #5d6062);

  /* Typography/h5/Medium */
  font-family: Roboto;
  font-size: 20px;
  font-style: normal;
  font-weight: 500;
  line-height: 30px; /* 150% */
`,sR=(0,g.Ay)("div")`
  color: #5d6062;
  text-align: center;

  font-family: Roboto;
  font-size: 16px;
  font-style: normal;
  font-weight: 400;
  line-height: 24px;
`,pi=(t,n)=>{const{data:s,isLoading:o,isFetching:r,error:a}=(0,Ps.HZ)({projectId:t,quoteId:n},{skip:!t||!n});return{files:(0,d.useMemo)(()=>s??[],[s]),isLoading:o||r,error:a}};var oR=m(576),L8=m(71027);const Mf=m.p+"041f120078487cce1e84b8c774ffe19e.svg",rR=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  overflow: hidden;
`,aR=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  position: relative;
`,iR=(0,g.Ay)(pt.A)`
  position: absolute;
  inset: 0;
  pointer-events: none;
`,lR=(0,g.Ay)(pt.A,{shouldForwardProp:t=>t!=="displayCloseButton"})`
  display: ${({displayCloseButton:t})=>t?"flex":"none"};
  position: absolute;
  top: 15px;
  left: 20px;
  background-color: rgba(50, 50, 50, 0.35);
  &:hover {
    background-color: rgba(0, 0, 0, 0.35);
  }
`,dR=({isThumbnail:t=!1})=>t?(0,e.jsx)(iR,{children:(0,e.jsx)("img",{style:{fontSize:20},src:Mf,alt:"Play Video"})}):(0,e.jsx)("img",{style:{fontSize:20},src:Mf,alt:"Play Video"}),Lf=({source:t,onClose:n,planId:s,isThumbnail:o=!1})=>{const r=(0,d.useRef)(null),a=(0,d.useRef)(null),[i,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!0),p=(0,d.useMemo)(()=>{const f={bigPlayButton:!1,fill:!0,responsive:!0,sources:[{src:t,type:"application/x-mpegURL"}]};return o?{autoplay:!1,controls:!1,userActions:{click:!1,doubleClick:!1,hotkeys:!1},...f}:{autoplay:!0,controls:!0,controlBar:{volumeMenuBar:!0,muteToggle:!0,volumeControl:!0,fullscreenToggle:!0},...f}},[t,o]);return(0,d.useEffect)(()=>{const f=document.createElement("video-js");f.classList.add("vjs-big-play-centered"),r.current?.appendChild(f);const h=(0,oR.A)(f,p,()=>{l(!0),u(!0)});return h.on("playing",()=>u(!1)),h.on("pause",()=>u(!0)),h.on("useractive",()=>l(!0)),h.on("userinactive",()=>l(!1)),h.on("ended",()=>l(!0)),a.current=h,()=>{h&&!h.isDisposed()&&h.dispose()}},[r,p,o]),(0,e.jsx)(rR,{"data-testid":`video-box-${s}`,children:(0,e.jsxs)(aR,{"data-vjs-player":!0,children:[(0,e.jsx)("div",{ref:r,style:{display:"flex",flex:1}}),(0,e.jsx)(lR,{"data-testid":"close-button",displayCloseButton:i&&!o,onClick:()=>{n&&n()},"aria-label":"Close video player",children:(0,e.jsx)(co.A,{color:"secondary"})}),(c||o)&&(0,e.jsx)(dR,{isThumbnail:!0})]})})},Ff=({plan:t,projectId:n,setError:s,error:o,maxWidth:r})=>{const{displayName:a}=t,i=t.streamingUrl!=null,l=t.uuid!=="0",c=p=>{if(p){const f=p.split(".").pop();if(f)return f.toUpperCase()}return""};return i?(0,e.jsx)(Lf,{source:t.streamingUrl,planId:t.id,isThumbnail:!0}):!l||o?(0,e.jsxs)(_m,{children:[(0,e.jsx)(SC,{children:c(a)}),(0,e.jsx)("img",{src:Wm,alt:"placeholder",style:{pointerEvents:"none",maxWidth:r??"none"}})]}):(0,e.jsx)(Um,{fileUuid:t.uuid,projectId:n,handleError:()=>s(!0)})};var cR=m(41225);const uR=({file:t,projectId:n,quoteId:s})=>{const[o,r]=(0,d.useState)(!1),[a,i]=(0,d.useState)(!1),l=p=>`/projects/${n}/materials/quote/${s}/document/video/${p}`,c=p=>`/projects/${n}/materials/quote/${s}/document/${p}`,u=()=>t.streamingUrl?l(t.id):c(t.id);return(0,e.jsx)(qt.A,{title:t.plansName,placement:"bottom",children:(0,e.jsxs)(KT,{"data-testid":`quote-details-file-info-${t.id}`,children:[(0,e.jsx)(YT,{children:(0,e.jsx)(Ff,{plan:t,projectId:n,setError:i,error:a,maxWidth:"190px"})}),(0,e.jsxs)(qT,{children:[(0,e.jsxs)(XT,{onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[(0,e.jsx)(L.Link,{to:u(),children:(0,e.jsx)(JT,{"data-testid":`material-quote-document-${t.id}`,children:t.displayName})}),o&&(0,e.jsx)(ZT,{"data-testid":`download-${t.id}`,href:t.url,style:{height:16,width:16},children:(0,e.jsx)(cR.A,{})})]}),(0,e.jsx)(eR,{children:Qo(t.createdAt,!0)})]})]})},t.id)},pR=({quoteSummary:t,projectId:n})=>{const{files:s}=pi(parseInt(n),t?.quoteId),o=3,r=s.slice(0,o),a=(0,L.useNavigate)();return s.length===0?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(Nh.A,{disableGutters:!0,elevation:0,defaultExpanded:!0,sx:{marginLeft:"24px",backgroundColor:"transparent"},children:[(0,e.jsx)(_h.A,{expandIcon:(0,e.jsx)(Sg.A,{}),sx:{display:"flex",gap:"8px",alignItems:"center",flexDirection:"row-reverse"},"data-testid":"collapsible-files-content",children:(0,e.jsxs)(E.A,{sx:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,e.jsx)($T,{children:"Quote Documents"}),(0,e.jsx)(HT,{children:s.length})]})}),(0,e.jsx)(Uh.A,{children:(0,e.jsxs)(VT,{children:[s.length>0&&r.map(i=>(0,e.jsx)(uR,{file:i,projectId:n,quoteId:t?.quoteId})),(0,e.jsx)(QT,{children:(0,e.jsx)(GT,{onClick:()=>a(`/projects/${n}/documents/quote/${t?.quoteId}`),children:(0,e.jsxs)(tR,{children:[s.length>o&&(0,e.jsxs)(nR,{children:["+",s.length-o," More"]}),(0,e.jsx)(sR,{children:"View in Documents"})]})})})]})})]})},Bf=({project:t,bidPacks:n,orderPacks:s,openModal:o,selectedPack:r,setSelectedPack:a,bidSummaryHtml:i,bidSummaryTotal:l,loadingState:c,showLineItemPricing:u,showQuantity:p,showPackTotals:f,partialPackOrderEnabled:h=!1,grandTotal:b,grandTotalOnly:x,totalInfo:v,quoteSummary:y,isResponsive:j=!1})=>{const A=(0,d.useRef)(null),w=(0,d.useRef)(!1),{isGridView:P,handleIconClick:C}=pu(),k=(T,W=!1)=>{a(T),W&&o(!0)};(0,d.useEffect)(()=>{if(r){const T=document.getElementById(String(as(r)));T&&(w.current=!0,T.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout(()=>{w.current=!1},1e3))}},[r]),(0,d.useEffect)(()=>{r||(n&&n.length>0?a(n[0]):s&&s.length>0&&a(s[0]))},[r,n,s,a]);const S=(0,d.useRef)(r),R=(0,d.useCallback)((0,H.debounce)(()=>{const T=A.current,W=T?.querySelectorAll(".pack-list-item"),N=[...n,...s.flatMap(Q=>{const re=[];return Q.status!=="DELIVERED"&&Q.lineItems.length>0&&re.push(Q),Q.deliveries&&re.push(...Q.deliveries),re})];let O=-1,z=0;if(W?.forEach((Q,re)=>{const ue=Q.getBoundingClientRect(),le=Math.min(ue.bottom,window.innerHeight)-Math.max(ue.top,0),F=Math.max(0,le);F>z&&(z=F,O=re)}),O!==-1){const Q=N[O];Q&&as(Q)!==as(S.current)&&a(Q)}if(!(!T||!W)&&T.scrollTop===0){N.length>0&&as(N[0])!==as(r)&&a(N[0]);return}},300),[n,s,a]),B=(0,d.useCallback)(()=>{if(!w.current)return R()},[w,R]);return(0,d.useEffect)(()=>{const T=A.current;if(T)return T.addEventListener("scroll",B),()=>{T.removeEventListener("scroll",B)}},[B]),j?(0,e.jsx)(is,{children:(0,e.jsx)(Of,{project:t,bidPacks:n,orderPacks:s,projectId:t.id.toString(),selectedId:vs.getTypedPackId(r),bidSummaryTotal:l,handlePackClick:k,loadingState:c,openModal:()=>o(!1),showPackTotals:f,quoteTotal:b,grandTotalOnly:x,totalInfo:v,partialPackOrderEnabled:h,isResponsive:j,showLineItemPricing:u,showQuantity:p})}):(0,e.jsxs)(J2,{children:[(0,e.jsx)(Of,{project:t,bidPacks:n,orderPacks:s,projectId:t.id.toString(),selectedId:vs.getTypedPackId(r),bidSummaryTotal:l,handlePackClick:k,loadingState:c,openModal:()=>o(!1),showPackTotals:f,quoteTotal:b,grandTotalOnly:x,totalInfo:v,partialPackOrderEnabled:h,showLineItemPricing:u,showQuantity:p}),(0,e.jsxs)(v2,{children:[(0,e.jsx)(pR,{projectId:t.id.toString(),quoteSummary:y}),r?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Jg,{variant:"text",children:[(0,e.jsx)(qt.A,{title:"Thumbnail View",arrow:!0,children:(0,e.jsx)(pt.A,{onClick:()=>C(!0),disabled:P,style:{borderRadius:0},children:(0,e.jsx)("img",{src:P?Af:jf,alt:"grid-view",style:{opacity:P?1:.5}})})}),(0,e.jsx)(qt.A,{title:"List View",arrow:!0,children:(0,e.jsx)(pt.A,{onClick:()=>C(!1),disabled:!P,style:{borderRadius:0},children:(0,e.jsx)("img",{src:P?Cf:Sf,alt:"list-view",style:{opacity:P?.5:1}})})})]}),(0,e.jsxs)(b2,{ref:A,children:[n.map((T,W)=>(0,e.jsx)("li",{id:as(T)?String(as(T)):void 0,className:"pack-list-item",style:{marginBottom:"25px"},children:(0,e.jsx)(_l,{selectedPack:T,openModal:()=>k(T,!0),project:t,showLineItemPricing:u,showQuantity:p,grandTotalOnly:x,partialPackOrderEnabled:h&&!ri(T.status)})},`bidPack-${W}`)),s.flatMap(T=>{const W=[];return T.status!=="DELIVERED"&&T.lineItems.length>0&&W.push((0,e.jsx)("li",{id:as(T)?String(as(T)):void 0,className:"pack-list-item",style:{marginBottom:"25px"},children:(0,e.jsx)(_l,{selectedPack:T,openModal:()=>k(T,!0),project:t,showLineItemPricing:u,showQuantity:p,grandTotalOnly:x})},`order-${as(T)}`)),T.deliveries.forEach((N,O)=>{W.push((0,e.jsx)("li",{id:as(N)?String(as(N)):void 0,className:"pack-list-item",style:{marginBottom:"15px",marginLeft:"20px"},children:(0,e.jsx)(_l,{selectedPack:N,openModal:()=>{},project:t,showLineItemPricing:u,showQuantity:p,grandTotalOnly:x})},`delivery-${N.deliveryId||O}`))}),W})]})]}):(0,e.jsx)(zT,{projectId:t.id,projectName:t.projectName,projectAddress:t.address,osrEmail:t.osrEmail,bidSummaryHtml:i})]})]})};var fu=m(65724);const mR=(0,g.Ay)("div")`
  display: flex;
  padding: 24px;
  flex-direction: column;
  align-items: flex-start;
  gap: 16px;
  flex: 1 0 0;
  align-self: stretch;
`,hR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  position: relative;
  flex: 1;
`,gR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  margin: auto;
  width: 552px;
  position: relative;
  align-self: center;

  ${t=>t.theme.breakpoints.down("md")} {
    flex-direction: column;
    margin: 24px auto;
    width: 80%;
  }
`,fR=(0,g.Ay)("img")`
  width: 100%;
  object-fit: cover;
`,xR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  align-self: stretch;
`,yR=(0,g.Ay)("div")`
  display: flex;
  align-items: center;
  gap: 8px;
`,N8=(0,g.Ay)("div")`
  flex: 1;
  padding: 20px;
  font-size: 14px;
  line-height: 1.2em;
  color: var(--bfs-primary-true-white);
  background-color: var(--bfs-11-22-nav-background-gray);
  width: 35%;

  ${t=>t.theme.breakpoints.down("md")} {
    width: auto;
  }

  h5 {
    font-size: 16px;
    font-weight: bold;
    margin: 8px 0 -10px 0;
  }
`,bR=(0,g.Ay)("div")`
  display: flex;
  flex: 2;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  text-align: center;
  padding: 20px;
  background-color: var(--bfs-primary-true-white);

  ${t=>t.theme.breakpoints.down("md")} {
    width: auto;
  }
`,vR=(0,g.Ay)("div")`
  font-size: 22px;
  font-weight: 600;
`,mi=(0,g.Ay)("div")`
  font-weight: 600;
`,_8=(0,g.Ay)(mi)`
  margin-bottom: 0.5rem;
`,U8=(0,g.Ay)("p")`
  font-style: italic;
  max-width: 370px;
`,W8=(0,g.Ay)("div")`
  width: 122px;
  height: 36px;
  flex-grow: 0;
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  gap: 8px;
  padding: 0;
  margin: 15px;
  color: var(--bfs-primary-true-white);
  background-color: var(--graythorne-yellows-yellow-2);
`,jR=(0,g.Ay)(K.A)`
  background-color: var(--light-secondary-main);
  font-weight: normal;
  font-size: 16px;
  margin: auto;
`,z8=({href:t,isDisabled:n})=>jsx("div",{style:{textAlign:"center"},children:jsx(CenteredLink,{href:t,target:"_blank",children:jsx(jR,{variant:"contained",disableElevation:!0,disabled:n,children:"Contact Sales Rep"})})}),Nf=(0,g.Ay)("div")`
  width: 100%;
  display: flex;
  flex-direction: column;
  margin-top: 1.5rem;
  text-align: left;
`,_f=(0,g.Ay)(mi)`
  text-align: left;
  margin-bottom: 0.5rem;
`,Uf=(0,g.Ay)("div")`
  text-align: left;
  width: 100%;
  margin: 7px 0;
`,AR=(0,g.Ay)(fu.A)`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  row-gap: 4px;
  column-gap: 6px;
  text-align: left;

  @media screen and (max-width: 600px) {
    grid-template-columns: 1fr;
  }
`,V8=(0,g.Ay)(ye.A)`
  margin-bottom: -10px;
`,Wf=(0,g.Ay)("div")`
  text-align: left;
  width: 100%;
  display: flex;
  justify-content: flex-end;
`,CR=(0,g.Ay)(E.A)`
  padding: 16px;
  border: 1px solid #e3e4e5;
  border-radius: 4px;
  display: flex;
  align-items: center;
`,SR=(0,g.Ay)(I.A)`
  font-family: 'Roboto', sans-serif;
  font-size: 14px;
  font-weight: 500;
`,wR=(0,g.Ay)(I.A)`
  font-size: 14px;
  color: #5d6062;
`,ER=(0,g.Ay)(E.A)`
  display: flex;
  flex-direction: row;
  gap: 12px;
  align-items: center;
`,PR=m.p+"a0bebdaf4c929b1c1412e81e98108532.jpg",Ul=m.p+"3496d572bcbda9ebf7ab37cad3779bb3.png",zf=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  align-self: stretch;
  border-bottom: 1px solid var(--Colors-Border-border-secondary, #eff0f0);
  border-radius: 16px 16px 0 0;
  background: var(--Colors-Background-bg-primary, #fff);
  box-shadow: 0 -4px 8px -2px rgba(0, 0, 0, 0.1),
    0 2px 4px -2px rgba(0, 0, 0, 0.06);
  padding: 24px 16px 16px 16px;
  flex-direction: column;
  align-items: center;
  align-self: stretch;
`,Vf=(0,g.Ay)("div")`
  display: flex;
  padding: 0px 16px 0px 16px;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  align-self: stretch;
`,IR=(0,g.Ay)(I.A)`
  color: var(--Colors-Text-text-primary, #0b0c0d);

  /* Typography/h6/Semibold */
  font-size: 18px;
  font-style: normal;
  font-weight: 600;
`,$f=(0,g.Ay)(I.A)`
  color: var(--Colors-Text-text-secondary, #3e4041);

  /* Typography/body2/Regular */
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
`,DR=(0,g.Ay)("div")`
  display: flex;
  justify-content: space-between;
  align-items: center;
  align-self: stretch;
  display: flex;
  padding-right: 8px;
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  gap: var(--2, 4px);
  flex: 1 0 0;
  color: #0b0c0d;
`,xu=(0,g.Ay)("div")`
  display: flex;
  padding: var(--5, 12px);
  flex-direction: column;
  align-items: center;
  gap: var(--3, 6px);
  align-self: stretch;
  border-top: 1px solid var(--Colors-Border-border-tertiary, #f4f5f5);
  position: fixed;
  bottom: 0;
  background: #fff;
  z-index: 100;
`,yu=(0,g.Ay)("div")`
  display: flex;
  justify-content: space-between;
  align-items: center;
  align-self: stretch;
`,bu=(0,g.Ay)("div")`
  display: flex;
  padding: 16px var(--6, 16px) 16px var(--6, 16px);
  flex-direction: column;
  align-items: flex-start;
  gap: var(--7, 24px);
  align-self: stretch;
  overflow-y: auto;
  max-height: 70%;
`,Hf=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 16px;
  align-self: stretch;
`,Qf=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 8px;
  width: 100%;
`,Gf=(0,g.Ay)("div")`
  display: flex;
  align-items: center;
  gap: 8px;
`,Kf=(0,g.Ay)("div")`
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  border-radius: 4px;
  border: 1px solid var(--Colors-Border-border-secondary, #eff0f0);
  background: var(--Colors-Background-bg-primary, #fff);
`,$8=(0,g.Ay)(I.A)`
  font-family: 'Roboto', sans-serif;
  font-size: 14px;
  font-weight: 500;
`,H8=(0,g.Ay)(I.A)`
  font-size: 14px;
  color: #5d6062;
`,Yf=(0,g.Ay)("li")`
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  align-self: stretch;
  &:not(:last-child) {
    border-bottom: 1px solid var(--Colors-Border-border-secondary, #eff0f0);
  }
`,qf=(0,g.Ay)("div")`
  display: flex;
  padding: 8px 12px 8px 12px;
  align-items: center;
  gap: 8px;
  align-self: stretch;
  width: 100%;
`,Wl=(0,g.Ay)(I.A)`
  display: flex;
  padding: 4px 0;
  flex-direction: column;
  align-items: flex-start;
  flex: 1 0 0;
  color: var(--Colors-Text-text-secondary, #3e4041);

  font-size: 16px;
  font-style: normal;
  font-weight: 400;
  line-height: 24px;
`,Xf=(0,g.Ay)(ve.A)`
  display: flex;
  align-items: flex-start;
`,hi=(0,g.Ay)(pt.A)`
  display: flex;
  width: 36px;
  flex-direction: column;
  align-items: flex-start;
`,kR=(0,g.Ay)("div")`
  display: flex;
  width: 100%;
  padding-bottom: 4px;
  flex-direction: column;
  align-items: flex-start;
  border-radius: var(--border-radius, 4px);
  border: 1px solid var(--Colors-Border-border-info-tertiary, #d3ebf7);
  background: var(--Colors-Background-bg-info-primary, #e9f5fb);

  justify-content: center;
  align-self: stretch;
`,TR=(0,g.Ay)("div")`
  display: flex;
  padding: var(--6, 16px) var(--6, 16px) 12px var(--6, 16px);
  align-items: flex-start;
  align-self: stretch;
  display: flex;
  flex-direction: row;
`,RR=(0,g.Ay)("div")`
  display: flex;
  padding: 0 var(--2, 4px) 0 var(--4, 8px);
  justify-content: flex-end;
  align-items: center;
  gap: 4px;
  align-self: stretch;
`,OR=(0,g.Ay)(K.A)`
  display: flex;
  padding: var(--4, 8px) var(--5, 12px);
  justify-content: center;
  align-items: center;
  gap: var(--3, 6px);
`,Q8=(0,g.Ay)("div")`
  display: flex;
  padding: var(--5, 12px);
  flex-direction: row;
  align-items: center;
  gap: var(--3, 6px);
  align-self: stretch;
  border-top: 1px solid var(--Colors-Border-border-tertiary, #f4f5f5);
  width: 100%;
  background-color: #ffffff;
`,G8=(0,g.Ay)("div")`
  display: flex;
  padding: var(--spacing-sm, 6px) var(--3, 6px);
  justify-content: space-between;
  align-items: center;
  align-self: stretch;
`,vu=(0,g.Ay)(K.A)`
  display: flex;
  padding: var(--4, 8px) var(--5, 12px);
  justify-content: center;
  align-items: center;
  gap: var(--3, 6px);
`,MR=(0,g.Ay)(I.A)`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  flex: 1 0 0;
`,LR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 24px;
  align-self: stretch;
`,FR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: var(--7, 24px);
  align-self: stretch;
`,BR=(0,g.Ay)("div")`
  display: flex;
  padding: 16px;
  flex-direction: column;
  align-items: flex-start;
  gap: 16px;
  align-self: stretch;
  border-radius: 4px;
  border: 1px solid var(--Colors-Border-border-secondary, #eff0f0);
  background: var(--Colors-Background-bg-primary, #fff);
`,NR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  align-self: stretch;
`,_R=(0,g.Ay)(I.A)`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 4px;
  align-self: stretch;
  color: var(--Colors-Text-text-primary, #0b0c0d);

  /* Typography/h6/Semibold */
  font-size: 18px;
  font-style: normal;
  font-weight: 600;
  line-height: 28px; /* 155.556% */
`,UR=(0,g.Ay)("div")`
  display: flex;
  align-items: center;
  align-content: center;
  gap: 4px;
  align-self: stretch;
  width: 100%;
`,WR=(0,g.Ay)(I.A)`
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--Colors-Text-text-tertiary, #636769);

  /* Typography/body2/Regular */
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 20px; /* 142.857% */
`,zR=(0,g.Ay)("div")`
  width: 4px;
  height: 4px;
  aspect-ratio: 1/1;
  border-radius: 9999px;
  background: var(--Colors-Foreground-fg-quaternary, #75787b);
`,Jf=(0,g.Ay)(Rn.A)`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: flex-start;
  gap: 8px;
  right: 4px;
  font-size: 14px;
  cursor: pointer;
  background: white;
  padding: 0px 4px;
  z-index: 1;
`,VR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: var(--5, 12px);
  align-self: stretch;
`,$R=(0,g.Ay)(I.A)`
  display: flex;
  align-items: center;
  gap: 8px;
  align-self: stretch;
  color: var(--Colors-Text-text-tertiary, #636769);

  /* Typography/body2/Regular */
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 20px; /* 142.857% */
`,HR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 12px;
  align-self: stretch;
`,Zf=(0,g.Ay)(I.A)`
  display: flex;
  justify-content: flex-start;
  align-items: center;
  padding-bottom: 6px;
  color: var(--Colors-Text-text-secondary, #3e4041);
  font-feature-settings: 'liga' off, 'clig' off;

  /* Text field/labelOutlined */
  font-size: 16px;
  font-style: normal;
  font-weight: 500;
  line-height: 24px; /* 150% */
`,ju=(0,g.Ay)(I.A)`
  display: flex;
  align-items: center;
  gap: 8px;
`,QR=(0,g.Ay)(_.A)`
  display: flex;
  align-items: flex-start;
  align-self: stretch;
  border-radius: var(--border-radius, 4px);
  margin-top: 0px;
  margin-bottom: 0px;
`,ex=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 16px;
  align-self: stretch;
  background: var(--Colors-Background-bg-primary, #fff);
  padding: 16px 16px 0px 16px;
`,tx=(0,g.Ay)(I.A)`
  display: flex;
  align-items: start;
  gap: 8px;
  align-self: stretch;
  color: var(--Colors-Text-text-primary, #0b0c0d);
  text-align: left;

  /* Typography/body1/Regular */
  font-size: 16px;
  font-style: normal;
  font-weight: 400;
`,GR=(0,g.Ay)("div")`
  display: flex;
  height: 24px;
  align-items: center;
  gap: 8px;
  flex-direction: row;
`,KR=(0,g.Ay)(I.A)`
  display: flex;
  height: 24px;
  align-items: center;
  gap: 8px;
`,YR=(0,g.Ay)(K.A)`
  display: flex;
  padding: var(--4, 8px) var(--6, 16px);
  justify-content: center;
  align-items: center;
  gap: var(--3, 6px);
  flex: 1 0 0;
  align-self: stretch;
  border-radius: var(--borderRadius, 4px);
  background: var(--Colors-Background-bg-brand-solid, #1d6bcd);

  /* Shadow/xs */
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
`,qR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 24px;
  align-self: stretch;
`,XR=(0,g.Ay)("div")`
  display: flex;
  padding: 16px;
  flex-direction: column;
  align-items: flex-start;
  gap: 16px;
  align-self: stretch;
  background: var(--Colors-Background-bg-primary, #fff);
`,JR=(0,g.Ay)("div")`
  border-radius: 4px;
  background: var(--Colors-Background-bg-primary, #fff);
  width: 100%;
`,ZR=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 16px;
  align-self: stretch;
  width: 100%;
`,eO=(0,g.Ay)(I.A)`
  display: flex;
  align-items: center;
  gap: 8px;
  align-self: stretch;
  color: #a50722;
  text-align: left;
`,nx=(0,g.Ay)("div")`
  display: flex;
  height: 74px;
  flex-direction: column;
  align-items: flex-start;
  gap: 6px;
  align-self: stretch;
`,tO=(0,g.Ay)(_.A)`
  display: flex;
  height: 44px;
  align-items: center;
  gap: 24px;
  flex-shrink: 0;
  align-self: stretch;
  width: 100%;
`,sx=(0,g.Ay)(sr.A)`
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  color: #3e4041;
`,nO=(0,g.Ay)(Be.A)`
  display: flex;
  height: 44px;
  justify-content: space-between;
  align-items: center;
  flex-shrink: 0;
  align-self: stretch;
`,sO=({onBack:t,onNext:n,onSubmit:s,isSubmitting:o,step:r,disabled:a,categoriesSelected:i,totalSteps:l})=>l===1?(0,e.jsx)(Au,{currentStep:r,rightButtonText:"Start Quote Request",rightButtonAction:s,disabled:a,bidRequested:o,totalSteps:1}):r===2?(0,e.jsx)(Au,{currentStep:r,leftButtonText:"Previous",leftButtonAction:t,rightButtonText:"Start Request",rightButtonAction:s,disabled:a,bidRequested:o,totalSteps:l}):(0,e.jsx)(Au,{currentStep:r,rightButtonText:"Next",rightButtonAction:n,disabled:i,totalSteps:l,bidRequested:o}),Au=({currentStep:t,leftButtonText:n,leftButtonAction:s,rightButtonText:o,rightButtonAction:r,disabled:a,totalSteps:i,bidRequested:l})=>i===1?(0,e.jsx)(xu,{sx:{width:"calc(100% - 24px)"},children:(0,e.jsx)(yu,{children:(0,e.jsx)(vu,{onClick:()=>r(),disabled:a,variant:"contained",sx:{width:"100%"},children:l?(0,e.jsx)(bt.A,{size:28,color:"inherit"}):o})})}):(0,e.jsx)(xu,{sx:{width:"calc(100% - 24px)"},children:(0,e.jsxs)(yu,{children:[n&&s?(0,e.jsx)(vu,{variant:"outlined",sx:{border:"1px solid var(--Colors-Border-border-primary, #d8d9da)",color:"var(--Colors-Text-text-secondary, #3e4041)"},onClick:()=>s(),children:n}):(0,e.jsx)(hi,{}),(0,e.jsx)(MR,{children:`${t} / 2`}),(0,e.jsx)(vu,{onClick:()=>r(),disabled:a,variant:"contained",children:l?(0,e.jsx)(bt.A,{size:28,color:"inherit"}):o})]})});function ox({project:t,isConfigureShoppable:n,bfsCategories:s,thirdPartyCategories:o,quoteRequestId:r}){const[a,i]=(0,d.useState)(!1),{userHasPermission:l}=(0,Ye.A)(),{lineId:c,quoteId:u,isLoading:p}=nc(t,!n),{isFlagEnabled:f}=(0,ut.u)(),h=f(D.SX.USE_NEW_QUOTE_REQUEST),b=f(D.SX.THIRD_PARTY_QUOTES),{allRoles:x}=(0,we.Sk)(),{requestBid:v,bidRequested:y,requestQuote:j}=sa(),{refreshQuoteSummary:A}=oo(t.id.toString()),{refresh3pQuoteSummary:w}=Do(t.id.toString()),P=s.reduce((ne,J)=>(ne[J.serviceRequestComponentTypeId]=J.checked,ne),{}),C=o.reduce((ne,J)=>(ne[J.serviceRequestComponentTypeId]=J.checked,ne),{}),k=ne=>{const J={},pe=ne.bidNeedByDate,Ee=dn()().startOf("date"),Te=ne.thirdPartyRequestDate;return T()&&(!pe?.isValid()||pe?.isBefore(Ee))?J.bidNeedByDate="invalid date":J.bidNeedByDate=void 0,B()&&(!Te?.isValid()||Te?.isBefore(Ee))?J.thirdPartyDate="invalid third party date":J.thirdPartyDate=void 0,Object.keys(J).forEach(me=>{J[me]===void 0&&delete J[me]}),J},S=(0,Ds.Wx)({initialValues:{notes:"",bidNeedByDate:null,thirdPartyNotes:"",thirdPartyRequestDate:null,selectedBfsCategories:P,selected3pCategories:C},validate:k,onSubmit:async()=>{y||he()}}),R=(0,d.useCallback)(()=>Object.values(S.values.selected3pCategories)?.some(ne=>ne===!0),[S]),B=(0,d.useCallback)(()=>R()&&S.values.thirdPartyRequestDate&&S.values.thirdPartyRequestDate.isValid()&&!S.errors.thirdPartyRequestDate?!1:R()?(R()&&!S.values.thirdPartyRequestDate?.isValid()&&S.errors.thirdPartyRequestDate,!0):!1,[R,S.errors.thirdPartyRequestDate,S.values.thirdPartyRequestDate]),T=(0,d.useCallback)(()=>S.values.bidNeedByDate&&S.values.bidNeedByDate.isValid()&&!S.errors.bidNeedByDate?!1:!(r&&h),[r,h,S.errors.bidNeedByDate,S.values.bidNeedByDate]),W=(0,d.useCallback)(()=>!l({tool:D.w5.MATERIALS,action:D.a2.REQUEST_BID,companyId:t.companyId,projectId:t.id}),[l,t]),N=(0,d.useCallback)(()=>r?Object.values(S.values.selectedBfsCategories).some(ne=>ne===!0)||Object.values(S.values.selected3pCategories).some(ne=>ne===!0):Object.values(S.values.selectedBfsCategories).some(ne=>ne===!0),[S.values.selected3pCategories,S.values.selectedBfsCategories,r]),O=()=>b&&o.length>0&&(!(0,ct.qE)(x)||(0,ct.EE)(x)),z=(0,d.useCallback)(ne=>{const J={...S.values.selectedBfsCategories};Object.keys(J).forEach(pe=>{+pe===ne&&(J[ne]=!J[ne])}),S.setFieldValue("selectedBfsCategories",J)},[S]),Q=(0,d.useCallback)(ne=>{const J={...S.values.selected3pCategories};Object.keys(J).forEach(pe=>{+pe===ne&&(J[ne]=!J[ne])}),S.setFieldValue("selected3pCategories",J)},[S]),re=(0,d.useCallback)(ne=>{S.setFieldValue("bidNeedByDate",ne)},[S]),ue=(0,d.useCallback)(ne=>{S.setFieldValue("thirdPartyRequestDate",ne)},[S]),le=Object.values(S.values.selectedBfsCategories).every(ne=>ne===!0),F=(0,d.useCallback)(()=>{const ne={...S.values.selectedBfsCategories};Object.keys(ne).forEach(J=>{ne[+J]=!le}),S.setFieldValue("selectedBfsCategories",ne)},[le,S]),V=Object.values(S.values.selected3pCategories).every(ne=>ne===!0),$=(0,d.useCallback)(()=>{const ne={...S.values.selected3pCategories};Object.keys(ne).forEach(J=>{ne[+J]=!V,S.setFieldValue("selected3pCategories",ne)})},[V,S]),ee=ne=>{const J=[];return Object.keys(ne).forEach(pe=>{ne[+pe]&&J.push(+pe)}),J},X=(ne,J)=>ne?.some(pe=>pe.marketplaceTags.some(Ee=>Ee.toLowerCase()===J.name.toLowerCase())),G=(ne,J)=>ne?.some(pe=>String(pe.serviceRequestComponentTypeId)===String(J.serviceRequestComponentTypeId)),Y=(0,d.useCallback)(()=>W()||!N()||p||Object.keys(S.errors).length!==0,[W,N,p,S.errors]),he=async()=>{i(!0);const ne={neededBy:S.values.bidNeedByDate?.toISOString()??"",bidCategories:ee(S.values.selectedBfsCategories),thirdPartyCategories:ee(S.values.selected3pCategories),notes:S.values.notes,thirdPartyNotes:S.values.thirdPartyNotes,thirdPartyRequestDate:S.values.thirdPartyRequestDate?.toISOString()??""};r&&h?await j(t.id,r,ne.bidCategories,ne.thirdPartyCategories,c,u,ne.thirdPartyNotes,ne.thirdPartyRequestDate):await v(t.id,ne.neededBy,ne.bidCategories,ne.notes,ne.thirdPartyCategories,c,u,ne.thirdPartyNotes,ne.thirdPartyRequestDate),A(),w(),i(!1)};return{formik:S,disabled:Y,canView3PCategories:O,handleUpdateBidCategory:z,handleDateChange:re,handleThirdPartyDateChange:ue,toggleAllCategories:F,allCategoriesSelected:le,isSubmitting:a,hasSelectionForCategory:X,hasQuoteForCategory:G,toggleAll3PCategoriesSelected:$,all3PCategoriesSelected:V,handleUpdateThirdPartyCategory:Q,isCategorySelected:N}}const oO=({projectName:t,projectAddress:n,step:s,onClose:o})=>{const r=()=>`${n?.streetOne}, ${n?.city}, ${n?.state}, ${n?.zip}`,a=s===1?"Select your quote categories":"Please select a 'Requested By' date and add any relevant comments.";return(0,e.jsxs)(zf,{children:[(0,e.jsxs)(Vf,{children:[(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",alignSelf:"stretch"},children:[(0,e.jsx)(IR,{variant:"h6",sx:{fontWeight:600},children:"Request Quote"}),(0,e.jsx)(pt.A,{onClick:o,children:(0,e.jsx)(co.A,{})})]}),(0,e.jsx)($f,{children:t}),(0,e.jsx)($f,{children:r()})]}),(0,e.jsx)(ex,{children:(0,e.jsx)(tx,{children:a})})]})};var rO=m(28153);const Cu=({value:t,labelText:n,onChange:s,disabled:o,isParent:r,onExpand:a,open:i,indeterminate:l=!1})=>(0,e.jsx)(Yf,{children:(0,e.jsxs)(qf,{children:[r?(0,e.jsx)(hi,{onClick:a,children:i?(0,e.jsx)(Wc.A,{}):(0,e.jsx)(rO.A,{})}):(0,e.jsx)(hi,{}),(0,e.jsx)(Wl,{sx:{fontWeight:r?"600":"400"},children:n}),(0,e.jsx)(Xf,{checked:t,disabled:o,onChange:c=>{s(c)},indeterminate:l??!1})]})}),aO=({bfsCategories:t,selectedBFSCategories:n,allCategoriesSelected:s,toggleAllCategories:o,handleUpdateBidCategory:r})=>{const[a,i]=(0,d.useState)(!0);return(0,e.jsx)(Hf,{children:(0,e.jsxs)(Qf,{children:[(0,e.jsxs)(Gf,{children:[(0,e.jsx)("img",{src:Ul,alt:"builder first source logo",style:{width:20,height:20}}),"Builder's FirstSource"]}),(0,e.jsx)(Kf,{children:(0,e.jsxs)(qn.A,{sx:{width:"100%",paddingY:0},children:[(0,e.jsx)(Cu,{labelText:"Select All",onChange:l=>o(),disabled:!1,value:s,isParent:!0,onExpand:()=>i(!a),open:a,indeterminate:Object.values(n).some(l=>l)&&!s}),(0,e.jsx)(ho.A,{in:a,children:t.map(l=>(0,e.jsx)(Cu,{value:n[l.serviceRequestComponentTypeId],onChange:()=>r(l.serviceRequestComponentTypeId),disabled:!1,labelText:l.name}))})]})})]})})},iO=({projectId:t,thirdPartyCategories:n,isConfigureShoppable:s,selected3pCategories:o,selectCategory:r,configureSelections:a,hasSelectionForCategory:i,hasQuoteForCategory:l,all3PCategoriesSelected:c,toggleAll3pCategories:u,canView3PCategories:p})=>{const{thirdPartyQuoteSummary:f}=Do(t),h=(0,d.useMemo)(()=>n.reduce((y,j)=>{const A=i(a,j),w=l(f?.thirdPartyQuotes,j);return y[j.serviceRequestComponentTypeId]={hasSelection:A,existingQuote:w},y},{}),[a,l,i,n,f?.thirdPartyQuotes]),[b,x]=(0,d.useState)(!1),v=n.some(y=>h[y.serviceRequestComponentTypeId].existingQuote||!h[y.serviceRequestComponentTypeId].hasSelection)||!s;return p()?(0,e.jsx)(Hf,{children:(0,e.jsxs)(Qf,{children:[(0,e.jsx)(Gf,{children:"Partners"}),(0,e.jsx)(dO,{}),(0,e.jsx)(Kf,{children:(0,e.jsxs)(qn.A,{style:{width:"100%"},children:[(0,e.jsx)(Cu,{labelText:"Select All",onChange:y=>{u()},disabled:v,value:c,isParent:!0,onExpand:()=>x(!b),open:b,indeterminate:Object.values(o).some(y=>y)&&!c}),(0,e.jsx)(ho.A,{in:b,children:n.map(y=>(0,e.jsx)(lO,{isConfigureShoppable:s,category:y,checked:o[y.serviceRequestComponentTypeId],onToggle:()=>r(y.serviceRequestComponentTypeId),status:h[y.serviceRequestComponentTypeId]},y.serviceRequestComponentTypeId))})]})})]})}):(0,e.jsx)(e.Fragment,{})},lO=({category:t,checked:n,onToggle:s,status:o,isConfigureShoppable:r})=>{const a=o.existingQuote||!o.hasSelection||!r;return(0,e.jsx)(Yf,{children:(0,e.jsxs)(qf,{children:[(0,e.jsx)(hi,{}),(0,e.jsx)(Wl,{sx:{fontWeight:"400"},children:t.sellerName}),(0,e.jsx)(Wl,{sx:{color:"#636769"},children:t.name}),(0,e.jsx)(Xf,{checked:n,disabled:a,onChange:()=>{s()}})]})})},dO=({...t})=>(0,e.jsxs)(kR,{children:[(0,e.jsxs)(TR,{children:[(0,e.jsx)(hi,{sx:{justifyContent:"start",alignSelf:"center","&.MuiIconButton-root":{padding:0}},children:(0,e.jsx)(Sl.A,{sx:{padding:"0px 8px 0px 0px"}})}),(0,e.jsx)(Wl,{sx:{color:"#1273B8"},children:"Some Categories are disabled until selections are made in Configure"})]}),(0,e.jsx)(RR,{children:(0,e.jsx)(L.Link,{to:`/projects/${t.projectId}/configure`,children:(0,e.jsx)(OR,{onClick:()=>{},children:"Make Selections"})})})]}),rx=({selectedCategories:t,onRequestDate:n,requestDate:s,onNotes:o,notes:r,isThirdParty:a,allAvailableCategories:i})=>{const l="Additional quote categories, other project info, etc.",c=a?"Partners":"Builder's FirstSource",[u,p]=(0,d.useState)(!1);return(0,e.jsx)(LR,{children:(0,e.jsx)(FR,{children:(0,e.jsxs)(BR,{children:[(0,e.jsxs)(NR,{children:[(0,e.jsx)(_R,{children:c}),(0,e.jsx)(cO,{availableCategories:i,selectedCategories:t})]}),a&&(0,e.jsxs)(GR,{children:[(0,e.jsx)(Ri.A,{checked:u,onChange:()=>p(!u)}),(0,e.jsx)(KR,{children:"Custom date and comment"})]}),(0,e.jsxs)(VR,{children:[(0,e.jsxs)(HR,{children:[(0,e.jsxs)(E.A,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:[(0,e.jsx)(Zf,{children:"Requested By Date"}),(0,e.jsx)(Xn.LocalizationProvider,{dateAdapter:ai.R,children:(0,e.jsx)(Xn.DatePicker,{label:"Select Date",value:s,onChange:n,views:["day"],disablePast:!0,slots:{openPickerIcon:Nr.A},slotProps:{textField:{variant:"outlined",fullWidth:!0}},disabled:a&&!u})}),(0,e.jsx)(ju,{})]}),(0,e.jsxs)(E.A,{sx:{width:"100%",display:"flex",flexDirection:"column"},children:[(0,e.jsx)(Zf,{children:"Comments"}),(0,e.jsx)(QR,{fullWidth:!0,multiline:!0,rows:3,margin:"normal",placeholder:l,type:"text",variant:"outlined",onChange:f=>o(f.target.value),value:r,InputLabelProps:{sx:{textWrap:"wrap"}},disabled:a&&!u})]})]}),(0,e.jsx)($R,{sx:{textAlign:"left"},children:"This requested by date and comment will apply to all requests unless manually updated"})]})]})})})},cO=({availableCategories:t,selectedCategories:n})=>{const[s,o]=(0,d.useState)(!1),r=(0,d.useRef)(null),[a,i]=(0,d.useState)(!1),l=Object.keys(n).filter(c=>n[+c]).map(c=>{const u=t.find(p=>p.serviceRequestComponentTypeId===+c);return u?u.name:""});return(0,d.useEffect)(()=>{const c=()=>{r.current&&i(r.current.scrollWidth>r.current.clientWidth)};return c(),window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[n]),(0,e.jsxs)(UR,{children:[(0,e.jsxs)(E.A,{sx:{display:"flex",flexWrap:s?"wrap":"nowrap",overflow:s?"visible":"hidden",whiteSpace:s?"normal":"nowrap",alignItems:"center",gap:"8px",maskImage:s?"none":"linear-gradient(to right, black 80%, transparent 100%)"},ref:r,children:[l.map((c,u)=>(0,e.jsxs)(se().Fragment,{children:[(0,e.jsx)(WR,{children:c}),u<l.length-1&&(0,e.jsx)(zR,{})]},c+u)),a&&s&&(0,e.jsx)(Jf,{underline:"none",onClick:()=>o(!s),children:"Show less"})]}),a&&!s&&(0,e.jsx)(se().Fragment,{children:(0,e.jsx)(Jf,{underline:"none",onClick:()=>o(!s),sx:{textWrap:"nowrap",margin:0,padding:0},children:"Show all"})})]})};var ax=m(78220);function uO({project:t,quoteRequestId:n,isConfigureShoppable:s,bfsCategories:o,thirdPartyCategories:r,configureSelections:a}){const[i,l]=(0,d.useState)(1),c=(0,L.useNavigate)(),{formik:u,disabled:p,canView3PCategories:f,handleUpdateBidCategory:h,handleDateChange:b,handleThirdPartyDateChange:x,toggleAllCategories:v,allCategoriesSelected:y,isSubmitting:j,hasSelectionForCategory:A,hasQuoteForCategory:w,toggleAll3PCategoriesSelected:P,all3PCategoriesSelected:C,isCategorySelected:k}=ox({project:t,isConfigureShoppable:s,bfsCategories:o,thirdPartyCategories:r,quoteRequestId:n}),S=[...r,...o];return(0,e.jsx)(is,{children:(0,e.jsxs)(ax.A,{onClose:()=>{c(-1)},onOpen:()=>{},open:!0,sx:{".MuiPaper-root":{width:"100%",height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",paddingBottom:"66px"}},anchor:"top",variant:"permanent",children:[(0,e.jsx)(oO,{projectName:t.projectName,projectAddress:t.address,step:i,onClose:()=>c(-1)}),i===1&&(0,e.jsxs)(bu,{sx:{maxHeight:"none"},children:[(0,e.jsx)(aO,{bfsCategories:o,selectedBFSCategories:u.values.selectedBfsCategories,allCategoriesSelected:y,handleUpdateBidCategory:h,toggleAllCategories:v}),(0,e.jsx)(iO,{projectId:t.id.toString(),thirdPartyCategories:r,isConfigureShoppable:s,selected3pCategories:u.values.selected3pCategories,selectCategory:R=>{u.setFieldValue("selected3pCategories",B=>{const T={...B};return T[R]=!B[R],T})},configureSelections:a,hasSelectionForCategory:A,hasQuoteForCategory:w,all3PCategoriesSelected:C,toggleAll3pCategories:P,canView3PCategories:f})]}),i===2&&!n&&(0,e.jsxs)(bu,{children:[(0,e.jsx)(rx,{selectedCategories:u.values.selectedBfsCategories,requestDate:u.values.bidNeedByDate,onRequestDate:b,onNotes:R=>u.setFieldValue("notes",R),notes:u.values.notes,isThirdParty:!1,allAvailableCategories:S}),f()&&(0,e.jsx)(rx,{selectedCategories:u.values.selected3pCategories,requestDate:u.values.thirdPartyRequestDate,onRequestDate:x,onNotes:R=>u.setFieldValue("thirdPartyNotes",R),notes:u.values.thirdPartyNotes,isThirdParty:!0,allAvailableCategories:S})]}),(0,e.jsx)(sO,{onBack:()=>l(1),onNext:()=>l(2),onSubmit:()=>u.handleSubmit(),isSubmitting:j,step:i,totalSteps:n?1:2,disabled:p(),categoriesSelected:!k()})]})})}var pO=m(90891);const mO=(t,n)=>t.some(s=>s.marketplaceTags.some(o=>o.toLowerCase()===n.name.toLowerCase())),hO=(t,n)=>t.some(s=>String(s.serviceRequestComponentTypeId)===String(n.serviceRequestComponentTypeId)),gO=({thirdPartyCategories:t,thirdPartyQuotes:n,selected3pCategories:s,selectCategory:o,isConfigureShoppable:r,configureSelections:a,thirdPartyRequestDate:i,setThirdPartyNotes:l,handleDateChange:c,thirdPartyNotes:u})=>{const p=(0,d.useMemo)(()=>t.reduce((h,b)=>{const x=mO(a,b),v=hO(n,b);return h[b.serviceRequestComponentTypeId]={hasSelection:x,existingQuote:v},h},{}),[a,t,n]),f=(0,d.useMemo)(()=>Object.values(p).some(h=>!h.hasSelection),[p]);return(0,e.jsxs)(Uf,{sx:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,e.jsx)(I.A,{sx:{fontWeight:600},children:"Partners"}),(0,e.jsxs)(Nf,{sx:{marginTop:0},children:[(0,e.jsx)(_f,{children:"Requested By"}),(0,e.jsx)(Xn.LocalizationProvider,{dateAdapter:ai.R,children:(0,e.jsx)(Xn.DatePicker,{onChange:c,value:i,views:["day"],disablePast:!0,components:{OpenPickerIcon:Nr.A},slotProps:{textField:{variant:"outlined",fullWidth:!0,InputProps:{style:{height:"40px"}}}}})})]}),f&&(0,e.jsx)(xO,{}),(0,e.jsx)(AR,{children:t.map(h=>(0,e.jsx)(fO,{isConfigureShoppable:r,category:h,checked:s[h.serviceRequestComponentTypeId],onToggle:()=>o(h.serviceRequestComponentTypeId),status:p[h.serviceRequestComponentTypeId]},h.serviceRequestComponentTypeId))}),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(mi,{children:"Notes"}),(0,e.jsx)(_.A,{fullWidth:!0,"data-testid":"third-party-notes",multiline:!0,rows:3,margin:"none",id:"notes",label:"Additional quote categories, product preferences, other project info, etc.",type:"text",variant:"outlined",onChange:h=>l(h.target.value),value:u,InputLabelProps:{sx:{textWrap:"wrap"}}})]})]})},fO=({category:t,checked:n,onToggle:s,status:o,isConfigureShoppable:r})=>{const a=o.existingQuote||!o.hasSelection||!r,i=()=>(0,e.jsxs)(ER,{children:[t.sellerLogoURL&&(0,e.jsx)("img",{style:{width:"45px",opacity:a?.5:1},src:t?.sellerLogoURL,alt:"logo"}),(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,e.jsx)(SR,{children:t.sellerName}),(0,e.jsx)(wR,{sx:{color:a?"#B3B5B6":""},children:t.name})]})]}),l=o.existingQuote?"A quote request for this category has already been placed.":"";return(0,e.jsx)(qt.A,{title:l,children:(0,e.jsx)(CR,{children:(0,e.jsx)(ye.A,{control:(0,e.jsx)(ve.A,{checked:n,onChange:()=>s(),name:`bid-category-${t.serviceRequestComponentTypeId}`}),disabled:a,label:i()})})})},xO=()=>{const{projectId:t}=(0,L.useParams)();return(0,e.jsx)(L.Link,{to:`/projects/${t}/configure`,children:(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"row",backgroundColor:"#E9F5FB",justifyContent:"space-between",alignItems:"center",borderRadius:"4px",padding:"8px 16px"},children:[(0,e.jsx)(pO.A,{sx:{color:"#176F98"}}),(0,e.jsx)(I.A,{sx:{fontSize:"14px",lineHeight:"20px",fontWeight:"400",color:"#176F98",paddingLeft:"12px",textAlign:"left"},children:"To enable quote categories you must select corresponding products in Configure."}),(0,e.jsx)(K.A,{variant:"text",color:"primary",sx:{fontSize:"12px",padding:"4px",minWidth:114},children:"Make Selections"})]})})},yO=({selectedBFSCategories:t,bfsCategories:n,allCategoriesSelected:s,toggleAllCategories:o,handleUpdateBidCategory:r,quoteRequestId:a,setNotes:i,val:l})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:12},children:(0,e.jsx)(Ou,{checked:s,labelText:"Select All",testId:"bid-category-select-all",onChange:c=>{o()},disabled:!1})}),(0,e.jsx)(fu.A,{style:{textAlign:"left",display:"grid",gridTemplateColumns:"repeat(2, 1fr)"},children:n.map(c=>(0,e.jsx)(Ou,{checked:t[c.serviceRequestComponentTypeId],labelText:c.name,testId:`bid-category-${c.serviceRequestComponentTypeId}`,onChange:()=>r(c.serviceRequestComponentTypeId),disabled:!1},c.serviceRequestComponentTypeId))}),!a&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(mi,{children:"Notes"}),(0,e.jsx)(_.A,{fullWidth:!0,"data-testid":"notes",multiline:!0,rows:3,margin:"normal",id:"notes",label:"Additional quote categories, product preferences, other project info, etc.",type:"text",variant:"outlined",onChange:c=>i(c.target.value),value:l,InputLabelProps:{sx:{textWrap:"wrap"}}})]}),(0,e.jsx)(Ce.A,{variant:"middle"})]});function bO({project:t,quoteRequestId:n,marketCategories:s,configureSelections:o,isConfigureShoppable:r,isResponsive:a}){const i=(0,L.useNavigate)(),{thirdPartyQuoteSummary:l}=Do(t.id.toString()),{allRoles:c}=(0,we.Sk)(),{bfsCategories:u,thirdPartyCategories:p}=(0,d.useMemo)(()=>{const S=[],R=[];return s.forEach(B=>{B.sellerName?R.push(B):((0,ct.qE)(c)||B.serviceRequestVisibility!==1)&&S.push(B)}),{bfsCategories:S,thirdPartyCategories:R}},[s,c]),{formik:f,disabled:h,canView3PCategories:b,handleUpdateBidCategory:x,handleDateChange:v,handleThirdPartyDateChange:y,toggleAllCategories:j,allCategoriesSelected:A,isSubmitting:w,handleUpdateThirdPartyCategory:P}=ox({project:t,isConfigureShoppable:r,bfsCategories:u,thirdPartyCategories:p,quoteRequestId:n}),{isFlagEnabled:C}=(0,ut.u)(),k=C(D.SX.USE_NEW_QUOTE_REQUEST);return a?(0,e.jsx)(uO,{project:t,quoteRequestId:n,bfsCategories:u,thirdPartyCategories:p,isConfigureShoppable:r,configureSelections:o}):(0,e.jsxs)(mR,{children:[(0,e.jsxs)(xR,{children:[(0,e.jsx)(I.A,{sx:{color:"rgba(93, 96, 98, 1)"},children:"Request Quote For"}),(0,e.jsx)(vR,{"data-testid":"project-name",children:t?.projectName}),(0,e.jsxs)(I.A,{children:[t.address?.streetOne," ",t.address?.city," ",t.address?.state," ",t.address?.zip]})]}),(0,e.jsx)(Ce.A,{variant:"middle"}),(0,e.jsx)(mi,{sx:{display:"flex",alignItems:"center",alignSelf:"stretch"},children:"Quote Categories"}),(0,e.jsxs)(yR,{children:[(0,e.jsx)("img",{src:Ul,alt:"builder first source logo",style:{width:20,height:20}}),(0,e.jsx)(I.A,{children:"Builders FirstSource"})]}),!n&&(0,e.jsxs)(Nf,{children:[(0,e.jsx)(_f,{children:"Requested By"}),(0,e.jsx)(Xn.LocalizationProvider,{dateAdapter:ai.R,children:(0,e.jsx)(Xn.DatePicker,{onChange:S=>v(S),value:f.values.bidNeedByDate,views:["day"],disablePast:!0,components:{OpenPickerIcon:Nr.A},slotProps:{textField:{variant:"outlined",fullWidth:!0,InputProps:{style:{height:"40px"}}}}})})]}),(0,e.jsxs)(Uf,{children:[(0,e.jsx)(yO,{selectedBFSCategories:f.values.selectedBfsCategories,bfsCategories:u,allCategoriesSelected:A,toggleAllCategories:j,handleUpdateBidCategory:x,quoteRequestId:n,setNotes:S=>f.setFieldValue("notes",S),val:f.values.notes}),b()&&(0,e.jsx)(gO,{thirdPartyCategories:p,selectCategory:S=>{P(S)},selected3pCategories:f.values.selected3pCategories,isConfigureShoppable:r,configureSelections:o,thirdPartyQuotes:l?.thirdPartyQuotes??[],thirdPartyRequestDate:f.values.thirdPartyRequestDate,setThirdPartyNotes:S=>f.setFieldValue("thirdPartyNotes",S),handleDateChange:y,thirdPartyNotes:f.values.thirdPartyNotes})]}),(0,e.jsxs)(Wf,{sx:{justifyContent:`${n&&k?"space-between":"flex-end"}`},children:[n&&k&&(0,e.jsx)(K.A,{variant:"contained",color:"secondary",onClick:()=>{i(`/projects/${t.id}/materials`)},sx:{justifySelf:"flex-start"},children:"Cancel Quote Request"}),(0,e.jsx)(K.A,{variant:"contained",color:"primary",disabled:h(),onClick:()=>{f.handleSubmit()},children:w?(0,e.jsx)(bt.A,{size:28,color:"inherit"}):" Start Quote Request"})]})]})}function vO(){const[t,n]=(0,d.useState)(),[s,o]=(0,d.useState)(!1),[r,a]=(0,d.useState)(),i=async(c,u,p)=>{n(!0),!c||c?.length==0||!u||u.length==0||!p||p?.length==0?(a(!1),n(!1)):l(u,c,p)},l=async(c,u,p)=>{o(!0);try{const f="/api/validate_project_address",h={city:u,state:c,zip:p},b=await nt.Ay.post(f,h),{valid:x}=b.data;a(x)}catch{a(!1)}finally{o(!1),n(!1)}};return{getAddressValidation:i,isAddressValid:r,requesting:t}}const ix=/^\d{5}(?:[-]\d{4})?$/;function Su({project:t}){const[n,s]=(0,d.useState)(null),[o,r]=(0,d.useState)(!1),{updateProject:a}=(0,Or.A)(),{refreshCategoryMaterials:i}=ui(t.id.toString()),{getAddressValidation:l,requesting:c,isAddressValid:u}=vO(),p=(0,d.useCallback)((h,b,x)=>{l(h,b,x)},[l]),f=(0,d.useCallback)(async()=>{if(n){const h={name:t.projectName,address:{street_one:n.street_one,city:n.city,state:n.state,zip:n.zip}};(t.address?.streetOne!==n.street_one||t.address?.city!==n.city||t.address?.state!==n.state||t.address?.zip!==n.zip)&&(await a(t.id,h),i())}},[n,t.projectName,t.address?.streetOne,t.address?.city,t.address?.state,t.address?.zip,t.id,a,i]);return(0,d.useEffect)(()=>{u&&c===!1?f().then(()=>r(!1)):u===!1&&c===!1&&r(!0)},[c,u,f]),(0,d.useEffect)(()=>{p(t.address?.city,t.address?.state,t.address?.zip)},[]),{isAddressValid:u,requesting:c,showAddressValidation:o,handleAddressValidation:p,setUpdatedAddress:s}}const jO=({project:t})=>{const n=(0,L.useNavigate)(),{isAddressValid:s,requesting:o,handleAddressValidation:r,setUpdatedAddress:a}=Su({project:t}),i=()=>{let c=!1;return ix.test(l.values.zip)||(l.errors.zip="Invalid zip",c=!0),l.values.city===""&&(l.errors.city="Missing City",c=!0),(l.values.state===""||l.values.state==="tbd")&&(l.errors.city="Missing State",c=!0),(l.values.zip===""||l.values.zip==="tbd")&&(l.errors.city="Missing Zip",c=!0),c},l=(0,Ds.Wx)({initialValues:{city:t.address?.city||"",street:t.address?.streetOne||"",state:t.address?.state||"",zip:t.address?.zip||""},onSubmit:async()=>{r(l.values.city,l.values.state,l.values.zip);const c={street_one:l.values.street,city:l.values.city,state:l.values.state,zip:l.values.zip};a(c)}});return(0,e.jsx)(is,{children:(0,e.jsx)(ax.A,{onClose:()=>{n(-1)},onOpen:()=>{},open:!0,anchor:"top",sx:{".MuiPaper-root":{width:"100%",height:"100%",backgroundColor:"var(--Colors-Background-bg-secondary, #fafafa)"}},variant:"permanent",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(zf,{children:[(0,e.jsx)(Vf,{children:(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",alignSelf:"stretch"},children:[(0,e.jsx)(DR,{children:(0,e.jsx)(I.A,{variant:"h6",sx:{fontWeight:600},children:"Project Address Verification"})}),(0,e.jsx)(pt.A,{onClick:()=>n(-1),children:(0,e.jsx)(co.A,{})})]})}),(0,e.jsx)(ex,{children:(0,e.jsx)(tx,{children:"Bid requests require a valid project city, state, and zip code. Please ensure your project's address is accurate and up to date before continuing."})})]}),(0,e.jsx)(bu,{children:(0,e.jsx)(qR,{children:(0,e.jsx)(XR,{children:(0,e.jsx)(JR,{children:(0,e.jsxs)(ZR,{children:[(0,e.jsx)(wu,{label:"Street Address/Location Description",value:l.values.street,onChange:c=>l.setFieldValue("street",c)}),(0,e.jsx)(wu,{label:"City*",value:l.values.city,onChange:c=>l.setFieldValue("city",c)}),(0,e.jsxs)(nx,{children:[(0,e.jsx)(sx,{children:"State*"}),(0,e.jsx)(nO,{sx:{"& .MuiInputBase-root":{width:"100%",textAlign:"left"},"& .MuiOutlinedInput-root":{border:"1px solid var(--common-white-30-p)"}},children:(0,e.jsx)(go.A,{id:"state",value:l.values.state,onChange:c=>l.setFieldValue("state",c.target.value),role:"list",label:"AL",children:_i.map(c=>(0,e.jsx)(it.A,{value:c,children:c},c))})}),(0,e.jsx)(ju,{})]}),(0,e.jsx)(wu,{label:"ZIP*",value:l.values.zip,onChange:c=>l.setFieldValue("zip",c),inputProps:{maxLength:10}}),!s&&!o&&(0,e.jsx)(eO,{children:"We are having trouble validating your project\u2019s city, state, and zip code. Please check the fields for accuracy. If you\u2019re still having issues, contact your sales rep for assistance."})]})})})})}),(0,e.jsx)(AO,{loading:!!(l.isSubmitting||o),disabled:i()||l.isSubmitting,onClick:()=>l.handleSubmit()})]})})})},AO=({loading:t,onClick:n,disabled:s})=>(0,e.jsx)(xu,{sx:{width:"calc(100% - 24px)"},children:(0,e.jsx)(yu,{children:(0,e.jsx)(YR,{variant:"contained",color:"primary",onClick:n,disabled:s,children:t?(0,e.jsx)(bt.A,{size:28,color:"inherit"}):"Validate & Start Quote Request"})})}),wu=({label:t,value:n,onChange:s,inputProps:o,error:r})=>(0,e.jsxs)(nx,{children:[(0,e.jsx)(sx,{children:t}),(0,e.jsx)(tO,{placeholder:t,value:n,onChange:a=>s(a.target.value),error:r,inputProps:o,sx:{".MuiInputBase-root":{width:"100%"}}}),(0,e.jsx)(ju,{})]}),CO=(0,Wn.A)("div")`
  font-size: 22px;
  font-weight: 600;
`,Eu=(0,Wn.A)(_.A)`
  text-align: center;
  background-color: var(--common-white-100-p);
  border-radius: 4px;
  border: 1px var(--common-white-30-p);
`,zl=(0,Wn.A)(sr.A)`
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  text-align: left;
  line-height: 1;
  letter-spacing: normal;
  font-weight: 700;
  color: var(--light-text-primary);
  padding: 2px 0;
  font-size: 12px;
  margin-bottom: 8px;
`,SO=(0,Wn.A)(Be.A)`
  width: 100%;
  text-align: center;
  background-color: var(--common-white-100-p);
  border-radius: 4px;
  margin-right: 1rem;

  .MuiOutlinedInput-root {
    // Targeting the input root to ensure border is visible
    border: 1px solid var(--common-white-30-p);
  }
`,wO=(0,Wn.A)(go.A)`
  width: 100%;
`,EO=(0,Wn.A)("div")`
  display: flex;
  width: 100%;
  justify-content: space-between; // Adjust space between items
`,PO=(0,Wn.A)("div")`
  text-align: left;
  width: 100%;
`,IO=(0,Wn.A)("div")`
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  height: 100%;
`;function DO({project:t,isResponsive:n}){const[s,o]=(0,d.useState)(""),[r,a]=(0,d.useState)(""),[i,l]=(0,d.useState)(""),[c,u]=(0,d.useState)(""),[p,f]=(0,d.useState)(!1),{isAddressValid:h,requesting:b,handleAddressValidation:x,setUpdatedAddress:v}=Su({project:t});(0,d.useLayoutEffect)(()=>{t&&(a(t.address?.city||""),u(t.address?.zip||""),l(t.address?.state||""),o(t.address?.streetOne||""))},[t]);const y=A=>{l(A.target.value)};(0,d.useEffect)(()=>{c&&f(ix.test(c))},[c]);const j=()=>{x(r,i,c),v({street_one:s,city:r,state:i,zip:c})};return n?(0,e.jsx)(jO,{project:t}):(0,e.jsxs)(IO,{children:[(0,e.jsxs)("div",{style:{marginTop:0},children:[(0,e.jsx)(CO,{children:"Project Address Verification"}),(0,e.jsx)("div",{style:{textAlign:"left",marginBottom:"30px",marginTop:"20px"},children:"Bid requests require a valid project city, state, and zip code. Please ensure your project\u2019s address is accurate and up to date before continuing."}),(0,e.jsxs)(PO,{children:[(0,e.jsx)(zl,{children:"Street Address/Location Description"}),(0,e.jsx)(Eu,{label:"1234 E Street",value:s,onChange:A=>{o(A.target.value)},style:{width:"100%"}})]}),(0,e.jsxs)(EO,{style:{width:"100%",marginTop:"15px",marginBottom:"15px"},children:[(0,e.jsxs)("div",{style:{flex:1,flexBasis:"15%",marginRight:"15px"},children:[(0,e.jsx)(zl,{children:"City *"}),(0,e.jsx)(Eu,{id:"city",label:"City",type:"text",value:r,onChange:A=>{a(A.target.value)},style:{width:"100%"}})]}),(0,e.jsxs)("div",{style:{flex:.5,marginRight:"15px"},children:[(0,e.jsx)(zl,{children:"State *"}),(0,e.jsx)(SO,{style:{width:"100%"},children:(0,e.jsx)(wO,{inputProps:{"data-testid":"state-select"},id:"state",value:i,onChange:A=>y(A),role:"list",label:"AL",MenuProps:{style:{maxHeight:400}},children:_i.map(A=>(0,e.jsx)(it.A,{value:A,children:A},A))})})]}),(0,e.jsxs)("div",{style:{flex:.5},children:[(0,e.jsx)(zl,{children:"Zip *"}),(0,e.jsx)(Eu,{id:"zip",label:"12345",inputProps:{maxLength:10},value:c,onChange:A=>{u(A.target.value)},error:!p,style:{width:"100%"}})]})]}),!h&&!b&&(0,e.jsx)("div",{style:{color:"#ff0000",textAlign:"left",marginTop:"30px"},children:"We are having trouble validating your project\u2019s city, state, and zip code. Please check the fields for accuracy. If you\u2019re still having issues, contact your sales rep for assistance."})]}),(0,e.jsx)(Wf,{style:{display:"flex",justifyContent:"flex-end",marginTop:"auto"},children:(0,e.jsx)(K.A,{variant:"contained",color:"primary",disabled:r===""||i===""||c===""||!p,onClick:()=>{b||j()},children:b===!0?(0,e.jsx)(bt.A,{size:28,color:"inherit"}):"Validate & Start Quote Request"})})]})}const kO=t=>{const{data:n,error:s,isLoading:o}=o2(t,{skip:!t});return{selections:(0,d.useMemo)(()=>n??[],[n]),error:s,isLoading:o}},lx=t=>{const{data:n,isFetching:s,isLoading:o,error:r,refetch:a}=s2(t,{skip:!t});return{data:n,isFetching:s,isLoading:o,error:r,refetch:a}};function TO({project:t,quoteRequestId:n}){const s=(0,Dt.A)(),o=(0,No.A)(s.breakpoints.down("md")),{allRoles:r}=(0,we.Sk)(),{selections:a,isLoading:i}=kO(t.id),{data:l,isLoading:c}=lx(String(t.id)),{isLoading:u}=(0,Or.A)(),{data:p}=ui(t.id.toString()),{isAddressValid:f,requesting:h,showAddressValidation:b}=Su({project:t}),x=()=>{const v=(0,ct.EL)(r),y=f&&p&&!u&&!b;return v?y:y&&!i&&!c};return(0,e.jsxs)(hR,{children:[(0,e.jsx)(fR,{src:PR,alt:"Lumber Background Image",sx:{width:"100%",height:"100%",position:"absolute",top:0,left:0}}),(0,e.jsx)(gR,{children:(0,e.jsxs)(bR,{style:{minHeight:"540px"},children:[h&&!b&&(0,e.jsx)(bt.A,{size:28,color:"inherit"}),x()&&(0,e.jsx)(bO,{project:t,quoteRequestId:n,marketCategories:p??[],isConfigureShoppable:l?.shoppable??!1,configureSelections:a,isResponsive:o}),b&&(0,e.jsx)(DO,{project:t,isResponsive:o})]})})]})}const RO=({disablePurchase:t,status:n,onClick:s,grandTotalOnly:o=!1})=>{const r=n||"UNKNOWN",{company:a}=(0,je.P)();return r===js.READY_FOR_ORDER&&a?.erpSystem!==An.v.AS400&&!o?(0,e.jsx)(K.A,{disabled:t,variant:"contained",size:"large","data-testid":"packTitleStatusButton",color:"success",onClick:s,sx:{marginRight:"2px",lineHeight:"1rem",borderRadius:"4px",padding:"10px 16px"},children:"Submit Order"}):(0,e.jsx)(ff,{dataTestId:"packTitleStatus",packStatusEnum:n,styles:{display:"flex",alignItems:"center",padding:"0 25px",fontSize:"24px",fontWeight:"700",height:"100%",marginBottom:"5px"}})},Y8=m.p+"d8773b22e8f47c34ce3799d697c9a6ec.png",q8=()=>{const{project:t}=useProject(),{company:n}=useCrewInfo(t?.id,t?.companyId);return jsx(Container,{children:jsxs(Group,{children:[jsxs(LeftColumn,{children:[jsx(Image,{src:BidInProgressImgSrc,alt:"Bid in progress placeholder"}),jsx("h5",{children:"Requesting a Quote"}),jsx("p",{children:"We'll contact you if we have any questions, otherwise we'll let you know when your quote is available. Please be sure to upload all necessary documents to this project's Documents area."}),jsx("h5",{children:"Questions? We're here to help!"}),jsx("p",{children:"Our team is always available to assist you at every step of the way, and we are fully committed to providing you with excellent customer service."}),!!n?.osrEmail&&jsx(ContactButton,{href:`mailto:${n?.osrEmail}`,isDisabled:!n})]}),jsxs(RightColumn,{children:["Bid Request for",jsx(Project,{"data-testid":"project-name",children:t?.projectName}),jsx(BidStatus,{children:"In Progress"}),jsx(Bold,{children:jsxs("p",{children:["Your BFS team is working on preparing your bid.",jsx("br",{}),"We'll notify you once it's ready."]})}),jsx(Note,{children:"Note: Please be sure to upload all necessary documents to this project's Documents area."})]})]})})},X8=null,Pu=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  flex-direction: row;
  gap: 24px;
  padding: 24px;
  font-size: 14px;
  overflow-y: auto;
`,OO=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  gap: 32px;
  width: 320px;
  flex: 0 0 320px;
  overflow-y: auto;
`,dx=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  flex-direction: column;
  overflow: auto;
`,cx=(0,g.Ay)(Zn.A)`
  height: 64px;
`,MO=(0,g.Ay)("div")`
  font-size: 16px;
  font-weight: bold;
`,aa=(0,g.Ay)("div")`
  min-width: 180px;
  max-width: 350px;
`,ux=(0,g.Ay)(K.A)`
  background-color: var(--light-primary-dark);
  width: 150px;
  margin-top: 1em;
`,px=(0,g.Ay)(I.A)`
  font-size: 18px;
  font-weight: bold;
  font-family: 'Roboto';
`,Iu=(0,g.Ay)(I.A)`
  font-size: 16px;
  font-weight: bold;
  font-family: 'Roboto';
`,J8=(0,g.Ay)(I.A)`
  font-weight: bold;
  font-size: 14px;
`,Vl=(0,g.Ay)(I.A)`
  font-family: 'Roboto';
  color: #333333;
  font-weight: 400;
  font-size: 12px;
`,gi=(0,g.Ay)(Ce.A)`
  margin-top: 8px;
  width: 100%;
  border-bottom: 1px solid black;
`,mx=(0,g.Ay)(Ce.A)`
  margin: 0;
  color: #333333;
  margin-right: 5px;
  margin-left: 5px;
`,Du=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  min-height: 100px;
  padding-top: 20px;
  gap: 4px;
`,LO=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  align-items: flex-end;
  height: 64px;
  justify-content: space-between;
  margin: 0 24px;
  border-bottom: 1px solid lightgray;
`,FO=(0,g.Ay)(ir.A)``,BO=(0,g.Ay)(Po.A)`
  font-family: 'Roboto';
  font-size: 16px;
  text-transform: none;
  color: black;
  font-weight: normal;

  &.last-tab {
    color: blue;
  }

  &.Mui-selected {
    font-weight: bold;
    color: black;
  }
`,NO=(0,g.Ay)("div")`
  display: flex;
  padding: var(--spacing-md, 8px) var(--spacing-xl, 16px);
  flex-direction: row;
  align-items: flex-start;
  align-self: stretch;
  border-radius: 4px;
  justify-content: space-between;
`,_O=(0,g.Ay)(K.A)`
  display: flex;
  padding: var(--spacing-xxs, 2px) 0px var(--spacing-xxs, 2px) 16px;
  align-items: center;
  border-radius: var(--borderRadius, 4px);
  color: white;
  border: 1px solid
    var(
      --Component-colors-Components-Button-Contained-warning-button-contained-warning-border_enabled,
      #dc6803
    );
  background: var(
    --Component-colors-Components-Button-Contained-warning-button-contained-warning-bg_enabled,
    #dc6803
  );

  /* Shadow/xs */
  box-shadow: 0px 1px 2px 0px rgba(0, 0, 0, 0.05);
  padding: var(--spacing-md, 8px) var(--spacing-lg, 12px);
  justify-content: center;
  gap: var(--spacing-sm, 6px);
`,UO=(0,g.Ay)("div")`
  flex-direction: column;
  display: flex;
  align-items: flex-start;
  align-self: stretch;
`,Z8=(0,g.Ay)("img")`
  display: flex;
  padding: 7px var(--spacing-512-px, 12px) 7px 0px;
  justify-content: center;
  align-items: center;
  width: 24px;
  height: 24px;
`,WO=(0,g.Ay)("div")`
  display: flex;
  padding: var(--spacing-md, 8px) 0px;
  flex-direction: column;
  align-items: flex-start;
  gap: var(--spacing-xs, 4px);
  flex: 1 0 0;
`,zO=(0,g.Ay)("div")`
  font-feature-settings: 'liga' off, 'clig' off;
  font-family: Roboto;
  font-size: 16px;
  font-style: normal;
  font-weight: 500;
  line-height: 150%;
  letter-spacing: 0.15px;
  align-content: center;
`,VO=(0,g.Ay)("div")`
  // color: var(--Colors-Text-text-warning-primary, #93370d);
  font-feature-settings: 'liga' off, 'clig' off;
  font-family: Roboto;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 143%;
  letter-spacing: 0.15px;
  padding-left: 36px;
`,$O=(0,g.Ay)("div")`
  display: flex;
  padding: var(--spacing-2xl, 24px) var(--spacing-2xl, 24px) 24px
    var(--spacing-2xl, 24px);
  flex-direction: column;
  align-items: flex-start;
  gap: var(--spacing-xl, 16px);
  align-self: stretch;
`,HO=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
`,QO=(0,g.Ay)("div")`
  padding: var(--spacing-md, 8px) 0px;
`,GO=({quoteSummary:t,isLoading:n,onUpdateDisplay:s,onShowSummary:o,selectedPack:r})=>{const a=t?.deliveries??[],i=t?.quotes??[],l=(0,d.useMemo)(()=>t?.orders??[],[t]),c=(0,d.useMemo)(()=>{const u={};return l.forEach(p=>{u[p.orderId]=p.quoteId}),u},[l]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(Iu,{children:"Quotes"}),(0,e.jsx)(gi,{}),i.length>0?(0,e.jsx)(Du,{children:(0,e.jsx)(qO,{quotes:i,onShowSummary:o,isSelected:!r})}):(0,e.jsx)(XO,{quoteSummary:t})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(Iu,{children:"All Deliveries"}),(0,e.jsx)(gi,{}),(0,e.jsx)(Du,{children:a?.length===0?(0,e.jsx)(Vl,{sx:{fontSize:14},children:"No Deliveries Scheduled"}):(0,e.jsx)(YO,{deliveries:a,onUpdateDisplay:s,selectedPack:r,orderQuoteIdMap:c})})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(Iu,{children:"All Unscheduled Orders"}),(0,e.jsx)(gi,{}),(0,e.jsx)(Du,{children:l?.length===0?(0,e.jsx)(Vl,{sx:{fontSize:14},children:"No Orders Pending"}):(0,e.jsx)(KO,{orders:l,onUpdateDisplay:s,selectedPack:r})})]})]})},KO=({orders:t,onUpdateDisplay:n,selectedPack:s})=>(0,e.jsx)(e.Fragment,{children:t.map(o=>{const r=s?.orderId===o.orderId&&!s?.deliveryId;return(0,e.jsx)(Wo,{role:"button",onClick:()=>n(o.orderId,o.packName,void 0,o.quoteId),sx:r?or:{},children:(0,e.jsx)(yf,{orderPack:o,selected:r})},o.orderId)})}),YO=({deliveries:t,onUpdateDisplay:n,selectedPack:s,orderQuoteIdMap:o})=>(0,e.jsx)(e.Fragment,{children:t.map(r=>{const a=s?.deliveryId===r.deliveryId;return(0,e.jsx)(Wo,{role:"button",onClick:()=>n(r.orderId,r.packName,r.deliveryId,o[r.orderId]),sx:a?or:{},children:(0,e.jsx)(Pf,{delivery:r,selected:a})},r.deliveryId)})}),qO=({quotes:t,onShowSummary:n,isSelected:s})=>{const o=t.some(a=>!!a.quotePublishedDate),r=()=>t.length===0?"":o?"Quotes Available":"Quotes Requested";return(0,e.jsx)(Wo,{role:"button",onClick:n,sx:s?or:{},children:(0,e.jsx)(ci,{selected:s,packName:"Summary",cardText:"",deliveryStatus:(0,e.jsx)("div",{style:{backgroundColor:"var(--graythorne-greens-green-3)",color:"white",marginTop:8,padding:"2px 6px",fontSize:12},children:r()})})})},XO=({quoteSummary:t})=>{const n=(0,Dt.A)(),{projectId:s}=(0,L.useParams)(),o=(0,L.useNavigate)();return t?.quoteRequestId?null:(0,e.jsx)(Wo,{role:"button",sx:{margin:`${n.spacing(1)} 0`},onClick:()=>{o(`/projects/${s}/materials/request_bid`)},children:(0,e.jsx)(I.A,{sx:{fontSize:"16px"},children:"Start Quote Request"})})},JO=(t,n)=>{const[s,o]=(0,d.useState)(!1),{createEvent:r}=(0,io.A)(),{fetchQuotePdf:a}=sa(),i=t&&"quotePDF"in t,l=i?t.quotePDF!==null:!0,c=(0,d.useCallback)((h,b,x=!1)=>{const v=document.createElement("a");v.href=h,v.download=`${b}-quote.pdf`,document.body.appendChild(v),v.click(),x&&window.URL.revokeObjectURL(h),document.body.removeChild(v)},[]),u=(0,d.useCallback)(async(h,b)=>{o(!0);const x=await a(h),v=window.atob(x),y=v.length,j=new Uint8Array(y);for(let P=0;P<y;P++)j[P]=v.charCodeAt(P);const A=new Blob([j],{type:"application/pdf"}),w=window.URL.createObjectURL(A);c(w,b,!0),o(!1)},[a,c]),p=(0,d.useCallback)((h,b,x)=>{const v=`/api/quotes/${h}/${n}/pdf_download/3p`;c(v,b)},[c,n]),f=(0,d.useCallback)(()=>{if(!t)return;const{quoteId:h,quoteName:b}=t;if(r({content_type:"project",object_id:n,tool:D.w5.MATERIALS,action:D.H1.DOWNLOAD,event_meta:{quoteId:h,quoteName:b}}),window.webkit?.messageHandlers?.quoteDownloadHandler)try{window.webkit.messageHandlers.quoteDownloadHandler.postMessage({event:"pdfDownload",data:{quoteId:h,quoteName:b,projectId:n,timestamp:new Date().toISOString()}})}catch(x){console.warn("Failed to send message to iOS:",x)}else console.info("WKScriptMessageHandler 'quoteDownloadHandler' not found - not running in iOS WebView");i&&t.quotePDF?p(h,b,t.quotePDF):u(h,b)},[u,p,t,r,n,i]);return{loading:s,downloadQuotePdf:f,canDownload:l}};var ZO=m(10609),e4=m(42400);function hx({quoteId:t,projectId:n,status:s,is3PQuote:o,canView3PDetails:r,thirdPartyContact:a}){const i=(0,L.useNavigate)(),{resetSelectedPacksForOrder:l}=oa(),c=(0,d.useCallback)(()=>{s===Yn.PUBLISHED&&(n&&l(n),i(`/projects/${n}/materials/quote/${t}`))},[n,t,l,i]),u=(0,d.useCallback)(()=>o&&r?s===Yn.EXPIRED||s===Yn.SELLER_SUBMITTED||s===Yn.BUYER_ORDERED:s===Yn.PUBLISHED,[s,o,r]);return{handleQuoteClick:c,shouldShowDetails:u,shouldShowContact:!r&&o&&a}}const t4=({quotes:t,thirdPartyQuotes:n,isResponsive:s=!1})=>{const{allRoles:o}=(0,Ye.A)(),r=!(0,ct.EL)(o),a=(0,L.useNavigate)(),{projectId:i}=(0,L.useParams)();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(gu.A,{sx:{width:"100%",paddingTop:"8px"},children:(0,e.jsxs)(ra.A,{sx:{border:`${s?"1px solid var(--light-secondary-light)":"none"}`,borderRadius:s?"4px":"none",overflow:"hidden",borderCollapse:"separate"},children:[!s&&(0,e.jsx)(n4,{}),(0,e.jsxs)(li.A,{sx:{width:"100%"},children:[t.map((l,c)=>(0,e.jsx)(gx,{index:c,quoteSummary:l,isResponsive:s},l.quoteId)),n?.map((l,c)=>(0,e.jsx)(gx,{index:c,thirdPartyQuoteSummary:l,canView3PDetails:r,isResponsive:s},l.quoteId))]})]})}),s&&(0,e.jsx)(K.A,{variant:"outlined",sx:{mt:"1rem",color:"text.primary",justifyContent:"left",borderColor:"lightgray",padding:".5rem 1rem",backgroundColor:"white",fontSize:"1rem"},startIcon:(0,e.jsx)(e4.A,{}),onClick:()=>a(`/projects/${i}/materials/request_bid`),children:"Request New Quote"})]})},n4=()=>(0,e.jsx)(di.A,{sx:{borderTopRightRadius:"8px",borderTopLeftRadius:"8px"},children:(0,e.jsxs)(cx,{sx:{backgroundColor:"white"},children:[(0,e.jsx)(xt.A,{children:"Name"}),(0,e.jsx)(xt.A,{children:"Status"}),(0,e.jsx)(xt.A,{children:"Seller"}),(0,e.jsx)(xt.A,{children:"Request By"}),(0,e.jsx)(xt.A,{}),(0,e.jsx)(xt.A,{}),(0,e.jsx)(xt.A,{sx:{width:"99%"}})]})}),gx=({index:t,quoteSummary:n,thirdPartyQuoteSummary:s,canView3PDetails:o=!1,isResponsive:r=!1})=>{const{projectId:a}=(0,L.useParams)(),i=n?n.quoteStatus:s?.status,{data:l,isLoading:c}=ui(a),{downloadQuotePdf:u,loading:p,canDownload:f}=JO(s??n,a),h=(0,d.useMemo)(()=>{const A=l?.find(w=>w.serviceRequestComponentTypeId.toString()===s?.serviceRequestComponentTypeId);return{name:A?.sellerName??"",logo:A?.sellerLogoURL??""}},[l,s?.serviceRequestComponentTypeId]),b=!!s,x=s??n,v=x.quoteExpiration,y={index:t,quoteId:x.quoteId,quoteName:x.quoteName,formattedStatus:Ok(i,v),status:i,sellerInfo:b?h:{logo:Ul,name:"Builders FirstSource"},projectId:a,onDownload:()=>u(),loading:p||!!(b&&c),is3PQuote:b,...b&&{canView3PDetails:o,thirdPartyContact:s?.contact},downloadEnabled:f},j={...y,quoteRequestedDate:v};return r?(0,e.jsx)(o4,{...y}):(0,e.jsx)(s4,{...j})},s4=({index:t,quoteId:n,quoteName:s,formattedStatus:o,status:r,quoteRequestedDate:a,projectId:i,onDownload:l,loading:c,sellerInfo:u,is3PQuote:p,downloadEnabled:f,canView3PDetails:h=!1,thirdPartyContact:b})=>{const{handleQuoteClick:x,shouldShowDetails:v,shouldShowContact:y}=hx({quoteId:n,projectId:i,status:r,is3PQuote:p,canView3PDetails:h,thirdPartyContact:b});return(0,e.jsxs)(cx,{sx:{backgroundColor:"white"},children:[(0,e.jsx)(xt.A,{children:(0,e.jsx)(aa,{sx:{flexDirection:"column",display:"flex",gap:"8px",minWidth:250},children:(0,e.jsx)(MO,{children:s})})}),(0,e.jsx)(xt.A,{children:(0,e.jsxs)(aa,{children:[r===Yn.REQUESTED?"Quote Requested":"",(0,e.jsx)("div",{children:o.text})]})}),(0,e.jsx)(xt.A,{children:(0,e.jsxs)(aa,{sx:{display:"flex",alignItems:"center",gap:"8px"},children:[u.logo&&(0,e.jsx)("img",{src:u.logo,alt:"seller logo",style:{width:24,height:24}}),u.name]})}),(0,e.jsx)(xt.A,{children:(0,e.jsx)(aa,{children:r===Yn.REQUESTED&&iu(a)})}),(0,e.jsxs)(xt.A,{children:[v()&&(0,e.jsxs)(aa,{sx:{gap:"8px",flexDirection:"row",display:"flex"},children:[(0,e.jsx)(ux,{variant:"contained",onClick:x,children:"View"}),(0,e.jsx)(ux,{variant:"contained",onClick:()=>l(n,s),disabled:c||!f,children:c?(0,e.jsx)(bt.A,{size:36}):"Download PDF"})]}),y&&(0,e.jsx)(aa,{children:(0,e.jsxs)(I.A,{sx:{fontSize:"14px",color:"#555A66",fontFamily:"Roboto"},children:[b?.email,b?.email&&b?.primaryPhone?" \u2022 ":"",b?.primaryPhone]})})]}),(0,e.jsx)(xt.A,{}),(0,e.jsx)(xt.A,{sx:{width:"99%"}})]})},o4=({quoteId:t,quoteName:n,formattedStatus:s,sellerInfo:o,onDownload:r,projectId:a,index:i,status:l,loading:c,is3PQuote:u,canView3PDetails:p,thirdPartyContact:f,downloadEnabled:h})=>{const{handleQuoteClick:b,shouldShowDetails:x}=hx({quoteId:t,projectId:a,status:l,is3PQuote:u,canView3PDetails:p,thirdPartyContact:f});return(0,e.jsxs)(E.A,{sx:{backgroundColor:"white",borderTop:!u&&i===0?"none":"1px solid lightgray",padding:".75rem 1rem",display:"flex",alignItems:"center",justifyContent:"space-between",gap:".5rem"},onClick:b,children:[(0,e.jsxs)(E.A,{display:"flex",gap:".5rem",alignItems:"center",children:[o.logo&&(0,e.jsx)(E.A,{component:"img",src:o.logo,alt:`${o.name} logo`,sx:{width:32,height:32,objectFit:"contain",flexShrink:0,borderRadius:"4px"}}),(0,e.jsxs)(E.A,{component:"span",sx:{width:"150px",overflow:"hidden",whiteSpace:"nowrap"},children:[(0,e.jsx)(I.A,{variant:"body1",sx:{overflow:"hidden",textOverflow:"ellipsis",fontWeight:500},children:n}),(0,e.jsx)(I.A,{variant:"body2",sx:{color:"var(--light-secondary-main)"},children:o.name})]}),(0,e.jsx)(to,{label:s.text,size:"small",shape:"square",sx:{alignSelf:"baseline",color:s.color,backgroundColor:s.backgroundColor,height:"1.25rem",border:"none","& .MuiChip-label":{fontSize:".75rem",fontWeight:500}}})]}),(0,e.jsx)(E.A,{display:"flex",alignItems:"center",gap:"1rem",children:c?(0,e.jsx)(bt.A,{size:16}):x()&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(pt.A,{sx:{width:"1.25rem",height:"1.25rem"},onClick:v=>{v.stopPropagation(),r()},disabled:c||!h,children:(0,e.jsx)(ZO.A,{})}),(0,e.jsx)(wf.A,{sx:{width:"1.25rem",height:"1.25rem"}})]})})]})},r4=({open:t,title:n,acceptButtonText:s,submit:o,cancel:r,close:a})=>(0,e.jsx)(Qn,{open:t,title:n,onCancel:()=>r(),onClose:()=>a(),onSubmit:()=>o(),cancelText:"Cancel",submitText:s,footerButtonAlignment:"flex-end",modalWidth:"600px",children:(0,e.jsx)($O,{children:"Updating the material list based on Home Configure Selections cannot be undone."})}),a4=({shoppableData:t,quoteLastModifiedDate:n})=>{const{projectId:s}=(0,L.useParams)(),[o,r]=(0,d.useState)(!1),{allRoles:a}=(0,we.Sk)(),[i,{isLoading:l}]=$g(),{project:c}=(0,De.B)(),{quoteId:u,lineId:p,isLoading:f}=nc(c),h="Home Configure Selections",b=j=>dn()(j).format("MM/DD/YYYY"),x=()=>(0,ct.EL)(a),v=()=>{s&&(i({exteriorLineId:p,exteriorQuoteId:u,projectId:s}),r(!1))},y=()=>({backgroundColor:"white",color:"black"});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r4,{title:"Update Material List",open:o,acceptButtonText:"Update List",submit:v,cancel:()=>r(!1),close:()=>r(!1)}),(0,e.jsxs)(NO,{sx:y(),children:[(0,e.jsx)(UO,{children:(0,e.jsxs)(WO,{children:[(0,e.jsx)(HO,{children:(0,e.jsx)(zO,{children:h})}),(0,e.jsxs)(VO,{children:[!x()&&"Contact your sales rep to update the material list.",(0,e.jsxs)("div",{children:["\u2022 Home Configure modified:"," ",b(t?.updatedDate??""),"."]}),(0,e.jsxs)("div",{children:["\u2022 Quote updated: ",b(n),"."]})]})]})}),x()&&(0,e.jsx)(QO,{children:(0,e.jsx)(_O,{onClick:()=>r(!0),disabled:l||f,children:"Update Material List"})})]})]})},fx=({quoteSummary:t,thirdPartyQuoteSummary:n,shoppableData:s})=>{const o=(0,Dt.A)(),{isFlagEnabled:r}=(0,ut.u)(),a=(0,No.A)(o.breakpoints.down("md")),i=r(D.SX.USE_REQUEST_TAKE_OFF_UI);return(0,e.jsxs)(dx,{children:[(0,e.jsx)("div",{style:{display:"flex"},children:!a&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Vl,{children:"Quotes"}),(0,e.jsx)(mx,{orientation:"vertical"}),(0,e.jsx)(px,{children:"Summary"})]})}),!a&&(0,e.jsx)(gi,{}),s?.shoppable&&t&&i&&(0,e.jsx)(a4,{shoppableData:s,quoteLastModifiedDate:t.lastModifiedDate}),t&&(0,e.jsx)(t4,{quotes:t.quotes,thirdPartyQuotes:n?.thirdPartyQuotes,isResponsive:a})]})},fi=({isResponsive:t=!1})=>(0,e.jsx)("div",{style:{display:"flex",flex:1,alignItems:"center",justifyContent:"center",width:t?"100%":void 0},className:"centered-loader",children:(0,e.jsx)(bt.A,{})}),i4=({selectedPack:t,orders:n,deliveries:s,parentQuote:o})=>{const{project:r}=(0,De.B)(),{isGridView:a,handleIconClick:i}=pu(),l=()=>t.deliveryId?"Deliveries":"Unscheduled Orders",c=(0,d.useMemo)(()=>t.deliveryId?s.find(u=>u.deliveryId===t.deliveryId)??null:t.orderId?n.find(u=>u.orderId===t.orderId)??null:null,[t,n,s]);return c?(0,e.jsxs)(dx,{children:[(0,e.jsxs)("div",{style:{display:"flex",marginTop:"30px"},children:[(0,e.jsxs)(Vl,{children:["All ",l()]}),(0,e.jsx)(mx,{orientation:"vertical"}),(0,e.jsx)(px,{children:c?.packName})]}),(0,e.jsx)(gi,{}),(0,e.jsxs)(Jg,{variant:"text",style:{top:"230px"},children:[(0,e.jsx)(qt.A,{title:"Thumbnail View",arrow:!0,children:(0,e.jsx)(pt.A,{onClick:()=>i(!0),disabled:a,style:{borderRadius:0},children:(0,e.jsx)("img",{src:a?Af:jf,alt:"grid-view",style:{opacity:a?1:.5}})})}),(0,e.jsx)(qt.A,{title:"List View",arrow:!0,children:(0,e.jsx)(pt.A,{onClick:()=>i(!1),disabled:!a,style:{borderRadius:0},children:(0,e.jsx)("img",{src:a?Cf:Sf,alt:"list-view",style:{opacity:a?.5:1}})})})]}),(0,e.jsx)(_l,{selectedPack:c,openModal:()=>{},project:r,showLineItemPricing:o?.showLineItemPricing??!0,showQuantity:o?.showQuantity??!0})]}):(0,e.jsx)(fi,{})},l4=({selectedSummaryTab:t,setSelectedSummaryTab:n})=>{const s=[{label:"Quotes"},{label:"Unscheduled Orders"},{label:"Deliveries"}];return(0,e.jsx)(E.A,{sx:{marginX:"16px",marginTop:"16px"},children:(0,e.jsx)(ir.A,{value:t,children:s.map((o,r)=>(0,e.jsx)(Po.A,{label:o.label,onClick:()=>n(r),sx:{color:"var(--light-secondary-main)","&.Mui-selected":{color:"text.primary"}}},r))})})};var d4=(t=>(t[t.Quotes=0]="Quotes",t[t.UnscheduledOrders=1]="UnscheduledOrders",t[t.Deliveries=2]="Deliveries",t))(d4||{});const xx=({title:t,listItems:n,emptyMessage:s,idKey:o,quoteSummary:r})=>{const{project:a}=(0,De.B)(),i=(0,d.useMemo)(()=>r?.orders??[],[r]),l=(0,d.useMemo)(()=>{const c={};return i.forEach(u=>{c[u.orderId]=u.quoteId}),c},[i]);return(0,e.jsx)(E.A,{children:n.length===0?(0,e.jsx)(E.A,{sx:{marginTop:0},children:(0,e.jsx)(I.A,{variant:"body1",children:s})}):(0,e.jsxs)(E.A,{sx:{marginTop:0,overflow:"hidden"},children:[(0,e.jsx)(I.A,{variant:"body1",sx:{marginBottom:".5rem"},children:t}),(0,e.jsx)(E.A,{sx:{border:"1px solid var(--light-secondary-light)",borderRadius:"4px",overflow:"hidden"},children:n.map((c,u)=>{const p=r?.quotes?.find(f=>f.quoteId===l[c.orderId]);return(0,e.jsx)(Nl,{item:c,project:a,index:u,idKey:o,showLineItemPricing:p?.showLineItemPricing??!0,showQuantity:p?.showQuantity??!0})})})]})})},yx=()=>{const t=(0,Dt.A)(),{projectId:n,packType:s,packTypeId:o}=(0,L.useParams)(),r=(0,L.useNavigate)(),{quoteSummary:a,isLoading:i,isFetching:l}=oo(n),{thirdPartyQuoteSummary:c}=Do(n),[u,p]=(0,d.useState)(null),f=(0,No.A)(t.breakpoints.down("md")),[h,b]=(0,d.useState)(0),{data:x,isLoading:v}=lx(n),y=(w,P,C,k)=>{p({orderId:w,packName:P,deliveryId:C,parentQuoteId:k??null})},j=(0,L.useMatch)("/projects/:projectId/materials/:packType/:packTypeId");(0,d.useEffect)(()=>{j&&!l&&(()=>{if(!s||!o||!a||!["orders","deliveries"].includes(s.toLowerCase()))return;let P;if(s==="orders"){const C=a.orders.find(k=>Number(k.orderId)===Number(o));C&&(P={orderId:C.orderId,packName:C.packName,parentQuoteId:C.quoteId})}if(s==="deliveries"){const C=a.deliveries.find(k=>String(k.deliveryId)===String(o));C&&(P={orderId:C.orderId,deliveryId:C.deliveryId,packName:C.packName,parentQuoteId:a.orders.find(k=>k.orderId===C.orderId)?.quoteId??null})}P&&p(P),r(`/projects/${n}/materials`)})()},[s,o,a,r,n,l,j]);const A=(0,d.useRef)(j);return(0,d.useEffect)(()=>{!A.current&&a&&a.quotes.length===0&&(a.orders.length>0||a.deliveries.length>0)&&(a.deliveries.length>0?y(a.deliveries[0].orderId,a.deliveries[0].packName,a.deliveries[0].deliveryId):y(a.orders[0].orderId,a.orders[0].packName))},[a,l]),l||v?(0,e.jsx)(fi,{}):f?(0,e.jsx)(is,{children:(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",overflowY:"scroll",width:"100%",backgroundColor:"var(--Colors-Background-bg-secondary, #fafafa)"},children:[(0,e.jsx)(l4,{selectedSummaryTab:h,setSelectedSummaryTab:b}),(0,e.jsxs)(E.A,{sx:{margin:"16px"},children:[h===0&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.A,{variant:"body1",sx:{fontSize:"1rem"},children:"Quotes"}),(0,e.jsx)(fx,{quoteSummary:a,thirdPartyQuoteSummary:c,shoppableData:x})]}),h===1&&(0,e.jsx)(xx,{title:"Unscheduled Orders",listItems:a?.orders??[],emptyMessage:"No Unscheduled Orders",idKey:"orderId",quoteSummary:a}),h===2&&(0,e.jsx)(xx,{title:"Deliveries",listItems:a?.deliveries??[],emptyMessage:"No Deliveries",idKey:"deliveryId",quoteSummary:a})]})]})}):(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Pu,{id:"quote-summary-container",children:[!f&&(0,e.jsx)(OO,{children:(0,e.jsx)(GO,{quoteSummary:a,isLoading:i,onUpdateDisplay:y,onShowSummary:()=>p(null),selectedPack:u})}),u?(0,e.jsx)(i4,{selectedPack:u,orders:a?.orders??[],deliveries:a?.deliveries??[],parentQuote:a?.quotes?.find(w=>w.quoteId===u.parentQuoteId)}):(0,e.jsx)(fx,{quoteSummary:a,thirdPartyQuoteSummary:c,shoppableData:x})]})})},c4=()=>{const{isAppEmbedded:t}=Os(),{allRoles:n}=(0,we.Sk)(),{isFlagEnabled:s}=(0,ut.u)(),{isQuotesEnabled:o,featureFlagsFetched:r}=ta(),{showError:a}=(0,Fe.d)(),i=s(D.SX.USE_MATERIALS_QUOTES),{projectId:l}=(0,L.useParams)(),{quoteSummary:c,isLoading:u,isFetching:p}=oo(l,!0),{error:f}=Do(l),{projectLoading:h}=(0,De.B)(),b=(0,d.useRef)(!0),x=()=>c&&!p&&c?.quotes.length===0&&c?.orders.length===0&&c.deliveries.length===0,v=()=>c&&c?.quotes.length!==0,y=(0,L.useMatch)("/projects/:projectId/materials");return(0,d.useEffect)(()=>{f&&a({message:"Third Party quotes are not available at this time"})},[f,a]),i?v()&&(0,ct.EL)(n)&&b.current&&y&&!t?(b.current=!1,(0,e.jsx)(L.Navigate,{to:`/projects/${l}/materials/edit_bid`,replace:!0})):(c&&(b.current=!1),x()&&y?(0,e.jsx)(L.Navigate,{to:`/projects/${l}/materials/request_bid`,replace:!0}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(ls,{showLoadingScreen:u||h}),(0,e.jsx)(kn,{sx:{overflowX:"hidden"},children:(0,e.jsx)(L.Outlet,{})})]})):r&&!o?(0,e.jsx)(L.Outlet,{}):null},u4=({quotes:t,isLoading:n,thirdPartyQuotes:s})=>{const{quoteId:o,projectId:r}=(0,L.useParams)(),{allRoles:a}=(0,Ye.A)(),i=(0,L.useNavigate)(),{resetMaterialsPageState:l}=lu(),{isFlagEnabled:c}=(0,ut.u)(),u=c(D.SX.USE_NEW_QUOTE_REQUEST),p=!(0,ct.EL)(a),f=(0,d.useMemo)(()=>{if(n)return[];const x=[{label:"Dashboard",value:"Dashboard"}];return t.filter(y=>!!y.quotePublishedDate).sort((y,j)=>y.quoteName.localeCompare(j.quoteName)).forEach(y=>{x.push({label:y.quoteName,value:String(y.quoteId)})}),p&&s.filter(j=>j.status===Yn.EXPIRED||j.status===Yn.SELLER_SUBMITTED||j.status===Yn.BUYER_ORDERED).sort((j,A)=>j.quoteName.localeCompare(A.quoteName)).forEach(j=>{x.push({label:j.quoteName,value:String(j.quoteId)})}),u&&x.push({label:"+ Request New Quote",value:"+ Request New Quote"}),x},[t,n,u,s,p]),h=(x,v)=>{l(r),i(v==="Dashboard"?`/projects/${r}/materials`:v==="+ Request New Quote"?`/projects/${r}/materials/request_bid`:`/projects/${r}/materials/quote/${v}`)},b=o??"Dashboard";return(0,e.jsx)(LO,{children:(0,e.jsx)(FO,{value:b,onChange:h,variant:"scrollable",scrollButtons:"auto",children:f.map((x,v)=>(0,e.jsx)(BO,{label:x.label,value:x.value,className:v===f.length-1&&u?"last-tab":""},x.value))})})},p4=()=>{const t=(0,Dt.A)(),{isAppEmbedded:n}=Os(),{isQuotesEnabled:s,featureFlagsFetched:o}=ta(),r=(0,L.useNavigate)(),{projectId:a}=(0,L.useParams)(),{quoteSummary:i,isLoading:l,error:c}=oo(a,!0),{thirdPartyQuoteSummary:u}=Do(a),{allRoles:p}=(0,we.Sk)(),{createEvent:f}=(0,io.A)(),{showError:h}=(0,Fe.d)(),{isFlagEnabled:b}=(0,ut.u)(),x=(0,No.A)(t.breakpoints.down("md")),v=()=>!(0,ct.EL)(p)||!i||n?!1:i.quotes.length>0||i.orders?.length>0||i.deliveries?.length>0;return(0,d.useEffect)(()=>{c&&h({message:"Error fetching quotes"})},[h,c]),(0,d.useEffect)(()=>{s&&a&&f({content_type:"project",object_id:a,tool:"materials"})},[a,f,s]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(vf,{visible:v(),quoteRequestId:i?.quoteRequestId,isCustomerViewOn:!0,handleChange:()=>{r(`/projects/${a}/materials/edit_bid`)}}),b(D.SX.TAX_DETAILS)&&i?.taxDetails&&(0,e.jsx)("pre",{children:JSON.stringify(i?.taxDetails,null,2)}),!x&&(0,e.jsx)(u4,{quotes:i?.quotes??[],isLoading:l,thirdPartyQuotes:u?.thirdPartyQuotes??[]}),(0,e.jsx)("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:!l&&!c&&(0,e.jsx)(L.Outlet,{})})]})},m4=()=>{const{project:t,projectLoading:n}=(0,De.B)(),{quoteSummary:s}=oo(t?.id?.toString()),{canViewPage:o}=(0,$n.s)({tool:D.w5.MATERIALS,action:D.a2.VIEW_BID_ORDERS_AND_DELIVERIES,projectId:t?.id,companyId:t?.companyId},[t]);return o?(0,e.jsx)(e.Fragment,{children:t&&!n&&(0,e.jsx)(TO,{project:t,quoteRequestId:s?.quoteRequestId})}):null};var bx=m(69307);const h4=(0,g.Ay)(bx.A)`
  display: flex;
  align-items: center;
  font-size: 14px;
  color: var(--bfs-primary-true-black);
  margin-right: 10px;
  flex: 1;
  justify-content: flex-end;

  .MuiFormLabel-asterisk {
    color: red;
  }
`,g4=(0,g.Ay)("div")`
  display: flex;
  flex: 2;
`,f4=(0,g.Ay)(Be.A)`
  display: flex;
  flex-direction: row;
  margin-bottom: 10px;

  .MuiFormControlLabel-label {
    font-size: 14px;
  }

  .MuiFormLabel-root.Mui-focused {
    color: var(--bfs-primary-true-black);
  }

  .MuiInputBase-input {
    font-size: 14px;
    color: var(--bfs-primary-true-black);
  }
`,x4=({onSelection:t})=>{const[n,s]=(0,d.useState)(null),[o,r]=(0,d.useState)(""),[a,i]=(0,d.useState)(""),{projectList:l,isLoading:c,isFetching:u}=(0,Ys.Y)({searchTerm:o,showErrorMessage:!0,shouldRefetch:!1}),p=(c||u)&&n?.projectName!==o,f=u?[]:l.map(v=>({label:v.projectName,value:v.projectExternalId})),h=(0,d.useCallback)((0,H.debounce)(v=>{r(v)},1e3),[r]),b=v=>{i(v),h(v)},x=v=>{t(v),s(v)};return(0,e.jsx)(yo,{children:(0,e.jsxs)(an,{sx:{width:"100%"},children:[(0,e.jsx)(Ls,{children:"Project"}),(0,e.jsx)(Gn.A,{onChange:(v,y)=>{if(y){const j=l.find(A=>A.projectExternalId===y.value);x(j??null)}},isOptionEqualToValue:(v,y)=>v.value===y.value,sx:{flex:1,margin:"0 0 1.25rem 0",height:"3rem",paddingBottom:"10px"},filterOptions:v=>v,inputValue:a,onInputChange:(v,y)=>{b(y)},loading:p,options:f,renderInput:v=>(0,e.jsx)(_.A,{...v,placeholder:"Select or search for existing projects",variant:"outlined",sx:{width:"100%"},InputProps:{...v.InputProps,endAdornment:(0,e.jsxs)(se().Fragment,{children:[p?(0,e.jsx)(bt.A,{color:"inherit",size:20}):null,v.InputProps.endAdornment]})}})})]})})},y4=({useNewProject:t,onUseNewProjectChange:n,onProjectSelect:s})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(f4,{children:[(0,e.jsx)(h4,{children:"Is this for an existing project?"}),(0,e.jsx)(g4,{children:(0,e.jsxs)(Gi.A,{row:!0,value:t?"new":"existing",onChange:o=>{o.target.value==="new"?n(!0):n(!1)},children:[(0,e.jsx)(ye.A,{value:"new",control:(0,e.jsx)(_o.A,{}),label:"New Project"}),(0,e.jsx)(ye.A,{value:"existing",control:(0,e.jsx)(_o.A,{}),label:"Existing Project"})]})})]}),!t&&(0,e.jsx)(x4,{onSelection:o=>s(o)})]}),b4=({existingProject:t})=>{const n={margin:"0 0 1.25rem 0",height:"3rem",paddingBottom:"10px"},{isFlagEnabled:s}=(0,ut.u)();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Td,{disabled:!0,onUpdate:()=>{},selectedCommunityId:t?.communityId??null}),s(D.SX.PROJECT_SYSTEM_LABELS)&&(0,e.jsx)(an,{children:(0,e.jsx)(kd,{onUpdateProjectLabels:()=>{},selectedLabels:t?.labels?t.labels:[],disabled:!0})}),(0,e.jsx)(qs,{}),(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"Location"}),(0,e.jsx)(yo,{children:(0,e.jsx)(an,{style:{width:"100%"},children:(0,e.jsx)(_.A,{margin:"normal",id:"street",fullWidth:!0,sx:n,variant:"outlined",placeholder:t?.address?.streetOne??"",disabled:!0})})}),(0,e.jsxs)(yo,{children:[(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"City"}),(0,e.jsx)(Pd,{margin:"normal",id:"city",placeholder:t?.address?.city??"",inputProps:{"data-testid":"city-input"},disabled:!0})]}),(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"State"}),(0,e.jsx)(Ui,{onChange:()=>{},initialValue:t?.address?.state,disabled:!0})]}),(0,e.jsxs)(an,{children:[(0,e.jsx)(Ls,{children:"Zip"}),(0,e.jsx)(Id,{margin:"normal",id:"zip",variant:"outlined",inputProps:{"data-testid":"zip-input"},placeholder:t?.address?.zip??"",disabled:!0})]})]})]})]})},v4=({closeDrawer:t,quoteData:n,existingProject:s})=>{const{company:o}=(0,je.P)(),{showSuccess:r,showError:a}=(0,Fe.d)(),i=(0,L.useNavigate)(),[l,c]=(0,ws.SU)(),u=f=>{t(f)};(0,d.useEffect)(()=>{c.isSuccess&&(r({message:"Quote has been created"}),u(!0))},[c.isSuccess]),(0,d.useEffect)(()=>{c.error?.status===409?a({title:"Project cannot be created",message:"We're sorry! All project names must be unique. Please try creating your project again with a different name, and contact Customer Support if the problem persists or you feel it is in error."}):c.error&&a({message:"Failed to create project"})},[c.error]);const p=async()=>{if(n){const f={...n,destinationProjectId:s?.projectExternalId},h={companyId:o?.id,name:s?.projectName,quoteData:f};try{const x=(await l(h).unwrap()).projectId;i(`/projects/${x}/documents`)}catch(b){console.error("project failed to update",b)}}};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Fi,{"data-testid":"manually-copy-master-set-quote-form",children:[(0,e.jsx)(b4,{existingProject:s}),(0,e.jsx)(Ed,{children:(0,e.jsx)(Li,{onClose:()=>u(!1),submitText:"Add Quote to Project",onSubmit:()=>p(),disabled:c.isLoading,loading:c.isLoading,buttonAlignment:"flex-end"})})]})})},j4=({closeDrawer:t,quoteData:n})=>{const{isFlagEnabled:s}=(0,ut.u)(),[o,r]=(0,d.useState)({useNewProject:!0,existingProject:null}),a=s(D.SX.USE_COPY_QUOTE_EXISTING_PROJECT),i=(0,d.useCallback)((f,h)=>{r(b=>{const x={...b,[f]:h};return f==="useNewProject"&&h===!0&&(x.existingProject=null),x})},[]),l=f=>{t(f)},c=f=>{i("existingProject",f)},u=f=>{i("useNewProject",f)},p=()=>{let f="Project Details";return o.useNewProject&&(f="New Project Details"),f};return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Fi,{"data-testid":"master-set-quote-form",children:[(0,e.jsxs)(Da,{children:[(0,e.jsxs)("div",{style:{flexDirection:"column",display:"flex",gap:8},children:[(0,e.jsx)(ka,{children:p()}),(0,e.jsx)(ov,{children:"Copy your existing quote to a new or existing project. All line items will be carried over."})]}),(0,e.jsx)(pt.A,{onClick:()=>l(!1),children:(0,e.jsx)("img",{src:Oa,alt:"close"})})]}),(0,e.jsx)(qs,{}),a&&(0,e.jsx)(y4,{useNewProject:o.useNewProject,onUseNewProjectChange:u,onProjectSelect:f=>c(f)}),!o.useNewProject&&(0,e.jsx)(v4,{closeDrawer:t,quoteData:n,existingProject:o.existingProject}),o.useNewProject&&(0,e.jsx)(tm,{closeDrawer:t,quoteData:n??void 0})]})})},A4=({open:t,closeDrawer:n,quoteData:s})=>(0,e.jsx)(Ta,{open:t,closeDrawer:()=>{},children:t?(0,e.jsx)(j4,{closeDrawer:n,quoteData:s}):null}),C4=()=>{const t=(0,L.useNavigate)(),{project:n}=(0,De.B)(),{addCrew:s}=(0,On.ts)(n?.id,n?.companyId),{quoteSummary:o,isFetching:r}=oo(String(n?.id)),{showError:a}=(0,Fe.d)(),[i,l]=(0,d.useState)({open:!1,quoteData:null}),{canViewPage:c}=(0,$n.s)({tool:D.w5.MATERIALS,action:D.a2.EDIT_BID,projectId:n?.id,companyId:n?.companyId},[n?.id,n?.companyId]);(0,d.useEffect)(()=>{o&&!r&&o.quotes.length===0&&o.orders.length===0&&o.deliveries.length===0&&t(`/projects/${n?.id}/materials`)},[o,t,n?.id,r]);const u=async f=>{if(f.type==="open-create-project-modal"&&vk(f)&&l({open:!0,quoteData:{...f,originProjectExternalId:n?.projectExternalId??""}}),f.type==="open-copy-quote-flyout"&&jk(f)&&l({open:!0,quoteData:{...f,originProjectExternalId:n?.projectExternalId??""}}),Ak(f)){const{email:h,firstName:b,lastName:x}=f;try{const v=await s(f.roleId,{email:h,firstName:b,lastName:x,phoneNumber:""},{suppressEmail:!0});if(v.error){const y=v.error.response?.data?.error||v.error;console.error("Error response from invite API:",y);const j=`Failed to invite ${h}: ${y}`;throw new Error(j)}window.parent.postMessage({type:"invite-processing-completed",inviteDetails:{email:h,inviteToken:v?.userAdded?.invite_token||null}},"*")}catch(v){console.error("Error sending invite:",v),a({message:`Failed to invite ${h}: ${v}`}),window.parent.postMessage({type:"invite-processing-completed",inviteDetails:{email:h,inviteToken:null}},"*")}}};(0,On.Pe)(u);const p=()=>{l({open:!1,quoteData:null})};return o&&!r&&!o.quoteRequestId?(0,e.jsx)(L.Navigate,{to:`/projects/${n?.id}/materials/request_bid`,replace:!0}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(vf,{visible:!0,isCustomerViewOn:!1,quoteRequestId:o?.quoteRequestId??null,handleChange:()=>{t(`/projects/${n?.id}/materials`)}}),c&&o?.quoteRequestId&&n?.companyId?(0,e.jsx)(c2,{quoteRequestId:o?.quoteRequestId,companyId:n?.companyId}):null,(0,e.jsx)(A4,{open:i.open,closeDrawer:p,quoteData:i.quoteData??void 0})]})},ku=(t,n,s,o=!1)=>{const{data:r,isFetching:a,isLoading:i,error:l,refetch:c}=Zk({projectId:t,quoteId:n,is3pQuote:s},{skip:o}),{setBidPacks:u,setOrderPacks:p}=lu();return(0,d.useEffect)(()=>{r&&(u(t,r.quotePacks??[]),p(t,r.orders??[]))},[r,t]),{quoteDetailsResponse:r,isFetching:a,isLoading:i,error:l,refreshQuoteDetails:c}},vx=({open:t,closeModal:n,quoteId:s,projectId:o,quoteLoading:r,isPurchaseTypeSingle:a,selectedPack:i,grandTotalOnly:l})=>{const{showError:c,showSuccess:u,showLoadingToast:p}=(0,Fe.d)(),{isFlagEnabled:f}=(0,ut.u)(),{company:h}=(0,je.P)(),{submitOrders:b}=sa(),[x]=r2(),{selectedPacksForOrder:v,resetSelectedPacksForOrder:y}=oa(),{refreshQuoteSummary:j,isLoading:A}=oo(o),{thirdPartyQuoteSummary:w,refresh3pQuoteSummary:P,isLoading:C}=Do(o),k=!!w?.thirdPartyQuotes.find(ue=>ue.quoteId===s),S=A||C,R=f(D.SX.USE_ASYNC_ORDERS)&&h?.erpSystem===An.v.SAPS4HANA,{refreshQuoteDetails:B}=ku(o,s,k,S),T=(0,L.useNavigate)(),[W,N]=se().useState(ro.LOADED),O=a&&Ol(i)?[Ll(i,!0)]:Object.values(v??{}),z=()=>{const ue=[],le=[];return O.forEach(F=>{if(Lk(F)){const $=Object.values(F.lineItems).map(ee=>ee.lineItemId);le.push({packId:F.bidPackId,lineItemIds:$})}else ue.push(F.bidPackId)}),{packIds:ue,partialPacks:le}},Q=()=>{B(),j(),P(),N(ro.LOADED),y(o),n()},re=async(ue,le,F,V,$=!0)=>{if(!o||!ue)return;N(ro.SUBMITTING_ORDER);const ee=vs.getBidPack(i),X=z();if(R){try{await x({projectId:Number(o),packIds:X.packIds,partialPacks:X.partialPacks,deliveryDate:ue,poNumber:F,comment:V,quoteId:s,third_party:k,emailConfirmationPreference:$}).unwrap(),p("Order is processing. Please check back for a status update.",{backgroundColor:"text.primary",spinnerColor:"info.main",autoTimeout:5e3}),Q()}catch(J){Q(),c({message:J?.data?.message||J?.error||"Error submitting order"})}return}const{message:G,orders:Y}=await b({projectId:Number(o),packIds:X.packIds,partialPacks:X.partialPacks,deliveryDate:ue,poNumber:F,comment:V,quoteId:s,third_party:k,emailConfirmationPreference:$}),he=Y.filter(J=>J.orderId==="error");let ne=!0;if(k&&G&&(ne=!1,c({message:"There is an error submitting a partner order. Please try again in a few minutes"})),he?.length===1){const J=le&&O?Object.values(O).find(pe=>pe.bidPack.bidPackId===he[0]?.packId)?.bidPack?.packName:ee?.packName;ne=!1,c({message:`We're sorry! We could not order ${J}. Here's what we know: ${G}. Please try again and contact Customer Support if the problem persists. `})}else he?.length>1?(ne=!1,c({message:`We're sorry! We could not order ${he?.length} of your requested packs. Here's what we know: ${G}.
              Please try again and contact Customer Support if the problem persists. `})):G?(ne=!1,c({message:`We're sorry! We could not order some of your requested packs. Here's what we know: ${G}. Please try again and contact Customer Support if the problem persists.`})):u({message:"Your Order has been placed!"});(!k||k&&ne)&&Q(),ne&&T(`/projects/${o}/materials/quote/${s}/orders/${Y[0]?.orderId}`,{replace:!0})};return t?(0,e.jsx)(W2,{open:t,closeModal:()=>{n(),l&&y(o)},data:{handlePurchasePack:re,loadingState:W,selectedBidPacksToOrder:O,isFromMultiPackSelect:!a},grandTotalOnly:l}):null},jx=(0,g.Ay)(Pu)`
  gap: 12px;
  flex-direction: column;
  padding-top: 0px;

  @media (max-width: 899px) {
    display: flex;
    padding: 0 16px;
    align-items: flex-start;
    gap: 16px;
    align-self: stretch;
  }
`,Tu=(0,g.Ay)(E.A)`
  display: flex;
  flex-direction: row;
  padding: 8px 0 0 0;
  overflow: hidden;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;

  @media (max-width: 899px) {
    overflow: visible;
    padding: 0;
    justify-content: none;
  }
`,Ax=(0,g.Ay)(I.A)`
  font-weight: 'bold';
  font-family: 'Roboto';
  font-size: 24px;
`,Cx=(0,g.Ay)(I.A)`
  font-family: 'Roboto';
  font-weight: 400;
  line-height: 24px;
  font-size: 14px;
  color: #5d6062;
`;var S4=m(11735);const w4=({is3PQuote:t})=>{const{company:n}=(0,je.P)(),o=t?"marketplacesupport@myparadigm.com":n?.osrEmail,r=t?"Contact Us":"Contact Sales Rep";return o?(0,e.jsx)(qg,{variant:"contained",href:`mailto:${o}`,sx:{marginTop:"1em",minWidth:155,backgroundColor:"#FFFFFF",borderColor:"#B3B5B6",color:"#5D6062",borderRadius:"4px","&:hover":{backgroundColor:"#FFFFFF"}},children:r}):null};var E4=m(5673),P4=m(76768);function Sx(t){return t.serviceRequestComponentTypeId!==void 0}const wx=({quoteDetails:t,is3PQuote:n,quoteSummary:s,projectId:o,isResponsive:r=!1})=>{const a=(0,L.useNavigate)(),i=(0,L.useLocation)(),{data:l,isLoading:c}=ui(o,!n),{data:u}=i2(t.quoteId),{allRoles:p}=(0,we.Sk)(),f=(0,ct.qE)(p),h=s?.quoteName??"",b=()=>{if(!s?.quoteExpiration)return"";const C=dn()(s.quoteExpiration),k=dn()(),S=C.format("MM/DD/YYYY");return C.isAfter(k)?`Expires: ${S}`:`Expired: ${S}`},x=(0,d.useMemo)(()=>!n||!s?null:l?.find(C=>Sx(s)&&String(C.serviceRequestComponentTypeId)===s.serviceRequestComponentTypeId)??null,[l,s,n]),v=()=>n?x?.sellerLogoURL:Ul,y=()=>n?x?.sellerName:"Builders FirstSource",j=()=>{if(!s||!Sx(s))return"";const C=[];return s.contact.email&&C.push(s.contact.email),s.contact.primaryPhone&&C.push(s.contact.primaryPhone),C.length>0?` \u2022 ${C.join(" \u2022 ")}`:""},A=C=>(0,e.jsx)(Tf,{icon:C?(0,e.jsx)(E4.A,{sx:{fontSize:14}}):(0,e.jsx)(P4.A,{sx:{fontSize:14}}),buttonText:C?"Viewed":"Not Viewed",buttonStyle:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',padding:"0 8px",width:"auto",height:"20px",fontSize:"12px",fontWeight:500,color:C?"var(--chip-primary-text)":"var(--chip-secondary-text)",backgroundColor:C?"var(--chip-primary-background)":"var(--chip-secondary-background)"},popupContent:w(C),popperStyle:{width:"fit-content"}}),w=C=>(0,e.jsx)(E.A,{sx:{padding:"12px",borderRadius:"4px",backgroundColor:"black",color:"white",fontSize:"12px"},children:C?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(I.A,{variant:"body2",children:"Quote Viewed"}),u?.events.map(k=>(0,e.jsxs)(E.A,{sx:{marginTop:"8px"},children:[(0,e.jsx)(I.A,{variant:"body2",sx:{marginBottom:"4px"},children:k.name}),(0,e.jsx)(I.A,{variant:"body2",children:k.email})]},k.userId))]}):"Customer has not viewed this quote yet."}),P=()=>{if(!n){const C=u?.status==="viewed",k=b()!=="";return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("span",{children:[y()," "]}),k&&(0,e.jsxs)("span",{children:["\u2022 ",b()," "]}),f&&(0,e.jsxs)("span",{children:["\u2022 ",A(C)]})]})}return`${y()} \u2022 ${t.quoteId} \u2022 ${b()} ${j()}`};return c?(0,e.jsx)(Tu,{}):r?(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,e.jsx)("div",{children:(0,e.jsxs)(K.A,{sx:{display:"flex",padding:"8px 12px",justifyContent:"center",alignItems:"center",gap:"6px",color:"#3E4041",fontSize:"12px",fontStyle:"normal",fontWeight:600,lineHeight:"16px"},onClick:()=>{const C=i.pathname.replace(/\/quote.*/,"");a(C)},children:[(0,e.jsx)(S4.A,{sx:{width:"16px"}}),"Back"]})}),(0,e.jsx)(Tu,{children:(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:"8px",flex:"1 0 0"},children:[(0,e.jsx)("img",{style:{borderRadius:"4px",width:"32px"},src:v(),alt:"BFS Logo"}),(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"2px",flex:"1 0 0"},children:[(0,e.jsx)(Ax,{variant:"h6",sx:{fontSize:"16px",fontStyle:"normal",fontWeight:"500",lineHeight:"24px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"312px"},children:h}),(0,e.jsx)(Cx,{variant:"body2",sx:{padding:"0"},children:P()})]})]})})]}):(0,e.jsxs)(Tu,{children:[(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"row",gap:"16px"},children:[(0,e.jsx)("img",{style:{borderRadius:"4px",width:"56px"},src:v(),alt:"BFS Logo"}),(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[(0,e.jsx)(Ax,{variant:"h4",children:h}),(0,e.jsx)(Cx,{children:P()})]})]}),(0,e.jsx)(w4,{is3PQuote:n})]})},Ex=()=>{const t=(0,L.useNavigate)(),n=(0,Dt.A)(),s=(0,No.A)(n.breakpoints.down("md")),{allRoles:o,userPermissionsFetched:r}=(0,we.Sk)(),{company:a}=(0,je.P)(),{isAppEmbedded:i}=Os(),{quoteId:l,projectId:c,packType:u,packTypeId:p}=(0,L.useParams)(),{project:f}=(0,De.B)(),{isFlagEnabled:h}=(0,ut.u)(),b=h(D.SX.USE_PARTIAL_PACK_ORDER),{quoteSummary:x,isLoading:v}=oo(c),{thirdPartyQuoteSummary:y,isLoading:j}=Do(c),A=y?.thirdPartyQuotes.find($=>$.quoteId===parseInt(l)),w=x?.quotes.find($=>$.quoteId===parseInt(l)),P=!!A,C=v||j,{quoteDetailsResponse:k,isFetching:S}=ku(c,Number(l),P,C),[R,B]=(0,d.useState)(!1),[T,W]=(0,d.useState)(!1),{createEvent:N}=(0,io.A)();P&&r&&(0,ct.EL)(o)&&t(`/projects/${c}/materials`),(0,d.useEffect)(()=>{const $=x?.quotes.find(ee=>ee.quoteId.toString()===l);N({content_type:"project",object_id:c,tool:D.w5.MATERIALS,action:D.H1.VIEW,event_meta:{quoteId:l,quoteName:$?.quoteName}})},[N]),(0,d.useEffect)(()=>(wa(Gs.QUOTE_ID,Number(l)),()=>{Ea(Gs.QUOTE_ID)}),[l]);const O=$=>{switch(so($)){case"bid":t(`/projects/${c}/materials/quote/${l}/bids/${$.bidPackId}`);break;case"order":t(`/projects/${c}/materials/quote/${l}/orders/${$.orderId}`);break;case"delivery":t(`/projects/${c}/materials/quote/${l}/deliveries/${$.deliveryId}`);break;default:break}},z=(0,d.useMemo)(()=>k?.quotePacks??[],[k]),Q=k?.isMasterSetQuote,re=(0,d.useMemo)(()=>Vg(k?.orders??[],a),[k,a]),ue=(0,d.useMemo)(()=>{if(!u||!p){const $=[...z,...re];return $.length>0?$[0]:null}return["bids","orders","deliveries"].includes(u.toLowerCase())?u==="bids"?z.find($=>String($.bidPackId)===String(p)):u==="orders"?re.find($=>String($.orderId)===String(p)):u==="deliveries"?re.flatMap($=>$.deliveries).find($=>String($.deliveryId)===String(p)):null:null},[z,re,u,p]),le=v||S;if(!le&&Q&&!i)return(0,e.jsx)(L.Navigate,{to:`/projects/${c}/materials/quote/${l}/elevation`,replace:!0});const F=$=>{W($),B(!0)},V=()=>{B(!1),W(!1)};return s?(0,e.jsxs)(jx,{children:[le&&(0,e.jsx)(fi,{isResponsive:!0}),(0,e.jsx)("div",{id:"quote-details"}),!le&&k&&f&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(wx,{quoteDetails:k,projectId:c,is3PQuote:P,quoteSummary:A??w,isResponsive:s}),(0,e.jsx)(Bf,{isResponsive:s,project:f,bidPacks:z,orderPacks:re,openModal:F,selectedPack:ue??null,setSelectedPack:$=>O($),bidSummaryHtml:null,bidSummaryTotal:null,grandTotal:k.grandTotal,grandTotalOnly:k.grandTotalOnly,totalInfo:k.totalInfo,loadingState:S,showLineItemPricing:k.showLineItemPricing??!1,showQuantity:k.showQuantity??!1,showPackTotals:k.showPackTotals??!1,quoteSummary:A??w,partialPackOrderEnabled:b&&k.isPartialPackOrderingEnabled})]}),(0,e.jsx)(vx,{open:R,closeModal:V,quoteId:Number(l),projectId:c,quoteLoading:S,isPurchaseTypeSingle:T,selectedPack:ue,grandTotalOnly:k?.grandTotalOnly??!1})]}):(0,e.jsxs)(jx,{children:[le&&(0,e.jsx)(fi,{}),(0,e.jsx)("div",{id:"quote-details"}),!le&&k&&f&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(wx,{quoteDetails:k,projectId:c,is3PQuote:P,quoteSummary:A??w}),(0,e.jsx)(Bf,{project:f,bidPacks:z,orderPacks:re,openModal:$=>{W($),B(!0)},selectedPack:ue??null,setSelectedPack:$=>O($),bidSummaryHtml:null,bidSummaryTotal:null,grandTotal:k.grandTotal,grandTotalOnly:k.grandTotalOnly,totalInfo:k.totalInfo,loadingState:S,showLineItemPricing:k.showLineItemPricing??!1,showQuantity:k.showQuantity??!1,showPackTotals:k.showPackTotals??!1,quoteSummary:A??w,partialPackOrderEnabled:b&&k.isPartialPackOrderingEnabled})]}),(0,e.jsx)(vx,{open:R,closeModal:V,quoteId:Number(l),projectId:c,quoteLoading:S,isPurchaseTypeSingle:T,selectedPack:ue,grandTotalOnly:k?.grandTotalOnly??!1})]})},I4=()=>{const{quoteId:t,projectId:n}=(0,L.useParams)(),{quoteSummary:s,isLoading:o}=oo(n),{quoteDetailsResponse:r,isFetching:a,error:i}=ku(n,Number(t),!1),l=(0,L.useNavigate)();(0,d.useEffect)(()=>(wa(Gs.QUOTE_ID,Number(t)),()=>{Ea(Gs.QUOTE_ID)}),[t]);const c=(0,d.useCallback)(()=>{l(`/projects/${n}/materials`)},[n,l]);return(0,d.useEffect)(()=>{r&&(r?.isMasterSetQuote||c())},[r,c]),(0,d.useEffect)(()=>{i&&c()},[i,c]),(0,e.jsxs)(Pu,{children:[(a||o)&&(0,e.jsx)(fi,{}),r&&r.quoteRequestId&&s&&(0,e.jsx)(u2,{bidId:r.quoteRequestId,quoteId:r.quoteId})]})};var ro=(t=>(t[t.FIRST_TIME_LOADING=0]="FIRST_TIME_LOADING",t[t.SUBMITTING_ORDER=1]="SUBMITTING_ORDER",t[t.LOADED=2]="LOADED",t[t.SWITCH_PAGE_VIEW=3]="SWITCH_PAGE_VIEW",t[t.LOADING=4]="LOADING",t[t.FIRST_TIME_LOADED=5]="FIRST_TIME_LOADED",t))(ro||{}),js=(t=>(t.BID_EXPIRED="BID_EXPIRED",t.READY_FOR_ORDER="READY_FOR_ORDER",t.ORDER_PROCESSING="ORDER_PROCESSING",t))(js||{}),un=(t=>(t.DELIVERED="DELIVERED",t.DELIVERY_IN_PROGRESS="DELIVERY_IN_PROGRESS",t.DELIVERY_SCHEDULED="DELIVERY_SCHEDULED",t.ORDER_PENDING="ORDER_PENDING",t.ORDER_PROCESSING="ORDER_PROCESSING",t.OUT_FOR_DELIVERY="OUT_FOR_DELIVERY",t.OPEN="OPEN",t.CANCELLED="CANCELLED",t.CANCELED="CANCELED",t.POS="POS",t.UNDELIVERABLE="UNDELIVERABLE",t.UNKNOWN="UNKNOWN",t.NOT_SCHEDULED="NOT_SCHEDULED",t.CLOSED="CLOSED",t))(un||{}),Sr=(t=>(t.DEFAULT="DEFAULT",t.DRAWER="DRAWER",t))(Sr||{}),D4=m(47333),k4=m(14977);const t9=(0,g.Ay)("section")`
  padding-top: 15vh;

  flex-direction: column;
  display: flex;
  text-align: ${t=>t.textAlign||"center"};

  @media screen and (max-width: 990px) {
    flex-direction: column;
  }

  @media screen and (max-width: 990px) {
    padding-top: 7vh;
  }
`,n9=(0,g.Ay)("p")`
  font-family: acumin-pro;
  font-size: 18px;
  font-weight: 400;
  font-stretch: normal;
  font-style: normal;
  line-height: normal;
  letter-spacing: normal;
  text-align: center;
  color: var(--bfs-primary-true-black);
`,s9=(0,g.Ay)(k4.A)`
  padding: 40px;
  margin-left: 30px;
  height: 231px;
  @media screen and (max-width: 990px) {
    margin-top: 40px;
  }
`,o9=(0,g.Ay)(I.A)`
  font-family: acumin-pro;
  font-size: 24px;
  font-weight: 700;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.05;
  letter-spacing: 0.6px;
  text-align: center;
`,Px=`
  max-width: 425px;
  margin: 10px 30px 30px 30px;
  padding: 39px 36px 36px;
  background-color: white;
`,r9=(0,g.Ay)("form")`
  ${Px}
  max-width: 325px;
  padding: 26px 66px;
  margin-top: 36px;
  align-self: center;
`,T4=(0,g.Ay)("div")`
  ${Px}
  text-align: center;
  align-self: center;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -20%);
`,a9=(0,g.Ay)(I.A)`
  font-family: acumin-pro;
  font-size: 30px;
  font-weight: bold;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.05;
  letter-spacing: 0.6px;
  margin-bottom: 10px;
  color: black;
`,i9=(0,g.Ay)("div")`
  @media screen and (min-width: 990px) {
    display: flex;
    flex-direction: row;
  }
`,R4=(0,g.Ay)("div")`
  text-align: center;
  align-self: center;
`,O4=(0,g.Ay)("h1")`
  margin: 0px;
  font-size: 42px;
  line-height: 1.1;
  font-weight: bold;
`,M4=(0,g.Ay)("p")`
  font-size: 26px;
  font-weight: normal;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.1;
  letter-spacing: normal;
  text-align: center;
  padding: 0 36px;
  margin: 0;
`,l9=(0,g.Ay)("div")`
  width: 90%;
  max-width: 1200px;
  margin: 0 auto;

  @media screen and (min-width: 600px) {
    width: 70%;
  }

  @media screen and (min-width: 900px) {
    width: 60%;
  }

  @media screen and (min-width: 1200px) {
    width: 50%;
  }
`,$l="UtmCodes",Ru=["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],L4=t=>Array.from(t.keys()).some(s=>Ru.includes(s.toLowerCase())),F4=t=>{const n={};return Ru.forEach(s=>{const o=t.get(s);o&&(n[s]=o)}),n},Ix=()=>{const[t,n]=(0,L.useSearchParams)(),s=(0,d.useCallback)(()=>{const i=F4(t),l={timestamp:dn()().toISOString(),utmCodes:i};window.localStorage.setItem($l,JSON.stringify(l)),n(c=>{const u=new URLSearchParams(c);return Ru.forEach(p=>{u.delete(p)}),u})},[t,n]),o=(0,d.useCallback)(()=>{window.localStorage.removeItem($l)},[]),r=(0,d.useCallback)(()=>{const i=window.localStorage.getItem($l);if(!i)return;const{timestamp:l}=JSON.parse(i);dn()().diff(dn()(l),"days")>=1&&o()},[o]),a=(0,d.useCallback)(()=>{const i=window.localStorage.getItem($l);if(!i)return null;try{return JSON.parse(i).utmCodes}catch{return null}},[]);return(0,d.useEffect)(()=>{L4(t)&&s(),r()},[t,r,s]),{getUTMCodes:a,clearUTMCodes:o}},B4={postLogin:async(t,n)=>{const s=sessionStorage.getItem(Nn.qm.PATH_TO_RETURN_TO);return nt.Ay.post("/auth/login",{email:t,token:n,next:s})}},Dx=m.p+"8747405004605f88825c4abe3503f256.svg",N4=m.p+"cf87972b2df0740b1913d317b81b1c49.svg";function xi(t){var n=t.lastIndexOf("@"),s=t.lastIndexOf(".");return n<s&&n>0&&t.indexOf("@@")==-1&&s>2&&t.length-s>2}function c9(t){const n=t.split(",");for(let s=0;s<n.length;s++)if(!xi(n[s].trim()))return!1;return!0}var Hl=m(22119),ia={};ia.styleTagTransform=zs(),ia.setAttributes=Us(),ia.insert=_s().bind(null,"head"),ia.domAPI=Ns(),ia.insertStyleElement=Ws();var u9=Bs()(Hl.A,ia);const p9=Hl.A&&Hl.A.locals?Hl.A.locals:void 0,kx="http://prod-api-mybfs.bldr.com/api/Site/document/file?type=1",Tx="http://prod-api-mybfs.bldr.com/api/Site/document/file?type=3",_4=({onSignIn:t})=>{const[n]=(0,L.useSearchParams)(),[s,o]=(0,d.useState)(""),r=(0,d.useRef)(!1),a=localStorage.getItem("using_app_V2"),l=localStorage.getItem("from_app")==="true"&&a==="false";(0,d.useEffect)(()=>{const p=n.get("loginHint")||sessionStorage.getItem("loginHint");sessionStorage.removeItem("loginHint"),p&&xi(p)&&(o(p),r.current||(r.current=!0,t(p)))},[n,t]);const c=async p=>{p.preventDefault(),await t(s)},u=p=>{p.preventDefault(),xi(s)&&t(s)};return l?(0,e.jsx)("div",{className:"container","data-testid":"sign-in-form",children:(0,e.jsx)("div",{className:"frame",children:(0,e.jsxs)("div",{className:"form-frame",children:[(0,e.jsx)("img",{alt:"MyBLDR Welcome logo","data-testid":"mybldr-welcome-logo",src:N4,className:"logo"}),(0,e.jsxs)("div",{style:{fontSize:18},className:"input-label",children:[" ","This version of the myBLDR app is no longer supported. Please visit the"," ",(0,e.jsx)(Rn.A,{href:"https://apps.apple.com/us/app/bldr/id6504291071",children:"app store"})," ","to download the latest version."]})]})})}):(0,e.jsxs)(E.A,{padding:"28px 24px",display:"flex",flexDirection:"column","data-testid":"sign-in-form",boxSizing:"border-box",width:"368px",borderRadius:"8px",gap:"32px",zIndex:1,sx:{backgroundColor:"#FFF"},alignItems:"center",children:[(0,e.jsxs)(E.A,{display:"flex",flexDirection:"column",gap:"12px",children:[(0,e.jsx)("img",{alt:"Builders FirstSource logo","data-testid":"mybldr-logo-header",src:Dx,style:{height:"32px",display:"block",width:"auto",padding:0,justifyContent:"flex-start",alignItems:"flex-start"}}),(0,e.jsx)(I.A,{variant:"h3",fontWeight:"semibold",children:"Welcome back"})]}),(0,e.jsxs)(E.A,{component:"form",onSubmit:u,display:"flex",flexDirection:"column",gap:"16px",width:"100%",children:[(0,e.jsxs)(E.A,{display:"flex",gap:"4px",flexDirection:"column",children:[(0,e.jsx)(I.A,{variant:"subtitle2",color:"text.secondary",fontWeight:"medium",children:"Email"}),(0,e.jsx)(_.A,{fullWidth:!0,className:"email",placeholder:"Enter your email",type:"email",value:s,onChange:p=>o(p.target.value),inputProps:{"data-testid":"user-login-email-input"}})]}),(0,e.jsx)(K.A,{variant:"contained",fullWidth:!0,type:"submit",sx:{backgroundColor:"#C80F2E",height:"40px","&:hover":{backgroundColor:"#B00D28"},"&.Mui-disabled":{backgroundColor:"#FAFAFA",border:"1px solid #F4F5F5",color:"red !important"}},disabled:!xi(s),"data-testid":"user-login-email-submit-button",children:(0,e.jsx)(I.A,{variant:"subtitle2",color:xi(s)?"#fff":"#D8D9DA",children:"Accept and Continue"})}),(0,e.jsxs)(I.A,{fontSize:"12px",lineHeight:"16px",color:"text.tertiary",paddingX:"4px",children:["By continuing, you agree to our"," ",(0,e.jsx)(Rn.A,{underline:"always",color:"text.secondary",href:kx,children:"Terms of Service"})," ","and"," ",(0,e.jsx)(Rn.A,{underline:"always",color:"text.secondary",href:Tx,children:"Privacy Policy"}),"."]})]})]})},U4=(0,g.Ay)("div")`
  display: flex;
  justify-content: center;
  flex-direction: column;
  align-items: center;
  padding: 24px;
  gap: 24px;
  z-index: 1;
  background: #fff;
  border-radius: 4px;
  box-shadow: 0px 16px 16px 0px rgba(0, 0, 0, 0.25);

  max-width: 664px;

  ${t=>t.theme.header?.height} {
    margin-top: ${t=>t.theme.header?.height};
  }
  @media screen and (max-width: 768px) {
    max-width: 564px;
  }
  @media screen and (max-width: 480px) {
    max-width: 400px;
    width: 100%;
    height: 100%;
    overflow-y: auto;
    justify-content: flex-start;
  }
`,W4=(0,g.Ay)("div")`
  display: flex;
  align-items: center;
  gap: 48px;
  align-self: stretch;
  flex-direction: row;
  @media screen and (max-width: 480px) {
    flex-direction: column;
    gap: 12px;
  }
`,h9=(0,g.Ay)("div")`
  color: #333;
  text-align: center;
  font-feature-settings: 'clig' off, 'liga' off;
  font-family: acumin-pro;
  font-size: 18px;
  font-style: normal;
  font-weight: 600;
  line-height: 24px;
`,g9=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 16px;
  align-self: stretch;
`,z4=(0,g.Ay)("div")`
  color: #000;
  font-family: 'Roboto';
  font-size: 20px;
  line-height: 30px;
  font-style: normal;
  font-weight: 600;
  line-height: normal;
`,f9=(0,g.Ay)("div")`
  color: #5d6062;
  font-family: 'Roboto';
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: 20px;
`,x9=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
  align-self: stretch;

  @media screen and (max-width: 480px) {
    flex: 1;
    justify-content: space-between;
    text-align: center;
  }
`,y9=(0,g.Ay)("a")`
  color: #3281e6;
  font-family: acumin-pro;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: normal;
`,b9=(0,g.Ay)("img")`
  max-width: 216px;
  display: flex;
  /* padding: 12px; */
  justify-content: center;
  align-items: center;
  gap: 7.787px;

  @media screen and (max-width: 480px) {
    max-width: 240px;
  }
`,v9=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
`,j9=(0,g.Ay)("img")`
  @media screen and (max-width: 480px) {
    max-width: 257px;
  }
`,A9=(0,g.Ay)(K.A)`
  /* width: 248px; */
  height: 78px;
  border-radius: 4px;
  border: 1px solid #b3b5b6;
  justify-content: space-between;
  background-color: white;
  gap: 12px;
  &:hover {
    background-color: white;
  }

  @media screen and (max-width: 480px) {
    width: 100%;
    justify-content: flex-start;
  }
`,C9=(0,g.Ay)("div")`
  color: #000;
  font-family: 'Roboto';
  font-size: 16px;
  line-height: 24px;
  font-style: normal;
  font-weight: 600;
  line-height: normal;
`,S9=(0,g.Ay)(W4)`
  gap: 24px;
  justify-content: space-between;

  @media screen and (max-width: 480px) {
    flex-direction: column;
    gap: 12px;
  }
`,w9=(0,g.Ay)(_.A)`
  & .MuiInputBase-input {
    padding: 8px;
  }
`,V4=()=>{const[t,n]=(0,d.useState)(!1),s=r=>{r.preventDefault();const a=sessionStorage.getItem(Nn.qm.PATH_TO_RETURN_TO);a?window.location.href=a:window.location.href="/"},o=r=>{r.preventDefault(),postMessage({status:"help-center-ticket"})};return(0,d.useEffect)(()=>{const r=sessionStorage.getItem(Nn.qm.PATH_TO_RETURN_TO);n(!!(r&&r.includes("/quote/")))},[]),(0,e.jsxs)(U4,{children:[(0,e.jsx)(z4,{children:"Registration Required"}),(0,e.jsxs)(I.A,{sx:{lineHeight:1.5,cursor:"pointer"},children:["We have re-sent an invite email and you must click the link in order to complete registration. If you cannot find that email or the link has expired, please request a new invite from your company admin, call 1-888-444-8399, or"," ",(0,e.jsx)(Rn.A,{onClick:o,role:"button",children:"click here for further help"}),"."]}),t&&(0,e.jsxs)(I.A,{sx:{textAlign:"left",lineHeight:1.5,cursor:"pointer",width:"100%"},children:["After completing registration, you can use"," ",(0,e.jsx)(Rn.A,{onClick:s,role:"button",children:"this link"})," ","to proceed to your quote."]})]})},Rx=m.p+"9a97e31f959fe634fa65e9fa164342fc.jpg",Ox=()=>(0,e.jsx)("img",{src:Rx,style:{position:"absolute",top:0,left:0,height:"100%",objectFit:"cover",width:"100%"},alt:""}),$4=(0,g.Ay)("div")(({theme:t})=>({display:"flex",flexDirection:"column",flex:1,justifyContent:"center",alignItems:"center",padding:24})),H4=()=>{const[t,n]=(0,d.useState)(!1),[s,o]=(0,d.useState)(!1),[r,a]=(0,d.useState)(!1),[i,l]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!1),[p,f]=(0,d.useState)(!1),[h,b]=(0,d.useState)(""),{showError:x}=(0,Fe.d)(),{getUTMCodes:v,clearUTMCodes:y}=Ix(),j=(0,L.useNavigate)(),A=async C=>{if(!C)return null;try{b(C),o(!0),n(!0);const k=await B4.postLogin(C);window.location.href=k.data.auth_url;const S=k.data?.redirectUrl==="/no_access",R=k.data?.redirectUrl==="/bfs_auth_landing";S?(o(!1),n(!1),j("/no_access")):R?j(`/bfs_auth_landing?email=${C}`):a(!0)}catch(k){w(k,C),o(!1)}},w=(C,k)=>{if(console.error("Error logging in: ",C),jc().isAxiosError(C))switch(C?.response?.status){case 400:x({message:"We ran into a problem. Please try again."});break;case 401:a(!1),console.error("User (",k,") is not whitelisted to use the application");break;case 403:f(!0);break;case 405:x({message:"We ran into a problem. Please try again."});break;case 406:x({message:"We ran into a problem. Please try again."});break;case 503:x({message:"We ran into a problem. Please try again."}),l(!0);break;default:a(!1),console.log("Received unknown error status ",C?.response?.status,C);break}},P=()=>s?(0,e.jsx)(T4,{"data-testid":"loading-card",children:(0,e.jsx)(bt.A,{})}):p?(0,e.jsx)(V4,{}):t?(j(`/register?email=${encodeURIComponent(h)}`),null):(0,e.jsx)(_4,{onSignIn:A});return(0,e.jsxs)(is,{children:[(0,e.jsxs)($4,{children:[(0,e.jsx)(Ox,{}),(0,e.jsx)(P,{})]}),(0,e.jsx)(I.A,{sx:{position:"absolute",left:0,right:0,margin:"0 auto",bottom:"12px",zIndex:1,textAlign:"center",strokeWidth:"0.5px",WebkitTextStrokeColor:"rgba(0,0,0,0)",textShadow:"0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.06)",fontFeatureSettings:"'liga' off, 'clig' off"},color:"#FFF",fontSize:"12px",children:"Powered by Builders FirstSource"})]})},Mx=()=>{const{isLoggedIn:t,userDataWaiting:n}=(0,Pt.A)(),{company:s,companyLoading:o}=(0,je.P)(),{userPermissions:r,userPermissionsLoading:a,allRoles:i}=(0,we.Sk)(),{isLoading:l}=(0,ss.F)(),{fetched:c,isFlagEnabled:u}=(0,ut.u)(),[p]=fo(Nn.Rh.mostRecentlySelectedCompany),{userHasPermission:f,isUserPermissionsLoading:h,companies:b}=(0,Ye.A)(),x=(0,D4.A)(),v=x.get("next"),y=x.get("from_app"),j=x.get("app_version");if(y&&(localStorage.setItem("from_app","true"),localStorage.setItem("using_app_V2",j?"true":"false")),!t&&!n)return(0,e.jsx)(H4,{});if(n||a||h||o||i.size===0||!c||l)return(0,e.jsx)(ls,{showLoadingScreen:!0,dataTestId:"user-login-loading-screen"});if(v)return(0,e.jsx)(L.Navigate,{to:`/${v}`});if((0,ct.EL)(i))return p?(0,e.jsx)(L.Navigate,{to:`/companies/${p}/projects`}):(0,e.jsx)(L.Navigate,{to:"/bfs/select_customer"});if((0,ct.Cy)(i)&&!u(D.SX.USE_V2_HEADER))return(0,e.jsx)(L.Navigate,{to:"/select_project"});if(Object.keys(r).length===0&&p)return(0,e.jsx)(L.Navigate,{to:`/companies/${p}/projects`});const A=s?.id||b?.[0]?.id,w=f({tool:D.w5.PROJECTS,action:D.a2.VIEW_PROJECTS_DASHBOARD,companyId:A,projectId:void 0});return w?(0,e.jsx)(L.Navigate,{to:`/companies/${A}/projects`}):(console.warn("Falling back to /select_project because there is no available company to send the user to.",{company:s,companies:b,hasProjectPermission:w}),(0,e.jsx)(L.Navigate,{to:"/select_project"}))},P9=()=>jsx(LandingPageContent,{textAlign:"left","data-testid":"non-whitelisted-content",children:jsxs(Container,{children:[jsx(LoginHeader,{sx:{marginBottom:"2rem"},children:"Welcome! We don't have a record of this email."}),jsxs(TextContent,{sx:{textAlign:"left",padding:0},children:["If you are an existing customer, ",jsx("a",{href:"http://www.mybldr.com/register",children:"register here."})]}),jsxs(TextContent,{sx:{textAlign:"left",padding:0},children:["If you are not a customer, ",jsx("a",{href:"https://www.bldr.com/contact/request-quote",children:"request access to myBLDR.com here."})]})]})}),Q4=(0,g.Ay)(K.A)`
  margin-top: 25px;
  background-color: var(--bfs-primary-accent-blue);
  text-transform: none;
  border-radius: 4px;
  max-width: 201px;
`,I9=({onSignIn:t})=>{const[n,s]=useState(""),o=async r=>{r.preventDefault(),await t(n)};return jsxs(LandingPageContent,{"data-testid":"sign-in-form",children:[jsxs(CenterAlign,{children:[jsx(LoginHeader,{children:"Sign in with your MyBFSBuilder account."}),jsxs(TextContent,{children:["For registered Builders FirstSource credit customers.",jsx("br",{}),jsx("br",{}),"New to Builders FirstSource?"," ",jsx("a",{href:"http://www.mybldr.com/register",children:"Register today!"})]})]}),jsxs(SignInFormTag,{onSubmit:o,children:[jsx(TextField,{variant:"standard",fullWidth:!0,label:"Email",type:"email",value:n,onChange:r=>s(r.target.value.toLowerCase()),inputProps:{"data-testid":"user-login-email-input"}}),jsx(Q4,{variant:"contained",disableElevation:!0,fullWidth:!0,disabled:!looksLikeMail(n),type:"submit","data-testid":"user-login-email-submit-button",children:"Accept and Login"}),jsxs(Typography,{variant:"body1",style:{paddingTop:"2rem"},children:["By continuing, you agree to our"," ",jsx("a",{href:"http://prod-api-mybfs.bldr.com/api/Site/document/file?type=1",target:"_blank",rel:"noreferrer",children:"Terms of Use"})," ","and"," ",jsx("a",{href:"http://prod-api-mybfs.bldr.com/api/Site/document/file?type=3",target:"_blank",rel:"noreferrer",children:"Privacy Policy"}),"."]})]})]})},G4=()=>{const{showError:t}=(0,Fe.d)(),[n]=(0,L.useSearchParams)(),s=n.get("error");return n.delete("error"),setTimeout(()=>{t({message:"Access denied"})},0),s==="403"?(0,e.jsx)(L.Navigate,{to:"/select_project"}):(0,e.jsx)(L.Navigate,{to:"/"})},K4=({children:t,featureFlags:n})=>{const{isFlagEnabled:s,fetched:o}=(0,ut.u)(),r=n.some(a=>s(a));return o?r?(0,e.jsx)(e.Fragment,{children:t}):(0,e.jsx)(L.Navigate,{to:"/select_project",replace:!0}):(0,e.jsx)(e.Fragment,{})},wr=(t,...n)=>()=>(0,e.jsx)(K4,{featureFlags:n,children:(0,e.jsx)(t,{})}),Y4=({loadingState:t,text:n,size:s,styles:o,handleClick:r})=>(0,e.jsx)(K.A,{onClick:r,variant:"contained",color:"primary",disabled:t,size:s,sx:{padding:"26px 16px",...o},children:t?(0,e.jsx)(bt.A,{size:"1rem"}):n}),D9=()=>jsx("div",{});var Ql=m(65941),la={};la.styleTagTransform=zs(),la.setAttributes=Us(),la.insert=_s().bind(null,"head"),la.domAPI=Ns(),la.insertStyleElement=Ws();var k9=Bs()(Ql.A,la);const yi=Ql.A&&Ql.A.locals?Ql.A.locals:void 0,Ou=({labelText:t,testId:n,checked:s,onChange:o,disabled:r})=>(0,e.jsx)(E.A,{className:yi.checkboxContainer,children:(0,e.jsxs)("label",{className:yi.customCheckbox,children:[(0,e.jsx)("input",{"data-testid":n,type:"checkbox",onChange:o,checked:s,disabled:r,className:yi.hiddenCheckbox}),(0,e.jsx)("span",{className:yi.styledCheckbox}),(0,e.jsx)(I.A,{variant:"body2",className:yi.checkboxLabel,children:t})]})}),Mu="ModFedRedirect";function q4(t){return!!(t&&t.path&&t.timestamp&&t.module)}const X4=()=>{const{isLoggedIn:t}=(0,Pt.A)(),n=()=>{const o=window.localStorage.getItem(Mu);window.localStorage.removeItem(Mu);try{if(!o)return"";const r=JSON.parse(o);return q4(r)?`${r?.path}/${window.location.hash}`??0:""}catch{return""}};if(!t)return null;const s=n();return s?(0,e.jsx)(L.Navigate,{to:s,replace:!0}):(0,e.jsx)(L.Navigate,{to:"/",replace:!0})};var J4=m(97746),Z4=m(75139),eM=m(68804);const Lx="230px",Fx=t=>({field:t,text:"",hidden:!0,align:"center",readOnly:!0,width:"150px",cellCls:""}),tM=(t,n,s,o=void 0,r,a)=>{const i=async(l,c,u)=>{await t(l,c,u),await r()};return[{field:"role",text:"Role",hidden:!0,readOnly:!0},{field:"user_name",text:"Name",width:"250px",htmlEncode:!1,readOnly:!0,locked:!0,renderer:l=>(0,e.jsx)(th,{value:l,onRemove:i,onAdd:n,onEdit:s,companyId:o,handleKebabClick:a})},{field:"user_email",text:"Email",width:"250px",readOnly:!0,locked:!0},{field:"user_phone",text:"Phone",width:"180px",readOnly:!0}]},T9=t=>!0,nM=t=>Object.entries(t).map(([n,s])=>{const r=s.filter(l=>l.display_name).map(l=>({field:`${n.replace(/\s+/g,"_").toLowerCase()}_${l.action}`,text:l.display_name,width:Lx,align:"center",readOnly:!0,cellCls:"bryntum-column-background"})),a=`${n.replace(/\s+/g,"_").toLowerCase()}_short`,i=Fx(a);return r.push(i),{text:n,collapsible:!0,collapsed:!0,collapseMode:"toggleAll",children:r,readOnly:!0}}),sM=(t,n)=>Object.entries(t).map(([s,o])=>{const a=o.filter(c=>c.display_name).map(c=>{const u=c.action.toLocaleUpperCase(),p=D.w5[s],f=D.a2[u];return{field:`${s.replace(/\s+/g,"_").toLowerCase()}_${c.action}`,text:c.display_name,id:c.id,type:"check",width:Lx,align:"center",cellCls:"bryntum-column-background",renderer({record:h,widgets:b,cellElement:x}){if(n?eh(p,f,h):!0){const y=b[0];y.disabled=!0,x.classList.add("b-force-read-only")}}}}),i=`${s.replace(/\s+/g,"_").toLowerCase()}_short`,l=Fx(i);return a.push(l),{text:s,collapsible:!0,collapsed:!0,collapseMode:"toggleAll",children:a,readOnly:!0}}),oM=(t,n,s,o,r,a,i)=>({groupSortFn:hp,field:"role",toggleOnRowClick:!1,renderer:({row:l,groupRowFor:c})=>{const u=n?.filter(b=>b.name===c)[0]?.id,p=s[u];l.cells.forEach(b=>{const x=b._domData.column;p&&x in p&&(b.textContent=p[x])});const f=l.cells[0];f._reactRootContainer&&f._reactRootContainer.unmount(),(0,ae.createRoot)(f).render((0,e.jsx)(tc,{role:c,onKebabClick:b=>t(c,b),userCanEditPermissions:r,canInviteOrEditCrew:a,hideKebab:!i}))}}),rM=(t,n,s,o,r,a,i)=>({height:"70vh",features:{cellMenu:{disabled:!0}},groupFeature:oM(t,n,s,o,r,a,i)}),aM=({assignments:t,userPermissions:n,tools:s,roles:o,getUpdatedAssignments:r,isLoading:a,setIsEditOpen:i,setSelectedRole:l,selectedRole:c,selectedRoleID:u,setSelectedRoleID:p,setIsOpen:f,setInitialSelectedPermissions:h,value:b,setValue:x,roleBasedData:v,userLevelPermissionsEnabled:y,isPortalAccessEnabled:j})=>{const{company:A}=(0,je.P)(),{showError:w,showSuccess:P}=(0,Fe.d)(),{addUserPermission:C,removeUserPermission:k}=qm(),{isFlagEnabled:S}=(0,ut.u)(),{addCrew:R,removeCrew:B,deleteRole:T,updateCrew:W}=(0,xd.A)(void 0,A?.id),{userHasPermission:N,isUserPermissionsLoading:O}=(0,Ye.A)(),[z,Q]=(0,d.useState)(!0),[re,ue]=(0,d.useState)([]),[le,F]=(0,d.useState)(null),[V,$]=(0,d.useState)(!1),[ee,X]=(0,d.useState)(!1),[G,Y]=(0,d.useState)(!1),[he,ne]=(0,d.useState)(null),[J,pe]=(0,d.useState)(!1),[Ee,Te]=(0,d.useState)({top:0,left:0}),me=(0,d.useRef)(null),$e=(0,d.useRef)(null),gt=async(Ct,Mt,Pe)=>{await C(Ct,Mt,Pe)},Rt=async(Ct,Mt,Pe)=>{await k(Ct,Mt,Pe)},rt=N({tool:D.w5.CREWS,action:D.a2.EDIT_BFS_PERMISSIONS,companyId:A?.id,projectId:void 0}),Ue=Ct=>{Ct.on("cellClick",({record:Mt,column:Pe,cellElement:Qe})=>{const Xt=Qe.querySelector('input[type="checkbox"]')?.disabled;if(Pe.type==="check"&&rt&&!Xt){const As=!Mt.get(Pe.field);Mt.set(Pe.field,As);const Ln=Mt.get("assignment_id"),hs=Mt.get("user_id"),Qs=Pe.id;As&&gt(hs,Ln,Qs),As||Rt(hs,Ln,Qs)}})},lt=(Ct,Mt,Pe)=>{f(!1);const Qe=yd(Ct,o),ht=mp(Qe,o);if(Qe){const Xt=Mt.currentTarget.getBoundingClientRect();Te({top:Xt.bottom,left:Xt.left}),pe(!0),x(Ct),l(Ct),h(ht),p(Qe),ne(Pe||null)}},ge=()=>{pe(!1)};(0,d.useEffect)(()=>{const Ct=Mt=>{const Pe=Mt.target;J&&me.current&&!me.current.contains(Pe)&&pe(!1)};return document.addEventListener("mousedown",Ct),()=>{document.removeEventListener("mousedown",Ct)}},[J,me]);const We=N({tool:D.w5.CREWS,action:D.a2.INVITE_OR_EDIT_CREW,companyId:A?.id,projectId:void 0}),At=N({tool:D.w5.CREWS,action:D.a2.EDIT_ROLE,companyId:A?.id,projectId:void 0}),xn=N({tool:D.w5.CREWS,action:D.a2.DELETE_ROLE,companyId:A?.id,projectId:void 0});(0,d.useEffect)(()=>{O||Q(We)},[A,O]);const on=async Ct=>{const Mt=yd(c,o),Pe=await W(Mt,Ct);return await r(),P({title:"Success",message:`You updated user: ${Ct.email}!`}),$(!1),Pe},Xe=async(Ct,Mt)=>{const Qe=o.find(Qt=>Qt.name===we.wy.Subs)?.id===Ct,ht=he?await W(Ct,Mt,he.assignmentId):await R(Ct,Mt,{suppressEmail:Qe});await r();const Xt=he?`You updated ${Mt.email}!`:`You added ${Mt.email} to your crew!`;return ht?.error?w({title:"Error",message:`${Mt.email} could not be updated.`}):P({title:"Success",message:Xt}),$(!1),ht},dt=async(Ct,Mt,Pe)=>{await B(Ct,Mt,Pe),await r(),X(!1)},Tn=async Ct=>{const Mt=await T(Ct);return await r(),Y(!1),Mt?.status===418?w({title:"Role cannot be deleted",message:"We're sorry! You cannot delete a role until all users have been removed or reassigned."}):Mt?.errors?.length>0?w({title:"Role cannot be deleted",message:"We're sorry! Something went wrong."}):Mt};function In(Ct){const Mt=tM(B,Xe,on,A?.id,r,lt),Pe=Object.entries(Ct).reduce((ht,[Xt,Qt])=>(Qt.length>0&&(ht[Xt]=Qt),ht),{}),Qe=y?sM(Pe,rt):nM(Pe);return[...Mt,...Qe]}return(0,d.useEffect)(()=>{s&&Object.keys(s).length!==0&&ue(In(s))},[s]),(0,d.useEffect)(()=>{if(s&&Object.keys(s).length!==0&&t){const Ct=rM(lt,o,v,A,rt,We,j);F(Ct)}},[t,s]),(0,d.useEffect)(()=>{if($e.current){const Ct=$e.current.instance;Ue(Ct)}return()=>{$e.current&&$e.current.instance.removeAllListeners()}},[le,re]),a?(0,e.jsx)("div",{children:"Loading..."}):a||!le?null:(0,e.jsxs)("div",{children:[(0,e.jsx)(Xm.C4,{ref:$e,config:le,columns:re,data:t}),(0,e.jsx)(Jm,{ref:me,role:c,position:Ee,onClose:ge,isVisible:J,setIsDeleteModalOpen:Y,setIsAddOpen:$,setIsDeleteUserModalOpen:X,setIsEditOpen:i,value:b,setValue:x,company:A,editRolePermission:At,deleteRolePermission:xn,userCanEditPermissions:rt,canInviteOrEditCrew:We,crewData:he}),(0,e.jsx)(fd,{isOpen:V,submitCallback:(Ct,Mt)=>Xe(Mt.id,Ct),closeModal:()=>$(!1),roles:o,setSelectedRole:l,currentRole:o.find(Ct=>Ct.name===b),crewData:he}),(0,e.jsx)(x1,{isOpen:G,submitCallback:()=>Tn(u),closeModal:()=>Y(!1),role:c,roleID:u}),(0,e.jsx)(ec,{open:ee,onRemove:()=>dt(he?.role,he?.id,he?.assignmentId),userId:he?.id,userEmail:he?.email,roleType:c,onClose:()=>X(!1)})]})},Bx=()=>{const{company:t}=(0,je.P)(),{userHasPermission:n}=(0,Ye.A)(),{isFlagEnabled:s}=(0,ut.u)(),{isLoading:o,fetchCrewAssignmentsAndTools:r,getUpdatedAssignments:a,assignments:i,tools:l,roles:c,roleBasedData:u,addRoleWithPermissions:p,updateRoleWithPermissions:f,userPermissions:h,isPortalAccessEnabled:b}=(0,eM.A)(String(t?.id)),{createEvent:x}=(0,On.AG)(),[v,y]=(0,d.useState)(!1),[j,A]=(0,d.useState)(!1),[w,P]=(0,d.useState)(""),[C,k]=(0,d.useState)(0),[S,R]=(0,d.useState)([]),[B,T]=(0,d.useState)(""),W=s(D.SX.CUSTOM_ROLES),N=s(D.SX.USER_LEVEL_PERMISSIONS),O=n({tool:D.w5.CREWS,action:D.a2.CREATE_ROLE,companyId:t?.id,projectId:void 0}),{canViewPage:z}=(0,$n.s)({tool:D.w5.CREWS,action:D.a2.VIEW_CREWS,companyId:t?.id,projectId:void 0},[t?.id]),Q=()=>{A(!1),R([]),P(""),T(""),k(0),y(!0)};(0,d.useEffect)(()=>{t&&x({content_type:"company",object_id:t?.id,tool:"crews"})},[t]),(0,d.useEffect)(()=>{t&&r().catch(le=>{console.error("Error fetching assignments:",le)})},[t]);const re=async(le,F)=>{await p(le,F,t),await a()},ue=async(le,F)=>{await f(le,F,C),await a()};return(0,e.jsxs)(e.Fragment,{children:[W?(0,e.jsx)(Ne,{initialSelectedPermissions:S,setInitialSelectedPermissions:R,isOpen:v||j,setIsEditOpen:A,isEditOpen:j,setIsOpen:y,tools:l,onRoleAdded:re,onRoleEdit:ue,value:B,setValue:T,selectedRoleID:C}):null,z&&(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"1.5rem",margin:"16px",backgroundColor:"white",borderRadius:".5rem",padding:"1rem",overflowX:"hidden"},children:[(0,e.jsxs)(Ge,{children:[(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"h6",sx:{marginBottom:".5rem"},children:"Crew Permissions"}),(0,e.jsx)(I.A,{variant:"body2",children:"Easily invite and manage admins, staff, home buyers, and project subcontractors with customizable permissions on this page."})]}),W&&O?(0,e.jsx)(K.A,{style:{marginBottom:0},variant:"contained",color:"primary",onClick:()=>Q(),"data-testid":"create-new-role-button",children:"Create New Role"}):null]}),!o&&!b&&(0,e.jsx)(Rs.A,{severity:"info",children:"This account has portal access disabled for customers."}),!o&&i&&l&&(0,e.jsx)(aM,{roles:c,assignments:i,userPermissions:h,tools:l,getUpdatedAssignments:a,isLoading:o,setIsEditOpen:A,setSelectedRole:P,selectedRole:w,selectedRoleID:C,setSelectedRoleID:k,setIsOpen:y,setInitialSelectedPermissions:R,value:B,setValue:T,roleBasedData:u,userLevelPermissionsEnabled:N,isPortalAccessEnabled:b})]})]})},Lu="BFS Support Team",iM=[{value:"none",label:"None"},{value:"email",label:"Email"}],Nx={value:"none",label:"None"},lM={value:"email",label:"All emails",description:"Receive notifications about the activity of customers and employees."},_x={value:"email_external",label:"External emails",description:"Receive notifications about the activity of customers."},dM=[Nx,lM,_x],Ux=[{field:"group",headerName:"Group",renderCell:t=>(0,e.jsx)(I.A,{variant:"inherit",fontWeight:"medium",children:t.value})},{field:"userLabel",headerName:"User",type:"string",renderCell:t=>(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center",marginLeft:"14px",paddingLeft:"24px",height:"100%",borderLeft:t.value||!t.value&&t.rowNode.type==="leaf"?"1px dashed lightgray":"none"},title:t.value,className:A0,role:"presentation",children:!t.value&&t.rowNode.type==="leaf"?(0,e.jsx)(I.A,{variant:"inherit",sx:{color:"gray"},children:"No Users Found"}):(0,e.jsxs)(I.A,{variant:"inherit",children:[t.value," ",t.row.displayLabel]})})}],ko=(t,n,s)=>({field:t,headerName:n,flex:1,minWidth:100,editable:!0,type:"singleSelect",renderEditCell:o=>(0,e.jsx)(H0,{...o,renderSelectedOption:({label:r})=>r,renderOption:({label:r,description:a})=>(0,e.jsx)(Cn.A,{secondary:a,sx:{width:"300px"},secondaryTypographyProps:{sx:{whiteSpace:"normal"}},children:r})}),valueOptions:({row:o})=>o.group===Lu?s??dM:iM}),cM=[...Ux,ko("quoteRequest","Quote Request"),ko("orderSubmitted","Order Submitted")],uM=[...Ux,ko("quoteRequest","Quote Request"),ko("orderSubmitted","Order Submitted"),ko("newPrimaryPlanUpload","New Primary Plan Upload"),ko("homeConfigureRequested","Home Configure Requested"),ko("buildOptimizeRequested","Build Optimize Requested"),ko("digitalToolsRequested","Digital Tools Requested"),ko("firstQuoteView","First Quote View",[Nx,_x])],bi=(0,Lo.xP)({baseQuery:(0,Zo.S)({baseUrl:"/api/companies/"}),reducerPath:"crewsNotifications",endpoints:t=>({getCrewsNotifications:t.query({query:n=>({url:`${n}/crew_notifications`,method:"GET"})}),updateCrewsNotification:t.mutation({query:({companyId:n,...s})=>({url:`${n}/crew_notifications`,method:"PUT",data:s}),async onQueryStarted({companyId:n,id:s,quoteRequested:o,orderSubmitted:r,newPrimaryPlanUpload:a,homeConfigureRequested:i,buildOptimizeRequested:l,digitalToolsRequested:c,firstQuoteView:u},{dispatch:p,queryFulfilled:f}){const h=p(bi.util.updateQueryData("getCrewsNotifications",n,b=>b.map(x=>x.id===s?{...x,quoteRequested:o,orderSubmitted:r,newPrimaryPlanUpload:a,homeConfigureRequested:i,buildOptimizeRequested:l,digitalToolsRequested:c,firstQuoteView:u}:x)));f.catch(h.undo)}})})}),{useGetCrewsNotificationsQuery:pM,useUpdateCrewsNotificationMutation:mM}=bi;function Er(t){return t==="none"?null:t}const hM=()=>{const{company:t}=(0,je.P)(),n=(0,Fe.d)(),{userHasPermission:s}=(0,Ye.A)(),{user:o}=(0,Pt.A)(),{allRoles:r}=(0,Ye.A)(),a=s({tool:D.w5.CREWS,action:D.a2.MANAGE_NOTIFICATIONS,companyId:t?.id,projectId:void 0}),[i]=mM(),{data:l=[],isFetching:c}=pM(t?.id,{skip:!t?.id,refetchOnMountOrArgChange:!0}),u=(0,Kn.b)(),p=(0,d.useRef)(null),f=[we.wy.CompanyManager,we.wy.CompanyCrew,we.wy.Subs,Lu];$o({handleResize:()=>zo(p.current)});const h=(0,d.useMemo)(()=>[...l].sort((y,j)=>{const A=f.indexOf(y.role),w=f.indexOf(j.role),P=A!==-1?A:f.length-1,C=w!==-1?w:f.length-1;return P-C}).map(y=>{const j=[we.wy.OSR,"BFS Component Design"].includes(y.role)?Lu:y.role,A=w=>w??"none";return{id:y.id,parentId:j,userLabel:y.email,displayLabel:y.displayLabel,quoteRequest:A(y.quoteRequested),orderSubmitted:A(y.orderSubmitted),newPrimaryPlanUpload:A(y.newPrimaryPlanUpload),homeConfigureRequested:A(y.homeConfigureRequested),buildOptimizeRequested:A(y.buildOptimizeRequested),digitalToolsRequested:A(y.digitalToolsRequested),firstQuoteView:A(y.firstQuoteView),group:j,isCurrentUserRow:y.email===o?.email}}),[t,l,o]),b=eo(u);return(0,e.jsx)(is,{children:(0,e.jsxs)(E.A,{sx:x=>({backgroundColor:x.palette.background.secondary,padding:"24px",boxSizing:"border-box"}),children:[(0,e.jsx)(I.A,{variant:"h4",component:"h1",fontWeight:"medium",sx:{paddingBottom:"16px",boxSizing:"border-box"},children:"Notifications"}),(0,e.jsx)(Vo,{ref:p,showRowBorder:!0,children:(0,e.jsx)(Jn,{apiRef:u,loading:c,columns:(0,ct.EL)(r)?uM:cM,rows:h,initialState:{rowGrouping:{model:["group"]},columns:{columnVisibilityModel:{userLabel:!1,group:!1}}},getRowClassName:b,isCellEditable:x=>x.field==="group"?!1:a||x.row.isCurrentUserRow,groupingColDef:{minWidth:200,flex:2,leafField:"userLabel",hideDescendantCount:!0},processRowUpdate:x=>{i({companyId:t?.id,id:x.id,email:x.userLabel,role:x.group,quoteRequested:Er(x.quoteRequest),orderSubmitted:Er(x.orderSubmitted),newPrimaryPlanUpload:Er(x.newPrimaryPlanUpload),homeConfigureRequested:Er(x.homeConfigureRequested),buildOptimizeRequested:Er(x.buildOptimizeRequested),digitalToolsRequested:Er(x.digitalToolsRequested),firstQuoteView:Er(x.firstQuoteView)}).then(v=>{"error"in v&&n.showError({message:Ya(v)})})},disableColumnReorder:!0,disableRowSelectionOnClick:!0,hideFooter:!0,disableColumnMenu:!0,slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"linear-progress"}}})})]})})},R9=null,gM=()=>{const{routes:t}=ic([{to:"permissions",icon:(0,e.jsx)(J4.A,{}),text:"Roles & Permissions",element:(0,e.jsx)(Bx,{}),key:"permissions"},{to:"notifications",icon:(0,e.jsx)(Z4.A,{}),text:"Notifications",element:(0,e.jsx)(hM,{}),key:"notifications"}]),{isFlagEnabled:n}=(0,ut.u)(),s=n(D.SX.USE_NOTIFICATIONS_PAGE);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(kn,{children:s?(0,e.jsx)(Ua,{sidebarContent:(0,e.jsx)(Hi,{items:t}),persistKey:Nn.Rh.crewsSidebar,width:"250px",children:(0,e.jsxs)(L.Routes,{children:[(0,e.jsx)(L.Route,{path:"",element:(0,e.jsx)(L.Navigate,{to:t[0].to,replace:!0})}),t.map(o=>(0,e.jsx)(L.Route,{path:`${o.to}${o.children?"/*":""}`,element:o.element},o.key))]})}):(0,e.jsx)(Bx,{})})]})},fM={width:"130px",top:t=>t.header?.height,height:t=>`calc(100% - ${t.header?.height})`,backgroundColor:"var(--bfs-primary-true-white)"},xM=(0,g.Ay)(_n.Ay)`
  font-size: 10px;
  color: var(--bfs-primary-true-black);
  flex-direction: column;
  border: solid 0.8px #e6e6e6;
`,yM=(0,g.Ay)(qn.A)`
  padding: 0;
`;var Gl=m(99973),da={};da.styleTagTransform=zs(),da.setAttributes=Us(),da.insert=_s().bind(null,"head"),da.domAPI=Ns(),da.insertStyleElement=Ws();var O9=Bs()(Gl.A,da);const M9=Gl.A&&Gl.A.locals?Gl.A.locals:void 0,bM=({navLink:t,parentRoute:n})=>{const s=(0,L.useLocation)(),{destination:o,disabled:r,icon:a,label:i}=t,l=()=>o===""?n.includes("/profile")?s.pathname.includes("profile")&&!s.pathname.includes("profile/"):s.pathname.includes("digital_tools")&&!s.pathname.includes("digital_tools/"):s.pathname.includes(o),c=()=>{let h="icon";return r?`${h} icon-disabled`:l()?`${h} icon-selected`:`${h} icon-unselected`},u=()=>r?"disabled":l()?"selected":"unselected",p=()=>{let h="";return a?h:(h="navButton",r?`${h} nav-disabled`:l()?`${h} button-selected`:`${h} button-unselected`)},f=()=>o==""?n:`${n}/${o}`;return(0,e.jsx)(xM,{"data-testid":"nav-container",className:p(),children:(0,e.jsxs)(L.Link,{to:f(),children:[a&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{"data-testid":"icon-container",className:c(),children:(0,e.jsx)(gm.k,{"data-testid":"icon-img",src:a,className:u()})}),i]}),!a&&(0,e.jsx)(E.A,{sx:{textAlign:"right"},children:i})]})})},vM=({navLinks:t,pathRoute:n})=>(0,e.jsx)(Oo.Ay,{variant:"permanent",anchor:"left","data-testid":"tools-drawer",PaperProps:{sx:fM},children:(0,e.jsx)(yM,{children:t.map(s=>(0,e.jsx)(bM,{navLink:s,parentRoute:n},s.label+s.destination))})}),jM=(0,g.Ay)(kn)`
  align-items: stretch;
  gap: 16px;
  padding: 24px;
  object-fit: contain;
  background-color: var(--bfs-11-22-body-background);
  margin-left: 130px;
`,L9={width:"130px",top:t=>t.header?.height,height:t=>`calc(100% - ${t.header?.height})`,backgroundColor:"var(--bfs-primary-true-white)"},F9=(0,g.Ay)(_n.Ay)`
  font-size: 10px;
  color: var(--bfs-primary-true-black);
  flex-direction: column;
  border: solid 0.8px #e6e6e6;
`,B9=(0,g.Ay)("img")`
  height: 68px;
  width: 68px;
  margin-bottom: 3px;
`,N9=(0,g.Ay)(qn.A)`
  padding: 0;
`,AM=(0,g.Ay)("div")`
  align-self: stretch;
  flex-grow: 1;
  display: flex;
  flex-direction: row;
  justify-content: flex-start;
  align-items: flex-start;
  gap: 10px;
  border-radius: 8px;
  background-color: var(--bfs-primary-true-white);
`,CM=(0,g.Ay)(xt.A)`
  background-color: #ebebeb;
  font-weight: bold;
  font-size: 14px;
  line-height: 15.4px;
  color: var(--bfs-primary-true-black);

  border-left: solid 1.8px #c8c8c8;
  border-right: solid 1.8px #c8c8c8;

  &:first-of-type {
    border-left: solid 0.9px #c8c8c8;
  }

  &:last-of-type {
    border-right: solid 0.9px #c8c8c8;
    min-width: 150px;
  }
`,vi=(0,g.Ay)(xt.A)`
  border: solid 0.9px #c8c8c8;
  border-left: solid 1.8px #c8c8c8;
  border-right: solid 1.8px #c8c8c8;
  flex: 1;

  &:first-of-type {
    border-left: solid 0.9px #c8c8c8;
    border-right: solid 1.8px #c8c8c8;
  }

  &:last-of-type {
    border-left: solid 1.8px #c8c8c8;
    border-right: solid 0.9px #c8c8c8;
  }
`,SM=(0,g.Ay)(Zn.A)(({theme:t})=>({"&:nth-of-type(even)":{backgroundColor:t.palette.action.hover}})),wM=(0,g.Ay)(gu.A)`
  min-width: 1101px;
  width: unset;
  box-sizing: border-box;
  display: flex;
  flex-direction: row;
  justify-content: flexStart;
  align-items: flexStart;
  gap: 10px;
  padding: 24px 20px 24px 24px;
  border-radius: 8px;
  background-color: var(--bfs-primary-true-white);
`,Fu=(0,g.Ay)(Rn.A)`
  color: #0064e4;
  font-size: 14px;
  text-align: left;

  &:hover {
    cursor: pointer;
  }
`,EM=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  gap: 13px;
`,PM=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 16px 8px;
  border: 1px solid #bfbfbf;
  border-radius: 4px;
`,IM=(0,g.Ay)("div")`
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
`,DM=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  gap: 4px;
`,Wx=(0,g.Ay)(K.A)`
  height: 38px;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 10px 16px 11px;
  border-radius: 8px;
  background-color: #818181;
  color: var(--bfs-primary-true-white);

  &:hover {
    background-color: #555352;
  }
`,kM=(0,g.Ay)("div")`
  border-bottom: 1px solid #bfbfbf;
`,TM=(0,g.Ay)("div")`
  display: flex;
  height: 30px;
  justify-content: flex-end;
  align-items: center;
  padding-right: 16px;
  gap: 48px;
`,RM=(0,g.Ay)("div")`
  display: flex;
  height: 48px;
  gap: 24px;
  justify-content: flex-end;
  align-items: center;
`,OM=(0,g.Ay)(K.A)`
  display: flex;
  height: 48px;
  font-size: 16px;
  flex-grow: 0;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 8px;
  padding: 0 16px;
  border-radius: 4px;
  color: var(--bfs-primary-true-white);
  background-color: #229920;

  &:hover {
    background-color: #229920;
  }
`,MM=(0,g.Ay)(xo)`
  font-size: 12px;
  width: 140px;
  text-align: right;
`,LM=(0,g.Ay)(Fu)`
  font-size: 12px;
  text-align: right;
`,FM=(0,g.Ay)("div")`
  height: 57px;
  align-self: stretch;
  flex-grow: 0;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  align-items: center;
  padding: 24px;
  border-radius: 8px;
  background-color: var(--bfs-primary-true-white);
`,BM=(0,g.Ay)("div")`
  width: 549px;
  height: 57px;
  flex-grow: 0;
  font-size: 16px;
  font-weight: 600;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.2;
  letter-spacing: normal;
  text-align: left;
  color: var(--bfs-primary-true-black);
`,NM=(0,g.Ay)(K.A)`
  width: 205px;
  height: 48px;
  flex-grow: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 8px;
  padding: 0 16px;
  border-radius: 4px;
  background-color: #229920;
  opacity: ${t=>t.disabled?".5":"1"};
  color: var(--light-secondary-contrast);
  font-size: 16px;
  font-weight: 600;
  font-stretch: normal;
  font-style: normal;
  line-height: 1.75;
  letter-spacing: 0.46px;
  text-align: center;
  &:hover {
    background-color: #229920;
  }
`,_M=(0,g.Ay)("p")`
  color: #000;
  font-feature-settings: 'clig' off, 'liga' off;
  font-family: acumin-pro, sans-serif;
  font-size: 20px;
  font-style: normal;
  font-weight: 600;
  line-height: normal;
  margin: 0px;
`,UM=(0,g.Ay)("div")`
  display: flex;
  align-items: center;
  gap: 16px;
  align-self: stretch;
`,WM=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
`,zM=(0,g.Ay)("p")`
  color: #000;
  font-feature-settings: 'clig' off, 'liga' off;
  font-family: acumin-pro, sans-serif;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: normal;
  margin: 0px;
`,VM=({openRequestDrawer:t})=>{const{company:n}=(0,je.P)(),{userHasPermission:s}=(0,Ye.A)(),{isFlagEnabled:o}=(0,ut.u)(),r=o(D.SX.DISABLE_DIGITAL_TOOLS_OPPORTUNITY),a=s({tool:D.w5.DIGITAL,action:D.a2.PURCHASE,companyId:n?.id,projectId:void 0});return(0,e.jsxs)(FM,{children:[(0,e.jsx)(BM,{children:"Our Digital Tools provide homebuilders with greater transparency and control over your projects while accelerating the sales process, better engaging homebuyers, and streamlining construction."}),!!n?.osrEmail&&(0,e.jsxs)(UM,{children:[(0,e.jsx)(Wx,{href:`mailto:${n?.osrEmail}`,children:"Contact Sales Rep"}),(0,e.jsxs)(WM,{children:[(0,e.jsx)(_M,{children:"Questions?"}),(0,e.jsx)(zM,{children:"Contact your sales representative"})]})]}),r?null:(0,e.jsx)(NM,{disabled:!a,onClick:t,children:"Request Digital Tools"})]})},Go=(0,g.Ay)(bx.A)`
  display: flex;
  align-items: center;
  font-size: 14px;
  color: var(--bfs-primary-true-black);
  margin-right: 10px;
  flex: 1;
  justify-content: flex-end;

  .MuiFormLabel-asterisk {
    color: red;
  }
`,Ko=(0,g.Ay)("div")`
  display: flex;
  flex: 2;
`,Yo=(0,g.Ay)(Be.A)`
  display: flex;
  flex-direction: row;
  margin-bottom: 10px;

  .MuiFormControlLabel-label {
    font-size: 14px;
  }

  .MuiFormLabel-root.Mui-focused {
    color: var(--bfs-primary-true-black);
  }

  .MuiInputBase-input {
    font-size: 14px;
    color: var(--bfs-primary-true-black);
  }
`,$M=(0,g.Ay)(K.A)`
  background-color: #229920;

  &.Mui-disabled {
    opacity: 0.38 !important;
    background-color: #229920;
  }

  &:hover {
    background-color: #229920;
  }
`,HM=()=>{const{createProjectFromNullId:t,createNewProject:n}=(0,De.B)(),[s,o]=(0,d.useState)(!1),[r,a]=(0,d.useState)(null),[i,l]=(0,d.useState)(!1),{company:c}=(0,je.P)(),u=(0,d.useCallback)(async(f,h)=>f.id?f.id:f.externalId&&t&&c?.id!==void 0?(await t(c.id,f.externalId)).id:h&&n&&c?.id!==void 0?await n(c.id,h):null,[t,n]);return{createOpportunity:(0,d.useCallback)(async f=>{if(!s){o(!0),a(null),l(!1);try{const{project:h,email:b,digitalTools:x,notes:v,newProject:y}=f,j=await u(h,y);if(!j)throw new Error("Failed to get project");await nt.Ay.post("/api/digital_tools/request_digital_tools",{project_id:j,contact_email:b,digital_tools:x,notes:v}),l(!0)}catch(h){console.error("Failed to create opportunity"),a(h)}finally{o(!1)}}},[s,u]),loading:s,error:r,success:i}},QM=({onSelection:t})=>{const[n,s]=(0,d.useState)(null),[o,r]=(0,d.useState)(""),[a,i]=(0,d.useState)(""),{projectList:l,isLoading:c,isFetching:u}=(0,Ys.Y)({searchTerm:o,showErrorMessage:!0,shouldRefetch:!1}),p=(c||u)&&n?.projectName!==o,f=u?[]:l.map(v=>({label:v.projectName,value:v.projectExternalId})),h=(0,d.useCallback)((0,H.debounce)(v=>{r(v)},1e3),[r]),b=v=>{i(v),h(v)},x=v=>{t(v),s(v)};return(0,e.jsxs)(Yo,{children:[(0,e.jsx)(Go,{children:"Project"}),(0,e.jsx)(Ko,{children:(0,e.jsx)(Gn.A,{onChange:(v,y)=>{if(y){const j=l.find(A=>A.projectExternalId===y.value);x(j??null)}},isOptionEqualToValue:(v,y)=>v.value===y.value,sx:{flex:1},filterOptions:v=>v,inputValue:a,onInputChange:(v,y)=>{b(y)},loading:p,options:f,renderInput:v=>(0,e.jsx)(_.A,{...v,placeholder:"Select or search for existing projects",variant:"outlined",sx:{width:"100%"},InputProps:{...v.InputProps,endAdornment:(0,e.jsxs)(se().Fragment,{children:[p?(0,e.jsx)(bt.A,{color:"inherit",size:20}):null,v.InputProps.endAdornment]})}})})})]})},GM=({shouldCreateNewProject:t,newProject:n,updateForm:s,notes:o})=>{const r=u=>s("existingProject",u),a=u=>s("notes",u),i=u=>s("useNewProject",u),l=(u,p)=>{s("newProject",{...n,[u]:p})},c=o.length>=255;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Yo,{children:[(0,e.jsx)(Go,{children:"Is this for an existing project?"}),(0,e.jsx)(Ko,{children:(0,e.jsxs)(Gi.A,{row:!0,value:t?"new":"existing",onChange:u=>{u.target.value==="new"?i(!0):i(!1)},children:[(0,e.jsx)(ye.A,{value:"new",control:(0,e.jsx)(_o.A,{}),label:"New Project"}),(0,e.jsx)(ye.A,{value:"existing",control:(0,e.jsx)(_o.A,{}),label:"Existing Project"})]})})]}),!t&&(0,e.jsx)(QM,{onSelection:u=>r(u)}),t&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Yo,{children:[(0,e.jsx)(Go,{required:!0,sx:{bottom:"12px"},children:"Project Name"}),(0,e.jsx)(Ko,{children:(0,e.jsx)(_.A,{sx:{width:"100%"},variant:"outlined",placeholder:"Project Name",required:!0,onChange:u=>l("name",u.target.value),inputProps:{maxLength:50}})})]}),(0,e.jsxs)(Yo,{children:[(0,e.jsx)(Go,{children:"Address"}),(0,e.jsx)(Ko,{children:(0,e.jsx)(_.A,{sx:{width:"100%"},variant:"outlined",placeholder:"Street Address / Location Description",onChange:u=>l("street",u.target.value)})})]}),(0,e.jsxs)(Yo,{children:[(0,e.jsx)(Go,{children:"City, State, Zip"}),(0,e.jsxs)(Ko,{style:{gap:"6px"},children:[(0,e.jsx)(_.A,{sx:{flex:4},variant:"outlined",placeholder:"City",onChange:u=>l("city",u.target.value)}),(0,e.jsx)(Ui,{onChange:u=>l("state",u),value:n.state??""}),(0,e.jsx)(_.A,{sx:{flex:1},variant:"outlined",placeholder:"Zip",onChange:u=>l("zip",u.target.value)})]})]})]}),(0,e.jsxs)(Yo,{children:[(0,e.jsx)(Go,{children:"Notes"}),(0,e.jsx)(Ko,{children:(0,e.jsx)(_.A,{sx:{width:"100%"},multiline:!0,rows:4,variant:"outlined",onChange:u=>a(u.target.value),placeholder:"Add any notes you feel will help complete your Digital Tools request.",inputProps:{maxLength:255},error:c,helperText:c?"Max characters reached":""})})]})]})},KM=({digitalTools:t,onDigitalToolsChange:n})=>{const s=[{label:"Drafting",value:"Drafting"},{label:"Build Optimize",value:"Build Optimize"},{label:"Home Configure",value:"Home Configure"},{label:"Render",value:"Render Services"},{label:"Home Plan Library",value:"Home Plan Library - Classic"}];return(0,e.jsxs)(Yo,{style:{gap:25},children:[(0,e.jsx)(Go,{style:{alignSelf:"flex-start",height:42},children:"Digital Tools Requested For This Project"}),(0,e.jsx)(Ko,{style:{flex:1},children:(0,e.jsx)(fu.A,{children:s.map(o=>(0,e.jsx)(ye.A,{control:(0,e.jsx)(ve.A,{checked:t.includes(o.value),onChange:r=>n(o.value,r.target.checked)}),label:o.label,value:o.value},o.value))})})]})},YM=({email:t,onEmailChange:n})=>(0,e.jsxs)(Yo,{children:[(0,e.jsx)(Go,{children:"Email"}),(0,e.jsx)(Ko,{children:(0,e.jsx)(_.A,{sx:{width:"100%"},variant:"outlined",onChange:s=>n(s.target.value),placeholder:"contact@email.com"})})]}),qM=({closeDrawer:t})=>{const{showError:n}=(0,Fe.d)(),{createOpportunity:s,loading:o,success:r,error:a}=HM(),[i,l]=(0,d.useState)({useNewProject:!1,existingProject:null,email:"",digitalTools:[],notes:"",newProject:{name:"",street:"",city:"",state:"",zip:""}}),c=(0,d.useCallback)((f,h)=>{l(b=>{const x={...b,[f]:h};return f==="useNewProject"&&h===!0?x.existingProject=null:f==="useNewProject"&&h===!1&&(x.newProject={name:"",street:"",city:"",state:"",zip:""}),x})},[]),u=()=>{if(o)return;const f=i.useNewProject?null:i.existingProject;s({project:{id:f?.id,externalId:f?.projectExternalId},email:i.email,digitalTools:i.digitalTools,notes:i.notes,newProject:i.newProject})};(0,d.useEffect)(()=>{r&&t(!0)},[r,t]),(0,d.useEffect)(()=>{a?.message==="Project name must be unique"?n({title:"Project cannot be created",message:"We're sorry! All project names must be unique. Please try creating your project again with a different name, and contact Customer Support if the problem persists or you feel it is in error."}):a&&n({message:"There was an error submitting your request."})},[a,n]);const p=()=>i.useNewProject?!i.newProject.name:!i.existingProject;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Da,{children:[(0,e.jsx)(ka,{children:"Digital Tools Request"}),(0,e.jsx)(pt.A,{onClick:()=>t(!1),children:(0,e.jsx)("img",{src:Oa,alt:"close"})})]}),(0,e.jsx)(Oi,{children:"Project Details"}),(0,e.jsx)(qs,{}),(0,e.jsx)(Mi,{children:(0,e.jsx)(GM,{newProject:i.newProject,shouldCreateNewProject:i.useNewProject,notes:i.notes,updateForm:c})}),(0,e.jsx)(Oi,{children:"Who should we contact with questions and final delivery"}),(0,e.jsx)(qs,{}),(0,e.jsx)(Mi,{children:(0,e.jsx)(YM,{email:i.email,onEmailChange:f=>c("email",f)})}),(0,e.jsx)(Oi,{children:"Digital Tools"}),(0,e.jsx)(qs,{}),(0,e.jsxs)(Mi,{children:[(0,e.jsx)(KM,{digitalTools:i.digitalTools,onDigitalToolsChange:(f,h)=>c("digitalTools",h?[...i.digitalTools,f]:i.digitalTools.filter(b=>b!==f))}),(0,e.jsx)(qs,{}),(0,e.jsxs)(Mi,{style:{paddingRight:"15%",paddingLeft:"15%",alignItems:"center"},children:[(0,e.jsx)(xo,{style:{textAlign:"center",marginBottom:30},children:"Our team will be in touch to confirm final details and pricing before any purchase is made."}),(0,e.jsx)($M,{variant:"contained",onClick:()=>u(),disabled:p(),children:o?(0,e.jsx)(bt.A,{size:"28px",color:"inherit"}):"Submit Request"})]})]})]})},XM=({open:t,closeDrawer:n})=>(0,e.jsx)(Ta,{open:t,closeDrawer:n,children:t?(0,e.jsx)(qM,{closeDrawer:n}):null}),JM=m.p+"2bc7583767ba2e29c06c4cd8f07b5ddc.svg",ZM=m.p+"3d960eddcd0a22733e0176c04155fa75.svg",eL=m.p+"9721d635c0d94a71b0150932c8342bac.svg",tL=m.p+"ee2370aa1c48bb1b86786f70be071cbc.svg",nL=m.p+"a0b23b63f9c6ce8ef652f79dd37256f9.svg",sL=m.p+"bb372ad04210434b98d5cf2070149ce2.svg";var Hs=(t=>(t.SUBMITTED="SUBMITTED",t.IN_PROGRESS="IN_PROGRESS",t.READY_FOR_PURCHASE="READY_FOR_PURCHASE",t.CANCELLED="CANCELLED",t.COMPLETE="COMPLETE",t))(Hs||{});const oL=t=>!t,rL=t=>[{icon:ZM,label:"My Digital Tools",destination:"",disabled:oL(t)},{icon:eL,label:"Drafting",destination:"drafting"},{icon:nL,label:"Build Optimize",destination:"build_optimize"},{icon:JM,label:"Home Configure",destination:"home_configure"},{icon:sL,label:"Render",destination:"render"},{icon:tL,label:"Home Plan Library",destination:"home_plan"}],aL=t=>{const n=t.opportunityName;return n.includes("-")?n.substring(0,n.lastIndexOf("-")):n},iL={[Hs.COMPLETE]:"Complete",[Hs.IN_PROGRESS]:"In Progress",[Hs.CANCELLED]:"Cancelled",[Hs.SUBMITTED]:"Submitted",[Hs.READY_FOR_PURCHASE]:"Ready for Purchase"},zx=()=>{const[t,n]=(0,d.useState)(!1),[s,o]=(0,d.useState)(!1),{createEvent:r}=(0,On.AG)(),a=(0,d.useCallback)(f=>{n(!1),f&&o(!0)},[]),{userHasPermission:i}=(0,Ye.A)(),{company:l}=(0,je.P)(),c=i({tool:D.w5.DIGITAL,action:D.a2.VIEW_DIGITAL_TOOLS,companyId:l?.id,projectId:void 0}),u=rL(c),{canViewPage:p}=(0,$n.s)({tool:D.w5.DIGITAL,action:D.a2.VIEW_DIGITAL_TOOLS,companyId:l?.id,projectId:void 0},[l?.id]);return(0,d.useEffect)(()=>{l&&r({content_type:"company",object_id:l?.id,tool:"digital tools"})},[l]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),p&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(vM,{navLinks:u,pathRoute:`/companies/${l?.id}/digital_tools`}),(0,e.jsxs)(jM,{children:[(0,e.jsx)(VM,{openRequestDrawer:()=>n(!0)}),(0,e.jsx)(AM,{children:(0,e.jsx)(L.Outlet,{})})]}),(0,e.jsx)(XM,{open:t,closeDrawer:a}),(0,e.jsx)(Qn,{open:s,onSubmit:()=>o(!1),title:"Digital Tools Requests",submitText:"Okay",children:(0,e.jsx)("div",{children:"Your Digital Tools request is being processed and can take up to a minute before it appears in your Digital Tools Home Page. Please refresh this page to review your current requests."})})]})]})},lL=(0,g.Ay)(Ge)`
  background-color: rgba(0, 48, 135, 0.6);
  height: 74px;
  align-items: center;
  justify-content: center;
  padding-bottom: 4px;
  box-shadow: 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 2px 2px 0 rgba(0, 0, 0, 0.14),
    0 3px 1px -2px rgba(0, 0, 0, 0.2);
`,dL=(0,g.Ay)(I.A)`
  color: white;
  font-size: 36px;
  font-weight: bold;
`,Vx=({title:t="Coming Soon!"})=>(0,e.jsx)(lL,{children:(0,e.jsx)(dL,{children:t})}),ca=({selectedTool:t})=>{const{requestMarketingContent:n,content:s,loading:o}=nh();return(0,d.useEffect)(()=>{n(t)},[t]),!o&&s==""?(0,e.jsx)(Vx,{}):(0,e.jsx)(oh,{htmlContent:s,overrideStyle:{marginTop:"0px",maraginBottom:"24px",borderRadius:"8px"}})},cL=()=>{const[t,n]=(0,d.useState)(!1),[s,o]=(0,d.useState)(null),[r,a]=(0,d.useState)(!1),[i,l]=(0,d.useState)(""),{user:c}=(0,Pt.A)(),[u]=fo(`receivePurchaseConfirmationEmailPreference_${c?.email}`,{initialState:!0}),{submitOrders:p}=sa(),f=(0,d.useRef)(p);return f.current=p,{purchaseDigitalTool:(0,d.useCallback)(async(b,x,v)=>{try{a(!0),o(!1),n(!1);const y=dn()(),{message:j,orders:A}=await f.current({projectId:Number(b),packIds:[x],deliveryDate:y,poNumber:void 0,comment:void 0,quoteId:v,emailConfirmationPreference:u});if(l(j),A.find(P=>P.packId===x)?.orderId!=="error")n(!0);else throw new Error(j)}catch{o(x)}finally{a(!1)}},[]),success:t,error:s,loading:r,message:i}},uL=({bidPack:t,requestedDate:n,purchasePack:s,purchaseInProgress:o,osrEmail:r,showQuantitySetting:a,showPriceSetting:i})=>{const l=ou(t),c=Ml(t);return(0,e.jsxs)(PM,{children:[(0,e.jsxs)(IM,{children:[(0,e.jsxs)(DM,{children:[(0,e.jsx)(Oi,{children:t.packName}),n&&(0,e.jsx)(xo,{children:`Requested on ${dn()(n).format("M/D/YYYY")}`}),(0,e.jsx)(xo,{children:ni(t.status).text})]}),!!r&&(0,e.jsx)(Wx,{href:`mailto:${r}`,children:"CONTACT SALES REP"})]}),(0,e.jsx)(kM,{children:(0,e.jsx)(mf,{packType:so(t),groupedLineItems:l,singleLineItems:c,mode:Sr.DRAWER,toggleLineItem:()=>{},showQuantitySetting:a,showPriceSetting:i,isLineItemSelected:()=>!1})}),(0,e.jsxs)(TM,{children:[(0,e.jsx)(xo,{children:"Grand Total"}),(0,e.jsx)(xo,{children:(0,Ze.up)(t.totalPrice)})]}),(0,e.jsxs)(RM,{children:[(0,e.jsxs)(MM,{children:["By continuing, you agree to our"," ",(0,e.jsx)(LM,{underline:"none",href:"http://prod-api-mybfs.bldr.com/api/Site/document/file?type=1",target:"_blank",rel:"noreferrer",children:"Terms of Use."})]}),(0,e.jsx)(OM,{onClick:()=>s(t.bidPackId),disabled:o,children:o?(0,e.jsx)(bt.A,{thickness:5,color:"inherit",size:"20px"}):"Submit Order"})]})]})},pL=(t,n)=>{const{data:s,error:o,isLoading:r}=e2({projectId:t,quoteIds:n});return{data:s,error:o,isLoading:r}},mL=({projectId:t,quoteIds:n,projectName:s,closeDrawer:o,opportunity:r})=>{const{company:a}=(0,je.P)(),{showError:i}=(0,Fe.d)(),{data:l,error:c,isLoading:u}=pL(t,n),{purchaseDigitalTool:p,success:f,error:h,loading:b,message:x}=cL(),v=(j,A)=>{p(t,j,Number(A))},y=a?.osrEmail;return(0,d.useEffect)(()=>{f&&o(!0)},[f,o]),(0,d.useEffect)(()=>{if(h&&l){let j="";for(const A of l)for(const w of A.quotePacks)if(w.bidPackId===h){j=w.packName;break}i({message:`We're sorry! We could not order ${j}. Here's what we know: ${x}. Please try again and contact Customer Support if the problem persists.`}),o()}},[h,i,l,x,o]),(0,d.useEffect)(()=>{c&&i({message:"Error fetching digital tool quotes. Please try again and contact Customer Support if the problem persists."})},[c,i]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Da,{children:[(0,e.jsx)(ka,{children:s}),(0,e.jsx)(pt.A,{onClick:()=>o(),children:(0,e.jsx)("img",{src:Oa,alt:"close"})})]}),(0,e.jsxs)(EM,{children:[u&&(0,e.jsx)(os,{}),!u&&l?.flatMap(j=>j.quotePacks.filter(A=>A.hasDigitalTools).map(A=>(0,e.jsx)(uL,{bidPack:A,requestedDate:r?.createDate,purchasePack:w=>v(w,String(j.quoteId)),osrEmail:y,purchaseInProgress:b,showQuantitySetting:j.showQuantity,showPriceSetting:j.showLineItemPricing},A.bidPackId)))]})]})},hL=({projectId:t,projectName:n,open:s,closeDrawer:o,opportunity:r,quoteIds:a})=>(0,e.jsx)(Ta,{open:s,closeDrawer:o,testId:"purchase-drawer",children:s?(0,e.jsx)(mL,{projectId:t,quoteIds:a,projectName:n,closeDrawer:o,opportunity:r}):null}),gL=()=>{const[t,n]=(0,d.useState)(!1),[s,o]=(0,d.useState)([]),[r,a]=(0,d.useState)(""),{company:i}=(0,je.P)(),l=(0,d.useCallback)(async()=>{n(!0),a("");try{const{data:c}=await nt.Ay.get(`/api/companies/${i?.id}/digital_tools`),u=(0,Ze.bn)(c);o(u)}catch{a("Failed to fetch opportunities")}finally{n(!1)}},[]);return{loading:t,opportunities:s,error:r,fetchOpportunities:l}},fL=({opportunity:t,openPurchaseModal:n})=>{const s=(0,L.useNavigate)(),{createDate:o,status:r,digitalTools:a,projectId:i}=t,l=r===Hs.READY_FOR_PURCHASE,{quoteSummary:c,isFetching:u,error:p}=oo(i,!1,!l,!0),{digitalToolPacks:f,digitalToolOrders:h,digitalToolQuoteIds:b}=(0,d.useMemo)(()=>{const j=[],A=[];c?.quotes.forEach(P=>{const C=P.quotePacks.filter(k=>k.containsDigitalTools);C.length>0&&j.push(P.quoteId),C.forEach(k=>A.push(k))});const w=c?.orders.map(P=>P.hasDigitalTools)??[];return{digitalToolPacks:A,digitalToolOrders:w,digitalToolQuoteIds:j}},[c]),x=(0,d.useMemo)(()=>{if(l&&c){const j=f.length>0,A=h.length>0;if(j)return Hs.READY_FOR_PURCHASE;if(!j&&A)return Hs.IN_PROGRESS;if(!j&&!A)return Hs.SUBMITTED}return r},[c,r,l,f,h]),v=iL[x],y=()=>p?null:x===Hs.READY_FOR_PURCHASE?(0,e.jsx)(Fu,{underline:"none",onClick:()=>n(t,b),children:"View and Approve Bid"}):x===Hs.COMPLETE?(0,e.jsx)(Fu,{underline:"none",onClick:()=>t.projectId&&s(`/projects/${t.projectId}/documents`),children:"View Details"}):null;return(0,e.jsxs)(SM,{children:[(0,e.jsx)(vi,{className:"opportunityDateCell",children:dn()(o).format("M/D/YYYY")}),(0,e.jsx)(vi,{className:"projectNameCell",children:aL(t)}),(0,e.jsx)(vi,{className:"digitalToolsCell",children:a.join(", ")}),(0,e.jsx)(vi,{className:"statusCell",children:u?(0,e.jsx)(Mn.A,{variant:"text",sx:{fontSize:14}}):v}),(0,e.jsx)(vi,{className:"nextStepsCell",children:u?(0,e.jsx)(Mn.A,{variant:"text",sx:{fontSize:14}}):y()})]})},xL=t=>t.includes("-")?t.substring(0,t.lastIndexOf("-")):t,yL=(t,n)=>{const s=dn()(t.createDate),o=dn()(n.createDate);return s.isAfter(o)?-1:s.isAfter(o)?0:1},bL=()=>{const{showError:t}=(0,Fe.d)(),n=(0,Pn.wA)(),[s,o]=(0,d.useState)({open:!1,projectId:null,projectName:"",quoteIds:[],opportunity:null}),{company:r}=(0,je.P)(),{loading:a,opportunities:i,error:l,fetchOpportunities:c}=gL(),{canViewPage:u}=(0,$n.s)({tool:D.w5.DIGITAL,action:D.a2.VIEW_DIGITAL_TOOLS,companyId:r?.id,projectId:void 0},[r?.id],`/companies/${r?.id}/digital_tools/drafting`);(0,d.useEffect)(()=>{u&&c()},[c,u]),(0,d.useEffect)(()=>{l&&t({message:l})},[l,t]);const p=(b,x)=>{o({open:!0,projectId:b.projectId,projectName:xL(b.opportunityName),quoteIds:x,opportunity:b})},f=(0,d.useCallback)(async(b=!1)=>{o({open:!1,projectId:null,projectName:"",quoteIds:[],opportunity:null}),b&&(await c(),n(na.util.invalidateTags(["Quotes"])))},[c,n]),h=[{label:"Request Date",field:"opportunityDate"},{label:"Project Name",field:"projectName"},{label:"Digital Tools",field:"digitalTools"},{label:"Status",field:"status"},{label:"Next Steps",field:"nextSteps"}];return i.length===0?(0,e.jsx)(ca,{selectedTool:"empty_status_table"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(wM,{children:(0,e.jsxs)(ra.A,{stickyHeader:!0,"aria-label":"Digital Tools Table",children:[(0,e.jsx)(di.A,{children:(0,e.jsx)(Zn.A,{children:h.map(b=>(0,e.jsx)(CM,{children:b.label},b.label))})}),(0,e.jsx)(li.A,{children:i.sort(yL).map(b=>(0,e.jsx)(fL,{opportunity:b,openPurchaseModal:p},b.opportunityId))})]})}),(0,e.jsx)(hL,{open:s.open,projectId:s.projectId,quoteIds:s.quoteIds,projectName:s.projectName,opportunity:s.opportunity,closeDrawer:f})]})},vL=()=>{const[t,n]=(0,d.useState)(""),[s,o]=(0,d.useState)(!0),[r,a]=(0,d.useState)(null),{company:i}=(0,je.P)();return{fetchBuilderProfileUrl:(0,d.useCallback)(async c=>{try{const{data:u}=await nt.Ay.get(`/companies/${i?.id}/builder_profile/${c}`),p=u.iframe_url;n(p)}catch(u){a(u+"error retrieving builder profile ")}finally{o(!1)}},[]),contentURL:t,loading:s,error:r}},jL={demographics:{title:"Demographics",body:"Company Information"},branding:{title:"Branding",body:"Control your customer's experience to match your distinct company brand. Home Configure links you share or host will use this branding."},locations:{title:"Location",body:"List the locations of your company."}},Bu=({selectedTool:t})=>{const{fetchBuilderProfileUrl:n,contentURL:s,loading:o}=vL();(0,d.useEffect)(()=>{n(t)},[t,n]);const r=jL[t]??{title:"",body:""};return!o&&s==""?(0,e.jsx)(Vx,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qr,{title:r.title,body:r.body}),(0,e.jsx)(jr,{title:"",urlPath:s,dataTestId:`${t}-profile-iframe`,overrideBase:!0,containerStyle:{backgroundColor:"white",borderRadius:8},iframeStyle:{borderWidth:0}})]})},AL=m.p+"1561914f92a5d7c27a3c4d82106e0807.svg",CL=m.p+"b6e914c8d35eaa4407a07460b5a2755e.svg",SL=m.p+"b5705c572a595c0953b75cd4d0cef268.svg",wL=m.p+"9f74482f8f30f7706883ff39da950def.svg",EL=m.p+"907d22e3449ef8f03ceae99e4f86d3a1.svg",PL=m.p+"5b7e356bec6607dda6108b57b0175d2c.svg",IL=m.p+"902740a91b10774737e30803b62866d5.svg",DL=m.p+"8d469967e7462ed731efe2551bb524af.svg",kL=m.p+"b57c63131d89a9b9ddde037350de2234.svg",TL=m.p+"88bacf99a104d1036ccd17039fb187d3.svg",RL=(t,n,s=!1)=>[{label:"Demographics",destination:"demographics",disabled:!1,icon:AL},{label:"Branding",destination:"branding",disabled:!1,icon:CL},{label:"Location",destination:"location",disabled:!1,icon:SL},{label:"Spec Sheets",destination:"spec_sheets",disabled:!t(D.SX.SPEC_SHEETS)||!(0,ct.EL)(n),icon:wL},{label:"Schedule Templates",destination:"schedule_templates",disabled:!t(D.SX.SCHEDULE_TEMPLATE),icon:EL},{label:"QuickBooks Setup",destination:"quickbooks_setup",disabled:!t(D.SX.QUICK_BOOKS),icon:PL},{label:"BFS Account Settings",destination:"settings",disabled:!1,icon:IL},{label:"Cost Codes",destination:"cost_codes",disabled:!t(D.SX.SELF_SERVICE_COST_CODES),icon:DL},{label:"Vendor Management",destination:"vendor_management",disabled:!t(D.SX.USE_VENDOR_MANAGEMENT),icon:kL},{label:"Linked Accounts",destination:"linked_accounts",disabled:!t(D.SX.USE_LINKED_ACCOUNTS)||(0,ct.EL)(n)||!s,icon:TL}];var Kl=(t=>(t.DEMOGRAPHICS="demographics",t.BRANDING="branding",t.LOCATIONS="locations",t))(Kl||{});const OL=(0,g.Ay)(kn)(({theme:t})=>({alignItems:"stretch",gap:"16px",padding:"24px",objectFit:"contain",backgroundColor:"#f8f8f8",height:`calc(100vh - ${t.header.height})`,boxSizing:"border-box"})),$x=()=>{const{isFlagEnabled:t}=(0,ut.u)(),{allRoles:n}=(0,we.Sk)(),{companies:s}=(0,Ye.A)(),{createEvent:o}=(0,On.AG)(),{company:r}=(0,je.P)(),a=(0,d.useMemo)(()=>RL(t,n,(s??[]).length>1),[t,n,s]),{canViewPage:i}=(0,$n.s)({tool:D.w5.PROFILE,action:D.a2.EDIT_PROFILE,companyId:r?.id,projectId:void 0},[r?.id]);return(0,d.useEffect)(()=>{r&&o({content_type:"company",object_id:r?.id,tool:"profile"})},[r]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),i&&(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Ua,{persistKey:"profileSidebar",sidebarContent:(0,e.jsx)(Hi,{items:a.map(l=>({key:l.label,text:l.label,to:l.destination,icon:(0,e.jsx)("img",{src:l.icon,alt:`${l.label} icon`,style:{width:24,height:24}}),disabled:l.disabled}))}),width:"240px",children:(0,e.jsx)(OL,{children:(0,e.jsx)(L.Outlet,{})})})})]})},ML=(0,g.Ay)("div")`
  flex: 1;
  background-color: white;
  padding: 24px;
  border-radius: 8px;
`,LL=()=>{const[t,n]=(0,d.useState)(""),[s,o]=(0,d.useState)(!0),[r,a]=(0,d.useState)(!1),i=(0,d.useCallback)(async l=>{o(!0);try{const c=await nt.Ay.get(`/companies/${l}/builder_id`);n(c.data.builder_id)}catch{a(!0)}finally{o(!1)}},[]);return{builderId:t,loading:s,error:r,getBuilderId:i}},FL=(0,d.lazy)(()=>m.e(986).then(m.t.bind(m,77986,23))),BL=()=>{const{user:t}=(0,Pt.A)(),{company:n,companyLoading:s}=(0,je.P)(),[o,r]=(0,d.useState)(!1),{builderId:a,getBuilderId:i,loading:l}=LL();return(0,d.useEffect)(()=>{const c={module:"SpecSheets",path:window.location.pathname,timestamp:dn()().toISOString()};return window.localStorage.setItem(Mu,JSON.stringify(c)),r(!0),()=>{window.localStorage.removeItem("ModFedRedirect")}},[]),(0,d.useEffect)(()=>{n?.id&&i(n?.id)},[n?.id,i]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ls,{showLoadingScreen:l||s}),(0,e.jsx)(qr,{title:"Spec Sheet Template Manager",body:"Below you can create, edit, and remove Spec Sheet templates."}),(0,e.jsx)(ML,{id:"spec-sheet-container",children:o&&a&&t&&(0,e.jsx)(d.Suspense,{fallback:(0,e.jsx)(os,{}),children:(0,e.jsx)(Kd,{children:(0,e.jsx)(FL,{userEmail:t?.email,builderId:a,optionalRedirect:`${window.location.origin}/spec_sheets`})})})})]})},NL=(0,d.lazy)(()=>m.e(595).then(m.t.bind(m,73595,23)).then(t=>({default:t.Settings})).catch(()=>({default:Es}))),_L=({customerNumber:t,erpSystem:n})=>{const{accessToken:s}=(0,Pt.A)();return!t||!n?(console.error("Cannot render settings without customerNumber and erpSystem"),(0,e.jsx)(Es,{})):(0,e.jsx)(NL,{customerNumber:t,erpSystem:n,accessToken:s,manageUsersMode:"off"})},UL=()=>{const{company:t}=(0,je.P)(),{createEvent:n}=(0,On.AG)(),{appFocus:s}=(0,_t.A)();return(0,d.useEffect)(()=>{s===_t.O.BFS&&n({content_type:null,object_id:null,tool:"settings"})},[]),(0,d.useEffect)(()=>{t&&s===_t.O.BUILDER_TOOLS&&n({content_type:"company",object_id:t.id,tool:"settings"})},[t]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(qr,{title:"Settings",body:"Select from the options below to update your BFS Account Settings."}),(0,e.jsx)(vo,{children:(0,e.jsx)(Yc,{children:(0,e.jsx)(_L,{customerNumber:t?.accountNumber,erpSystem:t?.erpSystem})})})]})},WL={userDataWaiting:!0,emailError:!1,emailRequested:!1,magicLinkExpired:!1,user:void 0},zL=({children:t,initialValue:n=WL})=>{const[s,o]=(0,d.useState)(n.userDataWaiting),[r,a]=(0,d.useState)(n.user),{fetchUserPermissions:i,userPermissions:l,hasPermission:c,permissionsLoading:u,allRoles:p}=(0,we.Sk)(),{fetchCompany:f}=(0,je.P)(),[h,b]=(0,d.useState)(!1),[x,v]=(0,d.useState)(!1),[y,j]=(0,d.useState)(!1),[A,w]=(0,d.useState)(()=>localStorage.getItem(Nn.rw.ACCESS_TOKEN)),P=(0,L.useNavigate)(),C=(0,L.useLocation)(),k=(0,d.useCallback)(z=>{localStorage.setItem(Nn.rw.ACCESS_TOKEN,z.accessToken),localStorage.setItem(Nn.rw.EXPIRES_ON,z.expiresAt.toString()),w(z.accessToken)},[]);(0,d.useEffect)(()=>{const z=new URLSearchParams(C.search),Q=z.get("nonce");if(!Q)return;z.delete("nonce");const re=z.toString(),ue=encodeURIComponent(C.pathname+(re?`?${re}`:""));window.location.replace(`/auth/exchange_nonce?nonce=${encodeURIComponent(Q)}&next=${ue}`)},[C]);const S=(0,d.useCallback)(()=>{const z=localStorage.getItem(Nn.rw.EXPIRES_ON);return z?(parseInt(z,10)*1e3-Date.now())/(60*1e3)<5:!0},[]),R=(0,d.useCallback)(async()=>{const z=await nt.Ay.get("/auth/logout"),{signOutURL:Q}=z.data;localStorage.removeItem(Nn.rw.ACCESS_TOKEN),localStorage.removeItem(Nn.rw.EXPIRES_ON),localStorage.removeItem(jp(Nn.Rh.mostRecentlySelectedCompany)),Ca.datadogLogs.clearUser(),Sa.datadogRum.clearUser(),window.location.href=Q},[]),B=(0,d.useCallback)(async()=>{if(y)return!1;j(!0);try{const{data:{accessToken:z,expiresOn:Q}}=await nt.Ay.post("/auth/refresh_token",{accessToken:A},{withCredentials:!0});return k({accessToken:z,expiresAt:Q}),!0}catch(z){return console.error("Error refreshing token:",z),await R(),!1}finally{j(!1)}},[k,A,y,R]);(0,d.useEffect)(()=>{if(C.pathname.startsWith("/register"))return;(async()=>{if(A&&S()&&!y){v(!0);try{await B()}finally{v(!1)}}else if(!A){o(!1),b(!1);const Q=new URLSearchParams(C.search),re=Q.get("nonce");if(Q.has("loginHint"))return;re||((0,Nn.Fc)(),P("/"))}})()},[A,S,y,B,P,C.search]),(0,d.useEffect)(()=>{if(!h)return;const z=setInterval(async()=>{S()&&!y&&await B()},50*1e3);return()=>clearInterval(z)},[h,S,B,y]);const T=(0,d.useCallback)(async()=>{o(!0);try{const z=localStorage.getItem("from_app")?"true":"false",Q=await nt.Ay.get(`/auth/user?isMobile=${z}`);a(Q.data);const re={id:Q.data?.id,name:Q.data?.name,email:Q.data?.email};return Ca.datadogLogs.setUser(re),Sa.datadogRum.setUser(re),Q.data}catch(z){return console.error("AuthProvider: Error fetching user data. Auth errors should be handled by axiosConf.",z),null}finally{o(!1)}},[]);(0,d.useEffect)(()=>{A&&!r&&!x&&!y&&(async()=>{try{if(S()&&!await B())return;b(!0),await Promise.all([T(),i(),f()])}catch(z){console.error("AuthProvider: Error during initial data aggregation. Auth errors should be handled by axiosConf.",z)}})()},[A,r,s,x,y,T,i,f,S,B]);const W=async()=>await T(),N=async({email:z,phone:Q,name:re})=>(await nt.Ay.put("/auth/update_user",{email:z,phone:Q,name:re}),T());(0,d.useEffect)(()=>{const z=(0,ct.EL)(p);r&&z&&r.company===""&&P("/select_customer")},[r,p,P]);const O={isLoggedIn:h,onSignOut:R,waiting:x||s,userDataWaiting:s,user:r,setUser:a,permissions:l,hasPermission:c,permissionsLoading:u,updateUser:N,refreshUserData:W,setTokenWithExpiry:k,accessToken:A,refreshToken:B,isTokenExpired:S};return(0,e.jsx)(Pt.c.Provider,{value:O,children:t})},VL={MuiBottomNavigation:{styleOverrides:{root:{"& .Mui-disabled":{opacity:.5}}}},MuiBottomNavigationAction:{styleOverrides:{root:{color:"var(--bfs-primary-true-white)","&.Mui-selected":{backgroundColor:"var(--bfs-11-22-nav-selected-gray)",color:"var(--bfs-primary-true-white)"}}}},MuiDialogContent:{styleOverrides:{root:{paddingTop:"37px"}}},MuiButton:{defaultProps:{disableElevation:!0},styleOverrides:{root:({ownerState:t})=>({color:"var(--light-primary-contrast)",fontStretch:"normal",fontStyle:"normal",letterSpacing:"0.46px",lineHeight:1.75,fontWeight:600,backgroundColor:"transparent",fontSize:"1rem",textTransform:"capitalize",...t.size==="small"&&{fontSize:"13px",lineHeight:1.69,fontWeight:500,height:"30px",padding:"8px 12px"},...t.size==="medium"&&{padding:"13px 12px",lineHeight:"1.75",fontSize:"14px",height:"40px"},...t.size==="large"&&{padding:"17px 16px",height:"48px",fontSize:"1rem"},"&:disabled":{color:"var(--light-action-disabled-26-p)"},...t.variant==="text"&&{color:`var(--light-${t.color}-dark)`,"&:hover":{backgroundColor:`var(--light-${t.color}-shades-4-p)`}},...t.variant==="contained"&&{backgroundColor:`var(--light-${t.color}-main)`,"&:hover":{backgroundColor:`var(--light-${t.color}-dark)`},"&:disabled":{backgroundColor:`var(--light-${t.color}-light)`,color:"var(--light-primary-contrast)"}},...t.variant==="outlined"&&{borderColor:`var(--light-${t.color}-shades-50-p)`,color:`var(--light-${t.color}-main)`,"&:hover":{backgroundColor:`var(--light-${t.color}-shades-4-p)`},"&:disabled":{borderColor:"var(--light-action-disabled-background-12-p)"}}})}},MuiGrid:{defaultProps:{spacing:"4px"}},MuiDrawer:{styleOverrides:{root:{width:"60%"}}},MuiDataGrid:{styleOverrides:{root:{fontFamily:"Roboto, acumin-pro",borderRadius:"0px","& .MuiDataGrid-cell":{border:"solid 0.5px var(--datagrid-cell-border)",backgroundColor:"var(--bfs-primary-true-white)"},"& .MuiDataGrid-columnHeader":{backgroundColor:"var(--datagrid-header-background)",border:"solid 0.5px var(--datagrid-header-border)",borderTop:"none"},"& .MuiDataGrid-columnHeaderTitle":{fontWeight:"bold"}}}},MuiInputLabel:{defaultProps:{shrink:!1},styleOverrides:{root:{transition:"opacity 0.2s ease","&.Mui-focused":{opacity:0},"&.MuiFormLabel-filled":{opacity:0}}}},MuiTextField:{styleOverrides:{root:{"& legend":{display:"none"},"& fieldset":{top:0}}}}},$L={common:{black:ke.colors["bfs-primary-true-black"].value,white:ke.colors["bfs-primary-true-white"].value},primary:{main:ke.colors["light-info-main"].value,dark:ke.colors["light-info-dark"].value,light:ke.colors["light-info-light"].value,contrastText:ke.colors["light-info-contrast"].value},info:{main:ke.colors["light-info-main"].value,dark:ke.colors["light-info-dark"].value,light:ke.colors["light-info-light"].value,contrastText:ke.colors["light-info-contrast"].value},secondary:{main:ke.colors["light-secondary-main"].value,dark:ke.colors["light-secondary-dark"].value,light:ke.colors["light-secondary-light"].value,contrastText:ke.colors["light-secondary-contrast"].value},grey:{100:ke.colors["bfs-secondary-support-gray-light"].value,500:ke.colors["bfs-secondary-support-gray-medium"].value,900:ke.colors["bfs-secondary-support-gray-dark"].value},warning:{main:ke.colors["light-warning-main"].value,dark:ke.colors["light-warning-dark"].value,light:ke.colors["light-warning-light"].value,contrastText:ke.colors["light-warning-contrast"].value},error:{main:ke.colors["light-error-main"].value,dark:ke.colors["light-error-dark"].value,light:ke.colors["light-error-light"].value,contrastText:ke.colors["light-error-contrast"].value},success:{main:ke.colors["light-success-main"].value,dark:ke.colors["light-success-dark"].value,light:ke.colors["light-success-light"].value,contrastText:ke.colors["light-success-contrast"].value},graythorneBlue:{100:ke.colors["graythorne-blues-blue-1"].value,200:ke.colors["graythorne-blues-blue-2"].value,500:ke.colors["graythorne-blues-blue-3"].value,600:ke.colors["graythorne-blues-blue-4"].value,800:ke.colors["graythorne-blues-blue-5"].value,900:ke.colors["graythorne-blues-blue-6"].value},graythorneGray:{100:ke.colors["graythorne-grays-gray-1"].value,200:ke.colors["graythorne-grays-gray-2"].value,500:ke.colors["graythorne-grays-gray-3"].value,600:ke.colors["graythorne-grays-gray-4"].value,800:ke.colors["graythorne-grays-gray-5"].value,900:ke.colors["graythorne-grays-gray-6"].value},graythorneGreen:{100:ke.colors["graythorne-greens-green-1"].value,200:ke.colors["graythorne-greens-green-2"].value,500:ke.colors["graythorne-greens-green-3"].value,600:ke.colors["graythorne-greens-green-4"].value,800:ke.colors["graythorne-greens-green-5"].value,900:ke.colors["graythorne-greens-green-6"].value},graythorneRed:{100:ke.colors["graythorne-reds-red-1"].value,200:ke.colors["graythorne-reds-red-2"].value,500:ke.colors["graythorne-reds-red-3"].value,600:ke.colors["graythorne-reds-red-4"].value,800:ke.colors["graythorne-reds-red-5"].value,900:ke.colors["graythorne-reds-red-6"].value},graythorneYellow:{100:ke.colors["graythorne-yellows-yellow-1"].value,200:ke.colors["graythorne-yellows-yellow-2"].value,500:ke.colors["graythorne-yellows-yellow-3"].value,600:ke.colors["graythorne-yellows-yellow-4"].value,800:ke.colors["graythorne-yellows-yellow-5"].value,900:ke.colors["graythorne-yellows-yellow-6"].value}},U9=ke.colors["bfs-primary-builders-blue"].value,ao=({value:t},n,s)=>{let o={fontSize:t.font.size+"px",fontWeight:t.font.weight,fontFamily:t.font.family,fontStretch:t.font.stretch,lineHeight:t.line_height+"px",letterSpacing:(t.letter_spacing||0)+"px",textAlign:t.alignment};return n&&(o["@media (max-width:600px)"]={fontSize:t.font.size*n,lineHeight:t.line_height*n+"px"}),s&&(o["@media (max-width:600px)"]={fontSize:t.font.size*s,lineHeight:t.line_height*s+"px"}),o},HL=ke.text_styles["typography-h1"],QL=ke.text_styles["typography-h2"],GL=ke.text_styles["typography-h3"],KL=ke.text_styles["typography-h4"],YL=ke.text_styles["typography-h5"],qL=ke.text_styles["typography-h6"],XL=ke.text_styles["typography-body-1"],JL=ke.text_styles["typography-body-2"],ZL=ke.text_styles["typography-subtitle-1"],eF=ke.text_styles["typography-subtitle-2"],W9=ke.text_styles["components-alert-title"],z9=ke.text_styles["components-avatar-initials"],V9=ke.text_styles["components-input-text"],$9=ke.text_styles["components-input-label"],H9=ke.text_styles["components-button-large"],Q9=ke.text_styles["components-button-medium"],G9=ke.text_styles["components-button-small"],K9=ke.text_styles["components-table-header"],Y9=ke.text_styles["components-menu-item-dense"],q9=ke.text_styles["components-menu-item"],X9=ke.text_styles["components-list-subheader"],J9=ke.text_styles["components-menu-item-dense"],Z9=ke.text_styles["components-chip"],e7=ke.text_styles["typography-overline"],tF=ke.text_styles["typography-caption"],t7=ke.text_styles["components-badge-label"],n7=ke.text_styles["components-tooltip"],s7=ke.text_styles["components-helper-text"],nF={h1:ao(HL,.8,.6),h2:ao(QL,.8,.6),h3:ao(GL,.8,.6),h4:ao(KL,.8,.6),h5:ao(YL,.7,.5),h6:ao(qL),body1:ao(XL),body2:ao(JL,.9,.8),subtitle1:ao(ZL,.8,.6),subtitle2:ao(eF,.8,.6),caption:ao(tF,.8,.6),button:{color:"rgba(0, 0, 0, 0.87)",fontFamily:"acumin-pro"}},sF=({children:t})=>{const{isAppEmbedded:n}=Os(),s=dm(n),o=(0,d.useMemo)(()=>(0,Ud.A)({typography:nF,components:VL,palette:$L,spacing:[4,8,16,32],header:{height:`${s}px`}}),[s]);return(0,e.jsx)(Wd.A,{theme:o,children:t})},Hx="pubf7fbc09b569014e019ee06371cd6820a",oF="d3298097-6354-4ec6-893c-a1ba76691cc9",rF=window.mybldr_env.REACT_APP_DATADOG_SESSION_REPLAY_SAMPLE_RATE?parseInt(window.mybldr_env.REACT_APP_DATADOG_SESSION_REPLAY_SAMPLE_RATE):0,aF=({children:t})=>((0,d.useEffect)(()=>{window.mybldr_env.REACT_APP_DATADOG_ENV&&(Ca.datadogLogs.init({clientToken:Hx,env:window.mybldr_env.REACT_APP_DATADOG_ENV,site:"datadoghq.com",forwardConsoleLogs:["log","debug","info","warn","error"],sessionSampleRate:100,service:"mybldr-fe"}),Sa.datadogRum.init({applicationId:oF,clientToken:Hx,site:"datadoghq.com",service:"mybldr",env:window.mybldr_env.REACT_APP_DATADOG_ENV,sessionSampleRate:100,sessionReplaySampleRate:rF,trackUserInteractions:!0,trackResources:!0,trackLongTasks:!0,defaultPrivacyLevel:"allow"}))},[]),(0,e.jsx)(e.Fragment,{children:t})),iF=({children:t})=>{const[n,s]=(0,d.useState)([]),[o,r]=(0,d.useState)(!1),[a,i]=(0,d.useState)(!1),[l,c]=(0,d.useState)(null),{isLoggedIn:u}=(0,Pt.A)(),p=(0,d.useCallback)(async()=>{try{r(!0),c(null);const{data:b}=await nt.Ay.get("/api/v2/feature_flags");s(b)}catch(b){c(b)}finally{r(!1),i(!0)}},[]),f=(0,d.useCallback)(b=>n.find(v=>v.name===b)?.enabled??!1,[n]);(0,d.useEffect)(()=>{u&&p()},[p,u]);const h=(0,d.useMemo)(()=>({featureFlags:n,isFlagEnabled:f,error:l,isLoading:o,fetched:a}),[n,f,l,o,a]);return(0,e.jsx)(ut.c.Provider,{value:h,children:t})},lF=jc().create(),dF={ticketCreation:async(t,n,s,o,r,a,i)=>lF.post("https://mybldrjiraapi.azurewebsites.net/create_issue",{summary:t,email:s,description:n,name:o,accountNumber:r,issueType:a,files:i},{headers:{"Content-Type":"multipart/form-data"}})},r7=(0,g.Ay)("div")`
  display: flex;
  justify-content: center;
  flex-direction: column;
  align-items: center;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -45%);
  padding: 36px;
  gap: 24px;
  background: #fff;
  border-radius: 4px;
  box-shadow: 0px 16px 16px 0px rgba(0, 0, 0, 0.25);
  max-width: 429px;
  ${t=>t.theme.header?.height} {
    margin-top: ${t=>t.theme.header?.height};
  }
  @media screen and (max-width: 768px) {
    transform: translate(-50%, -50%);
  }
  @media screen and (max-width: 480px) {
    max-width: 257px;
    transform: translate(-50%, -45%);
  }
`,a7=(0,g.Ay)("div")`
  display: flex;
  align-items: center;
  gap: 48px;
  align-self: stretch;
  flex-direction: row;
  @media screen and (max-width: 480px) {
    flex-direction: column;
    gap: 12px;
  }
`,Pr=(0,g.Ay)("div")`
  color: #333;
  text-align: center;
  font-feature-settings: 'clig' off, 'liga' off;
  font-family: acumin-pro;
  font-size: 18px;
  font-style: normal;
  font-weight: 600;
  line-height: 24px;
`,cF=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 6px;
  align-self: stretch;
`,i7=(0,g.Ay)("div")`
  color: #000;
  font-family: acumin-pro;
  font-size: 14px;
  font-style: normal;
  font-weight: 700;
  line-height: normal;
`,l7=(0,g.Ay)("div")`
  color: #000;
  font-family: acumin-pro;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: normal;
  max-width: 429px;
`,d7=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
  align-self: stretch;
`,c7=(0,g.Ay)("a")`
  color: #3281e6;
  font-family: acumin-pro;
  font-size: 14px;
  font-style: normal;
  font-weight: 400;
  line-height: normal;
`,u7=(0,g.Ay)("img")`
  max-width: 216px;
  display: flex;
  padding: 12px;
  justify-content: center;
  align-items: center;
  gap: 7.787px;
  @media screen and (max-width: 480px) {
    max-width: 240px;
  }
`,p7=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
`,m7=(0,g.Ay)("img")`
  @media screen and (max-width: 480px) {
    max-width: 257px;
  }
`,h7=(0,g.Ay)("div")`
  background-color: transparent;
  border: 1px solid rgba(0, 0, 0, 0.23);
  flex-grow: 1;
  display: flex;
  border-radius: 4;
  color: #716f6f;
  padding: 8px 12px;
  margin-right: 20px;
`,g7={"& fieldset":{border:"1px solid rgba(0,0,0,0.23)",borderRadius:"4px",backgroundColor:"transparent"},flexGrow:1,marginRight:"20px",height:"100%"},f7={cursor:"pointer",height:"20px",color:"red"},x7=(0,g.Ay)(K.A)`
  border: none;
  margin-left: 20px;
  border-radius: 4px;
  background-color: var(--bfs-secondary-support-gray-dark);
  color: white !important;
  font-size: 15px;
  padding: 12px 16px 12px 16px;
  font-weight: 600;
  font-stretch: normal;
  font-style: normal;
  opacity: ${t=>t.disabled?.3:1};
  cursor: ${t=>t.disabled?"not-allowed":"pointer"};
  align-items: center;
  display: flex;
`,y7=(0,g.Ay)("button")`
  background-color: #229920;
  &.Mui-disabled {
    opacity: 0.38 !important;
    background-color: #229920;
  }
  &:hover {
    background-color: #229920;
  }
`,uF=(0,g.Ay)(_n.Ay)`
  color: var(--bfs-primary-true-black);
  flex-direction: row;
  margin-top: 8px;
  justify-content: space-between;
  border: solid 1px #cdd0d1;
  border-radius: 4px;
  background: #f8f8f8;
`,ji=(0,g.Ay)(_.A)({"& .MuiInputBase-multiline":{padding:"8px 12px"},"& .MuiInputBase-input":{padding:"8px 12px"}});var pF=(t=>(t.SUPPORT="support",t.BUG="bug",t.FEATURE_REQUEST="feature-request",t))(pF||{});const Qx=({showForm:t=!1}={showForm:!1})=>{const{company:n}=(0,je.P)(),{user:s}=(0,Pt.A)(),[o,r]=(0,d.useState)(""),[a,i]=(0,d.useState)(""),[l,c]=(0,d.useState)(""),[u,p]=(0,d.useState)(""),[f,h]=(0,d.useState)(""),[b,x]=(0,d.useState)("bug"),[v,y]=(0,d.useState)([]),[j,A]=(0,d.useState)([]),[w,P]=(0,d.useState)(!1),[C,k]=(0,d.useState)(t),{showError:S,showToast:R}=(0,Fe.d)(),B=(0,L.useNavigate)();(0,d.useEffect)(()=>{C&&T()},[C]),(0,Yd.P)(X=>{X.status==="help-center-ticket"&&k(!0)}),(0,d.useEffect)(()=>{c(s?.email||""),p(s?.name||"")},[s]);const T=()=>{r(""),i(""),c(s?.email||""),p(s?.name||""),h(n?.accountNumber?.toString()||""),x("bug"),y([]),A([])},W=[{label:"Issue Report",id:617,checked:!0,type:"bug"},{label:"General Support Request",id:618,checked:!1,type:"support"},{label:"Feature Request",id:619,checked:!1,type:"feature-request"}],N=async(X,G,Y,he,ne,J,pe)=>{if(!X||!G||!Y||!he||!J)return null;try{const Ee=await dF.ticketCreation(X,G,Y,he,ne,J,pe);if(!(Ee.status===201))S({message:"Error - Please try again later"});else{const me=Ee.data,$e=me.issue_key,gt=me.issue_self;k(!1),T(),R({severity:"success",title:"Ticket Created",message:`Ticket ${$e} created successfully. Thank you! We've received your request.`,renderAction:()=>(0,e.jsx)("a",{href:gt,target:"_blank",rel:"noreferrer",style:{color:"blue",border:"1px solid blue"},children:"Review your request here."})})}}catch{S({message:"Ticket Creation Failed"})}},O=X=>{if(X.target&&X.target.files){if(Q(X.target.files[0].name)){const G=Array.from(X.target.files);y(Y=>[...Y,...G])}}else if(Q(X[0].name)){const G=Array.from(X);y(Y=>[...Y,...G])}},z=X=>{y(v.filter(G=>G.name!==X))},Q=X=>!v.filter(G=>G.name===X).length;(0,d.useEffect)(()=>{const X=v.map(G=>G.name);A(X)},[v]);const[re,ue]=(0,d.useState)({issueSummary:"",issueDescription:"",reporterEmail:"",builderName:""}),le=()=>{const X={issueSummary:"",issueDescription:"",reporterEmail:"",builderName:""};return o.trim()||(X.issueSummary="This field is required"),a.trim()||(X.issueDescription="This field is required"),l.trim()||(X.reporterEmail="This field is required"),l.toLowerCase().includes("@myparadigm.com")&&(X.reporterEmail="@myparadigm.com emails are not allowed",R({severity:"error",title:"Internal Email",message:'If you are using an "@myparadigm.com" email, Please submit your help center query via a DTS ticket in Jira.',action:(0,e.jsx)("a",{href:"https://portal.myparadigm.com/",target:"_blank",rel:"noreferrer",style:{color:"blue",border:"1px solid blue"},children:"Help Center"})})),u.trim()||(X.builderName="This field is required"),ue(X),!Object.values(X).some(Boolean)},F=()=>{window.location.pathname==="/help"&&B("/")},V=async()=>{le()&&(P(!0),await N(o,a,l,u,f,b,v),P(!1),F())},ee={bug:`Please ensure the following required information is provided to help our team investigate this bug report:
    -Is this a new problem or when did it start happening? (required)
    -Please include the steps that led to the issue, what you expected to happen, and what actually happened. (required)
    -Please include a screenshot showing the bug or error message. (optional) -Please include a link to the exact project. (required)`,"feature-request":`Please ensure the following required information is provided so our team can consider your feedback:
    -Why would this feature or change be helpful? (required)
    -Where should this feature or change be located in myBLDR? (required) -Company or person providing this feedback, if different from yourself. (optional)
    -Please include a screenshot to indicate what you\u2019d like changed or provide a rough mock-up using \u201CSnipping Tool\u201D. (optional)`}[b]??"Provide a detailed description, steps to replicate, and any other context that may be helpful.";return(0,e.jsx)(Qn,{open:C,title:"Help and feedback center",titleBackgroundColor:"var(--bfs-primary-true-white)",titleColor:"var(--bfs-primary-true-black)",closeButtonColor:"var(--bfs-primary-true-black)",onCancel:()=>{F(),k(!1),T()},onClose:()=>{F(),k(!1),T()},loading:w,onSubmit:()=>{V()},cancelText:"Cancel",submitText:"Submit feedback",footerButtonAlignment:"flex-end",modalWidth:"600px",contentHeight:"846px",dialogContentPadding:"4px 24px 12px 24px",rootStyle:{zIndex:25e3},children:(0,e.jsxs)(cF,{className:"form-content",children:[(0,e.jsxs)(yo,{style:{width:"100%"},children:[(0,e.jsxs)(an,{style:{width:"100%"},children:[(0,e.jsx)(Pr,{style:{alignSelf:"flex-start"},children:"Name"}),(0,e.jsx)(ji,{fullWidth:!0,required:!0,placeholder:"First and Last Name",type:"text",value:u,onChange:X=>p(X.target.value),error:!!re.builderName,helperText:re.builderName})]}),(0,e.jsxs)(an,{style:{width:"100%"},children:[(0,e.jsx)(Pr,{style:{alignSelf:"flex-start"},children:"Email"}),(0,e.jsx)(ji,{fullWidth:!0,required:!0,placeholder:"Example@companyname.com",value:l,type:"email",onChange:X=>c(X.target.value),error:!!re.reporterEmail,helperText:re.reporterEmail})]})]}),(0,e.jsxs)(an,{style:{width:"100%"},children:[(0,e.jsxs)(Pr,{style:{alignSelf:"flex-start"},children:["Account Number"," ",(0,e.jsx)("span",{style:{color:"var(--graythorne-grays-gray-2)"},children:"(Optional)"})]}),(0,e.jsx)(ji,{fullWidth:!0,placeholder:"######",type:"text",value:f||"",onChange:X=>h(X.target.value)})]}),(0,e.jsxs)(an,{style:{width:"100%"},children:[(0,e.jsx)(Pr,{style:{alignSelf:"flex-start"},children:"Issue Type"}),(0,e.jsx)(Gi.A,{"aria-label":"issue-type",name:"issue-type",value:b,onChange:X=>x(X.target.value),children:W.map(X=>(0,e.jsx)(ye.A,{control:(0,e.jsx)(_o.A,{}),label:X.label,value:X.type,disabled:!1,sx:{marginLeft:0}},X.id))})]}),(0,e.jsxs)(an,{style:{width:"100%"},children:[(0,e.jsx)(Pr,{style:{alignSelf:"flex-start"},children:"Issue Summary"}),(0,e.jsx)(ji,{fullWidth:!0,required:!0,placeholder:"Summary",value:o,type:"text",onChange:X=>r(X.target.value),error:!!re.issueSummary,helperText:re.issueSummary})]}),(0,e.jsxs)(an,{style:{width:"100%"},children:[(0,e.jsx)(Pr,{style:{alignSelf:"flex-start"},children:"Description"}),(0,e.jsx)(ji,{fullWidth:!0,required:!0,placeholder:ee,value:a,type:"text",onChange:X=>i(X.target.value),error:!!re.issueDescription,helperText:re.issueDescription,multiline:!0,rows:8})]}),(0,e.jsx)(Tg,{uploadFiles:X=>O(X),showOverlay:!1,enabled:!0,children:(0,e.jsxs)(an,{style:{width:"100%"},children:[(0,e.jsxs)(Pr,{style:{alignSelf:"flex-start"},children:["Attachments"," ",(0,e.jsx)("span",{style:{color:"var(--graythorne-grays-gray-2)"},children:"(Optional)"})]}),(0,e.jsx)(Rg,{hasOverlay:!0,inputOrCard:"input",dragAndDropText:"Drop files to attach, or ",uploadButtonText:"browse",uploadButtonStyle:{color:"var(--bfs-primary-accent-blue)",backgroundColor:"unset",padding:0,"&:hover":{backgroundColor:"unset"}},onClickSelect:X=>{O(X)}})]})}),j.length>0&&(0,e.jsx)(qn.A,{sx:{width:"100%",flexDirection:"row",justifyContent:"space-between",padding:"0"},children:j.map(X=>(0,e.jsxs)(uF,{children:[X," ",(0,e.jsx)(Sd,{onClick:()=>z(X),sx:{padding:0,minWidth:0},children:(0,e.jsx)(Ss.A,{})})]},X))})]})})},Gx=se().createContext({token:"",csrfToken:"",sessionId:""}),mF=()=>se().useContext(Gx);var hF=m(35403);const Kx={token:"",csrfToken:"",sessionId:"",appLink:""};function gF({children:t}){const n=(0,L.useNavigate)(),{isLoggedIn:s,userDataWaiting:o,token:r}=(0,Pt.A)(),{pathname:a}=(0,L.useLocation)(),[i,l]=(0,d.useState)(""),[c,u]=(0,d.useState)(Kx.csrfToken),[p,f]=(0,d.useState)(Kx.sessionId);(0,d.useEffect)(()=>{const b=localStorage.getItem("from_app"),x=localStorage.getItem("paradigmAccessToken");if(!b||!s||o||a==="/force_sign_out")return;const v=(0,hF.t)();f(v.sessionid??"None"),u(v.csrftoken??"None"),l(fF(v.sessionid??"None",x??"None",v.csrftoken??"None")),n("/mobile")},[s,n,o,r,a]);const h={token:r,csrfToken:c,sessionId:p,appLink:i};return(0,e.jsx)(Gx.Provider,{value:h,children:t})}function fF(t,n,s){return`mybldrapp://pauth?sessionid=${t}&token=${n}&csrftoken=${s}`}const xF=({children:t})=>{const[n,s]=(0,d.useState)([]),[o,r]=(0,d.useState)({}),[a,i]=(0,d.useState)(!1),[l,c]=(0,d.useState)(!1),[u,p]=(0,d.useState)(!1),[f,h]=(0,d.useState)(null),[b,x]=(0,d.useState)(""),[v,y]=(0,d.useState)(new Set),{isLoggedIn:j}=(0,Pt.A)(),{projectId:A}=(0,L.useParams)(),w=(0,Pn.wA)(),[P,C]=(0,d.useState)(null),[k,S]=(0,d.useState)(null),R=(0,d.useCallback)(()=>{const V=new Set;for(const X in o){const G=o[X];for(const Y in G){const he=G[Y].assignments;for(const ne of he)V.add(ne.role)}}const $=[we.wy.OSR.toString(),we.wy.BFSComponentDesign.toString(),we.wy.CompanyManager.toString(),we.wy.CompanyCrew.toString(),we.wy.Subs.toString()];let ee="";for(const X of $)if(V.has(X)){ee=X;break}return x(ee),y(V),ee??null},[o,x,y]),B=(0,d.useCallback)(async V=>{try{c(!0);const $=await nt.Ay.get(`/api/projects/${V}/permissions`),ee=(0,Ze.bn)($.data);s(ee)}catch($){h($)}finally{c(!1)}},[]),T=(0,d.useCallback)(async()=>{try{p(!0);const V=await nt.Ay.get("/api/user/permissions"),$=(0,Ze.bn)(V.data);r($)}catch(V){h(V)}finally{p(!1),i(!0)}},[]),W=(0,d.useCallback)(V=>{const{tool:$,action:ee,companyId:X,projectId:G}=V;if(!o[$]||!o[$][ee])return!1;if(o[$][ee].extent==="TABLE"){for(const Y of o[$][ee].assignments){if(Y.role===we.wy.OSR||Y.role===we.wy.BFSComponentDesign||Y.role===we.wy.MarketManager)return!0;if(Y.projectId===null){if(Y.companyId===X)return!0}else if(Y.role===we.wy.Subs){if(Y.companyId===X&&Y.projectId===G)return!0}else if(Y.role===we.wy.Homebuyer&&Y.companyId===X&&Y.projectId===G)return!0}return!1}for(const Y of o[$][ee].assignments)if(Y.companyId===X&&Y.projectId===G)return!0;return!1},[o]),N=V=>{const{tool:$,action:ee,companyId:X,projectId:G}=V;if(!o[$]||!o[$][ee])return"";const Y=[we.wy.Subs,we.wy.CompanyCrew,we.wy.CompanyManager,we.wy.OSR];let he=o[$][ee]?.assignments[0]?.role;for(const ne of o[$][ee].assignments){if(ne.role===we.wy.OSR||ne.role===we.wy.BFSComponentDesign)return ne.role;if(ne.role===we.wy.CompanyManager||ne.role===we.wy.CompanyCrew){if(ne.companyId===X){const J=Y.indexOf(he);he=Y.indexOf(ne.role)>J?ne.role:he}}else if(ne.role===we.wy.Subs&&ne.companyId===X&&ne.projectId===G){const J=Y.indexOf(he);he=Y.indexOf(ne.role)>J?ne.role:he}}return he},{userHasPermission:O,isUserPermissionsLoading:z}=(0,Ye.A)(),Q=O({tool:D.w5.PROJECTS,action:D.a2.CREATE_PROJECT,companyId:P,projectId:void 0}),re=V=>(C(V),Q),ue=O({tool:D.w5.PROJECTS,action:D.a2.EDIT_PROJECT,companyId:P,projectId:A?Number(A):void 0}),le=(V,$)=>(C(V),S($),ue);(0,d.useEffect)(()=>{j&&!z&&(T(),A&&B(A))},[j,T,B,A,z]),(0,d.useEffect)(()=>{R()},[o,l,j,R]);const F={fetchProjectPermissions:B,projectPermissions:n,userPermissions:o,permissionsLoading:l,fetchUserPermissions:T,hasPermission:W,userHasPermission:O,getRoleFromPermissions:N,userHighestRole:b,allRoles:v,canCreateProject:re,canEditProject:le,userPermissionsFetched:a,userPermissionsLoading:u};return(0,e.jsx)(we.KV.Provider,{value:F,children:t})};var yF=m(90972);const bF={project:null,createLoading:!1},vF=({children:t,initialValues:n})=>{(0,yF.A)();const{refetch:s}=(0,Ys.Y)({searchTerm:"",showErrorMessage:!1,shouldRefetch:!1}),o={...bF,...n},{company:r,fetchCompany:a,companyLoading:i}=(0,je.P)(),[l,c]=(0,d.useState)(o.project),[u,p]=(0,d.useState)(!1),[f,h]=(0,d.useState)(o.createLoading),[b,x]=(0,d.useState)(!1),v=(0,L.useParams)(),{isLoggedIn:y}=(0,Pt.A)(),j=async S=>{if(S&&y){const R=`/api/projects/${S}/details`;p(!0);try{const B=await nt.Ay.get(R),{project:T}=B.data,W=(0,Ze.bn)(T);(0,H.isEqual)(W,T)||c(W)}catch(B){console.error("Failed to load project",B)}finally{p(!1)}}},A=(0,d.useCallback)(async(S,R,B=!0)=>{h(B);const T=`/api/companies/${S}/create_project/${encodeURIComponent(R)}`;try{return(await nt.Ay.post(T)).data}catch{console.error("Failed to create project")}finally{B&&s(),h(!1)}},[s]),w=(0,d.useCallback)(async(S,R)=>{const B=`/api/companies/${S}/create_project`;try{const T={name:R.name,address:{street_one:R.street,city:R.city,state:R.state,zip:R.zip},jobId:R.jobId},{data:W}=await nt.Ay.post(B,T);return W.project_id}catch(T){if(console.error("Failed to create project"),T?.response?.status===409)throw new Error("Project name must be unique");return null}},[]),P=()=>{c(null)},C=async(S,R,B,T,W)=>{if(f)return;const N=W??r?.id;if(!S&&R&&A&&N)try{S=(await A(N,R)).id}catch{const z="Unable to create project";console.error(z),T&&T(z);return}B&&S&&B(S,R)};(0,d.useEffect)(()=>{if(v.projectId&&y){const S=+v.projectId;j(S)}},[v.projectId,y]),(0,d.useEffect)(()=>{v.projectId&&y?l?.projectExternalId&&wa(Gs.PROJECT_ID,l.projectExternalId):Ea(Gs.PROJECT_ID)},[v.projectId,y,l?.projectExternalId]),(0,d.useEffect)(()=>{i||!l||l?.companyId===r?.id||a(l?.companyId,!0)},[l,i]);const k={project:l,fetchProject:j,createProjectFromNullId:A,createNewProject:w,clearSelectedProject:P,selectProject:C,setArchivingProject:x,createLoading:f,projectLoading:u,archivingProject:b};return(0,e.jsx)(De.v.Provider,{value:k,children:t})},Yx=()=>({notifyParent:(0,d.useCallback)(n=>{window.parent.postMessage(n,"*")},[])}),jF=({children:t})=>{const{isLoggedIn:n}=(0,Pt.A)(),{notifyParent:s}=Yx(),[o]=(0,L.useSearchParams)(),[r,a]=(0,d.useState)(!1),i=o.get("embedded")?.toLowerCase()==="true",[l,c]=(0,d.useState)(i);(0,d.useEffect)(()=>{!l&&i&&c(i)},[l,i]),(0,d.useEffect)(()=>{n&&l&&s({status:"ready"})},[n,l,s]),Ix();const u=(0,d.useMemo)(()=>({showArchivedProjects:r,setShowArchivedProjects:a,isAppEmbedded:l}),[r,a,l]);return(0,e.jsx)(Up.Provider,{value:u,children:t})},AF=1e3*60*60*1,CF=(0,g.Ay)(K.A)`
  background-color: #ec991e;
  text-transform: none;
  color: rgba(0, 0, 0, 0.6);
  margin-right: 16px;
  height: 40px;
  width: 83px;
  font-weight: 800;
  gap: 8px;
  padding: 1px 1px 0px;

  &:hover {
    background-color: #ed6c02;
  }
`,SF=(0,g.Ay)(up.A)({fontSize:"18px",color:"#ec991e"}),wF=({children:t})=>{const{showRefreshAppToast:n}=(0,Fe.d)(),s=(0,d.useRef)(null),o=()=>{window.location.reload()},r=(0,e.jsx)(CF,{onClick:()=>o(),children:"Refresh"}),a=()=>{s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{o()},AF),n({message:"",title:"There is a new version of myBLDR available! Please refresh your page to use the most current version.",action:r})},i=()=>{sessionStorage.removeItem("selectedProject")};return(0,d.useEffect)(()=>{const l=()=>{i(),a()};return nt.I.addEventListener("app.refreshNeeded",l),()=>{nt.I.removeEventListener("app.refreshNeeded",l)}},[]),(0,e.jsx)(e.Fragment,{children:t})},EF=({children:t})=>{const[n,s]=(0,d.useState)([]),o=(0,Dt.A)(),r=(0,d.useCallback)(v=>{const y={...v,id:Ac()};return s(j=>[...j,y]),y.id},[]),a=(0,d.useCallback)(({message:v,title:y,renderAction:j,onClose:A})=>r({severity:"success",autoTimeout:3e3,message:v,title:y,renderAction:j,onClose:A}),[r]),i=(0,d.useCallback)(({message:v,title:y,action:j,renderAction:A,onClose:w})=>r({severity:"error",message:v,title:y,action:j,renderAction:A,onClose:w}),[r]),l=(0,d.useCallback)((v,y)=>r({severity:"custom",autoTimeout:y?.autoTimeout??void 0,renderContent:()=>(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(bt.A,{size:18,sx:{color:y?.spinnerColor||"white"}}),(0,e.jsx)(I.A,{fontSize:14,color:y?.color||"white",children:v})]}),contentSx:{backgroundColor:y?.backgroundColor||o.palette.grey[900],color:y?.color||"#fff",paddingY:1,paddingX:2},anchorOrigin:{vertical:"bottom",horizontal:"center"}}),[r]),c=(0,d.useCallback)(({message:v,title:y,action:j,onClose:A})=>r({severity:"warning",message:v,autoTimeout:void 0,title:y,action:j,anchorOrigin:{vertical:"top",horizontal:"right"},style:{width:"426px",height:"79px"},isRefreshApp:!0,onClose:A}),[r]),u=(0,d.useCallback)((v,y,j)=>{s(A=>{const w=A.find(P=>P.id===v);return w?.onClose&&w.onClose(y,j),A.filter(P=>P.id!==v)})},[]),p=(0,d.useMemo)(()=>({showToast:r,showSuccess:a,showError:i,showRefreshAppToast:c,showLoadingToast:l,closeToast:u}),[r,a,i,c,l,u]),f=v=>{if(v.isRefreshApp)return{warning:(0,e.jsx)(SF,{})};if(v.severity==="custom")return{info:null}},h=20,b=70,x=10;return(0,e.jsxs)(Fe.$.Provider,{value:p,children:[t,n.map((v,y)=>{const j=(0,e.jsx)(pt.A,{onClick:P=>{P.stopPropagation(),u(v.id)},sx:{alignItems:"flex-start"},children:(0,e.jsx)(co.A,{fontSize:"small"})}),A=(0,e.jsxs)(e.Fragment,{children:[v?.renderAction?.(v.id)??v.action,!v.isRefreshApp&&j]}),w=h+(b+x)*(n.length-1-y);return(0,e.jsx)(kr.A,{open:!0,disableWindowBlurListener:!0,autoHideDuration:v.autoTimeout,onClose:v.isRefreshApp?()=>{}:(P,C)=>u(v.id,P,C),TransitionComponent:ho.A,anchorOrigin:v.anchorOrigin||{horizontal:"center",vertical:"bottom"},style:{bottom:`${w}px`,...v.style},children:(0,e.jsx)(Rs.A,{severity:v.severity!=="custom"?v.severity:void 0,action:A,onClose:P=>u(v.id,P,"alertClose"),iconMapping:f(v),sx:{...v.contentSx,display:"flex",alignItems:"flex-start","& .MuiAlert-icon":{...v.severity==="custom"?{display:"none"}:{alignItems:"flex-start"}},"& .MuiAlert-action":{alignItems:"flex-start",padding:"0 0 0 16px"}},children:v.renderContent?v.renderContent(v.id):(0,e.jsxs)(E.A,{children:[v.title&&(0,e.jsx)(Tr.A,{children:v.title}),(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:v.message||""}})]})})},v.id)})]})};var Nu=m(15816),ts=m(14420),PF=m(12565),Ai=m(32468);const IF=({baseUrl:t}={baseUrl:""})=>async({url:n,method:s,data:o,params:r,headers:a})=>{try{return{data:(await(0,nt.Ay)({url:t+n,method:s,data:o,params:r,headers:a})).data}}catch(i){return{error:i.response?.data}}},Yl=(0,Lo.xP)({reducerPath:"authApi",baseQuery:IF({baseUrl:"/auth"}),endpoints:t=>({getBFSRegistrationStatus:t.mutation({query:n=>({url:"/bfs_registration_status",method:"POST",data:n})}),registerCustomer:t.mutation({query:n=>({url:"/register",method:"POST",data:n})})})}),{useGetBFSRegistrationStatusMutation:DF,useRegisterCustomerMutation:kF}=Yl,ql=(0,Lo.xP)({baseQuery:(0,Zo.S)({baseUrl:"/api/spec-manager"}),reducerPath:"specManager",endpoints:t=>({specPackages:t.query({query:({company:n})=>({url:`/company/${n}/packages`,method:"GET"})})})}),{useSpecPackagesQuery:TF}=ql,RF=(0,Og.U1)({reducer:{materials:Kk,documents:ts.Ay,project:PF.Ay,[ws.Nq.reducerPath]:ws.Nq.reducer,[Nu.Q.reducerPath]:Nu.Q.reducer,[na.reducerPath]:na.reducer,[qi.reducerPath]:qi.reducer,[ll.reducerPath]:ll.reducer,[Me.YH.reducerPath]:Me.YH.reducer,[ql.reducerPath]:ql.reducer,[Di.reducerPath]:Di.reducer,[bi.reducerPath]:bi.reducer,[Ps.w3.reducerPath]:Ps.w3.reducer,[Ra.reducerPath]:Ra.reducer,[Ai.aM.reducerPath]:Ai.aM.reducer,[Yl.reducerPath]:Yl.reducer},middleware:t=>t().concat(ws.Nq.middleware,Nu.Q.middleware,na.middleware,qi.middleware,ll.middleware,bi.middleware,Me.YH.middleware,ql.middleware,Di.middleware,Ps.w3.middleware,Ra.middleware,Ai.aM.middleware,Yl.middleware)}),OF=({projectId:t,enabled:n})=>{const{data:s,error:o,isLoading:r,refetch:a}=a2({projectId:t},{skip:!t||!n});return{transactions:s,error:o,isLoading:r,refetch:a}};var MF=m(33829);const LF={connections:new Map,connect:()=>null,disconnect:()=>{},getConnection:()=>{}},qx=se().createContext(LF),FF=({url:t,onMessage:n,onError:s,onOpen:o,onClose:r,open:a})=>{const{connect:i,disconnect:l,getConnection:c}=(0,d.useContext)(qx),[u]=(0,d.useState)(()=>(0,MF.A)());(0,d.useEffect)(()=>(a?i(t,u):l(t,u),()=>{a&&l(t,u)}),[t,a,i,l,u]);const p=c(t),f=Xl(n),h=Xl(s),b=Xl(o),x=Xl(r);(0,d.useEffect)(()=>{if(!p?.ws)return;const y=p.ws,j=C=>{const k=JSON.parse(C.data);f.current?.(k,y,C)},A=C=>{h.current?.(y,C)},w=C=>{b.current?.(y,C)},P=C=>{x.current?.(y,C)};return y.addEventListener("message",j),y.addEventListener("error",A),y.addEventListener("open",w),y.addEventListener("close",P),()=>{y.removeEventListener("message",j),y.removeEventListener("error",A),y.removeEventListener("open",w),y.removeEventListener("close",P)}},[p?.ws,f,h,b,x]),(0,d.useEffect)(()=>{p?.isOpen&&p.ws&&b.current?.(p.ws,void 0)},[p?.isOpen,p?.ws,b]);const v=(0,d.useCallback)(y=>{p?.isOpen?p.ws.send(JSON.stringify(y)):console.warn("WebSocket is not open. Unable to send message:",y)},[p]);return{ws:p?.ws??null,isOpen:p?.isOpen??!1,sendMessage:v}},Xl=t=>{const n=(0,d.useRef)(t);return n.current=t,n},BF=({children:t})=>{const{projectId:n,quoteId:s}=(0,L.useParams)(),{appFocus:o}=(0,_t.A)(),{project:r}=(0,De.B)(),{pathname:a}=(0,L.useLocation)(),i=(0,Pn.wA)(),{showToast:l,closeToast:c}=(0,Fe.d)(),p=o===_t.O.PROJECT&&!!n,f=(0,d.useRef)(new Set),{transactions:h,refetch:b}=OF({projectId:n??"",enabled:p}),{refreshQuoteSummary:x}=oo(n),v=(0,d.useMemo)(()=>{const R=h??[],B=new Set(R.map(T=>T.quoteId));return Array.from(B)},[h]),y=()=>`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/order-status/`,j=()=>{i(na.util.invalidateTags(["Quotes","QuoteDetails"]))},A=(R,B,T,W)=>{const N=R?.orders?.filter(Q=>Q.orderId!=="success")??[],O=N.length,z=Q=>{W&&Q.preventDefault(),c(T)};if(O===1)return(0,e.jsxs)(e.Fragment,{children:["We're sorry! We could not complete your order. Here's what we know:",R?.message,". Click"," ",(0,e.jsx)(L.Link,{to:W?"":B,onClick:z,children:"here to go to your quote."})]});if(O>1)return(0,e.jsxs)(e.Fragment,{children:["We're sorry! We could not order ",N.length," of your requested packs. Here's what we know: ",R?.message,". Click"," ",(0,e.jsx)(L.Link,{to:W?"":B,onClick:z,children:"here"})," ","to go to your quote."]})},w=R=>{const{quoteId:B,projectId:T,response:W}=R,N=W?.orders.every(Q=>Q.orderId==="success")??!1,O=`/projects/${T}/materials/quote/${B}`,z=!!(0,L.matchPath)(O,a)||!!(0,L.matchPath)(`${O}/*`,a);l(N?{severity:"success",renderContent:Q=>(0,e.jsxs)(e.Fragment,{children:["Your order for ",r?.projectName," has processed successfully. Click"," ",(0,e.jsx)(L.Link,{to:z?"":O,onClick:re=>{z&&(re.preventDefault(),j()),c(Q)},children:"here"})," ","to go to your order and refresh the order details"]}),anchorOrigin:{vertical:"bottom",horizontal:"center"}}:{severity:"error",renderContent:Q=>(0,e.jsx)(e.Fragment,{children:A(W,O,Q,z)}),anchorOrigin:{vertical:"bottom",horizontal:"center"}})},{isOpen:P,sendMessage:C}=FF({url:y(),open:h&&h.length>0,onMessage:R=>{Sk(R)&&w(R.payload)}}),k=(0,d.useCallback)((R,B)=>{C({type:"order_subscribe",payload:{projectId:B,quoteId:R}}),f.current.add(R)},[C]),S=(0,d.useCallback)((R,B)=>{C({type:"order_unsubscribe",payload:{projectId:B,quoteId:R}}),f.current.delete(R)},[C]);return(0,d.useEffect)(()=>{if(!P||!n)return;const R=new Set(v),B=f.current,T=v.filter(N=>!B.has(N)),W=Array.from(B).filter(N=>!R.has(N));T.forEach(N=>{k(N,Number(n))}),W.forEach(N=>{S(N,Number(n))})},[P,v,n,C,k,S]),(0,d.useEffect)(()=>()=>{P&&n&&f.current.forEach(B=>{S(B,Number(n))})},[P,n,S]),(0,e.jsx)(e.Fragment,{children:t})},NF=({children:t})=>{const[n,s]=(0,d.useState)(new Map),o=se().useRef(n);o.current=n;const r=(0,d.useCallback)((c,u)=>{let p=o.current.get(c);if(p)return p.subscribers.has(u)||(p.subscribers.add(u),s(new Map(o.current))),p.ws;const f=new WebSocket(c);p={ws:f,url:c,isOpen:!1,subscribers:new Set([u])},f.onopen=()=>{p.isOpen=!0,s(b=>new Map(b))},f.onclose=()=>{p.isOpen=!1,s(b=>{const x=new Map(b);return x.delete(c),x})},f.onerror=b=>{console.error(`WebSocket error for ${c}:`,b)};const h=new Map(o.current);return h.set(c,p),s(h),f},[]),a=(0,d.useCallback)((c,u)=>{const p=o.current.get(c);p&&(p.subscribers.delete(u),p.subscribers.size===0?((p.ws.readyState===WebSocket.OPEN||p.ws.readyState===WebSocket.CONNECTING)&&p.ws.close(),s(f=>{const h=new Map(f);return h.delete(c),h})):s(new Map(o.current)))},[]),i=(0,d.useCallback)(c=>n.get(c),[n]),l={connections:n,connect:r,disconnect:a,getConnection:i};return(0,e.jsx)(qx.Provider,{value:l,children:t})},_F=()=>(0,e.jsx)(aF,{children:(0,e.jsx)(NF,{children:(0,e.jsx)(EF,{children:(0,e.jsx)(Pn.Kq,{store:RF,children:(0,e.jsx)(wF,{children:(0,e.jsx)(zL,{children:(0,e.jsx)(gF,{children:(0,e.jsx)(jF,{children:(0,e.jsx)(Tb,{children:(0,e.jsx)(xF,{children:(0,e.jsx)(iF,{children:(0,e.jsx)(vF,{children:(0,e.jsx)(BF,{children:(0,e.jsxs)(sF,{children:[(0,e.jsx)(Qx,{}),(0,e.jsx)(L.Outlet,{})]})})})})})})})})})})})})})});class UF extends se().Component{render(){const n=l=>{console.log("Error loading viewer.",l)},s=l=>{console.log("Viewer document loaded.")},o=(l,c)=>{console.log("Error loading viewer document.",c)},r=(l,c)=>{console.log("Loaded viewer model.",c)},a=(l,c)=>{console.log("Error loading viewer model.",c)},i=l=>{console.log("Token requested by the viewer."),nt.Ay.get("/api/viewer_auth").then(c=>{l(c.data.accessToken,c.data.expiresInSeconds),console.log("Token generated for the viewer.")})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{background:`url(${Ke}) no-repeat center center`,backgroundSize:"contain",width:"40px",height:"40px",border:"none",position:"fixed",marginTop:"8px",marginLeft:"8px",padding:0,zIndex:1e4,cursor:"pointer",pointerEvents:"auto"},onClick:this.props.onClose}),(0,e.jsx)(ch,{urn:this.props.derivativeId,onViewerError:n.bind(this),onTokenRequest:i.bind(this),onDocumentLoad:s.bind(this),onDocumentError:o.bind(this),onModelLoad:r.bind(this),onModelError:a.bind(this)})]})}}const WF=()=>{const{planId:t}=(0,L.useParams)(),n=(0,L.useNavigate)(),s=()=>{n(-1)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(kn,{className:"view-model",children:(0,e.jsx)(UF,{derivativeId:t,onClose:s})})]})},zF=()=>{const{projectId:t}=(0,L.useParams)();return(0,e.jsx)(L.Navigate,{to:`/projects/${t}/documents`,replace:!0})};var VF=m(43846),$F=m(88692),Jl=m.n($F);const HF=async(t,n)=>{const s=`/api/plans/${t}/auth?project_id=${n||""}`,o=await nt.Ay.get(s);return{token:o.data.access,collaboration_url:o.data.collaboration_url}};var Zl=m(70551);const QF=(0,Wn.A)("div")`
  display: flex;
  flex-direction: column;
  width: 100%;
`,E7=(0,g.Ay)("div")`
  margin-top: 90px;
`,Xx=t=>{const n=document.querySelector("html");t?n.style.overflow="hidden":n.style.overflow=""},Jx=()=>{const{planId:t,quoteId:n}=(0,L.useParams)(),{project:s}=(0,De.B)(),{files:o}=(0,Zl.e)(s?.id),{files:r}=pi(s?.id,parseInt(n)),a=[...o,...r],[i,l]=(0,d.useState)(""),[c,u]=(0,d.useState)(void 0),{user:p}=(0,Pt.A)(),{width:f}=(0,ef.A)(),{userHasPermission:h,isUserPermissionsLoading:b}=(0,Ye.A)(),x=(0,L.useNavigate)(),v="#pdf-container",y=h({companyId:s?.companyId,projectId:s?.id,tool:D.w5.DOCUMENTS,action:D.a2.MARKUP_FILES});(0,d.useEffect)(()=>{b||!s?.id||!s?.companyId||y||x(`/projects/${s.id}/documents`)},[b,s?.id,s?.companyId]),(0,d.useEffect)(()=>(window.scrollTo({top:0,behavior:"smooth"}),Xx(!0),A().catch(P=>{console.error(`Failed to load PDF ${i}`,P),j()}),()=>{Xx(!1)}));const j=()=>{Jl()&&Jl().unload(v)},A=async()=>{if(!t)return;const P=a.find(C=>C.id.toString()===t);if(P){try{if(Jl()&&!c){const C=await HF(P.uuid,s?.id);await w(P.uuid,C.token,C.collaboration_url)}}catch(C){j(),console.error(`Failed to load plan with id: ${t}`,C)}l(P.displayName||P.plansName)}},w=async(P,C,k)=>{const S=`${window.location.protocol}//${window.location.host}/static/`;j();const R=await Jl().load({container:v,baseUrl:S,serverUrl:k,instant:!0,documentId:P,authPayload:{jwt:C},styleSheets:["/static/frontend/PSPDFKit.css"],enableHistory:!0}),B=(0,e.jsxs)("div",{className:"PSPDFKit-StyledBackButtonDiv","data-testid":"styledBackButtonDiv",children:[(0,e.jsx)(VF.A,{"data-testid":"ArrowBackIosNewIcon",style:{height:"1rem"}}),f>900?(0,e.jsxs)("span",{"data-testid":"StyledAllPlansSpan",className:"PSPDFKit-BackText",children:[" ","Back"]}):(0,e.jsx)(e.Fragment,{})]});R?.setToolbarItems(T=>{const W=a.find(ue=>ue.id.toString()===t);if(!W)return T;const N=document.createElement("div");(0,ae.createRoot)(N).render(B);const z={type:"custom",id:"back-button",node:N,title:"Back Button",className:"PSPDFKit-BackButtonElement",onPress:ue=>{x(-1),j()}},Q=document.createElement("span");Q.innerText=W.displayName||W.plansName;const re={type:"custom",title:"Document Name",node:Q,className:"PSPDFKit-DocumentDisplayName"};return T.splice(0,0,z,re),T.push({type:"responsive-group",mediaQueries:["min-width: 0px"],id:"undo-redo-buttons"}),T.push({type:"undo",responsiveGroup:"undo-redo-buttons"}),T.push({type:"redo",responsiveGroup:"undo-redo-buttons"}),T}),u(R),R.setAnnotationCreatorName(p?.name)};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(kn,{className:"PDF-viewer",children:(0,e.jsx)(QF,{"data-testid":"styled-plans-markup-test",children:(0,e.jsx)("div",{"data-testid":"pspdf-container",id:"pdf-container",style:{width:"100%",height:"100vh"}})})})]})},GF=m.p+"967b2445cbc41f2af2ab06b287271472.png",KF=m.p+"2cf42460bca343bd1e41513eb209952d.png",YF=()=>(0,e.jsxs)(R4,{children:[(0,e.jsxs)(hd,{style:{margin:"225px 0 40px"},children:[(0,e.jsx)("img",{src:GF,alt:"BFS Logo",style:{marginRight:"32px",width:"116px",height:"100px"}}),(0,e.jsx)("img",{src:KF,alt:"BMC Logo",style:{width:"166px",height:"100px"}})]}),(0,e.jsx)(O4,{children:"Your account will be available soon!"}),(0,e.jsx)(M4,{children:"Please ask your OSR for more information about the new myBLDR.com exprience."}),(0,e.jsx)("br",{}),(0,e.jsx)(Bn,{href:"http://MyBFSBuilder.com",children:(0,e.jsx)(K.A,{variant:"contained",color:"primary",size:"medium",children:"Visit MyBFSBuilder.com"})})]}),Zx=()=>{const{planId:t,quoteId:n}=(0,L.useParams)(),{project:s}=(0,De.B)(),{files:o}=(0,Zl.e)(s?.id),{files:r}=pi(s?.id,parseInt(n)),a=[...o,...r],i=(0,L.useNavigate)(),l=a.find(c=>c.id===t);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(_d,{}),l?.streamingUrl&&(0,e.jsx)(Lf,{onClose:()=>{i(-1)},source:l.streamingUrl,planId:t})]})},qF=["documents","configure","build","materials","schedule","budget","crews","profile"];function XF(){const[t,n]=(0,L.useSearchParams)(),s=(0,L.useNavigate)(),{isAppEmbedded:o}=Os(),{notifyParent:r}=Yx(),{refreshUserData:a,onSignOut:i}=(0,Pt.A)(),{fetchCompany:l}=(0,je.P)(),c=(b,x,v)=>!!b&&!!x&&!!v,u=(b,x,v)=>!!b&&!!x&&!!v,p=(b,x)=>!!b&&!!x,f=b=>{const x=b.get("next");let v;return x&&qF.includes(x.toLowerCase())?v=x.toLowerCase():x?.toLowerCase()==="projects"?v="projects":x?v=x:v="documents",v},h=(0,d.useRef)(o);return h.current=o,(0,d.useEffect)(()=>{async function b(){let x;const v=t.get("erpSystem"),y=t.get("erpNumber"),j=t.get("externalProjectId"),A=t.get("orderId"),w=t.get("deliveryId");let P,C;if(c(y,v,j)){const S=encodeURIComponent(j);if(x=encodeURI(`/api/${v}/${y}/project/${S}`),x)try{P=(await nt.Ay.get(x))?.data?.projectId}catch{s("/select_project");return}}else if(u(v,A,w)){const S=encodeURI(`/api/${v}/materials/${A}/${w}`);try{const R=await nt.Ay.get(S);P=R?.data?.projectId,console.log("projectId",P,"response",R)}catch{s("/select_project");return}}else if(p(v,y)&&f(t)==="projects")try{const{data:S}=await nt.Ay.post("/companies/get_or_create_company",{erp_number:y,erp_system:Aa(v)});await l(Number(S)),C=S}catch{console.log("error occured in getting company id"),s("/select_project");return}let k;if(P){await a();const S=f(t);A&&w?k=`/projects/${P}/${S}/deliveries/${w}`:k=`/projects/${P}/${S}`}else C?(await a(),k=`/companies/${C}/projects`):k="/select_project";h.current&&(k+="?embedded=true"),s(k)}b()},[t,s]),(0,e.jsx)(ls,{showLoadingScreen:!0})}const JF=(0,d.lazy)(()=>m.e(439).then(m.t.bind(m,42439,23)).then(t=>({default:t.OrdersDeliveries})).catch(()=>({default:Es}))),ZF=({customerNumber:t,erpSystem:n})=>{const{accessToken:s}=(0,Pt.A)();return!t||!n?(console.error("Cannot render orders without customerNumber and erpSystem"),(0,e.jsx)(Es,{})):(0,e.jsx)(JF,{accessToken:s,customerNumber:t,erpSystem:n})},e5=(0,g.Ay)("div")`
  position: relative;
  top: 62px;
  display: flex;
  flex-direction: column;
  height: 100%;
  flex: 1;

  ${t=>t.theme.breakpoints.up("lg")} {
    top: 80px;
  }
  ${t=>t.theme.breakpoints.up("xl")} {
    top: 111px;
  }
`,t5=t=>t?.status==="navigate",n5=t=>{const[n,s]=(0,d.useState)(""),[o]=(0,L.useSearchParams)(),r=(0,L.useNavigate)(),{appFocus:a}=(0,_t.A)(),{company:i,fetchCompany:l,companyLoading:c}=(0,je.P)(),{createEvent:u}=(0,On.AG)(),{isFlagEnabled:p}=(0,ut.u)(),f=p(D.SX.ORDERS_DELIVERIES_FEDERATED_MODULE),{canViewPage:h}=(0,$n.s)({tool:D.w5.ORDERS,action:D.a2.VIEW_ORDERS,companyId:i?.id,projectId:void 0,permanentlyDisable:i?.erpSystem===An.v.AS400},[i?.id,i?.erpSystem],`/companies/${i?.id}/projects`,void 0,i?[i?.erpSystem]:void 0);(0,d.useEffect)(()=>{i&&a===_t.O.BUILDER_TOOLS&&u({content_type:"company",object_id:i.id,tool:"orders"})},[i]);const b=o.get("externalProjectId");return(0,d.useEffect)(()=>{if(!i){c||l(t.companyId);return}let x=`${An.s[i.erpSystem]}/${i.accountNumber}/jobs/iframed`;b&&(x=`${x}/job-details/${b}`),s(`${x}?redirect=false`)},[t.bidId,t.companyId,i,c,l,b]),(0,d.useEffect)(()=>{const x=v=>{const y=v.data,j=a===_t.O.BFS?"bfs":"companies";t5(y)&&i?.id&&y?.jobId&&r(`/${j}/${i?.id}/statements?externalProjectId=${y?.jobId}`)};return window.addEventListener("message",x),()=>{window.removeEventListener("message",x)}},[i?.id,r,a]),(0,d.useEffect)(()=>{f&&b&&i?.id&&r(`/companies/${i.id}/orders/job-details/${b}`,{replace:!0})},[f,b,i?.id,r]),h?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),f?(0,e.jsx)(kn,{children:(0,e.jsx)(vo,{children:(0,e.jsx)(ZF,{customerNumber:i?.accountNumber,erpSystem:i?.erpSystem})})}):(0,e.jsx)(e5,{children:(0,e.jsx)(jr,{urlPath:n,title:"Orders",dataTestId:"orders-iframe"})})]}):(0,e.jsx)(hn,{})},s5=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  margin-top: 90px;
`,o5=(0,d.lazy)(()=>m.e(200).then(m.t.bind(m,9200,23)).then(t=>({default:t.InvoicesStatements})).catch(()=>({default:Es}))),r5=({customerNumber:t,erpSystem:n})=>{const{accessToken:s}=(0,Pt.A)();return!t||!n?(console.error("Cannot render statements without customerNumber and erpSystem"),(0,e.jsx)(Es,{})):(0,e.jsx)(o5,{accessToken:s,customerNumber:t,erpSystem:n})},a5=()=>{const{company:t}=(0,je.P)(),[n]=(0,L.useSearchParams)(),s=n.get("externalProjectId"),{createEvent:o}=(0,On.AG)(),{appFocus:r}=(0,_t.A)(),{allRoles:a}=(0,we.Sk)(),i=(0,L.useNavigate)(),{isFlagEnabled:l}=(0,ut.u)(),c=l(D.SX.STATEMENTS_FEDERATED_MODULE),{userHasPermission:u,isUserPermissionsLoading:p}=(0,Ye.A)(),{isLoggedIn:f}=(0,Pt.A)(),h=u({tool:D.w5.STATEMENTS,action:D.a2.VIEW_STATEMENTS,companyId:t?.id,projectId:void 0}),b=u({tool:D.w5.STATEMENTS,action:D.a2.VIEW_BFS_INVOICES,companyId:t?.id,projectId:void 0});(0,d.useEffect)(()=>{f&&!h&&!b&&!p&&i("/select_project")},[f,h,b,i,t,p]),(0,d.useEffect)(()=>{t&&r===_t.O.BUILDER_TOOLS&&o({content_type:"company",object_id:t.id,tool:"statements"})},[t]),(0,d.useEffect)(()=>{t&&!(0,ct.EL)(a)&&t?.isPoCustomer&&i(`/companies/${t.id}/projects`)},[t]);const x=()=>{if(!t)return"";let y=`${An.s[t.erpSystem]}/${t.accountNumber}/invoices-statements/iframed`;s&&(y=`${y}/invoices/${s}`);const j=encodeURIComponent(window.location.href);return`${y}?redirect=false&mybldr=true&redirectBackURL=${j}`};(0,d.useEffect)(()=>{s&&t?.id&&c&&i(`/companies/${t.id}/statements/invoices/${s}`,{replace:!0})},[t?.id,s,i,c]),(0,On.Pe)(y=>{if(vg(y)&&y.to==="settings"){const j=y.subpage?`/${encodeURIComponent(y.subpage)}`:"";i(`/companies/${t?.id}/profile/settings${j}`)}});const v=x();return!v||!b&&!h?(0,e.jsx)(hn,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),c?(0,e.jsx)(kn,{children:(0,e.jsx)(vo,{children:(0,e.jsx)(r5,{customerNumber:t?.accountNumber,erpSystem:t?.erpSystem})})}):(0,e.jsx)(s5,{children:(0,e.jsx)(jr,{title:"Statements",urlPath:v,dataTestId:"statements-iframe"})})]})};function i5(){const{appFocus:t}=(0,_t.A)(),[n,s]=(0,d.useState)(!1),[o,r]=(0,d.useState)(""),{company:a}=(0,je.P)(),i=t===_t.O.BFS?"/api/market_manager/catalog":`/companies/${a?.id}/catalog_url`;return{requestCatalog:(0,d.useCallback)(async()=>{try{s(!0);const u=(await nt.Ay.get(i))?.data.catalog_url;r(u)}catch(c){console.error("Error making catalog request",c)}finally{s(!1)}},[i]),catalogURL:o,loading:n}}const ey=()=>{const{requestCatalog:t,catalogURL:n}=i5(),{createEvent:s}=(0,On.AG)(),{company:o}=(0,je.P)(),{appFocus:r}=(0,_t.A)(),{canViewPage:a}=(0,$n.s)();return(0,d.useEffect)(()=>{s({content_type:r===_t.O.BFS?null:"company",object_id:r===_t.O.BFS?null:o?.id,tool:"catalog"})},[]),(0,d.useEffect)(()=>{(r===_t.O.BFS||r===_t.O.BUILDER_TOOLS&&o?.id)&&t()},[t,o?.id,r]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),a&&(0,e.jsx)(kn,{children:(0,e.jsx)(jr,{title:"",urlPath:n,dataTestId:"catalog-iframe",overrideBase:!0})})]})},l5=()=>{const{canViewPage:t}=(0,$n.s)();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),t&&(0,e.jsx)(kn,{children:(0,e.jsxs)(Ag,{children:[(0,e.jsx)("h1",{style:{borderBottom:"3px solid #ccc"},children:"Reports"}),(0,e.jsxs)(jg,{onClick:()=>window.open("https://app.powerbi.com/Redirect?action=OpenApp&appId=8590984a-0f03-49ba-822b-58d159a0d67a"),style:{cursor:"pointer"},children:[(0,e.jsx)("h3",{style:{margin:0,color:"blue"},children:"Power BI Reports"}),(0,e.jsx)("p",{style:{marginBottom:0},children:"Utilize the Power BI reports to get the information you need and bookmark this link for future access."})]})]})})]})};function d5(t){const s=`; ${document.cookie}`.split(`; ${t}=`);if(s.length===2)return s.pop()?.split(";").shift()}const c5=()=>{const{keyId:t}=(0,L.useParams)(),n=d5("sessionid"),s=`mybldrapp://?token=${t}?sessionId=${n}`;return(0,e.jsx)("div",{children:(0,e.jsx)("a",{href:s,children:"Click here to open the app"})})};function u5(){const{appLink:t}=mF();return t&&(window.location.href=t),(0,e.jsx)(os,{})}const p5=(0,d.lazy)(()=>m.e(680).then(m.t.bind(m,14680,23)).then(t=>({default:t.BidDashboard})).catch(()=>({default:Es}))),m5=()=>{const{accessToken:t}=(0,Pt.A)();return(0,e.jsx)(p5,{accessToken:t})},h5=()=>{const{createEvent:t}=(0,io.A)(),{isFlagEnabled:n}=(0,ut.u)(),{canViewPage:s}=(0,$n.s)();return(0,d.useEffect)(()=>{t({content_type:null,object_id:null,tool:"bids"})},[t]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),s&&(0,e.jsx)(kn,{children:n(D.SX.BID_DASHBOARD_FEDERATED_MODULE)?(0,e.jsx)(vo,{children:(0,e.jsx)(m5,{})}):(0,e.jsx)(jr,{title:"Bids",urlPath:"workflows?mybldr=true&redirect=false",dataTestId:"bids-iframe"})})]})},g5=(0,d.lazy)(()=>m.e(516).then(m.t.bind(m,12516,23)).then(t=>({default:t.EmployeeDashboard})).catch(()=>({default:Es}))),f5=()=>{const{accessToken:t}=(0,Pt.A)();return(0,e.jsx)(g5,{accessToken:t})},x5=()=>{const t=(0,L.useNavigate)(),{showError:n}=(0,Fe.d)(),{company:s,fetchCompany:o}=(0,je.P)(),{clearSelectedProject:r}=(0,De.B)(),{createEvent:a}=(0,io.A)(),{isFlagEnabled:i}=(0,ut.u)(),[l,c]=(0,d.useState)(!1),[u]=Ad(),{canViewPage:p}=(0,$n.s)({tool:D.w5.DASHBOARD,action:D.a2.VIEW_BFS_DASHBOARD,companyId:void 0,projectId:void 0});(0,d.useEffect)(()=>{a({content_type:null,object_id:null,tool:D.w5.DASHBOARD})},[a]);const f=async j=>{const A=Aa(j.erpSystem),w=String(j.customerNumber);if(w===s?.accountNumber&&s?.erpSystem===A)return s?.id;const P=await u({erp_number:w,erp_system:A});if("error"in P)throw new Error(P.error?.toString());return r(),await o(Number(P.data)),P.data},h=async j=>{c(!0);try{const A=await f(j),{jobId:w}=j;t(`/companies/${A}/statements?externalProjectId=${w}`)}catch{n({message:"Unable to navigate to Statements"}),c(!1)}},b=async j=>{c(!0);try{const A=await f(j),{jobId:w}=j;t(`/companies/${A}/orders?externalProjectId=${w}`)}catch(A){console.log("error",A),n({message:"Unable to navigate to Job Details"}),c(!1)}},x=j=>{switch(j.to){case"invoices":h(j);break;case"job-details":b(j);break;default:break}},v=async j=>{try{const A=await f(j);t(`/companies/${A}/projects`)}catch{n({message:"Unable to activate customer"})}};(0,On.Pe)(j=>{vg(j)?x(j):bg(j)&&v(j)});const y=(0,d.useMemo)(()=>s?`${An.s[s.erpSystem]}/${s.accountNumber}/employee-dashboard/iframed?mybldr=true&redirect=false`:"",[s]);return p?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),i(D.SX.EMPLOYEE_DASHBOARD_FEDERATED_MODULE)?(0,e.jsx)(kn,{children:(0,e.jsx)(vo,{children:l?(0,e.jsx)(os,{}):(0,e.jsx)(f5,{})})}):(0,e.jsx)(kn,{children:(0,e.jsx)(jr,{title:"BFS Dashboard",urlPath:y,dataTestId:"bfs-dashboard-iframe"})})]}):(0,e.jsx)(hn,{})},y5=(0,g.Ay)(kn)`
  align-items: center;
  justify-content: center;
`,b5=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  border-radius: 4px;
  overflow: hidden;
  background-color: black;
  box-shadow: 4px 4px 8px rgba(0, 0, 0, 0.25);
`,v5=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 24px;
  background-color: black;
`,ty=(0,g.Ay)(I.A)`
  font-family: 'Roboto';
  color: white;
  line-height: normal;
`,j5=(0,g.Ay)(ty)`
  font-size: 24px;
  font-weight: 700;
`,A5=(0,g.Ay)(ty)`
  font-size: 16px;
  font-weight: 400;
`,C5=(0,g.Ay)(K.A)`
  background-color: var(--light-primary-main);
  color: white;
  font-family: 'Roboto';
  font-size: 14px;
  line-height: 1;
  margin-top: 24px;

  &:hover {
    background-color: var(--light-primary-dark);
  }
`,S5=m.p+"684d6be187ddfa885d6ef3f3f0da19e5.jpg",w5=({title:t,subTitle:n,actionConfig:s})=>{const o=(0,L.useNavigate)(),{allRoles:r}=(0,we.Sk)(),{company:a}=(0,je.P)(),i=(0,L.useLocation)().pathname,{project:l}=(0,De.B)(),c={visible:!1,text:"",disabled:!0},u=s?{...c,...s({navigate:o,project:l,company:a,path:i,allRoles:r})}:c;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(y5,{children:(0,e.jsxs)(b5,{children:[(0,e.jsx)("img",{src:S5,alt:"Coming Soon"}),(0,e.jsxs)(v5,{children:[(0,e.jsx)(j5,{children:t}),n&&(0,e.jsx)(A5,{children:n}),u.visible&&(0,e.jsx)(C5,{disabled:u.disabled,onClick:()=>{u.onClick&&u.onClick()},children:u.text})]})]})})]})},E5=({children:t,erp:n,comingSoonProps:s,featureFlag:o})=>{const{company:r}=(0,je.P)(),{isFlagEnabled:a}=(0,ut.u)(),i=a(o),l=r?.erpSystem.toLowerCase()===n.trim().toLowerCase();return l&&!o||o&&i&&l?(0,e.jsx)(w5,{...s}):(0,e.jsx)(e.Fragment,{children:t})},P5=(t,n,s,o)=>()=>(0,e.jsx)(E5,{erp:n,featureFlag:o||"",comingSoonProps:s,children:(0,e.jsx)(t,{})}),I5=()=>{const{isLoggedIn:t,onSignOut:n,userDataWaiting:s}=(0,Pt.A)(),[o,r]=(0,d.useState)(!1),[a]=(0,L.useSearchParams)(),i=(0,L.useNavigate)(),l=a.get("from_app"),c=a.get("app_version");return(0,d.useEffect)(()=>{l&&(localStorage.setItem("from_app","true"),localStorage.setItem("using_app_V2",c?"true":"false"))},[l,c]),(0,d.useEffect)(()=>{s||o||(r(!0),t?n?.():i("/"))},[o,s,n,t,i]),(0,e.jsx)(os,{})},D5=({children:t,headerText:n})=>(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(E.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundImage:`url(${Rx})`,backgroundRepeat:"repeat-y",backgroundSize:"cover",backgroundPosition:"center top","@media (max-width: 600px)":{padding:"2rem",boxSizing:"border-box",alignItems:"flex-start"}},children:(0,e.jsxs)(E.A,{sx:{padding:"30px 60px",minWidth:"200px",marginBottom:"40px",borderRadius:"10px",background:"#fff",boxShadow:"5px 5px 20px rgba(0,0,0,.4)","@media (max-width: 600px)":{marginTop:"90px"}},children:[(0,e.jsx)(I.A,{sx:{fontSize:"2rem",marginBottom:".5rem",fontWeight:500,lineHeight:1.2,marginTop:0,textAlign:"center","@media (max-width: 600px)":{fontSize:"1.5rem"}},children:n}),t]})})}),k5=()=>(0,e.jsx)(D5,{headerText:"Authentication in progress"}),T5=()=>{const[t,n]=(0,d.useState)(!0),[s,o]=(0,d.useState)(null),r=(0,L.useNavigate)(),a=(0,L.useLocation)(),{setTokenWithExpiry:i}=(0,Pt.A)();return(0,d.useEffect)(()=>{(async()=>{try{const c=new URLSearchParams(a.search),u=c.get("access_token"),p=c.get("expires_on"),f=c.get("next"),h=sessionStorage.getItem(Nn.qm.PATH_TO_RETURN_TO);if(sessionStorage.removeItem(Nn.qm.PATH_TO_RETURN_TO),!u||!p)throw new Error("Missing token parameters in redirect URL");const b=Number(p);await i({accessToken:u,expiresAt:b});const x=decodeURIComponent(f??h??"/");r(x,{replace:!0})}catch(c){console.error("ParadigmAuthRedirect error:",c),o(c?.message??"Unknown error")}finally{n(!1)}})()},[a.search,r,i]),t?(0,e.jsx)(k5,{}):s?(0,e.jsxs)("div",{children:["Authentication Error: ",s]}):null},R5=()=>{const t=(0,L.useNavigate)(),[n]=(0,L.useSearchParams)(),s=n.get("projectId"),o=n.get("quoteId"),r=n.get("loginHint"),a=n.get("inviteUrl"),{isLoggedIn:i,userDataWaiting:l}=(0,Pt.A)(),[c]=DF();return(0,d.useEffect)(()=>{if(!s){console.error("Project ID is required for QuoteShareLanding"),t("/",{replace:!0});return}if(l)return;const u=o?`/projects/${s}/materials/quote/${o}`:`/projects/${s}/materials`,p=()=>{sessionStorage.setItem(Nn.qm.PATH_TO_RETURN_TO,u),t("/",{replace:!0})};if(i){t(u,{replace:!0});return}else if(!r){p();return}c({email:r}).unwrap().then(f=>{if(f.registered||!f.existsInMyBLDR)p();else{sessionStorage.setItem(Nn.qm.LOGIN_HINT,r);const h=encodeURIComponent(document.location.origin+u),b=`${a}&returnUrl=${h}`;window.location.href=b}}).catch(f=>{console.error("Error checking BFS registration status:",f),t("/",{replace:!0})})},[i,l,s,r,o,t,c,a]),(0,e.jsx)("div",{children:"Loading..."})};var ny=m(30995);const O5=m.p+"5b3278f7d74dbd5716fa605a44afda93.jpg",M5=m.p+"65f8c3ce5a339f56e45409a27945318e.jpg",L5={display:"block",marginBottom:"6px",fontSize:13,fontWeight:500},ua={borderRadius:"6px"},Ci=({children:t})=>(0,e.jsx)(I.A,{component:"label",sx:L5,children:t}),F5=({error:t,onSupportClick:n})=>{switch(t.code){case"bfs_account_exists":return(0,e.jsxs)(I.A,{children:["This email has already been registered. Please log in"," ",(0,e.jsx)(Rn.A,{href:"/login",underline:"hover",children:"here"}),"."]});case"registration_failed_with_no_manager":return(0,e.jsxs)(I.A,{children:["You currently do not have the required permissions to register. Contact"," ",(0,e.jsx)(Rn.A,{onClick:n,href:"#",underline:"hover",children:"customer support"})," ","to request access or log in"," ",(0,e.jsx)(Rn.A,{href:"/login",underline:"hover",children:"here"}),"."]});case"registration_failed_with_manager":return(0,e.jsxs)(I.A,{children:["You currently do not have the required permissions to register. You can log in"," ",(0,e.jsx)(Rn.A,{href:"/login",underline:"hover",children:"here"}),", or contact your company manager to request access."]});default:return(0,e.jsx)(e.Fragment,{children:t.message})}},B5=()=>{const[t,{isLoading:n,isSuccess:s,error:o}]=kF(),[r,a]=(0,d.useState)(!1),l=new URLSearchParams(window.location.search).get("email")||"",c=(0,Ds.Wx)({initialValues:{firstName:"",lastName:"",email:l,customerNumber:"",invoiceNumber:"",invoiceAmount:"",acceptedTerms:!1},validate:f=>{const h={};return Object.entries(f).forEach(([b,x])=>{b==="acceptedTerms"?x||(h[b]="Please accept the terms."):x||(h[b]="Required")}),h},onSubmit:f=>{t(f)}}),u=c.isValid&&c.dirty,p=f=>{f.preventDefault(),postMessage({status:"help-center-ticket"})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(E.A,{sx:{position:"relative",height:"100vh"},children:[(0,e.jsx)(Ox,{}),(0,e.jsx)(E.A,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"48px",boxSizing:"border-box",zIndex:1},children:(0,e.jsx)(E.A,{className:"container","data-testid":"register-form",children:(0,e.jsx)(E.A,{className:"frame",sx:{width:500,minHeight:720,height:"auto",maxHeight:"calc(100vh - 128px)",overflowY:"auto",borderRadius:"8px",border:"1px solid #e0e0e0",backgroundColor:"#fff"},children:(0,e.jsx)(E.A,{className:"form-frame",sx:{alignItems:"stretch",maxWidth:"none",width:"100%",p:"32px",backgroundColor:"transparent",boxShadow:"none",borderRadius:0},children:(0,e.jsxs)("form",{onSubmit:c.handleSubmit,style:{display:"flex",flexDirection:"column",gap:20,width:"100%"},children:[(0,e.jsx)(E.A,{sx:{mb:0,display:"flex",justifyContent:"flex-start",width:"100%"},children:(0,e.jsx)("img",{alt:"Builders FirstSource logo",src:Dx,style:{height:24,display:"block",width:"auto",padding:0,margin:0,gap:0,justifyContent:"flex-start",alignItems:"flex-start"}})}),s?(0,e.jsx)(Rs.A,{severity:"success",variant:"outlined",sx:{alignItems:"flex-start",whiteSpace:"normal",wordBreak:"break-word",marginBottom:0,marginTop:0},children:"Registration successful! Please check your email to continue."}):o?(0,e.jsx)(Rs.A,{severity:"error",variant:"outlined",role:"alert",sx:{alignItems:"flex-start",whiteSpace:"normal",wordBreak:"break-word",marginBottom:0,marginTop:0},children:"code"in o&&"message"in o?(0,e.jsx)(F5,{onSupportClick:p,error:o}):"Something went wrong"}):(0,e.jsx)(I.A,{component:"h1",sx:{margin:0,marginLeft:"-3px",fontSize:20,fontWeight:600},children:"New Customer Registration"}),(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,e.jsx)(I.A,{component:"h2",variant:"h6",sx:{margin:0,fontSize:16,fontWeight:600,marginLeft:"-2px",paddingBottom:"4px"},children:"Account Details"}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(Ci,{children:"Full Name"}),(0,e.jsxs)(ny.A,{direction:"row",spacing:"12px",children:[(0,e.jsx)(_.A,{placeholder:"First Name",name:"firstName",value:c.values.firstName,onChange:c.handleChange,fullWidth:!0,size:"small",sx:ua,disabled:n||s}),(0,e.jsx)(_.A,{placeholder:"Last Name",name:"lastName",value:c.values.lastName,onChange:c.handleChange,fullWidth:!0,size:"small",sx:ua,disabled:n||s})]})]}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(Ci,{children:"Email"}),(0,e.jsx)(_.A,{placeholder:"example@email.com",type:"email",name:"email",value:c.values.email,onChange:c.handleChange,fullWidth:!0,size:"small",sx:ua,disabled:n||s})]})]}),(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"6px",mt:"0px"},children:[(0,e.jsx)(I.A,{component:"h2",variant:"h6",sx:{margin:0,fontSize:16,fontWeight:600,marginLeft:"4px",paddingBottom:"0"},children:"Customer Verification"}),(0,e.jsxs)(E.A,{sx:{margin:0,fontSize:12,color:"#666",marginBottom:"3px",lineHeight:1.6},children:[(0,e.jsxs)(I.A,{component:"span",sx:{fontSize:12,color:"#666",display:"block",marginBottom:"2px"},children:["Please provide the following information from an invoice issued within the last 6 months. Click",(0,e.jsx)(Rn.A,{onClick:f=>{f.preventDefault(),a(!0)},href:"#",underline:"hover",sx:{fontSize:12,cursor:"pointer"},children:" here "}),"to see an example."]}),(0,e.jsxs)(I.A,{component:"span",sx:{fontSize:12,color:"#666"},children:["Don't have this information? Click"," ",(0,e.jsx)(Rn.A,{onClick:p,href:"#",underline:"hover",sx:{fontSize:12},children:"here"})," ","to contact customer support."]})]}),(0,e.jsxs)(ny.A,{direction:"row",spacing:"12px",children:[(0,e.jsxs)(E.A,{sx:{flex:1},children:[(0,e.jsx)(Ci,{children:"Customer Number"}),(0,e.jsx)(_.A,{placeholder:"######",name:"customerNumber",value:c.values.customerNumber,onChange:c.handleChange,fullWidth:!0,size:"small",sx:ua,disabled:n||s})]}),(0,e.jsxs)(E.A,{sx:{flex:1},children:[(0,e.jsx)(Ci,{children:"Invoice Number"}),(0,e.jsx)(_.A,{placeholder:"######",name:"invoiceNumber",value:c.values.invoiceNumber,onChange:c.handleChange,fullWidth:!0,size:"small",sx:ua,disabled:n||s})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(Ci,{children:"Invoice Amount"}),(0,e.jsx)(_.A,{placeholder:"0.00",name:"invoiceAmount",value:c.values.invoiceAmount,onChange:c.handleChange,fullWidth:!0,size:"small",InputProps:{inputComponent:Kh,startAdornment:(0,e.jsx)(Ks.A,{position:"start",children:"$"})},sx:ua,disabled:n||s})]})]}),(0,e.jsx)(E.A,{sx:{mt:"-6px",mb:.5,display:"flex",justifyContent:"center"},children:(0,e.jsx)(ye.A,{control:(0,e.jsx)(ve.A,{name:"acceptedTerms",checked:c.values.acceptedTerms,onChange:c.handleChange,size:"small",disabled:n||s}),label:(0,e.jsxs)(I.A,{fontSize:"12px",lineHeight:"16px",color:"text.tertiary",children:["I agree to the"," ",(0,e.jsx)(Rn.A,{underline:"always",color:"text.secondary",href:kx,target:"_blank",rel:"noopener noreferrer",children:"Terms of Service"})," ","and"," ",(0,e.jsx)(Rn.A,{underline:"always",color:"text.secondary",href:Tx,target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"}),"."]})})}),!s&&(0,e.jsxs)(E.A,{sx:{display:"flex",gap:"8px",justifyContent:"flex-end",mt:"-8px",mb:"8px"},children:[(0,e.jsx)(K.A,{variant:"outlined",onClick:()=>history.back(),size:"medium",sx:{borderRadius:"4px",textTransform:"none",fontSize:14,fontWeight:500,backgroundColor:"#FFFFFF",borderColor:"#B3B5B6",color:"#000000",padding:"8px 12px",width:"67px",height:"36px","&:hover":{backgroundColor:"#F5F5F5",borderColor:"#B3B5B6"}},children:"Cancel"}),(0,e.jsx)(K.A,{variant:"contained",type:"submit",disabled:!u||n,size:"medium",sx:{borderRadius:"4px",textTransform:"none",fontSize:14,fontWeight:500,backgroundColor:"#1976d2",padding:"8px 12px",width:"81px",height:"36px","&:hover":{backgroundColor:"#1565c0"}},children:"Register"})]})]})})})})})]}),(0,e.jsxs)(Ms.A,{open:r,onClose:()=>a(!1),maxWidth:"md",fullWidth:!0,children:[(0,e.jsxs)(tr.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,e.jsx)(I.A,{variant:"h6",component:"div",children:"Your invoice should look similar to one of these formats."}),(0,e.jsx)(pt.A,{edge:"end",color:"inherit",onClick:()=>a(!1),"aria-label":"close",children:(0,e.jsx)(co.A,{})})]}),(0,e.jsxs)(nr.A,{children:[(0,e.jsx)(I.A,{variant:"subtitle1",sx:{mb:2},children:"Example 1"}),(0,e.jsx)(E.A,{sx:{textAlign:"center",mb:3},children:(0,e.jsx)("img",{src:O5,alt:"Invoice example 1",style:{maxWidth:"100%",height:"auto"}})}),(0,e.jsx)(I.A,{variant:"subtitle1",sx:{mb:2},children:"Example 2"}),(0,e.jsx)(E.A,{sx:{textAlign:"center"},children:(0,e.jsx)("img",{src:M5,alt:"Invoice example 2",style:{maxWidth:"100%",height:"auto"}})})]})]})]})},N5=()=>{const[t,n]=(0,d.useState)(null),[s,o]=(0,d.useState)("Disconnected"),[r,a]=(0,d.useState)([]),[i,l]=(0,d.useState)(""),c=(0,d.useRef)(null),u=()=>{c.current?.scrollIntoView({behavior:"smooth"})};(0,d.useEffect)(()=>{u()},[r]);const p=()=>{const j=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws/order-status/`,A=new WebSocket(j);A.onopen=()=>{o("Connected"),console.log("WebSocket connected")},A.onmessage=w=>{const P=JSON.parse(w.data);a(C=>[...C,P]),console.log("Message received:",P)},A.onclose=()=>{o("Disconnected"),console.log("WebSocket disconnected")},A.onerror=w=>{o("Error"),console.error("WebSocket error:",w)},n(A)},f=()=>{t&&(t.close(),n(null))},h=()=>{t&&t.readyState===WebSocket.OPEN&&i.trim()&&(t.send(JSON.stringify({message:i})),l(""))},b=y=>{y.key==="Enter"&&h()},x=()=>{switch(s){case"Connected":return"green";case"Disconnected":return"red";case"Error":return"orange";default:return"gray"}},v=y=>{switch(y){case"connection_established":return"#007bff";case"order_update":return"#28a745";case"echo":return"#6c757d";case"error":return"#dc3545";default:return"#343a40"}};return(0,e.jsxs)("div",{style:{maxWidth:"800px",margin:"20px auto",padding:"20px",border:"1px solid #ddd",borderRadius:"8px",fontFamily:"Arial, sans-serif"},children:[(0,e.jsx)("h2",{children:"Order Status WebSocket POC"}),(0,e.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[(0,e.jsx)("span",{style:{marginRight:"10px"},children:"Status:"}),(0,e.jsx)("span",{style:{color:x(),fontWeight:"bold",padding:"4px 8px",borderRadius:"4px",backgroundColor:s==="Connected"?"#d4edda":"#f8d7da"},children:s})]}),(0,e.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,e.jsx)("button",{onClick:p,disabled:s==="Connected",style:{padding:"8px 16px",backgroundColor:s==="Connected"?"#6c757d":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:s==="Connected"?"not-allowed":"pointer"},children:"Connect"}),(0,e.jsx)("button",{onClick:f,disabled:s!=="Connected",style:{padding:"8px 16px",backgroundColor:s!=="Connected"?"#6c757d":"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:s!=="Connected"?"not-allowed":"pointer"},children:"Disconnect"})]})]}),(0,e.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,e.jsx)("h3",{children:"Send Test Message"}),(0,e.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,e.jsx)("input",{type:"text",value:i,onChange:y=>l(y.target.value),onKeyPress:b,placeholder:"Type a message...",disabled:s!=="Connected",style:{flex:1,padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}}),(0,e.jsx)("button",{onClick:h,disabled:s!=="Connected"||!i.trim(),style:{padding:"8px 16px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:s!=="Connected"?"not-allowed":"pointer"},children:"Send"})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("h3",{children:["Messages (",r.length,")"]}),(0,e.jsxs)("div",{style:{height:"400px",overflowY:"auto",border:"1px solid #ddd",padding:"10px",borderRadius:"4px",backgroundColor:"#f8f9fa"},children:[r.length===0?(0,e.jsx)("p",{style:{color:"#6c757d",fontStyle:"italic"},children:"No messages yet. Connect to see real-time updates."}):r.map((y,j)=>(0,e.jsxs)("div",{style:{marginBottom:"10px",padding:"8px",backgroundColor:"white",borderLeft:`4px solid ${v(y.type)}`,borderRadius:"4px"},children:[(0,e.jsxs)("div",{style:{fontSize:"12px",color:"#6c757d",marginBottom:"4px"},children:[new Date().toLocaleTimeString()," - Type: ",y.type,y.order_id&&` - Order: ${y.order_id}`,y.status&&` - Status: ${y.status}`]}),(0,e.jsx)("div",{children:y.message})]},j)),(0,e.jsx)("div",{ref:c})]})]}),(0,e.jsxs)("div",{style:{marginTop:"20px",fontSize:"14px",color:"#6c757d"},children:[(0,e.jsx)("h4",{children:"Instructions:"}),(0,e.jsxs)("ol",{children:[(0,e.jsx)("li",{children:'Click "Connect" to establish WebSocket connection'}),(0,e.jsx)("li",{children:"Send test messages using the input field"}),(0,e.jsxs)("li",{children:["Run the simulation script: ",(0,e.jsx)("code",{children:"python simulate_events.py"})]}),(0,e.jsx)("li",{children:"Watch for real-time SAP order updates in the messages area"})]})]})]})},sy=[{path:":projectId/plans",component:zF},{path:":projectId/documents/:planId/:quoteId?",component:Jx},{path:":projectId/materials/quote/:quoteId/document/:planId",component:Jx},{path:":projectId/documents/viewmodel/:planId/:quoteId?",component:WF},{path:":projectId/configure",component:dh},{path:":projectId/video/:planId/:quoteId?",component:Zx},{path:":projectId/materials/quote/:quoteId/document/video/:planId",component:Zx},{path:":projectId/preview",component:dh},{path:":projectId/build",component:bS},{path:":projectId/schedule",component:Wh},{path:":projectId/budget/*",component:P5(uD,An.v.AS400,{title:"Budget is coming soon!",subTitle:"Thank you for your patience as we finish building this feature.",actionConfig:({project:t,navigate:n,allRoles:s})=>({text:"Pay BFS Invoices Here",disabled:!1,visible:(0,ct.pX)(s,[we.wy.OSR,we.wy.BFSComponentDesign,we.wy.CompanyManager]),onClick:()=>{s&&(0,ct.EL)(s)?n(`/companies/${t?.companyId}/statements`):n(`/bfs/${t?.companyId}/statements`)}})},D.SX.HIDE_AS400_INVOICE)},{path:":projectId/crews",component:p1}],oy=[{component:Mx,index:!0},{path:"websocket_poc",component:N5},{path:"select_project",component:gk},{path:"register",component:B5},{path:"magic_link/:key_id",component:Mx},{path:"paradigm",component:T5},{path:"process_jwt",component:os},{path:"no_access",component:YF},{path:"force_sign_out",component:I5},{path:"app_landing/:keyId",component:c5},{path:"select_customer",component:()=>(0,e.jsx)(L.Navigate,{to:"/bfs/select_customer"})},{path:"error_forward",component:G4},{path:"open",component:XF},{path:"mobile",component:u5},{path:"spec_sheets",component:X4},{path:"help",component:()=>(0,e.jsx)(Qx,{showForm:!0})},{path:"quote_share_landing",component:R5}],ry=[{component:yD,path:"select_customer"},{component:wr(x5,D.SX.BFS_DASHBOARD),path:"dashboard/*"},{component:wr(h5,D.SX.BFS_BIDS),path:"bids/*"},{component:wr(ey,D.SX.MARKET_MANAGER_CATALOG),path:"catalog"},{component:l5,path:"reports"}],ay=[{component:ey,path:":companyId/catalog"},{component:Wa,path:":companyId/projects"},{component:a5,path:":companyId/statements/*"},{component:n5,path:":companyId/orders/*"},{component:wr(zx,D.SX.DIGITAL_TOOLS),path:":companyId/digital_tools"},{component:wr(gM,D.SX.COMPANY_CREWS),path:":companyId/crews/*"},{component:wr($x,D.SX.PROFILE),path:":companyId/profile"},{component:wr(Wh,D.SX.COMPANY_SCHEDULE),path:":companyId/schedule"}];var _5=m(97375),U5=m.n(_5),W5=m(75125),z5=m.n(W5),V5=m(47581),$5=m.n(V5);let iy=!1;const H5=()=>{iy||(dn().extend(U5()),dn().extend(z5()),dn().extend($5()),iy=!0)};var Q5=m(26795);const G5=rs(({open:t,onClose:n})=>{const s=(0,Fe.d)(),{company:o}=(0,je.P)(),[r,a]=(0,d.useState)([]),[i]=(0,Me.VX)(),l=async()=>{const c=new FormData;r.forEach(u=>{c.append("vendors",u)});try{await i({company:o?.id,formData:c}).unwrap(),s.showSuccess({message:"Vendors imported successfully!"})}catch(u){s.showError({message:fn(u),action:(0,e.jsx)(is,{children:(0,e.jsx)(sn,{variant:"text",color:"error",component:"a",href:"/static/VendorListImportTemplate.xlsx",children:"Downloads template"})})})}finally{n()}};return(0,e.jsx)(Zt,{open:t,onClose:n,title:"Import vendors from file",fullWidth:!0,hideCancel:!0,content:(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,e.jsx)(ml.Ay,{onDrop:c=>a(Array.from(c)),accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx",".xls"],"text/csv":[".csv"]},children:({getRootProps:c,getInputProps:u,isDragActive:p})=>(0,e.jsxs)("div",{...c(),children:[(0,e.jsx)("input",{...u(),hidden:!0}),r.length===0&&(0,e.jsx)(Sc,{fileTypes:"CSV",size:"large",isDragActive:p})]})}),r.length>0&&(0,e.jsxs)(I.A,{children:[(0,e.jsx)(I.A,{sx:{display:"inline"},fontWeight:"medium",children:"Attachment"})," ",(0,e.jsxs)(I.A,{sx:{display:"inline"},children:["(",r.length,")"]})]}),(0,e.jsx)(Cc,{files:r.map(c=>({id:c.name,name:c.name})),removeFile:async c=>{a(r.filter(u=>u.name!==c))},disableRemoveFile:!1,sx:{gap:1}})]}),actions:[{title:"Download template",component:"a",href:"/static/VendorListImportTemplate.xlsx",variant:"text",sx:{marginRight:"auto"}},{title:"Cancel",variant:"text",color:"secondary",onClick:n},{title:"Import Vendors",disabled:!r.length,variant:"contained",onClick:l}]})});var _u=m(55080),K5=m(71961);const Y5=t=>{const n=(0,d.useRef)(null),[s,o]=(0,d.useState)(!1);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(du.A,{variant:"contained",color:"secondary",children:[(0,e.jsx)(K.A,{...t,startIcon:(0,e.jsx)(_u.A,{}),children:"Import Vendors"}),(0,e.jsx)(K.A,{size:"small",onClick:()=>o(!0),ref:n,children:(0,e.jsx)(K5.A,{})})]}),(0,e.jsx)(Hn.A,{anchorEl:n.current,open:s,onClose:()=>o(!1),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,e.jsx)(it.A,{onClick:()=>o(!1),component:"a",href:"/static/VendorListImportTemplate.xlsx",children:"Download Template"})})]})};var q5=m(42670);const pa=({sx:t,size:n,children:s,icon:o=q5.A,...r})=>{const a=o;return(0,e.jsx)(Ti.A,{...r,sx:[i=>({width:n,height:n,bgcolor:i.palette.background.tertiary,border:`1px solid ${i.palette.border.secondary}`,transition:"all 0.2s ease-out"}),...Array.isArray(t)?t:[t]],children:s||(0,e.jsx)(a,{sx:{fontSize:n*.5,color:"text.secondary"}})})},X5=[{field:"name",type:"custom",headerName:"Name",flex:1,renderCell:({row:t,value:n})=>{const{vendorId:s}=(0,L.useParams)(),{company:o}=(0,je.P)(),r=(0,L.useNavigate)();return(0,e.jsx)(E.A,{sx:{display:"flex",height:"100%",flexDirection:"column",justifyContent:"center"},children:(0,e.jsxs)(E.A,{onClick:()=>r(`/companies/${o?.id}/profile/vendor_management/${t.id}`),sx:a=>({cursor:"pointer",boxSizing:"border-box",maxWidth:"100%",width:"fit-content",display:"flex",alignItems:"center",gap:"10px",padding:"12px 8px",border:"1px solid transparent",borderRadius:"4px",lineHeight:"normal",transition:a.transitions.create("border-color",{easing:a.transitions.easing.easeIn,duration:a.transitions.duration.shortest}),...t.id===Number(s)?{"& > :last-child":{opacity:1},borderColor:a.palette.border.secondary}:{"&:hover":{borderColor:a.palette.border.secondary},"&:hover > :last-child":{opacity:1}}}),children:[(0,e.jsx)(pa,{src:t.avatarFileUrl,size:32}),(0,e.jsx)(I.A,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},color:n?"":"secondary",children:n||"Enter Vendor Name"}),(0,e.jsx)(Fo.A,{sx:a=>({opacity:0,color:a.palette.text.secondary,transition:a.transitions.create("opacity",{easing:a.transitions.easing.easeIn,duration:a.transitions.duration.shortest})})})]})})}},{field:"category",type:"custom",headerName:"Category",flex:1,renderCell:({row:t})=>(0,e.jsx)(E.A,{sx:{display:"flex",alignItems:"center",height:"100%"},children:t.categories.map(n=>(0,e.jsx)(to,{label:n.name,color:"warning",shape:"square",size:"small",sx:{marginRight:".5rem"}}))})},{field:"actions",type:"actions",headerName:"",width:50,getActions:({row:t})=>{const{isModalOpen:n,openModal:s,closeModal:o}=ln(),[r]=(0,Me.S$)(),{vendorId:a}=(0,L.useParams)(),i=(0,L.useNavigate)(),l=(0,Fe.d)(),{company:c}=(0,je.P)();return[(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:s,color:"inherit"}),(0,e.jsx)(Zt,{open:n,onClose:o,title:"Delete vendor",content:"Deleting vendors will remove them from all associated invoices. This action cannot be undone.",actions:[{title:"Delete",color:"error",onClick:async()=>{try{Number(a)===t.id&&i(`/companies/${c?.id}/profile/vendor_management`,{replace:!0}),await r(t).unwrap(),o()}catch(u){l.showError({message:fn(u)})}}}]})]})]}}],ly=540,J5=(0,g.Ay)(Oo.Ay)(({theme:t})=>({"& .MuiDrawer-paper":{width:ly},zIndex:49,flexShrink:0,variants:[{props:({open:n})=>n,style:{width:ly,overflowX:"hidden",transition:t.transitions.create("width",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen})}},{props:({open:n})=>!n,style:{width:0,overflowX:"hidden",transition:t.transitions.create("width",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})}}]})),Z5=()=>{const t=(0,Kn.b)(),n=(0,Fe.d)(),s=(0,L.useNavigate)(),{vendorId:o}=(0,L.useParams)(),r=(0,d.useRef)(null),{company:a}=(0,je.P)(),[i]=(0,Me.TQ)(),{data:l=[],isFetching:c}=(0,Me.T5)({company:a?.id},{skip:!a}),{isModalOpen:u,closeModal:p,openModal:f}=ln();(0,d.useEffect)(()=>{if(o&&!c){const v=l.find(({id:y})=>y===Number(o));v?t.current.setRowSelectionModel([v.id]):(n.showToast({severity:"info",message:"Vendor not found"}),s(`/companies/${a?.id}/profile/vendor_management`,{replace:!0}))}},[l,o,c]);const h=(0,d.useMemo)(()=>l.map(({id:v,company:y,name:j,vendorFiles:A,categories:w=[]})=>{const P=A?.find(C=>C.isAvatar);return{id:v,company:y,name:j,avatarFileUrl:P?.url,categories:w,vendorFiles:A}}),[l]),b=eo(t);$o({handleResize:()=>zo(r.current)});const x=async()=>{try{const{id:v}=await i({company:a?.id}).unwrap();s(`/companies/${a?.id}/profile/vendor_management/${v}`)}catch(v){n.showError({message:fn(v)})}};return(0,e.jsxs)(is,{children:[(0,e.jsxs)(E.A,{sx:{display:"flex"},children:[(0,e.jsxs)(E.A,{sx:{flexGrow:1,overflowX:"hidden",display:"flex",flexDirection:"column",gap:"16px"},children:[(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"h3",fontWeight:"medium",component:"h1",children:"Vendor Management"}),(0,e.jsx)(I.A,{variant:"body1",children:"This is a definition of vendors, what they do and how they are useful"})]}),(0,e.jsxs)(E.A,{children:[(0,e.jsxs)(E.A,{sx:v=>({backgroundColor:"white",display:"flex",alignItems:"center",paddingX:v.spacing(1.5),paddingY:v.spacing(1),border:`1px solid ${v.palette.divider}`,borderBottom:0,gap:"12px",borderTopLeftRadius:v.shape.borderRadius,borderTopRightRadius:v.shape.borderRadius}),children:[(0,e.jsx)(I.A,{sx:{flex:1},variant:"body1",fontWeight:"bold",children:"Vendors"}),(0,e.jsx)(Y5,{onClick:f}),(0,e.jsx)(sn,{variant:"contained",onClick:x,startIcon:(0,e.jsx)(pr.A,{}),children:"Add Vendor"})]}),(0,e.jsx)(Vo,{ref:r,ignoreEditableOutline:!0,children:(0,e.jsx)(Jn,{rowHeight:64,apiRef:t,rows:h,columns:X5,loading:c,slotProps:{loadingOverlay:{variant:"linear-progress",noRowsVariant:"skeleton"}},getRowClassName:b})})]})]}),(0,e.jsx)(J5,{open:!!o,variant:"persistent",anchor:"right",children:(0,e.jsx)(E.A,{sx:v=>({paddingTop:v.header.height,height:"100%",boxSizing:"border-box"}),children:(0,e.jsx)(L.Outlet,{})})})]}),(0,e.jsx)(G5,{open:u,onClose:p})]})},eB=({open:t,onClose:n})=>{const{user:s,updateUser:o}=(0,Pt.A)(),[r,a]=(0,d.useState)({value:s?.email?s.email:""}),[i,l]=(0,d.useState)({value:s?s.name:"",isDirty:!1}),[c,u]=(0,d.useState)({value:s?.phone?s.phone:"",isDirty:!1}),p=x=>{l({value:x,isDirty:!0})},f=x=>{u({value:x,isDirty:!0})},h=()=>i.isDirty&&i.value.length>0;(0,d.useEffect)(()=>{s&&(a({value:s.email}),s.name?l({value:s.name,isDirty:!0}):l({value:(0,Ze.S1)(s.email),isDirty:!0}),u({value:s.phone?s.phone:"",isDirty:!1}))},[s?.email]);const b=async()=>{if(h()&&o){const x={email:r.value,phone:c.value,name:i.value};o(x)}n()};return(0,e.jsx)(Qn,{title:"Welcome to MyBLDR!",submitText:"Confirm",onSubmit:b,disabled:!i.value,open:t,children:(0,e.jsxs)("div",{children:[(0,e.jsx)(I.A,{variant:"body1",sx:{textAlign:"center",padding:"1em 0em 3em"},children:"Please confirm your contact information to continue"}),(0,e.jsx)(Be.A,{fullWidth:!0,sx:{margin:".5rem 0"},children:(0,e.jsx)(_.A,{label:"First and Last Name",InputLabelProps:{shrink:!0},variant:"standard",required:!0,value:i.value,onChange:x=>p(x.target.value),error:i.isDirty&&i.value==="",helperText:i.isDirty&&i.value===""?"First and Last Name is required":" "})}),(0,e.jsx)(Be.A,{fullWidth:!0,sx:{margin:".5rem 0"},children:(0,e.jsx)(_.A,{label:"Email",InputLabelProps:{shrink:!0},variant:"standard",required:!0,value:r.value,InputProps:{readOnly:!0},helperText:" "})})]})})},R7=(0,g.Ay)(_.A)`
  width: 12em;
  flex-grow: 1;
`,O7=(0,g.Ay)(_.A)`
  margin-left: 1em;
`,M7=323,tB="64px",Uu=(0,g.Ay)(kn)(({theme:t})=>({display:"flex",position:"static",marginLeft:"105px"})),nB=(0,g.Ay)("div",{shouldForwardProp:t=>t!=="plansCount"})`
  display: flex;
  width: 100%;
  max-width: 100%;
  flex-wrap: wrap;
  justify-content: flex-start;
`,sB=(0,g.Ay)("div")`
  margin: 0.5rem;
`,oB=(0,g.Ay)("div")(({theme:t,className:n})=>({flex:1,width:"100%",maxWidth:"100%",display:"flex",flexDirection:"column",position:"relative",overflowY:"auto",padding:"32px 24px 32px 56px",boxSizing:"border-box",...n==="homeBuyerEmbedded"&&{padding:"0"}})),rB=(0,g.Ay)("div")(({theme:t})=>({display:"flex",justifyContent:"space-between",alignItems:"center",height:tB,width:"100%",position:"fixed",backgroundColor:"var(--graythorne-grays-gray-4)",zIndex:1e3,paddingRight:"16px",boxSizing:"border-box"})),aB=(0,g.Ay)(K.A)`
  /* padding: 0.75rem; */
  flex-grow: 0;
  flex-direction: row;
  justify-content: center;
  background-color: clear;
  color: var(--graythorne-grays-gray-3);
  pointer-events: all;
  cursor: pointer;
`,L7=(0,g.Ay)("div")`
  display: flex;
  flex: 1;
  overflow: hidden;
`,iB=(0,g.Ay)("span")`
  font-size: 16px;
  line-height: 1.5;
  letter-spacing: 0.15px;
  color: white;
  padding: 20px 24px;
  background-color: var(--bfs-primary-true-black);
  min-width: 103px;
  text-align: center;
`,Wu=(0,g.Ay)(it.A)`
  color: var(--light-text-primary);
  border-bottom: 1px solid #e1e1e1;
  padding: 6px 16px;
  height: 36px;
  z-index: 1000;
  &:hover {
    color: white;
    background-color: var(--graythorne-blues-blue-3);
  }
`,lB=(0,g.Ay)(Wu)`
  color: #e30014;
  &:hover {
    color: white;
    background-color: #e30014;
  }
`,dB=(0,g.Ay)("div")`
  width: 234px;
  min-height: 60px;
  position: absolute;
  transform: translate(-70%, 15%);
  z-index: 9999;
  display: flex;
  flex-direction: column;
  box-shadow: 0 3px 14px 2px var(--light-text-primary-shades-12-p),
    0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 5px 5px -3px rgba(0, 0, 0, 0.2);
  background-color: rgba(255, 255, 255, 0.62);
  padding: 8px 0;
  border-radius: 4px;
`,cB=({selectedFolderId:t,handleOptionClick:n,project:s})=>{const[o,r]=(0,d.useState)(!1),{userHasPermission:a}=(0,Ye.A)(),i=(0,d.memo)(()=>(0,e.jsx)(kf.x,{onClickAway:f,children:(0,e.jsxs)(dB,{"data-testid":"folder-actions-menu",children:[(0,e.jsx)(Wu,{onClick:()=>p("Rename"),id:"rename-dropdown-option","data-testid":"rename-dropdown-option",children:"Rename"}),(0,e.jsx)(Wu,{onClick:()=>p("Manage"),id:"permissions-dropdown-option","data-testid":"permissions-dropdown-option",children:"Manage Permissions"}),(0,e.jsx)(lB,{onClick:()=>p("Delete"),id:"delete-dropdown-option","data-testid":"delete-dropdown-option",children:"Delete"})]})})),l=()=>t!==0,c=a({tool:D.w5.DOCUMENTS,action:D.a2.MANAGE_FOLDERS,companyId:s.companyId,projectId:s.id}),u=()=>{r(!o)},p=h=>{r(!1),n(h)},f=()=>{r(!1)};return l()?(0,e.jsxs)("span",{children:[(0,e.jsx)(aB,{disabled:!c,"data-testid":"edit-folder-kebab",style:{opacity:c?"100%":"30%"},size:"small",onClick:u,children:(0,e.jsx)(Mo.A,{})}),o&&(0,e.jsx)(i,{})]}):null},uB=Ps.w3.injectEndpoints({endpoints:t=>({getFolders:t.query({query:n=>({url:`/${n}/folders`}),transformResponse:n=>{const s=["Desktop","BFS Only","BFS Component Design","Homebuyer"],o=(0,Ze.bn)(n);return o.systemFolders.sort((r,a)=>{const i=s.indexOf(r.name),l=s.indexOf(a.name);return i!==-1&&l!==-1?i-l:o.systemFolders.length-1}),o},providesTags:["Folders"]}),createFolder:t.mutation({query:({projectId:n,name:s,roles:o})=>({url:`/${n}/folders`,method:"POST",data:{name:s,roles:o}}),invalidatesTags:["Folders"]}),renameFolder:t.mutation({query:({projectId:n,folderId:s,newFolderName:o})=>({url:`/${n}/folders/${s}`,method:"PUT",data:{id:s,newFolderName:o}}),transformResponse:n=>(0,Ze.bn)(n),invalidatesTags:["Folders"]}),updateFolderPermissions:t.mutation({query:({newFolderName:n,folderId:s,projectId:o,newFolderPermissions:r})=>({url:`/${o}/folders/${s}`,method:"PUT",data:{id:s,newFolderName:n,updatedFolderRoles:r}}),invalidatesTags:["Folders"]}),deleteFolder:t.mutation({query:({projectId:n,folderId:s})=>({url:`/${n}/folders/${s}`,method:"DELETE"}),transformResponse:n=>(0,Ze.bn)(n),invalidatesTags:["Folders"]}),addFileToFolder:t.mutation({queryFn:async({projectId:n,folderId:s,fileId:o,folderName:r,isSystemFolder:a,entityId:i,entityType:l})=>{let c="",u={};s===0?c=`/api/projects/${n}/files/${o}/folders/${s}`:(c=`/api/projects/${n}/folders/file/${o}`,u={folderId:s,systemFolder:a,entityId:i,entityType:l});try{return{data:(await nt.Ay.put(c,u)).status}}catch(p){return{error:p}}},invalidatesTags:["Folders","Files"]}),updateQuoteFileLocation:t.mutation({query:({projectId:n,fileId:s,originFolderType:o,originFolderId:r,destinationFolderType:a,destinationFolderId:i,fileName:l,entityId:c,entityType:u})=>({url:`/${n}/folders/quote-file`,method:"PUT",data:{fileId:s,originFolderId:r,originFolderType:o,destinationFolderId:i,destinationFolderType:a,fileName:l,entityId:c,entityType:u}}),invalidatesTags:["Files","QuoteFiles"],transformResponse:n=>(0,Ze.bn)(n)})})}),{useGetFoldersQuery:pB,useAddFileToFolderMutation:mB,useCreateFolderMutation:hB,useDeleteFolderMutation:gB,useRenameFolderMutation:fB,useUpdateFolderPermissionsMutation:xB,useUpdateQuoteFileLocationMutation:yB}=uB,Si=t=>{const{isLoggedIn:n}=(0,Pt.A)(),{data:s,isLoading:o,isFetching:r,isSuccess:a}=pB(t,{skip:!t||!n}),i=(0,d.useMemo)(()=>[],[]);return{folders:s?.folders??i,systemFolders:s?.systemFolders??i,modelingFolders:s?.modelingFolders??i,quoteFolders:s?.quoteFolders??i,foldersLoading:o||r,isSuccess:a}},ma=(t={redirectOnNotFound:!1})=>{const n=(0,L.useNavigate)(),{projectId:s,folderId:o}=(0,L.useParams)(),{folders:r,modelingFolders:a,systemFolders:i,foldersLoading:l,quoteFolders:c,isSuccess:u}=Si(Number(s)),p=(0,L.useMatch)("/projects/:projectId/documents"),f=(0,L.useMatch)("/projects/:projectId/documents/system/*"),h=(0,L.useMatch)("/projects/:projectId/documents/folder/*"),b=(0,L.useMatch)("/projects/:projectId/documents/quote/*"),x=(0,L.useMatch)("/projects/:projectId/documents/modeling/*"),v=(0,d.useCallback)(j=>{const A=j.folderType;A===Sn.SYSTEM?n(`/projects/${s}/documents/system/${j.id}`):A===Sn.MODELING?n(`/projects/${s}/documents/modeling/${j.id}`):A===Sn.QUOTE?n(`/projects/${s}/documents/quote/${j.id}`):n(`/projects/${s}/documents/folder/${j.id}`)},[n,s]),y=(0,d.useMemo)(()=>{if(p)return i[0]??null;let j=[];return f?j=i:h?j=r:x?j=a:b&&(j=c),j?.length===0?null:j.find(A=>String(A.id)===o)??null},[p,f,h,x,o,r,a,i,c,b]);return(0,d.useEffect)(()=>{t.redirectOnNotFound&&u&&!y&&o&&n(`/projects/${s}/documents`)},[y,u,n,o,s,t.redirectOnNotFound]),{selectedFolder:y,selectFolder:v}},qo=(t,n)=>t.name===n.name&&t.id===n.id,F7=(t,n)=>n.filter(s=>qo(s,t)).length>0,dy=(t,n)=>t.name==="BFS Component Design"||n?.name==="BFS Component Design",cy=t=>{const n=zu(t);return["ifc","rvt"].includes(n)},zu=t=>t.displayName?.split(".").pop()?.toLowerCase()??"",Vu=(t,n)=>zu(t)===n.toLowerCase(),$u=(t,n)=>t.folderType===Sn.MODELING||n.folderType===Sn.MODELING,bB=t=>[FolderType.MODELING,FolderType.QUOTE].includes(t),B7=t=>bB(t.folderType),Hu=t=>Vu(t,"ifc"),ed=t=>Vu(t,"rvt"),uy=t=>{const n=(0,Pn.wA)(),s=(0,Pn.d4)(f=>f.documents.mergeIFC),[o,r]=(0,Ps.hQ)(),{selectedFolder:a}=ma(),i=a?.folderType===Sn.MODELING,l=i&&a?.id?String(a?.id):void 0,{data:c}=za(t?.id,l,!i),u=(0,d.useCallback)(f=>n((0,ts.Rw)(f)),[n]),p=(0,d.useMemo)(()=>{if(!i||!c)return!1;let f=!1;const h=c.filter(x=>(x.isMarkedForMerge&&(f=!0),Hu(x)&&!x.isMarkedForMerge)),b=c.filter(x=>ed(x));return f?!1:h.length>0&&b.length>0},[c,i]);return{mergeIFC:s,toggleMergeIFC:u,mergeEnabled:p,mergeModelingFiles:o,mergeStatus:r}},vB=({user:t,project:n})=>{const s=(0,Pn.wA)(),{toggleMergeIFC:o,mergeEnabled:r}=uy(n),{selectedFolder:a}=ma({redirectOnNotFound:!1}),i=a?.folderType===Sn.USER,l=a?.folderType===Sn.MODELING,c=u=>{switch(u){case"Rename":s((0,ts._D)(ts.MR.RENAME));break;case"Delete":s((0,ts._D)(ts.MR.DELETE));break;case"Manage":s((0,ts._D)(ts.MR.PERMISSIONS));break}};return(0,e.jsx)(rB,{children:a&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(iB,{"data-testid":"folder-title",children:a.name}),t&&i&&(0,e.jsx)(cB,{selectedFolderId:a.id,handleOptionClick:c,project:n}),t&&l&&(0,e.jsx)(K.A,{sx:{padding:"8px 12px",color:"white",borderColor:"white","&:hover":{backgroundColor:"#484A4C",borderColor:"#FFFFFF"},"&:focus":{boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05), 0px 0px 0px 4px rgba(255, 255, 255, 0.60)"}},disableRipple:!0,variant:"outlined",onClick:()=>o(!0),disabled:!r,children:(0,e.jsx)(I.A,{sx:{fontFamily:"Roboto",fontSize:"14px",lineHeight:"20px",fontWeight:500},children:"Merge"})})]})})},jB=(0,g.Ay)("img")(({theme:t})=>({fontSize:"86px",[t.breakpoints.up("xl")]:{fontSize:"86px"},[t.breakpoints.up("lg")]:{fontSize:"52px"},[t.breakpoints.up("sm")]:{fontSize:"52px"},[t.breakpoints.up("xs")]:{fontSize:"52px"}})),AB=(0,g.Ay)(Oo.Ay)(({theme:t})=>({width:"105px"})),CB={top:t=>`calc(${t.header?.height} + 64px)`,height:t=>`calc(100% - ${t.header?.height} - 64px)`},SB=(0,g.Ay)(I.A)(({theme:t})=>({fontSize:"10px",padding:"0 8px",textAlign:"center",lineHeight:"normal",letterSpacing:"normal",[t.breakpoints.up("xl")]:{fontSize:"10px"},[t.breakpoints.up("lg")]:{fontSize:"10px"}})),wB=({open:t,onClose:n,folder:s})=>{const[o,r]=(0,d.useState)(s.name||"");return t?(0,e.jsx)(Qn,{title:"Rename Folder",titleBackgroundColor:"var(--graythorne-grays-gray-5)",dialogContentPadding:"32px 24px 0 24px",dialogActionsPadding:"0 24px 20px 24px",open:t,onSubmit:()=>n(o),onClose:()=>n(),disabled:!1,submitText:"Save",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{paddingBottom:"4px"},children:(0,e.jsx)("b",{children:"Folder Name"})}),(0,e.jsx)(Be.A,{fullWidth:!0,children:(0,e.jsx)(_.A,{label:"Folder name",inputProps:{style:{padding:"9px 12px 7px 12px"}},value:o,onChange:a=>r(a.target.value),variant:"outlined"})})]})}):(0,e.jsx)(e.Fragment,{})},EB=({open:t,onClose:n,folder:s})=>{const o=(0,g.Ay)("div")`
    height: 24px;
    align-self: stretch;
    flex-grow: 0;
    font-family: acumin-pro, sans-serif;
    font-size: 20px;
    font-weight: bold;
    font-stretch: normal;
    font-style: normal;
    line-height: normal;
    letter-spacing: normal;
    text-align: center;
    color: var(--light-text-primary);
    padding-bottom: 24px;
  `,r=(0,g.Ay)("div")`
    height: 38px;
    align-self: stretch;
    flex-grow: 0;
    font-family: acumin-pro, sans-serif;
    font-size: 16px;
    font-weight: normal;
    font-stretch: normal;
    font-style: normal;
    line-height: normal;
    letter-spacing: normal;
    text-align: left;
    color: var(--light-text-primary);
  `;return(0,e.jsx)(Qn,{title:"Delete Folder",titleBackgroundColor:"#ea0015",destructive:!0,open:t,onSubmit:()=>n(!0),onClose:()=>n(!1),disabled:!1,submitText:"Delete Folder",children:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(o,{children:s?.name}),(0,e.jsxs)("div",{children:[(0,e.jsx)("b",{children:"Attention!"})," Deleting this folder will return all files to the Desktop folder. ",(0,e.jsx)("b",{children:"No files will be deleted by this action."})]})]})})};var PB=m(59749);const py=({selectedRoles:t,setSelectedRoles:n,handleRoleSelect:s,folderPermissions:o,companyId:r,projectId:a,isLoading:i,isEditingFolderPermissions:l})=>{const{projectPermissions:c,getRoleFromPermissions:u}=(0,we.Sk)(),[p,f]=(0,d.useState)(u({tool:D.w5.DOCUMENTS,action:D.a2.VIEW_FILES,companyId:r,projectId:a})),[h,b]=(0,d.useState)(o?.map(A=>A.name));(0,d.useEffect)(()=>{const A=j.reduce((w,P)=>{const C=P?.role?.name;return l?(h?.includes(C)||C===p||C===we.wy.CompanyManager)&&w.push(C):(C===p||C===we.wy.CompanyManager)&&w.push(C),w},[]);n(A)},[p,h]);const x=["upload","view","markup","edit","delete"],v=[we.wy.Homebuyer,we.wy.OSR,we.wy.BFSComponentDesign,we.wy.BIMCoordinator,we.wy.BFS3pQuoteAdmin],j=c.filter(A=>{const w=A?.role?.name;return!v.includes(w)}).map(A=>({role:A?.role,permissions:A?.permissions?.documents?.filter(w=>w.action.includes("files"))||[]}));return(0,e.jsxs)("div",{style:{backgroundColor:"var(--bfs-primary-true-white)"},children:[(0,e.jsx)(I.A,{variant:"h6",sx:{marginBottom:"1.3rem"},children:"Who can have access to this folder and the files inside?"}),(0,e.jsxs)(E.A,{sx:{display:"grid",gridTemplateColumns:"1fr 2fr",rowGap:".5rem",columnGap:"2rem"},children:[(0,e.jsx)(E.A,{}),(0,e.jsx)(E.A,{sx:{display:"flex",justifyContent:"space-around",borderBottom:"1px solid lightgray",paddingBottom:".5rem"},"data-testid":"tools-column",children:x.map((A,w)=>(0,e.jsx)(I.A,{variant:"body2",children:Se().startCase(A)},w))}),(0,e.jsx)(E.A,{sx:{textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-between"},"data-testid":"role-names",children:j.map((A,w)=>{const P=A?.role?.name,C=P===p||P===we.wy.CompanyManager,k=t.includes(P)||C,S=`role-${A?.role?.id}-checkbox`;return(0,e.jsx)(Ou,{labelText:A?.role?.name,testId:S,checked:k,disabled:i||C,onChange:R=>{s(P)}},S)})}),(0,e.jsx)(E.A,{"data-testid":"permissions-grid",sx:{display:"grid",gridTemplateColumns:`repeat(${x.length}, 1fr)`,alignItems:"center"},children:x.map((A,w)=>(0,e.jsx)(E.A,{children:j.map(P=>P?.permissions?.some(k=>k.action.toLowerCase().includes(A))?(0,e.jsx)(PB.A,{sx:{color:"#229920",width:".5rem",aspectRatio:"1 / 1",display:"block",marginInline:"auto",marginBottom:".5rem"}},`${A}-role-${P?.role?.id}`):(0,e.jsx)(Ss.A,{sx:{color:"red",width:".8rem",aspectRatio:"1 / 1",display:"block",marginInline:"auto",marginBottom:".5rem"}}))},`${A}--${w}`))})]})]})},IB=({isOpen:t,onClose:n,folderPermissions:s,projectId:o,companyId:r,selectedRoles:a,setSelectedRoles:i,handleRoleSelect:l,handleUpdatePermissions:c,isManageFolderModalLoading:u,isEditingFolderPermissions:p})=>(0,e.jsx)(Qn,{open:t,testId:"manage-permissions-modal",title:"Folder Permissions",onClose:n,onSubmit:c,loading:u,children:(0,e.jsx)(py,{selectedRoles:a,setSelectedRoles:i,handleRoleSelect:l,folderPermissions:s,companyId:r,projectId:o,isLoading:u,isEditingFolderPermissions:p})}),my=t=>{const{showError:n,showSuccess:s}=(0,Fe.d)(),[o,{isLoading:r}]=hB({fixedCacheKey:"createFolder"}),[a,{isLoading:i}]=gB({fixedCacheKey:"deleteFolder"}),[l,{isLoading:c}]=mB({fixedCacheKey:"addFileToFolder"}),[u,{isLoading:p}]=fB({fixedCacheKey:"renameFolder"}),[f,{isLoading:h}]=yB({fixedCacheKey:"updateQuoteFileFolder"}),[b,{isLoading:x}]=xB({fixedCacheKey:"updateFolderPermissions"}),v=(0,d.useCallback)(async(k,S)=>{try{const R=await o({projectId:t,name:k,roles:S}).unwrap();return console.log("new folder created:",R),s({message:"Folder created"}),R}catch{n({message:"There was an error creating new folder. Please try again in a few moments."})}},[n,s,o,t]),y=async(k,S,R,B,T,W,N)=>{try{const O=await l({projectId:k,folderId:S,fileId:R,folderName:B,isSystemFolder:T,entityId:W,entityType:N}).unwrap();return O===201?s({message:`File was successfully added to ${B} folder.`}):O===204&&s({message:"Document removed from folder"}),!0}catch{return n({message:`There was an error moving a file to ${B} folder. Please try again in a few moments.`}),!1}},j=async(k,S,R,B,T,W,N,O,z)=>{try{return await f({projectId:k,fileId:S,originFolderId:R,originFolderType:B,destinationFolderId:T,destinationFolderType:W,fileName:N,entityId:O,entityType:z}).unwrap(),s({message:"File was successfully added to folder."}),!0}catch{return n({message:"There was an error moving a file to folder. Please try again in a few moments."}),!1}},A=(0,d.useCallback)(async(k,S)=>{try{return(await u({projectId:t,folderId:k,newFolderName:S}).unwrap()).folderName&&s({message:"Folder renamed"}),!0}catch(R){const B=R?.response?.data||"There was an error renaming the folder. Please try again in a few moments.";return n({message:B}),!1}},[u,t,n,s]);return{isLoading:r||i||c||p||h||x,createFolder:v,renameFolder:A,addFileToFolder:y,updateFolderPermissions:async(k,S,R)=>{try{return await b({folderId:k,newFolderName:S,projectId:t,newFolderPermissions:R}).unwrap()&&s({message:"Folder permissions updated"}),!0}catch(B){const T=B?.response?.data||"There was an error updating the folder permissions. Please try again in a few moments.";return n({message:T}),!1}},deleteFolder:async k=>{try{const R=(await a({projectId:t,folderId:k}).unwrap()).movedFilesCount;return R>0?s({message:`${R} Files moved to the Desktop folder`,title:"Folder deleted"}):s({message:"",title:"Folder deleted"}),!0}catch{return n({message:"There was an error deleting folder. Please try again in a few moments."}),!1}},updateQuoteFileLocation:j}},hy=m.p+"a60bf61204bdd6faaad551d033e2d18b.svg",DB=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  margin: 0 20%;
  padding: 60px;
`,kB=(0,g.Ay)("div")`
  display: flex;
  flex-direction: column;
  ${t=>t.theme.breakpoints.up("lg")} {
    flex-direction: row;
  }
`,gy=(0,g.Ay)("img")`
  width: 100%;
  object-fit: cover;
`,TB=(0,g.Ay)("div")`
  flex: 1;
  padding: 20px;
  font-size: 14px;
  line-height: 1.2em;
  color: var(--bfs-primary-true-white);
  background-color: var(--bfs-11-22-nav-background-gray);
  h5 {
    font-size: 16px;
    font-weight: bold;
    margin: 8px 0 -10px 0;
  }
`,RB=(0,g.Ay)("div")`
  display: flex;
  flex: 2;
  flex-direction: column;
  align-items: center;
  text-align: center;

  padding: 20px;
  background-color: var(--bfs-primary-true-white);
`,U7=(0,g.Ay)("div")`
  font-size: 22px;
  font-weight: 600;
`,fy=(0,g.Ay)(Ss.A)`
  color: var(--graythorne-grays-gray-4);
  top: 8px;
  right: 8px;
  align-self: flex-end;
  cursor: pointer;
`,xy=(0,g.Ay)("b")`
  font-size: 20px;
`,OB=(0,g.Ay)("b")`
  font-weight: bold;
  align-self: flex-start;
  margin-bottom: 8px;
`,MB=(0,g.Ay)(K.A)`
  background-color: var(--light-secondary-main);
  font-weight: normal;
  font-size: 16px;
  margin: auto;
  width: 100%;
`,LB=(0,g.Ay)("div")`
  display: flex;
  width: 100%;
  flex-direction: column;
  align-items: flext-start;
  margin-top: 30px;
  margin-bottom: 30px;
`,FB=(0,g.Ay)("label")`
  font-weight: bold;
  align-self: flex-start;
  margin-bottom: 8px;
`,BB=(0,g.Ay)("input")`
  height: 38px;
  padding: 7px 12px;
  border: 1px solid var(--light-other-outlined-border-23-p);
  border-radius: 4px;
  font-size: 16px;
  line-height: 0px;
  box-sizing: border-box;
`,yy=({folderName:t,handleInputChange:n,errorText:s,placeholder:o="",isLoading:r})=>(0,e.jsxs)(LB,{children:[(0,e.jsx)(FB,{htmlFor:"folderName",children:"Folder Name"}),(0,e.jsx)(BB,{id:"folderName",value:t,onChange:n,placeholder:o,disabled:r}),s&&(0,e.jsx)("div",{children:s})]}),NB=({href:t})=>(0,e.jsx)("div",{style:{textAlign:"center",width:"100%"},children:(0,e.jsx)(Bn,{href:t,target:"_blank",children:(0,e.jsx)(MB,{variant:"contained",disableElevation:!0,children:"Get Help"})})}),_B=t=>{const{project:n}=(0,De.B)(),{isFlagEnabled:s}=(0,ut.u)(),{projectPermissions:o}=(0,we.Sk)(),r=s(D.SX.LINKED_FOLDERS),[a,i]=(0,d.useState)(""),[l,c]=(0,d.useState)(""),u=x=>{i(x.target.value)},p=()=>{c(""),i(""),t.onClose()};function f(){if(t.folders.some(v=>v.name===a)){c("A folder with that name already exists");return}if(["/",":","\\","*","?",'"',"<",">","|"].some(v=>a.includes(v))){c('Folder name contains invalid characters (/, :, \\, *, ?, ", <, >, |)');return}if(a.length>64){c("Folder name is too long (max 64 characters)");return}c(""),i(""),t.onCreateFolder(a,t.selectedRoles)}const h=["Upload","View","Markup","Edit","Delete"],b="/help";return(0,e.jsx)(pp.A,{"data-testid":"create-folder-modal",open:t.isOpen,onClose:t.onClose,BackdropProps:{style:{backgroundColor:"rgba(0,0,0,.7)"}},sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(DB,{sx:{maxWidth:900},children:(0,e.jsxs)(kB,{children:[(0,e.jsx)(TB,{children:r?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(gy,{src:hy,alt:"Create folder image"}),(0,e.jsx)("h5",{children:"Project Folders"}),(0,e.jsx)("p",{children:"Say goodbye to the hassle of disorganized project files and hello to streamlined project management. With Project Folders, you can easily store, access, and organize all your project-related documents, plans, and photos in one central location."}),(0,e.jsx)("h5",{children:"Questions? We're here to help!"}),(0,e.jsx)("p",{children:"Our team is always available to assist you at every step of the way, and we are fully committed to providing you with excellent customer service."}),(0,e.jsx)(E.A,{sx:{textAlign:"center"},children:(0,e.jsx)(K.A,{color:"secondary",variant:"contained",sx:{padding:"1.5rem 1rem"},href:b,children:"Get Help"})})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(gy,{src:hy,alt:"Create folder image"}),(0,e.jsx)("h5",{children:"Project Folders"}),(0,e.jsx)("p",{children:"Say goodbye to the hassle of disorganized project files and hello to streamlined project management. With Project Folders, you can easily store, access, and organize all your project-related documents, plans, and photos in one central location."}),(0,e.jsx)("h5",{children:"Questions? We're here to help!"}),(0,e.jsx)("p",{children:"Our team is always available to assist you at every step of the way, and we are fully committed to providing you with excellent customer service."}),(0,e.jsx)(NB,{href:b})]})}),(0,e.jsx)(RB,{children:r?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(fy,{onClick:p,"data-testid":"close-button"}),(0,e.jsx)(I.A,{variant:"h5",sx:{fontWeight:"300"},children:"Folder Options for"}),(0,e.jsx)(xy,{children:a||"Untitled"}),(0,e.jsx)(yy,{folderName:a,handleInputChange:u,errorText:l,placeholder:"Untitled",isLoading:t.isLoading}),n&&(0,e.jsx)(py,{selectedRoles:t.selectedRoles,setSelectedRoles:t.setSelectedRoles,handleRoleSelect:t.handleRoleSelect,folderPermissions:o.map(x=>x.role),companyId:n.companyId,projectId:n.id,isLoading:t.isLoading}),(0,e.jsxs)(E.A,{sx:{display:"flex",width:"100%",alignItems:"flex-end",justifyContent:"space-between",marginTop:"auto"},children:[(0,e.jsx)(K.A,{color:"secondary",variant:"contained",sx:{padding:"1.5rem 1rem"},onClick:p,children:"Cancel"}),(0,e.jsx)(K.A,{color:"primary",variant:"contained",sx:{padding:"1.5rem 1rem"},onClick:f,disabled:a==="",children:t.isLoading?(0,e.jsx)(bt.A,{size:"1rem"}):"Save"})]})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(fy,{onClick:p,"data-testid":"close-button"}),(0,e.jsx)("div",{children:"Folder Options for"}),(0,e.jsx)(xy,{children:"Untitled"}),(0,e.jsx)(yy,{folderName:a,handleInputChange:u,errorText:l,placeholder:"",isLoading:t.isLoading}),(0,e.jsx)(OB,{children:"Folder Permissions"}),(0,e.jsxs)("div",{style:{textAlign:"left"},children:[(0,e.jsx)("p",{style:{color:"var(--light-error-dark)",display:"inline-block",fontWeight:"bold",margin:0},children:"Coming Soon!"})," ","We currently only support project-wide permissions. All files are visible to everyone on this project."]}),(0,e.jsx)(K.A,{color:"primary",variant:"contained",sx:{alignSelf:"flex-end",marginTop:"auto",width:70,height:48},onClick:f,disabled:a==="",children:"Save"})]})})]})})})},UB=({selectedFolder:t,project:n,selectedRoles:s,folders:o,setSelectedRoles:r,handleRoleSelect:a,onFolderSelected:i})=>{const l=(0,Pn.wA)(),c=(0,L.useNavigate)(),u=(0,Pn.d4)(C=>C.documents.modalStatus),{updateFolderPermissions:p,deleteFolder:f,renameFolder:h,createFolder:b,isLoading:x}=my(n.id),v=C=>u===C,y=(0,d.useCallback)(()=>{l((0,ts._D)(ts.MR.NONE))},[l]),j=async C=>{C&&t&&(await f(t.id),c(`/projects/${n.id}/documents`,{replace:!0})),y()},A=async C=>{t&&C&&await h(t.id,C),y()},w=async()=>{t&&await p(t.id,t.name,s),y()},P=async(C,k)=>{const S=await b(C,k);S&&i(S)};return(0,d.useEffect)(()=>()=>{y()},[y]),t?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(wB,{open:v(ts.MR.RENAME),onClose:A,folder:t}),(0,e.jsx)(EB,{open:v(ts.MR.DELETE),onClose:j,folder:t}),(0,e.jsx)(IB,{isOpen:v(ts.MR.PERMISSIONS),onClose:y,folderPermissions:t.assignments,projectId:n.id,companyId:n.companyId,selectedRoles:s,setSelectedRoles:r,handleRoleSelect:a,handleUpdatePermissions:w,isManageFolderModalLoading:x,isEditingFolderPermissions:v(ts.MR.PERMISSIONS)}),(0,e.jsx)(_B,{onClose:y,isOpen:v(ts.MR.CREATE),folders:o,onCreateFolder:P,isLoading:x,selectedRoles:s,setSelectedRoles:r,handleRoleSelect:a})]}):null},td=m.p+"a5fa3fc426b1d042ee732465abdbeed1.svg",by=m.p+"87fb6a5bbab63c180e47aef00450b4fe.svg",vy=m.p+"bbb0555e6cf546d3bce10ac8329fe58a.svg",WB=m.p+"9de41649f3d7b3fed14dec01a5cf9dab.svg";function jy({selectedFolder:t,folder:n,hoverId:s,disabled:o,onClick:r,dragHandlers:a}){const{onDragOver:i,onDragEnter:l,onDragLeave:c,onDrop:u}=a,p=n.name==="New Folder",[f,h]=(0,d.useState)(td);(0,d.useEffect)(()=>{qo(t,n)?h(by):h(p?WB:td)},[t]);const b=y=>{p||(n.id!==s&&!qo(t,n)&&h(vy),i(y))},x=y=>{p||(qo(t,n)?h(by):h(td),c(y))},v=y=>{!qo(t,n)&&!p&&h(y?vy:td)};return(0,e.jsxs)(se().Fragment,{children:[(0,e.jsx)(_n.Ay,{disablePadding:!0,sx:{...o&&{cursor:"not-allowed"},margin:"8px",width:"auto"},onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),onClick:r,onDragOver:b,onDragEnter:l,onDragLeave:x,onDrop:u,children:(0,e.jsxs)(xs.A,{sx:{display:"flex",flexDirection:"column",gap:"4px",padding:"0",width:"89px",...o&&{opacity:".3"},"&:hover":{backgroundColor:"inherit"}},disabled:o,children:[(0,e.jsx)(Un.A,{children:(0,e.jsx)(jB,{src:f,alt:`${n.name} icon`})}),(0,e.jsx)(Cn.A,{style:{margin:0},children:(0,e.jsx)(SB,{children:n.name})})]})}),(0,e.jsx)(Ce.A,{})]})}const zB=({project:t,selectedFolder:n,files:s,quoteFiles:o,isDragging:r,folders:a,systemFolders:i,quoteFolders:l,modelingFolders:c,canCreateFolders:u,onFolderSelected:p,refreshFiles:f,isSalesUser:h})=>{const b=(0,Pn.wA)(),{showError:x}=(0,Fe.d)(),{userHasPermission:v}=(0,Ye.A)(),{foldersLoading:y}=Si(),{addFileToFolder:j,updateQuoteFileLocation:A}=my(t.id),[w,P]=(0,d.useState)(null),C=async(N,O,z,Q,re,ue)=>{const le=i.some(V=>V.id===O&&V.name===Q);await j(N,O,z,Q,le,re,ue)&&f()},k=(N,O)=>{N.stopPropagation(),N.preventDefault(),qo(O,n)||P(O.id)},S=(N,O)=>{N.stopPropagation(),N.preventDefault(),qo(O,n)||P(O.id)},R=async(N,O)=>{if(N.stopPropagation(),N.preventDefault(),dy(n,O)||$u(n,O)){x({message:`Files cannot be moved in or out of the ${O.name} folder`,title:"Permission Denied"}),P(null);return}if(qo(O,n)){x({message:`File is already in ${O.name}`,title:"Permission Denied"}),P(null);return}if(P(null),t?.companyId===void 0||t?.id===void 0)return;const z=N.dataTransfer.getData("text"),re=[...s,...o].find(ee=>ee.id===z),{entityId:ue,entityType:le,plansName:F}=re||{};if(!v({tool:D.w5.DOCUMENTS,action:D.a2.MANAGE_FOLDERS,projectId:t.id,companyId:t.companyId})){x({message:`There was an error moving this document to ${O.name}`,title:"Permission Denied"});return}if(!(O.folderType===Sn.QUOTE||n?.folderType===Sn.QUOTE)){await C(t?.id,O.id,z,O.name,ue,le);return}h&&n?A(t.id,z,n.id,n.folderType,O.id,O.folderType,F,ue,le):x({message:`There was an error moving this document to ${O.name}`,title:"Permission Denied"})},B=N=>{N.stopPropagation(),N.preventDefault(),P(null)},T=(N,O)=>y?[]:N.map(z=>(0,e.jsx)(jy,{selectedFolder:n,folder:z,onClick:()=>p(z),hoverId:w,dragHandlers:{onDrop:Q=>R(Q,z),onDragOver:Q=>k(Q,z),onDragEnter:Q=>S(Q,z),onDragLeave:B},disabled:!1},`${O}-${z.id}`)),W=()=>{const N={assignments:[],id:-1,name:"New Folder",folderType:Sn.USER},O=()=>{};return(0,e.jsx)(jy,{selectedFolder:n,folder:N,onClick:()=>b((0,ts._D)(ts.MR.CREATE)),disabled:r,hoverId:w,dragHandlers:{onDragOver:O,onDragEnter:O,onDragLeave:O,onDrop:O}})};return(0,e.jsxs)(qn.A,{disablePadding:!0,children:[T(i,"system-folder"),T(a,"user-folder"),T(c,"modeling-folder"),T(l,"quote-folder"),u&&W()]})},VB=({isDragging:t,canCreateFolders:n})=>{const{project:s}=(0,De.B)(),[o,r]=(0,d.useState)([]),{folders:a,modelingFolders:i,systemFolders:l,quoteFolders:c}=Si(Number(s?.id)),{selectedFolder:u,selectFolder:p}=ma(),f=u?.folderType===Sn.QUOTE?u?.id:void 0,{files:h}=pi(s?.id,f),{files:b,refreshFiles:x}=(0,Zl.e)(s?.id),{allRoles:v}=(0,Ye.A)(),y=(0,ct.EL)(v),j=A=>{o.includes(A)?o.includes(A)&&r(w=>w.filter(P=>P!==A)):r([...o,A])};return!u||!s?(0,e.jsx)(e.Fragment,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(AB,{anchor:"left",variant:"permanent","data-testid":"folders-drawer",PaperProps:{sx:CB},children:(0,e.jsx)(zB,{project:s,selectedFolder:u,files:b,quoteFiles:h,isDragging:t,folders:a,systemFolders:l,quoteFolders:c,modelingFolders:i,canCreateFolders:n,onFolderSelected:p,refreshFiles:x,isSalesUser:y})}),(0,e.jsx)(UB,{selectedFolder:u,project:s,selectedRoles:o,folders:a,setSelectedRoles:r,handleRoleSelect:j,onFolderSelected:p})]})},Ay=(t,n,s,o)=>{const r=(0,Ps.Bj)(n),a=(0,d.useRef)(s);a.current=s;const i=o.every(l=>l);(0,d.useEffect)(()=>{i&&t.forEach(l=>{r(a.current(l),{ifOlderThan:3*60})})},[t,r,i])},$B=()=>{const{project:t}=(0,De.B)(),{modelingFolders:n,quoteFolders:s}=Si(t?.id);Ay(n,"getModelingFiles",o=>({jiraKey:o.id?.toString(),projectId:t?.id}),[t?.id]),Ay(s,"getQuoteFiles",o=>({quoteId:o.id,projectId:t?.id}),[t?.id])},HB=()=>{const{user:t}=(0,Pt.A)(),{project:n,projectLoading:s}=(0,De.B)(),{createEvent:o}=(0,io.A)(),{userHasPermission:r}=(0,Ye.A)(),[a,i]=(0,d.useState)(!1);$B();const l=(0,$n.s)({tool:D.w5.DOCUMENTS,action:D.a2.VIEW_FILES,companyId:n?.companyId,projectId:n?.id},[n?.companyId,n?.id]);let c=r({tool:D.w5.DOCUMENTS,action:D.a2.MANAGE_FOLDERS,companyId:n?.companyId,projectId:n?.id});return(0,d.useEffect)(()=>{n&&o({content_type:"project",object_id:n.id,tool:"documents"})},[n,o]),(0,d.useEffect)(()=>{t&&!t.name&&i(!0)},[t]),l?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(ls,{showLoadingScreen:s}),(0,e.jsxs)(kn,{children:[t&&n&&(0,e.jsx)(vB,{user:t,project:n}),(0,e.jsx)(VB,{isDragging:!1,canCreateFolders:c}),(0,e.jsx)(L.Outlet,{})]}),(0,e.jsx)(eB,{open:a,onClose:()=>i(!1)})]}):null};var nd=m(41628);const QB=m.p+"aab5b8be647c9b88b7fa24da47f58e8d.svg",GB=m.p+"a24a18891c8dcf4cd630f32f8548c8e2.svg",Cy=m.p+"b40c1483bf518b22d5cc74ebaaea924c.svg",KB=m.p+"0f8659319430d26850356c36eda44acf.svg",YB=m.p+"b03ae6b9820871fadb00b2d93f47c853.svg",qB=({open:t,onClose:n,onConfirm:s,loading:o})=>(0,e.jsxs)(Ms.A,{open:t,onClose:n,PaperProps:{sx:{maxWidth:444}},children:[(0,e.jsx)(tr.A,{sx:{fontFamily:"Roboto",fontSize:20},children:"This document will be deleted"}),(0,e.jsx)(nr.A,{children:o?(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsx)(bt.A,{color:"error"})}):(0,e.jsx)(I.A,{sx:{fontFamily:"Roboto",lineHeight:"32px"},children:"Once you click \u201CDelete Forever\u201D this document will be gone forever. Are you sure?"})}),(0,e.jsxs)(Rr.A,{children:[(0,e.jsx)(K.A,{onClick:n,sx:{color:"#5D6062"},children:"Cancel"}),(0,e.jsx)(K.A,{onClick:s,color:"secondary",disabled:o,variant:"contained",sx:{backgroundColor:"#A50722"},children:"Delete Forever"})]})]}),XB=({open:t,onClose:n,onConfirm:s,loading:o,planName:r})=>{const[a,i]=(0,d.useState)(r);return(0,e.jsxs)(Ms.A,{open:t,onClose:n,fullWidth:!0,maxWidth:"sm",children:[(0,e.jsx)(tr.A,{sx:{fontFamily:"Roboto",fontSize:20},children:"Edit File Name"}),(0,e.jsx)(nr.A,{children:o?(0,e.jsx)("div",{style:{textAlign:"center"},children:(0,e.jsx)(bt.A,{color:"error"})}):(0,e.jsxs)(Be.A,{fullWidth:!0,children:[(0,e.jsx)(I.A,{sx:{fontFamily:"Roboto",fontSize:16,fontWeight:"bold"},children:"File Name"}),(0,e.jsx)(_.A,{value:a,onChange:l=>i(l.target.value),variant:"outlined"})]})}),(0,e.jsxs)(Rr.A,{children:[(0,e.jsx)(K.A,{onClick:n,sx:{color:"#5D6062"},children:"Cancel"}),(0,e.jsx)(K.A,{onClick:()=>s(a),color:"secondary",disabled:o,variant:"contained",sx:{backgroundColor:"#1D6BCD"},children:"Save"})]})]})},ha=(0,Wn.A)(Cn.A)`
  font-family: 'Roboto';
  font-size: 16px;
  font-weight: 400;
`,JB=({plan:t,permissions:n,folderType:s,folderId:o,isComponentDesignFolder:r=!1,color:a,disabled:i=!1})=>{const{project:l}=(0,De.B)(),{allRoles:c}=(0,Ye.A)(),u=(0,L.useNavigate)(),p=(0,L.useLocation)(),[f,h]=(0,d.useState)(!1),[b,x]=(0,d.useState)(!1),[v,y]=(0,d.useState)(!1),[j,A]=(0,d.useState)(null),w=!!j,{showSuccess:P,showError:C}=(0,Fe.d)(),{isFlagEnabled:k}=(0,ut.u)(),S=s===Sn.MODELING,R=s===Sn.QUOTE,B=(0,ct.EL)(c),T=!!t.isPublished,W=t?.isPrimary??!1,N=ge=>{A(ge.currentTarget)},O=()=>A(null),z=ge=>{ge.stopPropagation(),O()},[Q,{isLoading:re,error:ue,isSuccess:le}]=(0,Ps.EI)(),[F,{isLoading:V,error:$,isSuccess:ee}]=(0,Ps.eX)(),[X,{isLoading:G,error:Y,isSuccess:he}]=(0,Ps.$F)(),[ne,{isLoading:J}]=(0,Ps.l0)(),pe=ge=>{W||!l||(Q({planId:t.id,projectId:l?.id,fileName:t.displayName??""}),z(ge))},Ee=async()=>{if(!(!l||!S))try{O(),await ne({projectId:l.id,jiraKey:o.toString(),fileId:t.id,published:!T}).unwrap(),P({message:`File: ${t.displayName} successfully ${T?"unpublished":"published"}`})}catch{C({message:"Error publishing file"})}},Te=()=>{l&&F({projectId:l.id,projectExternalId:l.projectExternalId,entityId:t.entityId,entityType:t.entityType,fileName:t.displayName??""})},me=ge=>{if(l){if((0,nd.n8)(ge)){C({title:"File cannot be renamed.",message:`File name exceeds ${nd.nG} character limit.
Please try shortening the file name. `});return}if((0,nd.XO)(ge)){C({title:"File cannot be renamed.",message:'MyBLDR does not support files with special characters such as  / : \\ * ? " < > | in their name. Please rename again.'});return}X({fileName:t.displayName??"",newFileName:ge,projectId:l.id,projectExternalId:l.projectExternalId,entityId:t.entityId,entityType:t.entityType})}},$e=(ge,We="")=>(0,e.jsx)(Un.A,{children:(0,e.jsx)("img",{src:ge,alt:We})});(0,d.useEffect)(()=>{le&&P({message:`File: ${t.displayName} successfully marked as Primary Plan`}),ue&&C({message:"Error setting primary plan"})},[le,ue,t.displayName,C,P]),(0,d.useEffect)(()=>{ee&&P({message:`File: ${t.displayName} successfully deleted`}),$&&C({message:"Error deleting file"}),(ee||$)&&h(!1)},[ee,$,t.displayName,C,P,h]),(0,d.useEffect)(()=>{he&&P({message:"File successfully renamed"}),Y&&C({message:"Error renaming file"}),(he||Y)&&x(!1)},[he,Y,C,P]);const gt=k(D.SX.PUBLISH_MODEL_FILES)&&S&&cy(t)&&B,Rt=()=>R&&!B?!1:!S&&!(r&&cy(t)),rt=()=>R&&!B?!1:n.canRenameFile&&!S,Ue=()=>R&&!B?!1:n.canDeleteFile&&!S,lt=ge=>{const At=[...p.pathname.split("/").slice(0,-2),`viewmodel/${ge}`].join("/");u(At,{replace:!1})};return(0,e.jsxs)("span",{onClick:ge=>ge.stopPropagation(),children:[(0,e.jsx)(ls,{showLoadingScreen:J}),(0,e.jsx)(pt.A,{id:"long-button","aria-label":"more","aria-controls":w?"long-menu":void 0,"aria-expanded":w?"true":void 0,"aria-haspopup":"true",onClick:N,disabled:!n.canEditFile||i,"data-testid":"edit-plans-kebab",sx:{color:a,padding:"0px",pointerEvents:"all"},children:(0,e.jsx)(Zd.A,{})}),(0,e.jsxs)(Hn.A,{id:"kebab-menu",anchorEl:j,open:w,onClose:z,children:[gt&&(0,e.jsxs)(it.A,{onClick:()=>Ee(),children:[T?$e(YB,"Unpublish"):$e(KB,"Publish"),(0,e.jsx)(ha,{children:T?"Unpublish from Build Tab":"Publish to Build Tab"})]}),Rt()&&(0,e.jsxs)(it.A,{onClick:pe,children:[(0,e.jsxs)(ha,{sx:{color:W?"#124482":void 0},children:["Mark as Primary Plan",(0,e.jsx)(I.A,{sx:{fontSize:12,fontFamily:"Roboto",color:"#5D6062",fontStyle:"italic",marginTop:"4px"},children:"Primary set for previews and takeoffs"})]}),W&&(0,e.jsx)(Un.A,{sx:{justifyContent:"right"},children:(0,e.jsx)(Gd.A,{})})]}),(S?zu(t)!=="rvt":!0)&&(0,e.jsxs)(it.A,{href:t?.url,component:Rn.A,onClick:z,sx:{textAlign:"start"},children:[$e(GB,"Download"),(0,e.jsx)(ha,{children:"Download Original"})]}),S&&(0,e.jsxs)(it.A,{disabled:!S,onClick:()=>{O(),t?.derivativeId&&lt(t?.derivativeId)},children:[$e(Cy,"Edit"),(0,e.jsx)(ha,{children:"View Model"})]}),(rt()||Ue())&&(0,e.jsx)(Ce.A,{}),rt()&&(0,e.jsxs)(it.A,{onClick:()=>{x(!0),O()},children:[$e(Cy,"Edit"),(0,e.jsx)(ha,{children:"Edit Name"})]}),Ue()&&(0,e.jsxs)(it.A,{onClick:()=>{h(!0),O()},children:[$e(QB,"Delete"),(0,e.jsx)(ha,{children:"Delete"})]})]}),(0,e.jsx)(qB,{open:f,onClose:()=>{h(!1)},onConfirm:()=>Te(),loading:V}),(0,e.jsx)(XB,{open:b,loading:G,onClose:()=>x(!1),onConfirm:ge=>me(ge),planName:t.displayName??""})]})};var ZB=m(92542),e3=m(20194),t3=m(41325);const Sy=({text:t,color:n,backgroundColor:s,borderColor:o,icon:r})=>(0,e.jsxs)(E.A,{display:"flex",alignItems:"center","data-testid":"primary-plan-chip",sx:{padding:"4px",gap:"48x",borderRadius:"4px",backgroundColor:s,color:n,height:"24px",boxSizing:"border-box",border:"1px solid",borderColor:o||s},children:[r,(0,e.jsx)(I.A,{style:{color:n,fontSize:"12px",fontWeight:500,fontFamily:"Roboto",lineHeight:"16px"},children:t})]}),n3=({isPrimary:t,isPublished:n,isMarkedForMerge:s,isMerged:o,version:r})=>{const a=[];return t&&a.push({text:"Primary Plan",color:"#1858A8",backgroundColor:"#ECF3FC",borderColor:"#C7DCF7",icon:(0,e.jsx)(ZB.A,{sx:{color:"#1D6BCD",fontSize:"16px"}})}),n&&a.push({text:"Published",color:"#177802",backgroundColor:"#EDF5EB",borderColor:"#B8D9B1",icon:(0,e.jsx)(ki.A,{sx:{color:"#198402",fontSize:"16px"}})}),s&&a.push({text:"Waiting for merge",color:"#17181A",backgroundColor:"#F8F8F8",borderColor:"#E3E4E5",icon:(0,e.jsx)(e3.A,{sx:{color:"#75787B",fontSize:"16px"}})}),o&&a.push({text:"Merged",color:"#1858A8",backgroundColor:"#ECF3FC",borderColor:"#C7DCF7",icon:(0,e.jsx)(t3.A,{sx:{color:"#1D6BCD",fontSize:"16px"}})}),(0,e.jsxs)(E.A,{display:"flex",gap:"4px",sx:{position:"absolute",top:"8px",left:"8px",zIndex:1,width:"320px"},children:[a.map((i,l)=>(0,e.jsx)(Sy,{text:i.text,color:i.color,backgroundColor:i.backgroundColor,borderColor:i.borderColor,icon:i.icon},l)),(0,e.jsx)("div",{style:{marginLeft:"auto"},children:r&&(0,e.jsx)(Sy,{text:`V${r}`,backgroundColor:"#F8F8F8",borderColor:"#E3E4E5"})})]})},s3="SYSTEM",wy=({label:t,date:n,userName:s,color:o,backgroundColor:r})=>{const a=()=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Mr,{sx:{mb:".25rem",fontWeight:"bold"},children:`${t} by:`}),(0,e.jsxs)(Mr,{children:[s&&`${s}, `,Qo(n)]})]});return(0,e.jsxs)(Mr,{sx:{color:o,display:"flex",gap:".25rem",fontSize:".875rem"},children:[t,":"," ",(0,e.jsx)(E.A,{sx:{pointerEvents:"auto",cursor:"default"},children:(0,e.jsx)(qt.A,{title:a(),componentsProps:{tooltip:{sx:{backgroundColor:r}}},children:(0,e.jsx)(E.A,{component:"span",sx:{textDecoration:"underline",textDecorationStyle:"dotted"},children:Qo(n,!0)})})})]})},o3=({plan:t,projectId:n,companyId:s,plansPermissions:o,folderType:r,folderId:a,isComponentDesignFolder:i})=>{const[l,c]=(0,d.useState)(!1),u=(0,L.useNavigate)(),{isAppEmbedded:p}=Os(),f=r===Sn.MODELING,{plansName:h,displayName:b,createdAt:x,createdBy:v,isPrimary:y,isPublished:j,isMarkedForMerge:A,isMerged:w,agVersion:P,lastModifiedTime:C,lastModifiedBy:k}=t,S=t.streamingUrl!=null,{userHasPermission:R}=(0,Ye.A)();console.log("PlansCard",t);const B=le=>{let F=`/projects/${n}/documents/${le}`;r===Sn.QUOTE&&a&&(F+=`/${a}`),p&&(F+="?embedded=true"),u(F)},T=le=>{let F=`/projects/${n}/video/${le}`;r===Sn.QUOTE&&a&&(F+=`/${a}`),p&&(F+="?embedded=true"),u(F)},W=()=>{t.streamingUrl?T(t.id):B(t.id)},N=R({companyId:s,projectId:+n,tool:D.w5.DOCUMENTS,action:D.a2.MARKUP_FILES}),O=()=>[Sn.MODELING].includes(r)||!N&&!S?!0:!S&&(l||!(0,nd.zx)(b)),z=()=>l&&t.uuid!=="0"?{backgroundColor:"var(--graythorne-yellows-yellow-4)",color:"white"}:A?{backgroundColor:"#F1F2F2",color:"#B3B5B6"}:y?{backgroundColor:"var(--graythorne-blues-blue-4)",color:"white"}:j?{backgroundColor:"#125E01",color:"white"}:{backgroundColor:"var(--graythorne-grays-gray-4)",color:"white"},{backgroundColor:Q,color:re}=z(),ue=()=>f?(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:".5rem"},children:[x&&(0,e.jsx)(wy,{label:"Created",date:x,userName:v,color:re,backgroundColor:Q}),C&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Mr,{sx:{fontSize:".4rem",marginTop:"2px"},children:"\u25CF"}),(0,e.jsx)(wy,{label:"Updated",date:C,userName:k||"",color:re,backgroundColor:Q})]})]}):(0,e.jsxs)(e.Fragment,{children:[v&&v!==s3&&(0,e.jsxs)(Mr,{sx:{color:re},children:["Created by ",v]}),x&&(0,e.jsx)(Mr,{sx:{color:re},children:Qo(x)})]});return(0,e.jsxs)(bC,{onClick:()=>{O()||W()},"data-testid":"plans-card-paper",style:O()?{pointerEvents:"none",cursor:"none",overflow:"hidden"}:{overflow:"hidden"},children:[(0,e.jsx)(n3,{isPrimary:y,isPublished:j??!1,isMarkedForMerge:A??!1,isMerged:w??!1,version:P}),(0,e.jsx)(Ff,{plan:t,projectId:n,setError:c,error:l}),(0,e.jsxs)(AC,{style:{backgroundColor:Q},"data-testid":"plan-content-container",children:[(0,e.jsxs)(wC,{disableGutters:!0,children:[(0,e.jsx)(jC,{sx:{color:re},children:!l||t.uuid==="0"?b||h:"File processing..."}),(0,e.jsx)(JB,{plan:t,permissions:o,folderType:r,folderId:a,isComponentDesignFolder:i,color:re,disabled:A})]}),(0,e.jsx)(EC,{children:ue()})]})]})};m(55127);const r3=({plan:t,projectId:n,companyId:s,setDraggingId:o,isDragging:r,plansPermissions:a,folderType:i,folderId:l,draggable:c=!0,isComponentDesignFolder:u=!1})=>{const{userHasPermission:p}=(0,Ye.A)(),f=x=>{if(s===void 0){x.preventDefault();return}if(!p({tool:D.w5.DOCUMENTS,action:D.a2.MANAGE_FOLDERS,projectId:+n,companyId:+s})){x.preventDefault();return}o(t.id),x.dataTransfer.setData("text",`${t.id}`),b(x)},h=x=>{o(null)},b=x=>{const y=x.currentTarget.querySelector("img");if(y){const j=y.cloneNode();j.style.position="fixed",j.style.width="142px",j.style.height="104px",document.body.appendChild(j),x.dataTransfer.setDragImage(j,0,0)}};return(0,e.jsx)(vC,{draggable:c?"true":"false",onDragStart:f,onDragEnd:h,className:r?"dragging-container":"",children:s&&(0,e.jsx)(o3,{plan:t,projectId:n,companyId:+s,plansPermissions:a,folderType:i,folderId:l,isComponentDesignFolder:u})})};var a3=m(31007);const i3=(t,n,s)=>{const{showError:o,showSuccess:r}=(0,Fe.d)(),a=n?.folderType===Sn.MODELING,{refetch:i}=za(t?.id,n?.id.toString(),!a),[l,c]=(0,d.useState)({}),[u,p]=(0,d.useState)(null),[f,h]=(0,d.useState)(!1),b=(0,d.useCallback)(w=>w.reduce((k,S)=>k+S.size,0)>6442450944?(o({message:"Size of uploaded files exceeds max limit of 6GB"}),!1):!0,[o]),x=(0,d.useCallback)((w,P)=>{const C=w.loaded/w.total*100;c(k=>({...k,[P.name]:C}))},[]),v=(0,d.useCallback)(async w=>{const P=`/api/modeling_file/upload/${n?.id}`;try{p(null),h(!0),b(w)&&(await nt.Ay.post(P,w,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:C=>x(C,w[0])}),i())}catch(C){console.error(C),p("Error uploading to modeling files")}finally{h(!1),c({})}},[i,n,b,x]),y=(0,d.useCallback)(async(w,P)=>{const C=w.uploadUrl,k=P.get(w.fileName);if(k)try{const S={"Content-Type":"application/octet-stream",Authorization:`Bearer ${w.token}`},R=await k.arrayBuffer(),B=await jc().post(C,R,{headers:S,onUploadProgress:N=>x(N,k)}),T=B?.data?.data?.id,W=n?.id.toString();return T&&await nt.Ay.post(`/api/modeling_file/set_user_info/${W}`,{fileIds:[T]}),r({message:`Successfully uploaded File: ${k.name}`}),B}catch{o({message:`Failed to upload File: ${k.name}`})}},[x,o,r]),j=(0,d.useCallback)(async w=>{try{p(null),h(!0);const P=`/api/modeling_file/upload/${n?.id}/bucket`,C={files:w.map(T=>T.name)},k=await nt.Ay.post(P,C),S=(0,Ze.bn)(k.data),R=new Map;w.forEach(T=>{R.set(T.name,T)});const B=S.map(T=>y(T,R));await Promise.all(B),i()}catch{p("Error uploading to modeling files")}finally{h(!1),c({})}},[i,n,y]),A=()=>{const w=Object.values(l).length;return w===0?0:Object.values(l).reduce((P,C)=>P+C,0)/w};return(0,d.useEffect)(()=>{u&&o({message:u})},[u,o]),{uploading:f,progress:A(),uploadModelFiles:j,error:u}};var l3=m(42634);const Qu=({project:t,selectedFolder:n,plans:s,draggedFileId:o,setDraggedFileId:r,isSystemFolder:a,plansClassName:i})=>{const{uploading:l,progress:c,uploadFiles:u}=(0,a3.A)(),{uploading:p,progress:f,uploadModelFiles:h}=i3(t,n,s),{userHasPermission:b,allRoles:x}=(0,Ye.A)(),v=(0,ct.EL)(x),y=D.w5.DOCUMENTS,A=(()=>{const R=b({tool:y,action:D.a2.UPLOAD_FILES,companyId:t.companyId,projectId:t.id});return n.folderType===Sn.QUOTE?v&&R:R})(),w={canRenameFile:b({tool:y,action:D.a2.EDIT_FILES,companyId:t.companyId,projectId:t.id}),canDeleteFile:b({tool:y,action:D.a2.DELETE_FILES,companyId:t.companyId,projectId:t.id}),canEditFile:b({tool:y,action:D.a2.EDIT_FILES,companyId:t.companyId,projectId:t.id})},P=async R=>{if(n&&!$u(n,n)){const B=n.folderType===Sn.QUOTE,T=B?n.id:void 0,W=B?l3.c.QUOTE:void 0;await u(R,n.id,a,T?.toString(),W)}else await h(R)},C=()=>n.folderType===Sn.QUOTE?v:!$u(n,n),k=l||p,S=l?c:f;return(0,e.jsxs)(Tg,{uploadFiles:P,project:t,enabled:A,children:[(0,e.jsx)(ls,{showLoadingScreen:p}),(0,e.jsx)(oB,{"data-testid":"plans-box",className:i,children:(0,e.jsxs)(nB,{plansCount:s.length,children:[s.map(R=>(0,e.jsx)(r3,{plan:R,projectId:`${t.id}`,companyId:`${t.companyId}`,isDragging:o===R.id,setDraggingId:r,plansPermissions:w,draggable:C(),folderType:n.folderType,folderId:n.id,isComponentDesignFolder:dy(n)},R.id)),A&&(0,e.jsx)(sB,{children:k?(0,e.jsx)(bk,{progress:S}):(0,e.jsx)(Rg,{onClickSelect:R=>{const B=R?.target?.files;B&&P(Array.from(B))}})})]})})]})},d3=(t,n)=>{const{files:s,filesLoading:o,refreshFiles:r}=(0,Zl.e)(n);return{folderFiles:(0,d.useMemo)(()=>{if(!s||!t)return[];const i=t.folderType===Sn.SYSTEM;return s.filter(l=>l.isSystemFolder===i&&l.folderId===t.id&&!(Vu(l,"json")&&t.name==="BFS Only"&&i))},[s,t]),filesLoading:o,refreshFiles:r}},Gu=()=>{const{project:t}=(0,De.B)(),{foldersLoading:n}=Si(t?.id),{selectedFolder:s}=ma({redirectOnNotFound:!0}),{folderFiles:o,filesLoading:r}=d3(s,t?.id);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ls,{showLoadingScreen:n||r}),(0,e.jsx)(Uu,{children:s&&t&&(0,e.jsx)(Qu,{project:t,selectedFolder:s,plans:o,draggedFileId:null,setDraggedFileId:()=>{},isSystemFolder:s.folderType===Sn.SYSTEM})})]})},c3=(t,n,s=2)=>{const[o,r]=(0,d.useState)(!1),[a,i]=(0,d.useState)(0),[l]=(0,Ps.hu)(),{data:c,refetch:u}=za(t?.id,n),f=(c?.filter(h=>Hu(h)&&h.isMarkedForMerge)??[]).length>0;f&&a<=s&&!o?r(!0):(!f||a>s)&&o&&r(!1),(0,d.useEffect)(()=>{const h=async()=>{try{(await l({projectId:t?.id,jiraKey:n}).unwrap())?.length>0||u()}catch(x){console.error("Error fetching model file refresh",x)}finally{i(x=>x+1)}};let b;return o&&a<=s&&(b=setTimeout(()=>{h()},1e3*60*3)),()=>{b&&clearTimeout(b)}},[c,o,u,l,t?.id,n,a,s])},u3=({fileSelections:t,toggleSelection:n,disabled:s})=>(0,e.jsxs)(ra.A,{size:"small",sx:{"& th":{padding:"12px 8px",lineHeight:"20px"},"& td":{padding:"12px 8px",lineHeight:"20px"}},children:[(0,e.jsx)(di.A,{children:(0,e.jsxs)(Zn.A,{children:[(0,e.jsx)(xt.A,{children:"File"}),(0,e.jsx)(xt.A,{children:"Name"}),(0,e.jsx)(xt.A,{sx:{minWidth:"200px"}})]})}),t.map(o=>(0,e.jsxs)(Zn.A,{sx:{"& td":{borderBottom:"none"}},children:[(0,e.jsx)(xt.A,{children:o.plansName}),(0,e.jsx)(xt.A,{children:o.createdBy}),(0,e.jsx)(xt.A,{sx:{textAlign:"right",paddingRight:0},children:t.length>1&&(0,e.jsx)(ve.A,{checked:o.merge,onChange:()=>n(o),disabled:s})})]}))]}),p3=rs(({ifcFiles:t,rvtFiles:n,mergeLoading:s,mergeFiles:o,open:r,onClose:a})=>{const i=(0,d.useMemo)(()=>{const x=y=>(ed(y)?n:t).length===1?!0:y.isMerged??!1,v=y=>y.map(j=>({id:j.id,plansName:j.plansName,createdBy:j.createdBy,merge:x(j),isRvt:ed(j)}));return[...v(n),...v(t)]},[t,n]),l=(0,Ds.Wx)({enableReinitialize:!0,initialValues:i,onSubmit:async x=>{await o(x.filter(v=>v.merge).map(v=>v.id))}}),c=x=>{const v=[...l.values],y=v.find(j=>j.id===x.id);y.merge=!y.merge,y.isRvt&&y.merge&&v.filter(j=>j.isRvt&&j.id!==y.id).forEach(j=>j.merge=!1),l.setValues(v)},u=l.values.filter(x=>x.merge&&!x.isRvt),p=l.values.filter(x=>x.merge&&x.isRvt),f=()=>(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"16px",maxWidth:"650px"},children:[(0,e.jsx)(I.A,{variant:"body1",children:"A Revit file must be selected along with any IFCs to be included in the merge process. Only one Revit file can be selected per merge request. All selected IFCs will be merged with the selected Revit file."}),(0,e.jsx)(u3,{fileSelections:l.values,toggleSelection:c,disabled:!1})]}),h=()=>[{title:"Merge Files",disabled:u.length===0||p.length===0,onClick:l.submitForm}],b=()=>{if(t.length===1)return null;const x=u.length+p.length;return(0,e.jsx)(I.A,{variant:"body1",color:x>0?"primary":"secondary",children:`${x} ${x!==1?"Files":"File"} Selected`})};return(0,e.jsx)(Zt,{title:"Merge IFC files into Revit file",open:r,onClose:a,content:f(),actions:h(),infoElement:b(),maxWidth:"md",hideCancel:s})}),m3=({files:t,project:n,folder:s})=>{const{showError:o}=(0,Fe.d)(),{mergeIFC:r,toggleMergeIFC:a,mergeModelingFiles:i,mergeStatus:l}=uy(n);c3(n,s.id.toString());const c=t.filter(f=>Hu(f)),u=t.filter(f=>ed(f)),p=async f=>{try{await i({projectId:n.id,fileIds:f,jiraKey:s.id.toString()}).unwrap()}catch{o({message:"Files could not be merged at this time, please try again later."})}finally{a(!1)}};return(0,e.jsx)(is,{children:(0,e.jsx)(p3,{open:r,ifcFiles:c,rvtFiles:u,mergeLoading:l.isLoading,mergeFiles:p,onClose:()=>a(!1)})})},h3=()=>{const{user:t}=(0,Pt.A)(),{project:n}=(0,De.B)(),{showError:s}=(0,Fe.d)(),{selectedFolder:o}=ma({redirectOnNotFound:!0}),{data:r,isLoading:a,error:i}=za(n?.id,o?.id.toString());return(0,d.useEffect)(()=>{i&&s({message:"Failed to fetch Modeling Files"})},[i,s]),!o||!t||!n?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ls,{showLoadingScreen:a}),(0,e.jsxs)(Uu,{children:[(0,e.jsx)(Qu,{project:n,selectedFolder:o,plans:r??[],draggedFileId:null,setDraggedFileId:()=>{},isSystemFolder:o.folderType===Sn.SYSTEM}),n&&r&&(0,e.jsx)(m3,{files:r,project:n,folder:o})]})]})},g3=()=>{const{user:t}=(0,Pt.A)(),{project:n}=(0,De.B)(),{showError:s}=(0,Fe.d)(),{selectedFolder:o}=ma({redirectOnNotFound:!0}),{files:r,isLoading:a,error:i}=pi(n?.id,o?.id);return(0,d.useEffect)(()=>{i&&s({message:"Failed to fetch Modeling Files"})},[i,s]),!o||!t||!n?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ls,{showLoadingScreen:a}),(0,e.jsx)(Uu,{children:(0,e.jsx)(Qu,{project:n,selectedFolder:o,plans:r??[],draggedFileId:null,setDraggedFileId:()=>{},isSystemFolder:o.folderType===Sn.SYSTEM})})]})};var Ku=m(79003),f3=m(63593),x3=m(27603),y3=m(70765),b3=m(78998),v3=m(28322);const Yu=()=>{const{showError:t}=(0,Fe.d)(),n=async(a,i)=>{console.log("useFileUploader - BEFORE PUT REQUEST");const l={"Content-Type":a.type,"x-ms-version":"2019-12-12","x-ms-blob-type":"BlockBlob"};console.log("useFileUploader - Headers being set:",l);const c=await nt.v3.put(i,a,{headers:l});return console.log("useFileUploader - Request completed"),c};return{uploadAvatar:async(a,i,l)=>{try{const c=await nt.Ay.post(`/budget/v2/company/${i}/vendors/${l}/create_file`,{fileName:a.name,isAvatar:!0}),u=n(a,c.data.uploadUrl);return!0}catch(c){return console.log(c),t({title:"Upload Failed",message:"There was an error uploading your avatar. Please try again."}),!1}},uploadDocument:async(a,i,l)=>{try{const c=await nt.Ay.post(`/budget/v2/company/${i}/vendors/${l}/create_file`,{fileName:a.name,isAvatar:!1}),u=n(a,c.data.uploadUrl);return!0}catch(c){return console.log(c),t({title:"Upload Failed",message:"There was an error uploading your document. Please try again."}),!1}},uploadFileToUploadURL:n,deleteFile:async(a,i,l)=>{try{return await nt.Ay.post(`/budget/v2/company/${i}/vendors/${l}/delete_files`,{fileIds:a}),!0}catch(c){return console.log(c),t({title:"Delete Failed",message:"There was an error deleting your document. Please try again."}),!1}}}};var j3=m(70977),A3=m.n(j3),C3=m(69486),Ey=m(52381);const Py=.8,Iy=2,S3=.01,Dy=.1,ky=({onChange:t,children:n})=>(0,e.jsxs)(E.A,{component:"label",htmlFor:"vendor-avatar",sx:{cursor:"pointer"},children:[(0,e.jsx)("input",{type:"file",id:"vendor-avatar",accept:"image/*",onChange:s=>{const o=s.target.files?.[0];if(o){const r=new FileReader;r.onload=()=>{r.result&&t({file:o,dataUrl:r.result.toString()})},r.readAsDataURL(o)}},style:{display:"none"}}),n]}),w3=rs(({open:t,onClose:n,vendor:s})=>{const[o,r]=(0,d.useState)(),[a,i]=(0,d.useState)(1),[l,c]=(0,d.useState)(!1),u=(0,d.useRef)(null),{company:p}=(0,je.P)(),{uploadAvatar:f,deleteFile:h}=Yu(),{refetch:b}=(0,Me.T5)({company:p?.id},{skip:!p}),x=(0,Fe.d)(),v=(0,d.useMemo)(()=>s.vendorFiles?.find(C=>C.isAvatar),[s]),y=o?.dataUrl||v?.url,j=C=>{c(!0),r(C)},A=()=>new Promise(C=>setTimeout(async()=>{try{await b(),n()}finally{C(),r(null)}},2500)),w=async()=>{if(!v?.id){x.showError({message:"No avatar exists"});return}if(!await h([v.id],p?.id,s.id)){x.showError({message:"Failed to delete avatar"});return}await A()},P=async()=>{const C=await new Promise(S=>u.current?.getImage().toBlob(S,"image/jpeg",1));if(!C){x.showError({message:"Failed to render image"});return}if(!await f(new File([C],o?.file.name||v?.fileName||"avatar.jpg"),p?.id,s.id)){x.showError({message:"Failed to upload avatar"});return}await A()};return(0,e.jsx)(Zt,{onClose:n,open:t,hideCancel:!0,title:"Edit Vendor Avatar",content:(0,e.jsxs)(E.A,{sx:{width:320,gap:"20px",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,e.jsx)(er.A,{invisible:!y,overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:(0,e.jsx)(ky,{onChange:j,children:(0,e.jsx)(pa,{size:40,icon:Ey.A,sx:{"&:hover":{filter:"brightness(70%)"}}})}),children:y?(0,e.jsx)(pa,{size:160,sx:{bgcolor:"black"},children:(0,e.jsx)(A3(),{crossOrigin:"Anonymous",backgroundColor:"red",ref:u,image:y,width:160,height:160,borderRadius:180,scale:a,onImageChange:()=>c(!0)})}):(0,e.jsx)(ky,{onChange:j,children:(0,e.jsx)(pa,{src:y,size:160,icon:Ey.A,sx:{"&:hover":{filter:"brightness(70%)"}}})})}),(0,e.jsxs)(E.A,{sx:{width:"100%",display:"flex",alignItems:"center",gap:"8px",paddingX:"20px",boxSizing:"border-box"},children:[(0,e.jsx)(hl.A,{sx:{cursor:"pointer"},onClick:()=>i(Math.max(a-Dy,Py))}),(0,e.jsx)(C3.Ay,{sx:{flex:1},min:Py,step:S3,max:Iy,value:a,onChange:(C,k)=>i(Number(k))}),(0,e.jsx)(pr.A,{sx:{cursor:"pointer"},onClick:()=>i(Math.min(a+Dy,Iy))})]})]}),actions:[{title:"Remove",disabled:!v,onClick:w,variant:"text",color:"error",sx:{mr:"auto"}},{title:"Save",disabled:!l,onClick:P}]})}),E3=({onDeleteClick:t})=>(0,d.useMemo)(()=>[{field:"name",headerName:"Name",type:"string",flex:1,minWidth:100,editable:!0},{field:"email",headerName:"Email",type:"string",flex:1,minWidth:100,editable:!0},{field:"phone",headerName:"Phone Number",type:"string",flex:1,minWidth:100,editable:!0},{field:"actions",width:50,type:"actions",getActions:({row:n})=>{const{isModalOpen:s,openModal:o,closeModal:r}=ln();return[(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Is.A,{}),label:"Delete",onClick:()=>{"id"in n?o():t(n)}}),(0,e.jsx)(Zt,{open:s,onClose:r,title:"Delete Crew Member",content:"They will also lose access to all Purchase Orders that have been sent to this vendor; however, they will continue to be able to view projects they have been invited to. Are you sure you want to continue?",actions:[{title:"Delete Crew Member",color:"error",onClick:()=>{t(n),r()}}]})]})]}}],[t]),P3=t=>t.indexId,I3=({rows:t,onProcessRowUpdate:n,onDeleteClick:s})=>{const o=E3({onDeleteClick:s});return(0,e.jsx)(Jn,{getRowId:P3,columns:o,rows:t,hideFooter:!0,processRowUpdate:n})},qu=t=>{const{children:n,value:s,index:o}=t;return(0,e.jsx)(E.A,{role:"tabpanel",hidden:s!==o,sx:{overflowY:"auto",overflowX:"hidden"},children:s===o&&(0,e.jsx)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"24px",paddingY:"16px"},children:n})})},Ty=({children:t})=>(0,e.jsx)(E.A,{sx:n=>({display:"grid",gridTemplateColumns:"max-content max-content 1fr",gridAutoRows:"36px",alignItems:"center",rowGap:"16px",columnGap:"6px",color:n.palette.text.secondary}),children:t}),To=({icon:t=(0,e.jsx)("div",{}),label:n,input:s})=>(0,e.jsxs)(e.Fragment,{children:[t,(0,e.jsx)(I.A,{sx:{paddingRight:"16px"},children:n}),s]}),D3=({open:t,onReset:n,onSubmit:s})=>(0,e.jsx)(Zt,{open:t,onClose:n,title:"Are you sure?",content:"Deleting this category will remove it from all vendors. This cannot be undone.",actions:[{title:"Delete",color:"error",onClick:s}]}),k3=({open:t,onProceed:n,onReset:s,onSubmit:o})=>(0,e.jsx)(Zt,{open:t,onClose:s,hideCancel:!0,title:"Continue Without Saving?",content:"Closing or navigating away from this vendor without saving will discard any changes you made. This cannot be undone.",actions:[{title:"Continue Without Saving",variant:"text",color:"secondary",onClick:n},{title:"Save",color:"primary",onClick:o}]}),mo=["information","purchase-orders","documents"],T3=({vendor:t,refetchVendors:n,onDocumentUpload:s,deleteFile:o})=>{const[r,a]=(0,d.useState)(!1),{company:i}=(0,je.P)(),{isModalOpen:l,openModal:c,closeModal:u}=ln(),{data:p=[],refetch:f}=(0,Me.aL)({company:i?.id},{skip:!i,refetchOnMountOrArgChange:!0}),[h]=(0,Me.WF)(),[b]=(0,Me.Zw)(),x=(0,L.useNavigate)(),v=(0,Fe.d)(),{tab:y=mo[0]}=(0,L.useParams)(),[j,A]=(0,d.useState)(!1),[w,P]=(0,d.useState)(!1),[C,k]=(0,d.useState)(null),[S,R]=(0,d.useState)(!1),[B,T]=(0,d.useState)(!1),[W,N]=(0,d.useState)([]),[O,z]=(0,d.useState)(null),[Q,re]=(0,d.useState)(!1),ue=(0,d.useRef)(null),le=!!C,F=(0,Ds.Wx)({enableReinitialize:!0,initialValues:{name:t.name,categories:t.categories??[],addressOne:t.addressOne??"",addressTwo:t.addressTwo??"",city:t.city??"",state:t.state??"",zipCode:t.zipCode??"",email:t.email??"",phone:t.phone??"",fax:t.fax??"",notes:t.notes??"",purchaseOrderRecipientEmail:t.purchaseOrderRecipientEmail??"",vendorFiles:t.vendorFiles??[],vendorCrewMembers:t.vendorCrewMembers},validateOnChange:!1,validateOnBlur:!1,validateOnMount:!1,onSubmit:async({name:J,categories:pe,addressOne:Ee,addressTwo:Te,city:me,state:$e,zipCode:gt,email:Rt,phone:rt,fax:Ue,notes:lt,purchaseOrderRecipientEmail:ge,vendorCrewMembers:We},{resetForm:At,setFieldError:xn})=>{const on=await he({company:t.company,id:t?.id,name:J??t?.name,categories:pe,addressOne:Ee,addressTwo:Te,city:me,state:$e,zipCode:gt,email:Rt,phone:rt,fax:Ue,notes:lt,purchaseOrderRecipientEmail:ge,vendorFiles:F.values.vendorFiles,vendorCrewMembers:We});if("error"in on){const Xe=on.error;Xe.status===400?Object.entries(Xe.data).forEach(([dt,Tn])=>{dt==="vendorCrewMembers"&&Tn?Tn.forEach((In,Ct)=>{Object.entries(In).forEach(([Mt,Pe])=>{v.showError({message:`Vendor Crew Member ${Ct+1}: ${Pe.join(" ")}`})})}):xn(dt,Tn.join(" "))}):v.showError({message:fn(on)})}else A(!1),At()}}),V=async J=>{await h(J),z(null),k(null),n(),f()},{uploadDocument:$}=Yu(),ee=async J=>{try{if(re(!0),J.length>0&&i?.id){const pe=J.map(Te=>$(Te,i.id,t.id));(await Promise.all(pe)).some(Te=>Te)&&await s()}}finally{re(!1)}},X=(0,d.useCallback)(J=>{const pe=t.vendorCrewMembers.find(({id:Ee})=>Ee===J.id);F.setFieldValue(`vendorCrewMembers.${J.indexId}`,{...pe,deleted:!0})},[t,F]),G=(0,d.useCallback)(J=>{F.setFieldValue("vendorCrewMembers",F.values.vendorCrewMembers.filter((pe,Ee)=>Ee!==J.indexId))},[F]),Y=(t.vendorFiles?.filter(J=>!J.isAvatar)||[]).sort((J,pe)=>J.fileName.localeCompare(pe.fileName)).map(J=>({id:J.id,name:J.fileName,url:J.url}));(0,d.useEffect)(()=>{f(),A(!t.name),R(!1),N(p)},[t,p]);const[he]=(0,Me.KA)(),ne=(0,d.useMemo)(()=>F.values.vendorCrewMembers.map((J,pe)=>({indexId:pe,...J})).filter(({deleted:J})=>!J),[F.values.vendorCrewMembers]);return(0,e.jsxs)(E.A,{onSubmit:F.handleSubmit,component:"form",sx:{position:"relative",height:"100%",display:"flex",padding:"24px 24px 53px 24px",flexDirection:"column",gap:"24px",boxSizing:"border-box"},children:[(0,e.jsx)(qc,{shouldBlockNavigation:F.dirty,message:"You have made edits to your Vendor. Would you like to save the changes before leaving this page?",handleSaveChanges:F.handleSubmit,handleProceed:F.resetForm,component:k3}),(0,e.jsx)(pt.A,{"aria-label":"close",onClick:()=>x(`/companies/${i?.id}/profile/vendor_management`),sx:{position:"absolute",right:8,top:8,color:"black"},children:(0,e.jsx)(Ss.A,{})}),(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:"16px"},children:[(0,e.jsxs)(E.A,{children:[(0,e.jsx)(er.A,{invisible:!r,overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:(0,e.jsx)(pa,{size:32,sx:{pointerEvents:"none","&:hover":{filter:"brightness(70%)"}},children:(0,e.jsx)(Ku.A,{sx:{fontSize:20,color:"text.secondary"}})}),children:(0,e.jsx)(pa,{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),onClick:c,src:t.vendorFiles?.find(J=>J.isAvatar)?.url,size:72,sx:{cursor:"pointer"}})}),(0,e.jsx)(w3,{vendor:t,open:l,onClose:u})]}),(0,e.jsxs)(E.A,{children:[j?(0,e.jsx)(_.A,{variant:"standard",placeholder:"Enter Vendor Name",name:"name",required:!0,autoFocus:!0,value:F.values.name,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.name&&!!F.errors.name,helperText:F.touched.name&&F.errors.name,InputProps:{disableUnderline:!0,sx:J=>({...J.typography.h3,fontWeight:J.typography.fontWeightMedium})}}):(0,e.jsxs)(E.A,{onClick:()=>A(!0),sx:{display:"flex",width:"100%",alignItems:"center",gap:"8px",cursor:"pointer",paddingY:"7px","&:hover":{"& > :last-child":{visibility:"visible"}}},children:[(0,e.jsx)(I.A,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},variant:"h3",fontWeight:"medium",children:t.name}),(0,e.jsx)(Ku.A,{sx:{visibility:"hidden"}})]}),(0,e.jsx)(E.A,{children:S?(0,e.jsx)(Gn.A,{multiple:!0,freeSolo:!0,clearOnBlur:!0,onFocus:()=>P(!0),open:w,id:"vendor-categories",disableCloseOnSelect:!0,value:F.values.categories,getOptionLabel:J=>J.name,options:W,clearIcon:null,isOptionEqualToValue:(J,pe)=>J.name===pe.name,renderOption:(J,pe)=>{const{key:Ee,...Te}=J;return(0,e.jsx)(E.A,{...Te,children:(0,e.jsxs)(E.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,e.jsx)(to,{label:pe.name,color:"warning",shape:"square",size:"small"}),(0,e.jsxs)(E.A,{onClick:me=>{me.preventDefault(),me.stopPropagation()},children:[pe.id&&(0,e.jsx)(pt.A,{id:`category-${pe.name}-menu`,"aria-controls":le?"categories-menu":void 0,"aria-expanded":le?"true":void 0,"aria-haspopup":"true",onClick:me=>{me.preventDefault(),me.stopPropagation(),z(pe),k(me.currentTarget)},children:(0,e.jsx)(Zd.A,{})}),(0,e.jsx)(Hn.A,{id:"categories-menu",elevation:1,anchorEl:C,open:le&&w,onClose:()=>{k(null),z(null),ue.current&&(ue.current.focus(),setTimeout(()=>{P(!0)},0))},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:(0,e.jsx)(it.A,{onClick:()=>T(!0),children:"Delete"})}),(0,e.jsx)(D3,{open:B&&O?.id===pe.id,onReset:()=>T(!1),onSubmit:()=>V(pe)})]})]})},Ee)},renderInput:J=>(0,e.jsx)(_.A,{inputRef:ue,...J,size:"small",placeholder:"Start typing to add a category"}),renderTags:(J,pe)=>J.map((Ee,Te)=>{const{key:me}=pe({index:Te});return(0,e.jsx)(to,{label:Ee.name,color:"warning",shape:"square",size:"small",sx:Te>0?{marginLeft:".25rem"}:{}},me)}),onChange:async(J,pe)=>{const Ee=[];for(const Te of pe)if(typeof Te=="string"){const me=await b({company:i?.id,name:Te}).unwrap();Ee.push(me)}else Ee.push(Te);F.setFieldValue("categories",Ee)},onBlur:()=>{O||(R(!1),P(!1))}}):(0,e.jsxs)(E.A,{onClick:()=>{R(!0),ue.current.focus()},sx:{cursor:"pointer"},children:[!t.categories?.length&&(0,e.jsx)(I.A,{fontWeight:"small",color:"secondary",sx:{marginBottom:"6px"},children:"Add New Categories"}),F.values.categories?.map(J=>(0,e.jsx)(to,{label:J.name,color:"warning",shape:"square",size:"small",sx:{marginRight:".25rem"}},J.id))]})})]})]}),(0,e.jsxs)(E.A,{sx:{overflow:"hidden",height:"100%",display:"flex",flexDirection:"column"},children:[(0,e.jsx)(E.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,e.jsxs)(ir.A,{value:y,children:[(0,e.jsx)(Po.A,{value:mo[0],component:L.Link,to:`/companies/${i?.id}/profile/vendor_management/${t.id}/${mo[0]}`,label:"Information"}),(0,e.jsx)(Po.A,{value:mo[1],component:L.Link,to:`/companies/${i?.id}/profile/vendor_management/${t.id}/${mo[1]}`,label:"Purchase Orders"}),(0,e.jsx)(Po.A,{value:mo[2],component:L.Link,to:`/companies/${i?.id}/profile/vendor_management/${t.id}/${mo[2]}`,label:Y.length?`Documents (${Y.length})`:"Documents"})]})}),(0,e.jsxs)(qu,{value:y,index:mo[0],children:[(0,e.jsxs)(Ty,{children:[(0,e.jsx)(To,{label:"Address",icon:(0,e.jsx)(f3.A,{}),input:(0,e.jsx)(_.A,{variant:"standard",placeholder:"Number and Street",name:"addressOne",value:F.values.addressOne,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.addressOne&&!!F.errors.addressOne,helperText:F.touched.addressOne&&F.errors.addressOne,InputProps:{disableUnderline:!0}})}),(0,e.jsx)(To,{label:"Address 2",input:(0,e.jsx)(_.A,{variant:"standard",placeholder:"Unit Number, PO Box, etc.",name:"addressTwo",value:F.values.addressTwo,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.addressTwo&&!!F.errors.addressTwo,helperText:F.touched.addressTwo&&F.errors.addressTwo,InputProps:{disableUnderline:!0}})}),(0,e.jsx)(To,{label:"City",input:(0,e.jsx)(_.A,{variant:"standard",name:"city",placeholder:"e.g. Irving",value:F.values.city,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.city&&!!F.errors.city,helperText:F.touched.city&&F.errors.city,InputProps:{disableUnderline:!0}})}),(0,e.jsx)(To,{label:"State",input:(0,e.jsx)(Gn.A,{renderInput:J=>(0,e.jsx)(_.A,{...J,variant:"standard",name:"state",placeholder:"AL",error:F.touched.state&&!!F.errors.state,helperText:F.touched.state&&F.errors.state,InputProps:{...J.InputProps,disableUnderline:!0}}),options:_i,value:F.values.state,onChange:(J,pe)=>{F.setFieldValue("state",pe)}})}),(0,e.jsx)(To,{label:"Zip",input:(0,e.jsx)(_.A,{variant:"standard",name:"zipCode",placeholder:"00000",value:F.values.zipCode,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.zipCode&&!!F.errors.zipCode,helperText:F.touched.zipCode&&F.errors.zipCode,InputProps:{disableUnderline:!0}})}),(0,e.jsx)(To,{label:"Email",icon:(0,e.jsx)(x3.A,{}),input:(0,e.jsx)(_.A,{variant:"standard",type:"email",name:"email",placeholder:"e.g. example@example.com",value:F.values.email,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.email&&!!F.errors.email,helperText:F.touched.email&&F.errors.email,InputProps:{disableUnderline:!0}})}),(0,e.jsx)(To,{label:"Phone Number",icon:(0,e.jsx)(y3.A,{}),input:(0,e.jsx)(_.A,{variant:"standard",name:"phone",type:"tel",placeholder:"e.g. (555) 000-1234",value:F.values.phone,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.phone&&!!F.errors.phone,helperText:F.touched.phone&&F.errors.phone,InputProps:{disableUnderline:!0}})}),(0,e.jsx)(To,{label:"Fax Number",icon:(0,e.jsx)(b3.A,{}),input:(0,e.jsx)(_.A,{variant:"standard",name:"fax",type:"tel",placeholder:"e.g. (555) 000-1234",value:F.values.fax,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.fax&&!!F.errors.fax,helperText:F.touched.fax&&F.errors.fax,InputProps:{disableUnderline:!0}})})]}),(0,e.jsxs)(E.A,{children:[(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"6px"},children:[(0,e.jsx)(I.A,{fontWeight:"medium",children:"Vendor Crew"}),(0,e.jsx)(sn,{variant:"text",startIcon:(0,e.jsx)(pr.A,{}),onClick:()=>{F.setFieldValue("vendorCrewMembers",[...F.values.vendorCrewMembers,{name:"",email:"",phone:""}])},children:"Add Crew Member"})]}),(0,e.jsx)(I3,{rows:ne,onDeleteClick:J=>{"id"in J?X(J):G(J)},onProcessRowUpdate:J=>{F.setFieldValue(`vendorCrewMembers.${J.indexId}`,J)}})]}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{fontWeight:"medium",sx:{marginBottom:"6px"},children:"Notes"}),(0,e.jsx)(_.A,{multiline:!0,fullWidth:!0,variant:"outlined",minRows:5,name:"notes",placeholder:"Call before deliveries, forward purchase order to primary contact email, etc.",value:F.values.notes,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.notes&&!!F.errors.notes,helperText:F.touched.notes&&F.errors.notes})]})]}),(0,e.jsx)(qu,{value:y,index:mo[1],children:(0,e.jsx)(Ty,{children:(0,e.jsx)(To,{label:"Send Purchase Orders to:",icon:(0,e.jsx)(v3.A,{}),input:(0,e.jsx)(_.A,{variant:"standard",type:"email",name:"purchaseOrderRecipientEmail",placeholder:"e.g. example@example.com",value:F.values.purchaseOrderRecipientEmail,onChange:F.handleChange,onBlur:F.handleBlur,error:F.touched.purchaseOrderRecipientEmail&&!!F.errors.purchaseOrderRecipientEmail,helperText:F.touched.purchaseOrderRecipientEmail&&F.errors.purchaseOrderRecipientEmail,InputProps:{disableUnderline:!0}})})})}),(0,e.jsx)(qu,{value:y,index:mo[2],children:Q?(0,e.jsx)(os,{}):(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,e.jsx)(ml.Ay,{multiple:!0,onDrop:ee,accept:{"image/png":[".png"],"image/jpeg":[".jpg",".jpeg"],"application/pdf":[".pdf"]},children:({getRootProps:J,getInputProps:pe,isDragActive:Ee})=>(0,e.jsxs)("div",{...J(),children:[(0,e.jsx)("input",{...pe(),onChange:Te=>{const me=Te.target.files;me&&me.length>0&&ee(Array.from(me))},hidden:!0}),(0,e.jsx)(Sc,{size:Y.length>0?"small":"large",isDragActive:Ee})]})}),(0,e.jsx)(Cc,{files:Y,removeFile:async J=>{try{re(!0),await o([J],i?.id,t.id),await s()}finally{re(!1)}},disableRemoveFile:!1,sx:{gap:1}})]})})]}),(0,e.jsxs)(E.A,{sx:J=>({background:"white",borderTop:`1px solid ${J.palette.divider}`,position:"absolute",bottom:0,left:0,right:0,display:"flex",justifyContent:"flex-end",gap:"8px",padding:"8px"}),children:[(0,e.jsx)(sn,{type:"button",variant:"text",color:"secondary",size:"medium",disabled:!F.dirty||F.isSubmitting,onClick:()=>{A(!1),F.resetForm()},children:"Discard changes"}),(0,e.jsx)(sn,{type:"submit",variant:"contained",color:"primary",size:"medium",disabled:!F.dirty,loading:F.isSubmitting,children:"Save"})]})]})},R3=()=>{const{vendorId:t}=(0,L.useParams)(),{company:n}=(0,je.P)(),{deleteFile:s}=Yu(),{data:o=[],isLoading:r,refetch:a}=(0,Me.T5)({company:n?.id},{skip:!n}),i=(0,d.useMemo)(()=>o.find(({id:l})=>l===Number(t)),[o,t]);return r?(0,e.jsx)(os,{}):i?(0,e.jsx)(T3,{vendor:i,refetchVendors:a,onDocumentUpload:()=>new Promise(l=>{setTimeout(async()=>{try{await a()}finally{l()}},2500)}),deleteFile:async(l,c,u)=>{await s(l,c,u)&&setTimeout(()=>{a()},2500)}}):null},O3=({data:t,loading:n,maxAccountsReached:s,onSetDefault:o,onLinkAccount:r})=>(0,e.jsxs)(E.A,{sx:{flex:1,backgroundColor:"#FFFFFF",borderRadius:"4px",overflow:"hidden",border:a=>`1px solid ${a.palette.border.secondary}`},children:[(0,e.jsxs)(ra.A,{children:[(0,e.jsx)(L3,{}),(0,e.jsx)(li.A,{children:t.map((a,i)=>(0,e.jsx)(M3,{linkedData:a,onSetDefault:o,onLinkAccount:r,striped:i%2!==0,maxAccountsReached:s}))})]}),n&&t.length===0&&(0,e.jsx)(Od.A,{sx:{width:"100%"}})]}),M3=({linkedData:t,onLinkAccount:n,onSetDefault:s,striped:o,maxAccountsReached:r})=>{const a=!t.linked&&r,i=()=>a?(0,e.jsx)(F3,{}):t.linked?"Unlink Account":"Link Account";return(0,e.jsxs)(Zn.A,{sx:{background:o?l=>l.palette.background.secondary:"#FFF","& td":{borderBottom:"none"}},children:[(0,e.jsx)(xt.A,{children:(0,e.jsx)(I.A,{variant:"body2",children:t.name})}),(0,e.jsx)(xt.A,{align:"left",children:(0,e.jsx)(I.A,{variant:"body2",children:(0,e.jsx)(_o.A,{checked:t.isDefault,onChange:()=>s(t.id),value:t.isDefault,name:"default"})})}),(0,e.jsx)(xt.A,{align:"left",children:(0,e.jsx)(I.A,{variant:"body2",children:t.erpSystem})}),(0,e.jsx)(xt.A,{align:"center",children:(0,e.jsx)(I.A,{variant:"body2",children:t.erpNumber})}),(0,e.jsx)(xt.A,{align:"left",children:(0,e.jsx)(I.A,{variant:"body2",children:t.address})}),(0,e.jsx)(xt.A,{align:"center",sx:{width:85},children:(0,e.jsx)(qt.A,{title:i(),componentsProps:{tooltip:{sx:{maxWidth:"455px",backgroundColor:"#2E3032"}}},children:(0,e.jsx)("span",{children:(0,e.jsx)(ve.A,{onChange:()=>n(t.id),checked:t.linked,disabled:a})})})})]})},L3=()=>(0,e.jsx)(di.A,{children:(0,e.jsxs)(Zn.A,{children:[(0,e.jsx)(xt.A,{children:(0,e.jsx)(I.A,{variant:"body2",fontWeight:"fontWeightMedium",children:"Account Name"})}),(0,e.jsx)(xt.A,{align:"left",children:(0,e.jsx)(I.A,{variant:"body2",fontWeight:"fontWeightMedium",children:"Default"})}),(0,e.jsx)(xt.A,{align:"left",children:(0,e.jsx)(I.A,{variant:"body2",fontWeight:"fontWeightMedium",children:"System"})}),(0,e.jsx)(xt.A,{align:"center",children:(0,e.jsx)(I.A,{variant:"body2",fontWeight:"fontWeightMedium",children:"Account #"})}),(0,e.jsx)(xt.A,{align:"left",children:(0,e.jsx)(I.A,{variant:"body2",fontWeight:"fontWeightMedium",children:"Address"})}),(0,e.jsx)(xt.A,{align:"center",children:(0,e.jsx)(I.A,{variant:"body2",fontWeight:"fontWeightMedium",children:"Linked"})})]})}),F3=()=>(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{sx:{fontSize:"12px",lineHeight:"16px"},fontWeight:"fontWeightMedium",children:"Maximum linked account limit reached."}),(0,e.jsx)(I.A,{sx:{fontSize:"12px",lineHeight:"16px"},children:"You may only have 10 accounts linked at a time. Unlink other accounts to continue."})]}),B3=({open:t,onUpdate:n,closeModal:s,updatingAccounts:o})=>(0,e.jsxs)(Ms.A,{open:t,onClose:(r,a)=>{a!=="backdropClick"&&s()},children:[(0,e.jsxs)(tr.A,{sx:{display:"flex",justifyContent:"space-between"},children:["Update Linked Accounts",(0,e.jsx)(pt.A,{"aria-label":"close",onClick:()=>s(),sx:{paddingTop:0},children:(0,e.jsx)(co.A,{})})]}),(0,e.jsx)(nr.A,{children:"Linking or unlinking accounts may change your permissions."}),(0,e.jsxs)(Rr.A,{children:[(0,e.jsx)(K.A,{variant:"text",color:"secondary",onClick:()=>s(),children:"Cancel"}),(0,e.jsx)(K.A,{variant:"contained",onClick:()=>{o||n()},children:"Update Linked Accounts"})]})]}),N3=()=>{const{showError:t,showSuccess:n}=(0,Fe.d)(),[s,o]=(0,d.useState)(!1),{data:r,isLoading:a}=(0,Ai.MJ)(),{linkedAccounts:i,isLoading:l}=(0,ss.F)(),[c,{isLoading:u}]=(0,Ai.vc)(),p=10,f=(0,d.useMemo)(()=>{if(!r||l)return[];let w;const P=new Set(i.map(C=>(C.isDefault&&(w=C.companyId),C.companyId)));return r.map(C=>({...C,linked:P.has(C.id),isDefault:w===C.id}))},[i,r,l]),h=(0,Ds.Wx)({enableReinitialize:!0,initialValues:f,onSubmit:async w=>{let P=w.filter(C=>C.linked).map(C=>({companyId:C.id,isDefault:C.isDefault}));if(P.length>10){t({message:"Cannot link more than 10 accounts"});return}P.length<2&&(P=[]);try{await c(P).unwrap(),n({message:"Accounts successfully linked"})}catch{t({message:"Error linking accounts"}),h.resetForm()}finally{o(!1)}}}),b=w=>{const P=(0,H.cloneDeep)(h.values);P.forEach(C=>{C.isDefault=C.id===w,C.isDefault&&(C.linked=!0)}),h.setValues(P)},x=w=>{const P=(0,H.cloneDeep)(h.values),C=P.find(k=>k.id===w);C.linked=!C?.linked,!C?.linked&&C?.isDefault&&(C.isDefault=!1),h.setValues(P)},v={background:"unset !important",borderColor:"border.secondary",borderWidth:"1px",borderStyle:"solid"},y=h.values.filter(w=>w.linked).length,j=(0,d.useMemo)(()=>{if(!h.dirty)return!0;const w=h.values.some(P=>P.isDefault);return i.length===0?!(w&&y>=2):y>=2?!(w&&h.dirty):!h.dirty},[h.values,h.dirty,i,y]),A=()=>j?(0,e.jsx)(_3,{}):"";return(0,e.jsxs)(is,{children:[(0,e.jsxs)(E.A,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{variant:"h4",fontWeight:"fontWeightMedium",children:"Linked Accounts"}),(0,e.jsx)(I.A,{variant:"body1",color:"text.secondary",sx:{paddingTop:"0.125rem"},children:"Link BFS accounts to your MyBLDR account to view all of your projects in one place. You can only link accounts that have granted you admin privileges."})]}),(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"flex-end",gap:"8px",minWidth:"325px"},children:[(0,e.jsx)(K.A,{variant:"contained",disabled:j,onClick:()=>{h.resetForm()},color:"secondary",sx:j?v:{background:"#FFFFFF",borderColor:"border.secondary",borderWidth:"1px",borderStyle:"solid"},children:"Reset Changes"}),(0,e.jsx)(qt.A,{title:A(),componentsProps:{tooltip:{sx:{backgroundColor:"#2E3032"}}},children:(0,e.jsx)("span",{children:(0,e.jsx)(K.A,{variant:"contained",disabled:j,onClick:()=>o(!0),sx:j?v:{borderColor:"primary.main",borderWidth:"1px",borderStyle:"solid"},children:"Update Linked Accounts"})})})]})]}),(0,e.jsx)(E.A,{sx:{display:"flex",flex:1},children:(0,e.jsx)(O3,{data:h.values,loading:a||l,maxAccountsReached:y>=p,onLinkAccount:x,onSetDefault:b})}),(0,e.jsx)(B3,{open:s,onUpdate:()=>{h.submitForm()},closeModal:()=>o(!1),updatingAccounts:u})]})},_3=()=>(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{sx:{fontSize:"12px",lineHeight:"16px"},fontWeight:"fontWeightMedium",children:"A default account must be selected before saving."}),(0,e.jsxs)(I.A,{sx:{fontSize:"12px",lineHeight:"16px"},children:["Minimum linked accounts: ",(0,e.jsx)("span",{style:{fontWeight:500},children:"2"})]})]});var sd=m(77573),U3=m(12847),W3=m(60254);const z3=()=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(is,{children:(0,e.jsx)(kn,{sx:t=>({backgroundColor:t.palette.common.white}),children:(0,e.jsx)(Ua,{sidebarContent:(0,e.jsx)(Hi,{items:[{icon:(0,e.jsx)(sd.A,{}),text:"Home",key:"home",to:"home",disabled:!0,element:(0,e.jsx)("div",{})},{icon:(0,e.jsx)(U3.A,{}),text:"Communities",key:"communities",to:"communities",element:(0,e.jsx)("div",{})},{icon:(0,e.jsx)(sd.A,{}),text:"Standard Specs",key:"standard-specs",to:"standard-specs",disabled:!0,element:(0,e.jsx)("div",{})},{icon:(0,e.jsx)(sd.A,{}),text:"All Specifications",key:"all-specifications",to:"all-specifications",disabled:!0,element:(0,e.jsx)("div",{})},{icon:(0,e.jsx)(sd.A,{}),text:"Plans Library",key:"plans-library",to:"plans-library",disabled:!0,element:(0,e.jsx)("div",{})},{icon:(0,e.jsx)(W3.A,{}),text:"Settings",key:"settings",to:"settings",disabled:!0,element:(0,e.jsx)("div",{})}]}),persistKey:Nn.Rh.specificationsSidebar,width:"250px",children:(0,e.jsx)(E.A,{sx:{px:"24px"},children:(0,e.jsx)(L.Outlet,{})})})})})]});var V3=m(51767),$3=m(91587);const Ry=({label:t,isChecked:n})=>(0,e.jsxs)(I.A,{sx:{display:"flex",lineHeight:"12px",alignItems:"center"},fontSize:"small",children:[n?(0,e.jsx)(V3.A,{color:"success"}):(0,e.jsx)($3.A,{color:"error"}),t]}),H3=({community:t})=>{const n=(0,L.useNavigate)();return(0,e.jsxs)(E.A,{onClick:()=>n(String(t.communityId)),sx:{cursor:"pointer",display:"flex",flexDirection:"column",gap:"16px",padding:"8px"},children:[(0,e.jsx)(E.A,{sx:{width:"234px",height:"95px",background:"linear-gradient(118deg, #F1F1F1 -2.89%, #FEFEFE 125.64%)"}}),(0,e.jsxs)(E.A,{sx:{display:"flex",gap:"8px",justifyContent:"space-between"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column"},children:[(0,e.jsx)(I.A,{variant:"caption",fontWeight:"bold",fontSize:"small",children:t.communityName}),(0,e.jsx)(I.A,{color:"primary",fontSize:"10px",sx:{lineHeight:"16px"},children:t.erpSystem})]}),(0,e.jsx)(z0.A,{label:t.communityStatus,variant:"outlined",size:"small"})]}),(0,e.jsxs)(E.A,{sx:{display:"flex",gap:"8px"},children:[(0,e.jsx)(Ry,{label:"Plans On File",isChecked:!1}),(0,e.jsx)(Ry,{label:"Specs Added",isChecked:!0})]})]})};var Xu=m(10871),Oy=m(15253),Q3=m(10774),G3=m(25238),Xo=m(70188);const K3=rs(({open:t,onClose:n})=>{const[s]=Zp(),{company:o}=(0,je.P)(),r=(0,Fe.d)(),a=(0,Ds.Wx)({initialValues:{communityName:"",divisionId:null,statusId:null},onSubmit:async({communityName:i})=>{try{await s({companyId:o?.id,communityData:{communityName:i}}),n()}catch(l){r.showError({message:fn(l)})}}});return(0,e.jsx)(Zt,{title:"New Community",subtitle:"Please provide a name and details for this new community.",fullWidth:!0,open:t,onClose:n,actions:[{title:"Create",loading:a.isSubmitting,onClick:()=>a.handleSubmit()}],content:(0,e.jsxs)(E.A,{sx:{display:"grid",gap:"24px",gridTemplateColumns:"1fr 1fr"},children:[(0,e.jsxs)(E.A,{sx:{gridColumn:"span 2"},children:[(0,e.jsx)(I.A,{fontWeight:"medium",sx:{marginBottom:"6px"},children:"Community Name"}),(0,e.jsx)(_.A,{fullWidth:!0,required:!0,name:"communityName",value:a.values.communityName,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.communityName&&!!a.errors.communityName,helperText:a.touched.communityName&&a.errors.communityName})]}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{fontWeight:"medium",sx:{marginBottom:"6px"},children:"Division"}),(0,e.jsx)(_.A,{fullWidth:!0,select:!0,name:"divisionId",value:a.values.divisionId,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.divisionId&&!!a.errors.divisionId,helperText:a.touched.divisionId&&a.errors.divisionId,children:(0,e.jsx)(it.A,{})})]}),(0,e.jsxs)(E.A,{children:[(0,e.jsx)(I.A,{fontWeight:"medium",sx:{marginBottom:"6px"},children:"Status"}),(0,e.jsxs)(_.A,{fullWidth:!0,select:!0,name:"statusId",value:a.values.statusId,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.statusId&&!!a.errors.statusId,helperText:a.touched.statusId&&a.errors.statusId,children:[(0,e.jsx)(it.A,{children:"Active"}),(0,e.jsx)(it.A,{children:"Planning"})]})]})]})})}),Y3=()=>{const{isModalOpen:t,openModal:n,closeModal:s}=ln(),{company:o}=(0,je.P)(),{data:r=[]}=Jp({companyId:o?.id},{skip:!o?.id});return(0,e.jsxs)(E.A,{children:[(0,e.jsx)(K3,{open:t,onClose:s}),(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",py:"16px",gap:"4px"},children:[(0,e.jsx)(I.A,{variant:"h6",fontWeight:"bold",sx:{flex:1},children:"Communities"}),(0,e.jsx)(_.A,{size:"small",placeholder:"Search communities",InputProps:{startAdornment:(0,e.jsx)(Ks.A,{position:"start",children:(0,e.jsx)(Xu.A,{})})}}),(0,e.jsx)(sn,{variant:"outlined",color:"secondary",startIcon:(0,e.jsx)(Oy.A,{}),children:"Filter"}),(0,e.jsx)(sn,{variant:"outlined",color:"secondary",startIcon:(0,e.jsx)(fr.A,{}),endIcon:(0,e.jsx)(Q3.A,{}),children:"Date Created"}),(0,e.jsx)(sn,{variant:"contained",color:"secondary",startIcon:(0,e.jsx)(G3.A,{}),children:"Invite"}),(0,e.jsx)(sn,{variant:"contained",color:"primary",startIcon:(0,e.jsx)(Xo.A,{}),onClick:n,children:"New Community"})]}),(0,e.jsx)(Ce.A,{sx:{mb:"16px"}}),(0,e.jsx)(E.A,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fill, 250px)",gap:"16px"},children:r.map(a=>(0,e.jsx)(H3,{community:a},a.communityId))})]})},q3=()=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(hn,{}),(0,e.jsx)(is,{children:(0,e.jsx)(kn,{sx:t=>({backgroundColor:t.palette.common.white}),children:(0,e.jsx)(L.Outlet,{})})})]});var X3=m(52600),My=m(41511),Ju=m(19704);const J3=({community:t,specPackages:n,selectedPackage:s,onPackageSelect:o,onDeletePackage:r})=>{const a=(0,L.useNavigate)(),{company:i}=(0,je.P)(),[l,c]=(0,d.useState)(0),u=(f,h)=>{c(h)},p=()=>{i?.id&&a(`/companies/${i.id}/specifications/communities`)};return(0,e.jsxs)(E.A,{sx:{width:"282px",height:"100%",backgroundColor:"common.white",borderRight:"1px solid",borderColor:"divider",display:"flex",flexDirection:"column"},children:[(0,e.jsx)(E.A,{sx:{padding:"8px 12px",borderBottom:"1px solid",borderColor:"divider",display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,e.jsxs)(xs.A,{onClick:p,sx:{borderRadius:1,px:1.5,py:.5,minHeight:"auto","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:[(0,e.jsx)(Un.A,{sx:{minWidth:"auto",mr:1},children:(0,e.jsx)(X3.A,{fontSize:"small"})}),(0,e.jsx)(Cn.A,{primary:t.communityName,primaryTypographyProps:{fontSize:"16px",fontWeight:700}})]})}),(0,e.jsxs)(E.A,{sx:{borderBottom:"1px solid",borderColor:"divider",padding:"8px 12px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,e.jsxs)(ir.A,{value:l,onChange:u,sx:{minHeight:"auto","& .MuiTabs-indicator":{display:"none"}},children:[(0,e.jsx)(Po.A,{label:"Community",sx:{minHeight:"auto",minWidth:"auto",padding:"2px 8px",fontSize:"12px",fontWeight:500,textTransform:"none",borderRadius:"4px",margin:"0 2px","&.Mui-selected":{backgroundColor:"grey.100",color:"text.primary"}}}),(0,e.jsx)(Po.A,{label:"Spec Library",sx:{minHeight:"auto",minWidth:"auto",padding:"2px 8px",fontSize:"12px",fontWeight:500,textTransform:"none",borderRadius:"4px",margin:"0 2px","&.Mui-selected":{backgroundColor:"grey.100",color:"text.primary"}}})]}),(0,e.jsx)(pt.A,{size:"small",children:(0,e.jsx)(Xu.A,{})})]}),(0,e.jsx)(E.A,{sx:{padding:"8px 12px",borderBottom:"1px solid",borderColor:"divider"},children:(0,e.jsxs)(qn.A,{disablePadding:!0,children:[(0,e.jsx)(_n.Ay,{disablePadding:!0,children:(0,e.jsx)(xs.A,{sx:{borderRadius:1,px:1.5,py:.5},children:(0,e.jsx)(Cn.A,{primary:"Community Details",primaryTypographyProps:{fontSize:"16px",fontWeight:500}})})}),(0,e.jsx)(_n.Ay,{disablePadding:!0,children:(0,e.jsx)(xs.A,{sx:{borderRadius:1,px:1.5,py:.5},children:(0,e.jsx)(Cn.A,{primary:"Plans",primaryTypographyProps:{fontSize:"16px",fontWeight:500}})})})]})}),(0,e.jsxs)(E.A,{sx:{padding:"4px 12px 8px 12px",borderBottom:"1px solid",borderColor:"divider"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[(0,e.jsx)(I.A,{variant:"overline",sx:{fontSize:"12px",fontWeight:700,textTransform:"uppercase",color:"text.secondary",letterSpacing:"0.24px"},children:"Spec Packages"}),(0,e.jsx)(pt.A,{size:"small",onClick:()=>console.log("Add new package"),children:(0,e.jsx)(Xo.A,{})})]}),(0,e.jsx)(qn.A,{disablePadding:!0,children:n.map(f=>(0,e.jsx)(_n.Ay,{disablePadding:!0,children:(0,e.jsxs)(xs.A,{selected:s===f.title,onClick:()=>o(f.title),sx:{borderRadius:1,px:1.5,py:.5,"&.Mui-selected":{backgroundColor:"#ECF3FC","&:hover":{backgroundColor:"#ECF3FC"}}},children:[(0,e.jsx)(Un.A,{sx:{minWidth:"auto",mr:1,color:"primary.main"},children:(0,e.jsx)(My.A,{})}),(0,e.jsx)(Cn.A,{primary:f.title,primaryTypographyProps:{fontSize:"16px",fontWeight:500}}),n.length>1&&(0,e.jsx)(pt.A,{size:"small",onClick:h=>{h.stopPropagation(),r(f.scopeTreeId)},sx:{ml:1},children:(0,e.jsx)(Ju.A,{fontSize:"small"})})]})},f.scopeTreeId))})]})]})};var Z3=m(73545);const e6=rs(({open:t,onClose:n,onAddLevel:s,existingLevelNames:o})=>{const r=(0,Ds.Wx)({initialValues:{levelName:""},validate:l=>{const c={};return!l.levelName||l.levelName.trim()===""?c.levelName="Level name is required":o.some(u=>u.toLowerCase()===l.levelName.trim().toLowerCase())&&(c.levelName="A level with this name already exists"),c},onSubmit:async({levelName:l})=>{s(l.trim()),n(),r.resetForm()}}),a=()=>{r.resetForm(),n()},i=l=>{l.preventDefault(),r.handleSubmit()};return(0,e.jsx)(Zt,{title:"Create New Level",subtitle:"Every new level will inherit the base specifications. Any modifications made to the new level will be clearly highlighted to help you track the changes.",maxWidth:"xs",open:t,onClose:a,PaperProps:{sx:{width:"480px",maxWidth:"480px"}},actions:[{title:"Create",loading:r.isSubmitting,onClick:()=>r.handleSubmit(),disabled:!r.isValid||!r.dirty}],content:(0,e.jsxs)(E.A,{component:"form",onSubmit:i,sx:{display:"flex",flexDirection:"column",gap:1,pt:.5},children:[(0,e.jsx)(I.A,{variant:"body2",fontWeight:"medium",sx:{mb:.5,color:"text.primary"},children:"Level Name"}),(0,e.jsx)(_.A,{fullWidth:!0,required:!0,name:"levelName",placeholder:"e.g., Premium, Luxury, Custom",value:r.values.levelName,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.levelName&&!!r.errors.levelName,helperText:r.touched.levelName&&r.errors.levelName,autoFocus:!0})]})})}),t6=rs(({open:t,onClose:n,currentLevelName:s,onEditLevel:o,existingLevelNames:r})=>{const a=(0,Ds.Wx)({initialValues:{levelName:s},enableReinitialize:!0,validate:c=>{const u={};return!c.levelName||c.levelName.trim()===""?u.levelName="Level name is required":c.levelName.trim()!==s&&r.some(p=>p.toLowerCase()===c.levelName.trim().toLowerCase())&&(u.levelName="A level with this name already exists"),u},onSubmit:async({levelName:c})=>{o(s,c.trim()),n(),a.resetForm()}}),i=()=>{a.resetForm(),n()},l=c=>{c.preventDefault(),a.handleSubmit()};return(0,e.jsx)(Zt,{title:"Edit Level Name",subtitle:"Update the name of this specification level.",maxWidth:"xs",open:t,onClose:i,PaperProps:{sx:{width:"480px",maxWidth:"480px"}},actions:[{title:"Save",loading:a.isSubmitting,onClick:()=>a.handleSubmit(),disabled:!a.isValid||!a.dirty}],content:(0,e.jsxs)(E.A,{component:"form",onSubmit:l,sx:{display:"flex",flexDirection:"column",gap:1,pt:.5},children:[(0,e.jsx)(I.A,{variant:"body2",fontWeight:"medium",sx:{mb:.5,color:"text.primary"},children:"Level Name"}),(0,e.jsx)(_.A,{fullWidth:!0,required:!0,name:"levelName",placeholder:"e.g., Premium, Luxury, Custom",value:a.values.levelName,onChange:a.handleChange,onBlur:a.handleBlur,error:a.touched.levelName&&!!a.errors.levelName,helperText:a.touched.levelName&&a.errors.levelName,autoFocus:!0})]})})}),n6={communityId:1,communityName:"Hidden Valley Farm",erpSystem:"QuickBooks",accountNumber:"54321",communityPhase:"Active",communityStatusId:1,communityStatus:"Active",archived:!1,isDeleted:!1},V7=[{id:"package-1",name:"Package 1",isActive:!0}],Ly="base-level",od="Base Level",s6=[{id:Ly,name:od,isActive:!0}],$7=null,o6=({onLevelChange:t})=>{const[n,s]=(0,d.useState)(s6),{isModalOpen:o,openModal:r,closeModal:a}=ln(),{isModalOpen:i,openModal:l,closeModal:c}=ln(),[u,p]=(0,d.useState)(null),{company:f}=(0,je.P)(),h=(0,L.useNavigate)(),{level:b,communityId:x}=(0,L.useParams)(),y=b&&n.some(T=>T.name===b)?b:od,j=n.find(T=>T.name===y),A=j?.id===Ly,w=T=>`/companies/${f?.id}/specifications/communities/${x}/${T}`;(0,d.useEffect)(()=>{f?.id&&x&&(b&&n.some(W=>W.name===b)||h(w(od),{replace:!0}))},[b,n,f?.id,x,h]),(0,d.useEffect)(()=>{j&&t?.(j.name)},[j?.name,t]);const P=T=>{const W={id:`level-${Date.now()}`,name:T,isActive:!0};s(N=>[...N,W]),h(w(T)),a()},C=T=>{T.preventDefault(),T.stopPropagation(),p(T.currentTarget)},k=()=>{p(null)},S=(T,W)=>{s(N=>N.map(O=>O.name===T?{...O,name:W}:O)),y===T&&h(w(W)),c()},R=()=>{s(T=>T.filter(W=>W.name!==y)),h(w(od)),k()},B=()=>{l(),k()};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(e6,{open:o,onClose:a,onAddLevel:P,existingLevelNames:n.map(T=>T.name)}),(0,e.jsx)(t6,{open:i,onClose:c,currentLevelName:j?.name||"",onEditLevel:S,existingLevelNames:n.map(T=>T.name)}),(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"flex-end",gap:1,padding:"0",position:"relative","&::after":{content:'""',position:"absolute",bottom:0,left:0,right:0,height:"1px",backgroundColor:"divider"}},children:[(0,e.jsx)(ir.A,{value:y,variant:"scrollable",scrollButtons:"auto",sx:{minHeight:"auto",position:"relative",zIndex:1,"& .MuiTabs-indicator":{backgroundColor:"primary.main",height:"2px",zIndex:2},"& .MuiTab-root":{minHeight:"auto",minWidth:"auto",padding:T=>T.spacing(1,2),fontSize:"14px",fontWeight:500,textTransform:"none",color:"text.primary",position:"relative","&.Mui-selected":{color:"text.primary"}}},children:n.map(T=>(0,e.jsx)(Po.A,{value:T.name,component:L.Link,to:w(T.name),label:(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:.25},children:[T.name,(0,e.jsx)(E.A,{sx:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:.25},children:y===T.name&&(0,e.jsx)(pt.A,{size:"small",onClick:C,sx:{padding:.25,"&:hover":{backgroundColor:"action.hover"}},children:(0,e.jsx)(Z3.A,{fontSize:"small"})})})]})},T.id))}),(0,e.jsx)(pt.A,{size:"small",onClick:r,title:"Add Specification Level",sx:{padding:1,borderRadius:.5,position:"relative",zIndex:1,"&:hover":{backgroundColor:"action.hover"}},children:(0,e.jsx)(Xo.A,{})})]}),(0,e.jsxs)(Hn.A,{anchorEl:u,open:!!u,onClose:k,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[(0,e.jsxs)(it.A,{onClick:B,children:[(0,e.jsx)(Un.A,{children:(0,e.jsx)(Ku.A,{fontSize:"small"})}),(0,e.jsx)(Cn.A,{children:"Edit Name"})]}),!A&&(0,e.jsxs)(it.A,{onClick:R,children:[(0,e.jsx)(Un.A,{children:(0,e.jsx)(Ju.A,{fontSize:"small"})}),(0,e.jsx)(Cn.A,{children:"Delete"})]})]})]})};var r6=m(27799),a6=m(94492);const rd=({startIcon:t,children:n,onClick:s,...o})=>(0,e.jsx)(K.A,{startIcon:t,onClick:s,sx:{textTransform:"capitalize",fontWeight:600,fontSize:"12px",padding:"8px 12px",color:"text.secondary",border:"none",backgroundColor:"transparent","&:hover":{backgroundColor:"transparent"}},...o,children:n}),i6=(t,n,s)=>{const o=a=>(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Ju.A,{}),label:"Delete",onClick:()=>n?.(String(a)),color:"error"}),r=()=>(0,e.jsx)(bs.Z,{icon:(0,e.jsx)(Xo.A,{}),label:"Add",onClick:()=>s?.(),color:"primary"});return[{field:"category",headerName:"Category",flex:1,minWidth:150,editable:!0},{field:"subCategory",headerName:"Sub Category",flex:1,minWidth:150,editable:!0},{field:"location",headerName:"Location",flex:1,minWidth:120,editable:!0},{field:"description",headerName:"Description",flex:1,minWidth:200,editable:!0},{field:"manufacturer",headerName:"Manufacturer",flex:1,minWidth:150,editable:!0},{field:"modelNo",headerName:"Model No",flex:1,minWidth:120,editable:!0},{field:"colorFinish",headerName:"Color/Finish",flex:1,minWidth:120,editable:!0},{field:"actions",type:"actions",headerName:"",width:50,getActions:a=>a.id===t[0]?.id?[r()]:n?[o(a.id)]:[]}]},l6=t=>t.id,d6=({specifications:t,searchQuery:n,onSearchChange:s,onSpecificationChange:o,onDeleteSpecification:r,onAddSpecification:a})=>{const i=(0,Kn.b)(),l=(0,d.useRef)(null),{waitForRow:c,onRowAdded:u}=po(),p=(0,d.useCallback)(async v=>{const y=Object.keys(v).find(j=>v[j]!==t.find(A=>A.id===v.id)?.[j]);y&&o&&o(v.id,y,v[y])},[o,t]),f=(0,d.useCallback)(v=>{console.error("Row update error:",v)},[]),h=(0,d.useMemo)(()=>i6(t,r,a),[t,r,a]),b=(0,d.useMemo)(()=>t.map(v=>({id:v.id,category:v.category,subCategory:v.subCategory,location:v.location,description:v.description,manufacturer:v.manufacturer,modelNo:v.modelNo,colorFinish:v.colorFinish})),[t]),x=eo(i);return $o({handleResize:()=>zo(l.current)}),(0,e.jsxs)(E.A,{sx:{flex:1,display:"flex",flexDirection:"column"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:.5,backgroundColor:"grey.50",border:"1px solid",borderColor:"divider",borderRadius:1,marginBottom:2,marginTop:2},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(rd,{startIcon:(0,e.jsx)(Xu.A,{}),onClick:()=>console.log("Search functionality"),children:"Search"}),(0,e.jsx)(rd,{startIcon:(0,e.jsx)(Oy.A,{}),onClick:()=>console.log("Filter functionality"),children:"Filter"}),(0,e.jsx)(rd,{startIcon:(0,e.jsx)(r6.A,{}),onClick:()=>console.log("Sort functionality"),children:"Sort"})]}),(0,e.jsx)(rd,{startIcon:(0,e.jsx)(a6.A,{}),onClick:()=>console.log("Edit columns functionality"),children:"Edit Columns"})]}),(0,e.jsx)(Vo,{ref:l,children:(0,e.jsx)(Jn,{rows:b,columns:h,getRowId:l6,processRowUpdate:p,onProcessRowUpdateError:f,getRowClassName:x,getCellClassName:cs,rowHeight:50,disableColumnMenu:!0,disableVirtualization:!0,hideFooter:!0,onRowAdded:u,apiRef:i,initialState:{columns:{columnVisibilityModel:{manufacturer:!1,modelNo:!1,colorFinish:!1}}}})})]})};var c6=m(70365),u6=m(92785);const Fy=({primaryAction:t,actions:n,size:s="medium",variant:o="contained"})=>{const[r,a]=(0,d.useState)(!1),i=(0,d.useRef)(null),l=()=>{a(!0)},c=()=>{a(!1)},u=p=>{p.onClick(),c()};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(du.A,{variant:o,ref:i,children:[(0,e.jsx)(K.A,{startIcon:t.icon,onClick:t.onClick,size:s,sx:{textTransform:"none",fontWeight:600,fontSize:s==="small"?"12px":"14px",px:s==="small"?1:1.5,py:s==="small"?.75:1},children:t.label}),(0,e.jsx)(K.A,{size:s,onClick:l,sx:{px:.5,minWidth:"auto"},children:(0,e.jsx)(u6.A,{})})]}),(0,e.jsx)(Hn.A,{anchorEl:i.current,open:r,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:n.map((p,f)=>(0,e.jsxs)(it.A,{onClick:()=>u(p),children:[p.icon,p.label]},f))})]})},p6=({packageName:t,onAddSpecs:n})=>{const s={label:"Import",icon:(0,e.jsx)(Xo.A,{}),onClick:()=>console.log("Import specifications")},o=[{label:"Add Specs",icon:(0,e.jsx)(Xo.A,{sx:{mr:1.5,fontSize:"20px"}}),onClick:n},{label:"Import Specs",icon:(0,e.jsx)(_u.A,{sx:{mr:1.5,fontSize:"20px"}}),onClick:()=>console.log("Import specifications")}];return(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",borderColor:"divider"},children:[(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,e.jsx)(My.A,{sx:{color:"text.secondary",fontSize:24}}),(0,e.jsx)(I.A,{sx:{fontSize:"18px",fontWeight:600,lineHeight:"28px",color:"text.primary"},children:t})]}),(0,e.jsxs)(E.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,e.jsx)(K.A,{variant:"outlined",size:"small",startIcon:(0,e.jsx)(c6.A,{sx:{fontSize:"16px"}}),onClick:()=>console.log("Export specifications"),sx:{textTransform:"capitalize",fontWeight:600,fontSize:"12px",px:1,py:.75,minHeight:"28px",borderRadius:"4px",borderColor:"divider",backgroundColor:"grey.100",color:"text.primary","&:hover":{backgroundColor:"grey.200",borderColor:"divider"}},children:"Export"}),(0,e.jsx)(Fy,{primaryAction:s,actions:o,variant:"contained",size:"small"})]})]})};var m6=m(95333);const h6=({onAddSpecs:t,onImportSpecs:n})=>{const s={label:"Add Specs",icon:(0,e.jsx)(Xo.A,{}),onClick:t},o=[{label:"Create single spec",icon:(0,e.jsx)(Xo.A,{sx:{mr:1.5,fontSize:"20px"}}),onClick:t},{label:"Import spec sheet",icon:(0,e.jsx)(_u.A,{sx:{mr:1.5,fontSize:"20px"}}),onClick:n||(()=>console.log("Import spec sheet"))}];return(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"64px 32px",textAlign:"center",maxWidth:"512px",margin:"0 auto"},children:[(0,e.jsx)(E.A,{sx:{width:"48px",height:"48px",backgroundColor:"common.white",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:2,border:"1px solid",borderColor:"divider",boxShadow:1},children:(0,e.jsx)(m6.A,{sx:{color:"text.secondary",fontSize:"24px"}})}),(0,e.jsxs)(E.A,{sx:{display:"flex",flexDirection:"column",gap:.5,marginBottom:3,maxWidth:"352px"},children:[(0,e.jsx)(I.A,{variant:"h6",sx:{fontSize:"16px",fontWeight:600,color:"text.primary",marginBottom:.5},children:"No Specs yet"}),(0,e.jsx)(I.A,{variant:"body2",sx:{fontSize:"14px",color:"text.secondary",lineHeight:1.43},children:"You currently do not have any specifications defined in this package yet. Get started by adding one manually or pulling specs in from other parts of your organization."})]}),(0,e.jsx)(Fy,{primaryAction:s,actions:o})]})},By=()=>{const{communityId:t,companyId:n}=(0,L.useParams)(),[s,o]=(0,d.useState)("Package 1"),[r,a]=(0,d.useState)(""),[i,l]=(0,d.useState)([]),c={...n6,communityId:parseInt(t||"1")},{data:u=[]}=TF({company:Number(n)}),p=()=>{const b={id:`spec-${Date.now()}`,category:"",subCategory:"",location:"",description:"",manufacturer:"",modelNo:"",colorFinish:""};l([b])},f=b=>{console.log("Delete package:",b)},h=i.length>0;return(0,e.jsxs)(E.A,{sx:{display:"flex"},children:[(0,e.jsx)(J3,{community:c,specPackages:u,selectedPackage:s,onPackageSelect:o,onDeletePackage:f}),(0,e.jsxs)(E.A,{sx:{flex:1,display:"flex",flexDirection:"column",px:3,py:2},children:[(0,e.jsx)(p6,{packageName:s,onAddSpecs:p}),(0,e.jsx)(o6,{}),h?(0,e.jsx)(d6,{specifications:i,searchQuery:r,onSearchChange:a,onSpecificationChange:(b,x,v)=>{l(y=>y.map(j=>j.id===b?{...j,[x]:v}:j))},onDeleteSpecification:b=>{l(x=>x.filter(v=>v.id!==b))},onAddSpecification:p}):(0,e.jsx)(h6,{onAddSpecs:p,onImportSpecs:()=>console.log("Import specifications")})]})]})};Q5.K.setLicenseKey("fe3362267a12158d0d03c7ff95859e6aTz0xMTkzMTIsRT0xNzg5ODYyMzk5MDAwLFM9cHJlbWl1bSxMTT1zdWJzY3JpcHRpb24sUFY9aW5pdGlhbCxLVj0y"),H5();const ad=t=>(0,d.createElement)(L.Route,{...t,element:(0,e.jsx)(t.component,{}),key:`route-${t.path}`}),g6=t=>(0,e.jsxs)(L.Route,{element:t,children:[oy&&oy.map(ad),(0,e.jsx)(L.Route,{path:"bfs_auth_landing",element:(0,e.jsx)(L.Navigate,{to:"/",replace:!0})}),(0,e.jsx)(L.Route,{path:"login",element:(0,e.jsx)(L.Navigate,{to:"/",replace:!0})}),(0,e.jsxs)(L.Route,{path:"projects",children:[sy&&sy.map(ad),(0,e.jsxs)(L.Route,{path:":projectId/materials",element:(0,e.jsx)(c4,{}),children:[(0,e.jsxs)(L.Route,{path:"",element:(0,e.jsx)(p4,{}),children:[(0,e.jsx)(L.Route,{path:"",element:(0,e.jsx)(yx,{})}),(0,e.jsx)(L.Route,{path:"quote/:quoteId",element:(0,e.jsx)(Ex,{})}),(0,e.jsx)(L.Route,{path:"quote/:quoteId/elevation",element:(0,e.jsx)(I4,{})}),(0,e.jsx)(L.Route,{path:"quote/:quoteId/:packType/:packTypeId",element:(0,e.jsx)(Ex,{})}),(0,e.jsx)(L.Route,{path:":packType/:packTypeId",element:(0,e.jsx)(yx,{})})]}),(0,e.jsx)(L.Route,{path:"request_bid",element:(0,e.jsx)(m4,{})}),(0,e.jsx)(L.Route,{path:"edit_bid",element:(0,e.jsx)(C4,{})})]}),(0,e.jsxs)(L.Route,{path:":projectId/documents",element:(0,e.jsx)(HB,{}),children:[(0,e.jsx)(L.Route,{path:"",index:!0,element:(0,e.jsx)(Gu,{})}),(0,e.jsx)(L.Route,{path:"system/:folderId",element:(0,e.jsx)(Gu,{})}),(0,e.jsx)(L.Route,{path:"folder/:folderId",element:(0,e.jsx)(Gu,{})}),(0,e.jsx)(L.Route,{path:"modeling/:folderId",element:(0,e.jsx)(h3,{})}),(0,e.jsx)(L.Route,{path:"quote/:folderId",element:(0,e.jsx)(g3,{})})]})]}),(0,e.jsx)(L.Route,{path:"bfs",children:ry&&ry.map(ad)}),(0,e.jsx)(L.Route,{path:"companies",children:ay&&ay.map(ad)}),(0,e.jsxs)(L.Route,{path:"companies/:companyId/specifications",element:(0,e.jsx)(z3,{}),children:[(0,e.jsx)(L.Route,{index:!0,element:(0,e.jsx)(L.Navigate,{to:"communities"})}),(0,e.jsx)(L.Route,{path:"communities",children:(0,e.jsx)(L.Route,{index:!0,element:(0,e.jsx)(Y3,{})})}),(0,e.jsx)(L.Route,{path:"all-specifications",element:(0,e.jsx)("div",{})}),(0,e.jsx)(L.Route,{path:"plans-library",element:(0,e.jsx)("div",{})}),(0,e.jsx)(L.Route,{path:"division-settings",element:(0,e.jsx)("div",{})})]}),(0,e.jsxs)(L.Route,{path:"companies/:companyId/specifications/communities/:communityId",element:(0,e.jsx)(q3,{}),children:[(0,e.jsx)(L.Route,{index:!0,element:(0,e.jsx)(By,{})}),(0,e.jsx)(L.Route,{path:":level",element:(0,e.jsx)(By,{})})]}),(0,e.jsxs)(L.Route,{path:"companies/:companyId/projects",element:(0,e.jsx)(Wa,{}),children:[(0,e.jsx)(L.Route,{path:"",element:(0,e.jsx)(Wa,{})}),(0,e.jsx)(L.Route,{path:"unmapped",element:(0,e.jsx)(Wa,{})}),(0,e.jsx)(L.Route,{path:"community/:communityId",element:(0,e.jsx)(Wa,{})})]}),(0,e.jsxs)(L.Route,{path:"companies/:companyId/digital_tools",element:(0,e.jsx)(zx,{}),children:[(0,e.jsx)(L.Route,{path:"",element:(0,e.jsx)(bL,{})}),(0,e.jsx)(L.Route,{path:"drafting",element:(0,e.jsx)(ca,{selectedTool:"drafting"})}),(0,e.jsx)(L.Route,{path:"build_optimize",element:(0,e.jsx)(ca,{selectedTool:"build_optimize"})}),(0,e.jsx)(L.Route,{path:"home_configure",element:(0,e.jsx)(ca,{selectedTool:"dt_configure"})}),(0,e.jsx)(L.Route,{path:"render",element:(0,e.jsx)(ca,{selectedTool:"render"})}),(0,e.jsx)(L.Route,{path:"home_plan",element:(0,e.jsx)(ca,{selectedTool:"home_plan"})})]}),(0,e.jsxs)(L.Route,{path:"companies/:companyId/profile",element:(0,e.jsx)($x,{}),children:[(0,e.jsx)(L.Route,{index:!0,element:(0,e.jsx)(L.Navigate,{to:"demographics",replace:!0})}),(0,e.jsx)(L.Route,{path:"demographics",element:(0,e.jsx)(Bu,{selectedTool:Kl.DEMOGRAPHICS})}),(0,e.jsx)(L.Route,{path:"branding",element:(0,e.jsx)(Bu,{selectedTool:Kl.BRANDING})}),(0,e.jsx)(L.Route,{path:"location",element:(0,e.jsx)(Bu,{selectedTool:Kl.LOCATIONS})}),(0,e.jsx)(L.Route,{path:"spec_sheets",element:(0,e.jsx)(BL,{})}),(0,e.jsx)(L.Route,{path:"schedule_templates",element:(0,e.jsx)(RD,{})}),(0,e.jsx)(L.Route,{path:"quickbooks_setup",element:(0,e.jsx)(ak,{})}),(0,e.jsx)(L.Route,{path:"settings/*",element:(0,e.jsx)(UL,{})}),(0,e.jsx)(L.Route,{path:"cost_codes",element:(0,e.jsx)(VD,{})}),(0,e.jsx)(L.Route,{path:"vendor_management",element:(0,e.jsx)(Z5,{}),children:(0,e.jsx)(L.Route,{path:":vendorId/:tab?",element:(0,e.jsx)(R3,{})})}),(0,e.jsx)(L.Route,{path:"linked_accounts",element:(0,e.jsx)(N3,{})})]})]}),f6=(0,L.createBrowserRouter)((0,L.createRoutesFromElements)(g6((0,e.jsx)(_F,{})))),x6=()=>(0,e.jsx)(L.RouterProvider,{router:f6}),H7=({title:t,message:n,visible:s,severity:o="error",onClose:r})=>jsx(PositionedCollapse,{in:s,children:jsxs(MUIAlert,{severity:o,onClose:r,children:[jsx(AlertTitle,{children:jsx(Typography,{children:t})}),n]})}),Q7=null;var G7=m(22969),id=m(24581),ga={};ga.styleTagTransform=zs(),ga.setAttributes=Us(),ga.insert=_s().bind(null,"head"),ga.domAPI=Ns(),ga.insertStyleElement=Ws();var K7=Bs()(id.A,ga);const Y7=id.A&&id.A.locals?id.A.locals:void 0;ae.createRoot(document.getElementById("root")).render((0,e.jsx)(x6,{}))},66251:(ze,xe,m)=>{"use strict";m.d(xe,{Ay:()=>K,I:()=>te,v3:()=>d});var e=m(72505),ae=m.n(e),ce=m(35403),g=m(92039);const te=new EventTarget,M=ae().create({withCredentials:!0}),Ae=H=>{H?M.defaults.headers.common["X-Paradigm-Access-Token"]=H:(delete M.defaults.headers.common.Authorization,delete M.defaults.headers.common["X-Paradigm-Access-Token"])},d=ae().create({withCredentials:!1});d.interceptors.request.use(function(H){return H.headers=H.headers||{},delete H.headers.Authorization,delete H.headers["X-Paradigm-Access-Token"],H}),d.interceptors.response.use(H=>H,H=>Promise.reject(H));let se=null;Ae(localStorage.getItem(g.rw.ACCESS_TOKEN)),M.interceptors.request.use(function(H){const{csrftoken:Se}=(0,ce.t)();H.headers=H.headers||{},Se&&(H.headers["X-CSRFToken"]=Se);const ve=localStorage.getItem(g.rw.ACCESS_TOKEN);return ve&&(H.headers["X-Paradigm-Access-Token"]=ve),H});const Be=H=>(!se&&H.headers?.["application-git-sha"]&&(se=H.headers["application-git-sha"]),H.headers?.["application-git-sha"]&&se!==H.headers["application-git-sha"]&&te.dispatchEvent(new CustomEvent("app.refreshNeeded")),H),_=async H=>{const{response:Se}=H;return Se?(H.response?.status===401&&console.error("401 error received",{requestUrl:H.config.url,requestData:H.config.data,responseStatus:H.response.status,responseData:H.response.data}),["/force_sign_out"].includes(window.location.pathname)?Promise.reject(H):Se.status===401?((0,g.Fc)(),console.warn(`axiosConf: Unrecoverable auth error (status ${Se.status}). Logging out.`),(0,g.Mi)()):Promise.reject(H)):(console.error("axiosConf: Network or other error without response:",H),Promise.reject(H))};M.interceptors.response.use(Be,_);const K=M},17978:(ze,xe,m)=>{"use strict";m.d(xe,{A8:()=>ye,B4:()=>Jt,DA:()=>Yt,FV:()=>Cs,GC:()=>md,GH:()=>ve,IZ:()=>Bt,Ie:()=>Ut,KA:()=>_,KO:()=>E,Nc:()=>Gt,Nj:()=>op,Nx:()=>Se,O9:()=>Kt,Ph:()=>wn,QA:()=>Ts,QM:()=>kt,QP:()=>Re,Rn:()=>Rn,S$:()=>Vt,T5:()=>Be,TQ:()=>rn,VX:()=>$t,WF:()=>ie,Wy:()=>It,Xp:()=>Et,YH:()=>se,Yr:()=>jn,Zn:()=>ap,Zw:()=>ot,_C:()=>it,aL:()=>q,aO:()=>hd,bV:()=>Ie,cG:()=>qe,cZ:()=>_e,ci:()=>Ce,cp:()=>H,dJ:()=>de,fe:()=>et,gR:()=>Ne,ib:()=>Ke,l:()=>ip,nZ:()=>nn,ni:()=>Ht,o8:()=>Fn,p0:()=>Je,pC:()=>I,qL:()=>wt,sK:()=>cp,ss:()=>dp,tN:()=>jt,u$:()=>ft,uC:()=>rp,uF:()=>Ve,uL:()=>Ft,v6:()=>ho,xd:()=>K,yM:()=>lp});var e=m(22923),ae=m(48361),ce=m(13561),g=m(26142);const te="VariancePurchaseOrder",M=(Ge,U)=>({type:te,id:`${Ge}-${U}`}),Ae=(Ge,U)=>({type:te,id:`${Ge}-parent-${U}`}),d=async(Ge,U,oe)=>{const fe=oe(Ge);try{const{data:be}=await U.queryFulfilled;oe(be)}catch{fe.undo()}},se=(0,e.xP)({baseQuery:(0,ae.S)({baseUrl:"/budget/v2"}),reducerPath:"budgetV2",tagTypes:["InvoiceFile","ProjectCostCode","VariancePurchaseOrder","VarianceTotals"],endpoints:Ge=>({vendors:Ge.query({query:({company:U})=>({url:`/company/${U}/vendors`,method:"GET"})}),updateVendor:Ge.mutation({query:U=>({url:`/company/${U.company}/vendors/${U.id}`,method:"PUT",data:U}),async onQueryStarted({company:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("vendors",{company:U},Oe=>Oe.map(tt=>tt.id===be.id?be:tt)))}}),createNewVendor:Ge.mutation({query:U=>({url:`/company/${U.company}/vendors`,method:"POST",data:U}),async onQueryStarted({company:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("vendors",{company:U},Oe=>Oe.concat(be)))}}),deleteVendor:Ge.mutation({query:({company:U,id:oe})=>({url:`/company/${U}/vendors/${oe}`,method:"DELETE"}),async onQueryStarted({company:U,id:oe},{dispatch:fe,queryFulfilled:be}){await be,fe(se.util.updateQueryData("vendors",{company:U},Oe=>Oe.filter(tt=>tt.id!==oe)))}}),uploadVendors:Ge.mutation({query:({company:U,formData:oe})=>({url:`/company/${U}/vendors/import_csv`,method:"POST",data:oe}),async onQueryStarted({company:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("vendors",{company:U},Oe=>Oe.concat(be)))}}),getExpenses:Ge.query({query:({projectId:U,include_vpo_invoices:oe})=>{const fe=`/project/${U}/expenses`,be=new URLSearchParams;oe&&be.append("include_vpo_invoices","true");const Oe=be.toString();return{url:Oe?`${fe}?${Oe}`:fe,method:"GET"}}}),updateExpense:Ge.mutation({query:U=>({url:`/project/${U.projectId}/expenses/${U.uid}`,method:"PUT",data:U}),async onQueryStarted({projectId:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("getExpenses",{projectId:U,include_vpo_invoices:!0},Oe=>Oe.map(tt=>tt.uid===be.uid?be:tt))),be.variancePurchaseOrderId&&oe(se.util.invalidateTags([M(U,be.variancePurchaseOrderId),Ae(U,be.purchaseOrderId),"VarianceTotals"])),be.purchaseOrderUid&&oe(se.util.updateQueryData("getPurchaseOrders",{projectId:U},Oe=>Oe.map(tt=>tt.uid===be.purchaseOrderUid?{...tt,invoices:(tt.invoices||[]).map(cn=>cn.uid===be.uid?be:cn)}:tt)))}}),createExpense:Ge.mutation({query:U=>({url:`/project/${U.projectId}/expenses`,method:"POST",data:U}),async onQueryStarted({projectId:U,purchaseOrderId:oe,variancePurchaseOrderId:fe},{dispatch:be,queryFulfilled:Oe}){const{data:tt}=await Oe;be(se.util.updateQueryData("getExpenses",{projectId:U,include_vpo_invoices:!0},cn=>cn.concat(tt))),oe&&!fe&&be(se.util.updateQueryData("getPurchaseOrders",{projectId:U},cn=>cn.map(Bn=>Bn.internalId===oe?{...Bn,invoices:Bn.invoices.concat(tt)}:Bn))),fe&&oe&&be(se.util.invalidateTags([M(U,fe),Ae(U,oe),"VarianceTotals"]))}}),deleteExpense:Ge.mutation({query:({projectId:U,uid:oe})=>({url:`/project/${U}/expenses/${oe}`,method:"DELETE"}),async onQueryStarted({projectId:U,uid:oe,variancePurchaseOrderId:fe,purchaseOrderId:be},{dispatch:Oe,queryFulfilled:tt}){await tt,Oe(se.util.updateQueryData("getExpenses",{projectId:U,include_vpo_invoices:!0},cn=>cn.filter(Bn=>Bn.uid!==oe))),Oe(se.util.updateQueryData("getPurchaseOrders",{projectId:U},cn=>cn.map(Bn=>({...Bn,invoices:Bn.invoices.filter(ya=>ya.uid!==oe)})))),fe&&be&&Oe(se.util.invalidateTags([M(U,fe),Ae(U,be),"VarianceTotals"]))}}),getScheduledPayments:Ge.query({query:({projectId:U})=>({url:`/project/${U}/scheduled-payments`,method:"GET"})}),getScheduledPaymentStatusChoices:Ge.query({query:({projectId:U})=>({url:`/project/${U}/scheduled-payments/list_status`,method:"GET"})}),createScheduledPayment:Ge.mutation({query:({projectId:U,...oe})=>({url:`/project/${U}/scheduled-payments`,method:"POST",data:{...oe,project:U}}),async onQueryStarted({projectId:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("getScheduledPayments",{projectId:U},Oe=>Oe.concat(be)))}}),updateScheduledPayment:Ge.mutation({query:({projectId:U,id:oe,...fe})=>({url:`/project/${U}/scheduled-payments/${oe}`,method:"PUT",data:fe}),async onQueryStarted({projectId:U,...oe},fe){await d(oe,fe,be=>fe.dispatch(se.util.updateQueryData("getScheduledPayments",{projectId:U},Oe=>Oe.map(tt=>tt.id===be.id?{...tt,...be}:tt))))}}),deleteScheduledPayment:Ge.mutation({query:({projectId:U,id:oe})=>({url:`/project/${U}/scheduled-payments/${oe}`,method:"DELETE"}),async onQueryStarted({projectId:U,id:oe},{dispatch:fe,queryFulfilled:be}){const Oe=fe(se.util.updateQueryData("getScheduledPayments",{projectId:U},tt=>tt.filter(cn=>cn.id!==oe)));be.catch(Oe.undo)}}),getChangeOrders:Ge.query({query:({project:U})=>({url:`/project/${U}/change-orders`,method:"GET"})}),getChangeOrderStatusChoices:Ge.query({query:({projectId:U})=>({url:`/project/${U}/change-orders/list_status`,method:"GET"})}),createChangeOrder:Ge.mutation({query:U=>({url:`/project/${U.project}/change-orders`,method:"POST",data:U}),async onQueryStarted({project:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("getChangeOrders",{project:U},Oe=>Oe.concat(be)))}}),createPaymentRequestForChangeOrder:Ge.mutation({query:({project:U,id:oe,expectedAmount:fe})=>({url:`/project/${U}/change-orders/${oe}/create_payment_request`,method:"POST",data:{expectedAmount:fe,project:U}}),async onQueryStarted({project:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("getChangeOrders",{project:U},Oe=>Oe.map(tt=>tt.id===be.changeOrder.id?be.changeOrder:tt)))}}),updateChangeOrder:Ge.mutation({query:U=>({url:`/project/${U.project}/change-orders/${U.id}`,method:"PUT",data:U}),async onQueryStarted(U,oe){await d(U,oe,fe=>oe.dispatch(se.util.updateQueryData("getChangeOrders",{project:fe.project},be=>be.map(Oe=>Oe.id===fe.id?fe:Oe))))}}),deleteChangeOrder:Ge.mutation({query:({project:U,id:oe})=>({url:`/project/${U}/change-orders/${oe}`,method:"DELETE"}),async onQueryStarted({project:U,id:oe},{dispatch:fe,queryFulfilled:be}){await be,fe(se.util.updateQueryData("getChangeOrders",{project:U},Oe=>Oe.filter(tt=>tt.id!==oe)))}}),getAllowances:Ge.query({query:({project:U})=>({url:`/project/${U}/allowances`,method:"GET"})}),createAllowance:Ge.mutation({query:U=>({url:`/project/${U.project}/allowances`,method:"POST",data:U}),async onQueryStarted({project:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("getAllowances",{project:U},Oe=>Oe.concat(be)))}}),createPaymentForAllowance:Ge.mutation({query:({project:U,id:oe,amount:fe})=>({url:`/project/${U}/allowances/${oe}/create_payment`,method:"POST",data:{amount:fe,project:U}}),async onQueryStarted({project:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("getAllowances",{project:U},Oe=>Oe.map(tt=>tt.id===be.id?be:tt)))}}),updateAllowance:Ge.mutation({query:U=>({url:`/project/${U.project}/allowances/${U.id}`,method:"PUT",data:U}),async onQueryStarted(U,oe){await d(U,oe,fe=>oe.dispatch(se.util.updateQueryData("getAllowances",{project:fe.project},be=>be.map(Oe=>Oe.id===fe.id?fe:Oe))))}}),deleteAllowance:Ge.mutation({query:({project:U,id:oe})=>({url:`/project/${U}/allowances/${oe}`,method:"DELETE"}),async onQueryStarted({project:U,id:oe},{dispatch:fe,queryFulfilled:be}){await be,fe(se.util.updateQueryData("getAllowances",{project:U},Oe=>Oe.filter(tt=>tt.id!==oe)))}}),getProfitAndLoss:Ge.query({query:({projectId:U})=>({url:`/project/${U}/profit-and-loss`,method:"GET"})}),getProjectCostCodes:Ge.query({query:({projectId:U})=>({url:`/project/${U}/project-cost-codes`,method:"GET"}),providesTags:["ProjectCostCode"]}),batchDeleteProjectCostCodes:Ge.mutation({query:({projectId:U,...oe})=>({url:`/project/${U}/project-cost-codes/batch_delete`,method:"POST",data:oe}),invalidatesTags:["ProjectCostCode"]}),createProjectCostCode:Ge.mutation({query:({projectId:U,...oe})=>({url:`/project/${U}/project-cost-codes`,method:"POST",data:{...oe,project:U}}),async onQueryStarted({projectId:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("getProjectCostCodes",{projectId:U},Oe=>Oe.concat(be)))}}),updateProjectCostCode:Ge.mutation({query:({projectId:U,id:oe,...fe})=>({url:`/project/${U}/project-cost-codes/${oe}`,method:"PUT",data:{...fe,project:U}}),async onQueryStarted({projectId:U,...oe},fe){await d(oe,fe,be=>fe.dispatch(se.util.updateQueryData("getProjectCostCodes",{projectId:U},Oe=>Oe.map(tt=>tt.id===be.id?{...tt,...be}:tt))))}}),deleteProjectCostCode:Ge.mutation({query:({projectId:U,id:oe})=>({url:`/project/${U}/project-cost-codes/${oe}`,method:"DELETE"}),async onQueryStarted({projectId:U,...oe},{dispatch:fe,queryFulfilled:be}){const Oe=fe(se.util.updateQueryData("getProjectCostCodes",{projectId:U},tt=>tt.filter(({id:cn})=>cn!==oe.id)));be.catch(Oe.undo)}}),createInvoiceFile:Ge.mutation({query:({uid:U,projectId:oe,...fe})=>({url:`/project/${oe}/expenses/${U}/create_file`,method:"POST",data:fe})}),getInvoiceFiles:Ge.query({query:({projectId:U,uid:oe})=>({url:`/project/${U}/expenses/${oe}/get_files`,method:"GET"})}),deleteInvoiceFiles:Ge.mutation({query:({projectId:U,uid:oe,fileIds:fe})=>({url:`/project/${U}/expenses/${oe}/delete_files`,method:"POST",data:{fileIds:fe}})}),sendInvoiceToQuickbooks:Ge.mutation({query:({id:U,projectId:oe,invoiceNumber:fe,dueDate:be,amount:Oe,balanceDue:tt,invoiceDate:cn,costCodeId:Bn,companyId:ya})=>({url:`/project/${oe}/expenses/send_to_quickbooks`,method:"POST",data:{id:U,project:oe,invoice_number:fe,due_date:be,amount:Oe,balance_due:tt,invoice_date:cn,cost_code:Bn,company_id:ya}})}),getVendorCategories:Ge.query({query:({company:U})=>({url:`/company/${U}/vendor-categories`,method:"GET"})}),deleteVendorCategory:Ge.mutation({query:({company:U,id:oe})=>({url:`/company/${U}/vendor-categories/${oe}`,method:"DELETE"})}),createVendorCategory:Ge.mutation({query:U=>({url:`/company/${U.company}/vendor-categories`,method:"POST",data:U}),async onQueryStarted({company:U},{dispatch:oe,queryFulfilled:fe}){try{const{data:be}=await fe;oe(se.util.updateQueryData("getVendorCategories",{company:U},Oe=>Oe.concat(be)))}catch(be){console.error("Error creating vendor category:",be)}}}),getPurchaseOrders:Ge.query({query:({projectId:U})=>({url:`/project/${U}/purchase-orders`,method:"GET"})}),createPurchaseOrder:Ge.mutation({query:({projectId:U,...oe})=>({url:`/project/${U}/purchase-orders`,method:"POST",data:{...oe,projectId:U}}),async onQueryStarted({projectId:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("getPurchaseOrders",{projectId:U},Oe=>Oe.concat(be)))}}),updatePurchaseOrder:Ge.mutation({query:({projectId:U,...oe})=>({url:`/project/${U}/purchase-orders/${oe.uid}`,method:"PUT",data:oe}),async onQueryStarted({projectId:U,...oe},fe){await d(oe,fe,be=>fe.dispatch(se.util.updateQueryData("getPurchaseOrders",{projectId:U},Oe=>Oe.map(tt=>tt.uid===be.uid?{...tt,...be}:tt))))}}),deletePurchaseOrder:Ge.mutation({query:({projectId:U,internalId:oe,cascadeDelete:fe=!1})=>{const be=`/project/${U}/purchase-orders/${oe}`,Oe=new URLSearchParams;fe&&Oe.append("cascade_delete","true");const tt=Oe.toString();return{url:tt?`${be}?${tt}`:be,method:"DELETE"}},async onQueryStarted({projectId:U,internalId:oe},{dispatch:fe,queryFulfilled:be}){const Oe=fe(se.util.updateQueryData("getPurchaseOrders",{projectId:U},tt=>tt.filter(cn=>cn.internalId!==oe)));be.catch(Oe.undo)}}),getPurchaseOrderStatusChoices:Ge.query({query:({projectId:U})=>({url:`/project/${U}/purchase-orders/status`,method:"GET"})}),getPurchaseOrderInvoiceStatusChoices:Ge.query({query:({projectId:U})=>({url:`/project/${U}/purchase-orders/invoice-status`,method:"GET"})}),createPurchaseOrderFile:Ge.mutation({query:({projectId:U,purchaseOrderId:oe,...fe})=>({url:`/project/${U}/purchase-orders/${oe}/create_file`,method:"POST",data:fe})}),getPurchaseOrderFiles:Ge.query({query:({projectId:U,purchaseOrderId:oe})=>({url:`/project/${U}/purchase-orders/${oe}/get_files`,method:"GET"})}),deletePurchaseOrderFiles:Ge.mutation({query:({projectId:U,purchaseOrderId:oe,...fe})=>({url:`/project/${U}/purchase-orders/${oe}/delete_files`,method:"POST",data:fe})}),varianceCodes:Ge.query({query:({projectId:U})=>({url:`/project/${U}/variance-codes`,method:"GET"})}),getVarianceTotals:Ge.query({query:({projectId:U})=>({url:`/project/${U}/variance-purchase-orders/totals`,method:"GET"}),providesTags:["VarianceTotals"]}),getVariancePurchaseOrders:Ge.query({query:({projectId:U,purchaseOrderId:oe,isStandalone:fe})=>{let be=`/project/${U}/variance-purchase-orders`;const Oe=new URLSearchParams;return oe&&Oe.append("purchase_order_id",oe.toString()),fe&&Oe.append("is_standalone","true"),Oe.toString()&&(be+=`?${Oe.toString()}`),{url:be,method:"GET"}},providesTags:(U,oe,{projectId:fe,purchaseOrderId:be})=>{const Oe=[];return U&&U.forEach(tt=>Oe.push(M(fe,tt.id))),be&&Oe.push(Ae(fe,be)),Oe}}),createVariancePurchaseOrder:Ge.mutation({query:({projectId:U,...oe})=>({url:`/project/${U}/variance-purchase-orders`,method:"POST",data:oe}),invalidatesTags:["VarianceTotals"],async onQueryStarted({projectId:U,purchaseOrderId:oe},{dispatch:fe,queryFulfilled:be}){const{data:Oe}=await be;fe(se.util.updateQueryData("getVariancePurchaseOrders",{projectId:U,purchaseOrderId:oe},tt=>tt.concat(Oe)))}}),createStandaloneWithPoShell:Ge.mutation({query:({projectId:U,...oe})=>({url:`/project/${U}/variance-purchase-orders/create_standalone_with_po_shell`,method:"POST",data:oe}),async onQueryStarted({projectId:U},{dispatch:oe,queryFulfilled:fe}){const{data:be}=await fe;oe(se.util.updateQueryData("getPurchaseOrders",{projectId:U},Oe=>Oe.concat(be.purchaseOrder))),be.purchaseOrder.internalId&&oe(se.util.upsertQueryData("getVariancePurchaseOrders",{projectId:U,purchaseOrderId:be.purchaseOrder.internalId},[be.variancePurchaseOrder]))}}),updateVariancePurchaseOrder:Ge.mutation({query:({projectId:U,id:oe,...fe})=>({url:`/project/${U}/variance-purchase-orders/${oe}`,method:"PUT",data:fe}),invalidatesTags:["VarianceTotals"],async onQueryStarted({projectId:U,id:oe,purchaseOrderId:fe},{dispatch:be,queryFulfilled:Oe}){const{data:tt}=await Oe;be(fe?se.util.updateQueryData("getVariancePurchaseOrders",{projectId:U,purchaseOrderId:fe},cn=>cn.map(Bn=>Bn.id===oe?tt:Bn)):se.util.updateQueryData("getVariancePurchaseOrders",{projectId:U},cn=>cn.map(Bn=>Bn.id===oe?tt:Bn)))}}),deleteVariancePurchaseOrder:Ge.mutation({query:({projectId:U,id:oe})=>({url:`/project/${U}/variance-purchase-orders/${oe}`,method:"DELETE"}),invalidatesTags:(U,oe,{projectId:fe,id:be,purchaseOrderId:Oe})=>[M(fe,be),Ae(fe,Oe),"VarianceTotals"]}),createChangeOrderForVpo:Ge.mutation({query:({projectId:U,vpoId:oe,...fe})=>({url:`/project/${U}/variance-purchase-orders/${oe}/create_change_order`,method:"POST",data:fe}),async onQueryStarted({projectId:U,vpoId:oe},{dispatch:fe,queryFulfilled:be}){const{data:Oe}=await be;fe(se.util.updateQueryData("getChangeOrders",{project:U},tt=>tt.concat(Oe.changeOrder))),fe(se.util.updateQueryData("getVariancePurchaseOrders",{projectId:U,purchaseOrderId:Oe.variancePurchaseOrder.purchaseOrderId},tt=>tt.map(cn=>cn.id===oe?Oe.variancePurchaseOrder:cn)))}}),createChangeOrderForAllowance:Ge.mutation({query:({projectId:U,allowanceId:oe,...fe})=>({url:`/project/${U}/allowances/${oe}/create_change_order`,method:"POST",data:fe}),async onQueryStarted({projectId:U,allowanceId:oe},{dispatch:fe,queryFulfilled:be}){const{data:Oe}=await be;fe(se.util.updateQueryData("getChangeOrders",{project:U},tt=>tt.concat(Oe.changeOrder))),fe(se.util.updateQueryData("getAllowances",{project:U},tt=>tt.map(cn=>cn.id===oe?Oe.allowance:cn)))}})})}),{useVendorsQuery:Be,useUpdateVendorMutation:_,useGetExpensesQuery:K,useUpdateExpenseMutation:H,useCreateExpenseMutation:Se,useDeleteExpenseMutation:ve,useGetProjectCostCodesQuery:ye,useBatchDeleteProjectCostCodesMutation:Ce,useCreateProjectCostCodeMutation:Ke,useUpdateProjectCostCodeMutation:Je,useDeleteProjectCostCodeMutation:jt,useCreateInvoiceFileMutation:wt,useGetInvoiceFilesQuery:Ft,useDeleteInvoiceFilesMutation:Ut,useSendInvoiceToQuickbooksMutation:jn,useCreateNewVendorMutation:rn,useDeleteVendorMutation:Vt,useUploadVendorsMutation:$t,useGetScheduledPaymentsQuery:It,useGetScheduledPaymentStatusChoicesQuery:Et,useCreateScheduledPaymentMutation:Bt,useUpdateScheduledPaymentMutation:nn,useDeleteScheduledPaymentMutation:Yt,useGetChangeOrdersQuery:et,useGetChangeOrderStatusChoicesQuery:kt,useCreateChangeOrderMutation:de,useCreatePaymentRequestForChangeOrderMutation:Ie,useUpdateChangeOrderMutation:_e,useDeleteChangeOrderMutation:Ve,useGetAllowancesQuery:Gt,useCreateAllowanceMutation:wn,useCreatePaymentForAllowanceMutation:Kt,useUpdateAllowanceMutation:Fn,useDeleteAllowanceMutation:Re,useGetProfitAndLossQuery:Ne,useGetVendorCategoriesQuery:q,useDeleteVendorCategoryMutation:ie,useCreateVendorCategoryMutation:ot,useGetPurchaseOrdersQuery:qe,useCreatePurchaseOrderMutation:ft,useUpdatePurchaseOrderMutation:Jt,useDeletePurchaseOrderMutation:Ht,useGetPurchaseOrderStatusChoicesQuery:Cs,useGetPurchaseOrderInvoiceStatusChoicesQuery:Ts,useCreatePurchaseOrderFileMutation:md,useGetPurchaseOrderFilesQuery:E,useDeletePurchaseOrderFilesMutation:it,useVarianceCodesQuery:I,useGetVariancePurchaseOrdersQuery:ho,useCreateVariancePurchaseOrderMutation:Rn,useCreateStandaloneWithPoShellMutation:op,useUpdateVariancePurchaseOrderMutation:rp,useDeleteVariancePurchaseOrderMutation:ap,useCreateChangeOrderForVpoMutation:ip,useCreateChangeOrderForAllowanceMutation:hd,useGetVarianceTotalsQuery:lp}=se,dp=()=>{const Ge=(0,ce.wA)(),{project:U}=(0,g.B)();return oe=>{Ge(se.util.updateQueryData("getExpenses",{projectId:U?.id,include_vpo_invoices:!0},fe=>fe.map(be=>be.uid===oe.uid?oe:be))),oe.purchaseOrderUid&&Ge(se.util.updateQueryData("getPurchaseOrders",{projectId:U?.id},fe=>fe.map(be=>be.uid===oe.purchaseOrderUid?{...be,invoices:be.invoices.map(Oe=>Oe.uid===oe.uid?oe:Oe)}:be))),oe.variancePurchaseOrderId&&Ge(se.util.updateQueryData("getVariancePurchaseOrders",{projectId:U?.id,purchaseOrderId:oe.purchaseOrderId??void 0},fe=>fe.map(be=>be.id===oe.variancePurchaseOrderId?{...be,invoices:be.invoices.map(Oe=>Oe.uid===oe.uid?oe:Oe)}:be)))}},cp=()=>{const Ge=(0,ce.wA)(),{project:U}=(0,g.B)();return oe=>{Ge(se.util.updateQueryData("getPurchaseOrders",{projectId:U?.id},fe=>fe.map(be=>be.uid===oe.uid?oe:be)))}}},42824:()=>{"use strict"},70551:(ze,xe,m)=>{"use strict";m.d(xe,{e:()=>M});var e=m(50318),ae=m.n(e),ce=m(17197),g=m(13561),te=m(14420);const M=Ae=>{const d=(0,g.wA)(),{data:se,isFetching:Be,refetch:_,error:K}=(0,ce.DJ)(Ae,{skip:!Ae}),H=(0,g.d4)(Ce=>Ce.documents.delayedFileFetching),Se=(0,e.useCallback)(()=>d((0,te.jc)()),[d]),ve=(0,e.useCallback)(Ce=>{Ce?(Se(),setTimeout(()=>{_(),Se()},Ce)):_()},[_,Se]);return{files:(0,e.useMemo)(()=>se??[],[se]),filesLoading:Be||H,refreshFiles:ve,error:K}}},14420:(ze,xe,m)=>{"use strict";m.d(xe,{Ay:()=>K,MR:()=>ae,Rw:()=>_,_D:()=>Be,jc:()=>se});var e=m(30038),ae=(H=>(H[H.DELETE=0]="DELETE",H[H.RENAME=1]="RENAME",H[H.PERMISSIONS=2]="PERMISSIONS",H[H.CREATE=3]="CREATE",H[H.NONE=4]="NONE",H))(ae||{});const ce={selectedFolder:null,folders:[],systemFolders:[],modelingFolders:[],delayedFileFetching:!1,modalStatus:4,mergeIFC:!1},g=(0,e.Z0)({name:"documents",initialState:ce,reducers:{updateSelectedFolder:(H,Se)=>{H.selectedFolder=Se.payload},updateFolders:(H,Se)=>{H.folders=Se.payload},updateSystemFolders:(H,Se)=>{H.systemFolders=Se.payload},updateModelingFolders:(H,Se)=>{H.modelingFolders=Se.payload},toggleDelayedFileFetching:H=>{H.delayedFileFetching=!H.delayedFileFetching},toggleFolderModal:(H,Se)=>{H.modalStatus=Se.payload},toggleMergeIFC:(H,Se)=>{H.mergeIFC=Se.payload}}}),{updateFolders:te,updateSystemFolders:M,updateSelectedFolder:Ae,updateModelingFolders:d,toggleDelayedFileFetching:se,toggleFolderModal:Be,toggleMergeIFC:_}=g.actions,K=g.reducer},17197:(ze,xe,m)=>{"use strict";m.d(xe,{$F:()=>se,Bj:()=>Se,DJ:()=>te,EI:()=>Ae,HZ:()=>Be,Q8:()=>M,eX:()=>d,hQ:()=>K,hu:()=>H,l0:()=>_,w3:()=>g});var e=m(22923),ae=m(48361),ce=m(9402);const g=(0,e.xP)({baseQuery:(0,ae.S)({baseUrl:"/api/projects"}),reducerPath:"files",keepUnusedDataFor:0,tagTypes:["Files","Folders","ModelingFiles","QuoteFiles"],endpoints:ve=>({getFiles:ve.query({query:ye=>({url:`/${ye}/files`}),transformResponse:ye=>(0,ce.bn)(ye?.plans),providesTags:["Files"]}),getModelingFiles:ve.query({query:({projectId:ye,jiraKey:Ce})=>({url:`/${ye}/modeling_files/${Ce}`}),transformResponse:ye=>(0,ce.bn)(ye),providesTags:["ModelingFiles"]}),getMarkedForMergeModelingFiles:ve.query({query:({projectId:ye,jiraKey:Ce})=>({url:`/${ye}/modeling_files/${Ce}`}),transformResponse:ye=>(0,ce.bn)(ye).filter(Ce=>Ce.isMarkedForMerge)}),getQuoteFiles:ve.query({query:({projectId:ye,quoteId:Ce})=>({url:`/${ye}/quote_files/${Ce}`}),transformResponse:ye=>(0,ce.bn)(ye?.plans),providesTags:["QuoteFiles"]}),setPrimaryPlan:ve.mutation({query:({projectId:ye,planId:Ce,fileName:Ke})=>({url:`/${ye}/primary_plan`,method:"POST",data:{planId:Ce,fileName:Ke,projectId:ye}}),invalidatesTags:["Files"]}),editFile:ve.mutation({query:({fileName:ye,newFileName:Ce,projectId:Ke,projectExternalId:Je,entityId:jt,entityType:wt})=>({url:`/${Ke}/files`,method:"PUT",data:{display_name:Ce,file_name:ye,new_file_name:Ce,project_external_id:Je,entity_id:jt,entity_type:wt}}),invalidatesTags:["Files"]}),deleteFile:ve.mutation({query:({projectId:ye,projectExternalId:Ce,entityId:Ke,entityType:Je,fileName:jt})=>({url:`/${ye}/files`,method:"DELETE",data:{file_name:jt,project_external_id:Ce,entity_id:Ke,entity_type:Je}}),invalidatesTags:["Files","QuoteFiles"]}),publishModelingFile:ve.mutation({query:({projectId:ye,jiraKey:Ce,fileId:Ke,published:Je})=>({url:`/${ye}/modeling_file/publish/${Ce}/${Ke}`,method:"POST",data:{published:Je}}),invalidatesTags:["ModelingFiles"]}),mergeModelingFiles:ve.mutation({query:({projectId:ye,jiraKey:Ce,fileIds:Ke})=>({url:`/${ye}/modeling_file/merge/${Ce}`,method:"POST",data:{fileIds:Ke}}),invalidatesTags:["ModelingFiles"]})})}),{useGetFilesQuery:te,useGetModelingFilesQuery:M,useSetPrimaryPlanMutation:Ae,useDeleteFileMutation:d,useEditFileMutation:se,useGetQuoteFilesQuery:Be,usePublishModelingFileMutation:_,useMergeModelingFilesMutation:K,useLazyGetMarkedForMergeModelingFilesQuery:H,usePrefetch:Se}=g},42634:(ze,xe,m)=>{"use strict";m.d(xe,{c:()=>e});var e=(ae=>(ae.PROJECTS="projects",ae.BID="bid",ae.COMMUNITY="community",ae.MASTERPLAN="masterplan",ae.QUOTE="quote",ae))(e||{})},3624:(ze,xe,m)=>{"use strict";m.d(xe,{B7:()=>Et,BI:()=>Se,BR:()=>Yt,DV:()=>H,FO:()=>kt,Ho:()=>_e,Hw:()=>$t,ID:()=>wn,JB:()=>Ve,Js:()=>Fn,K0:()=>jt,Mg:()=>wt,NU:()=>Ce,QN:()=>_,Qk:()=>ye,U$:()=>K,Vb:()=>rn,YY:()=>Ft,ZM:()=>Vt,cl:()=>Gt,g3:()=>Ie,hS:()=>Ke,iA:()=>Be,lX:()=>de,s2:()=>jn,uv:()=>Ut,zi:()=>Kt});var e=m(9755),ae=m(66169),ce=m(41e3),g=m.n(ce),te=m(88835),M=m(24974),Ae=m.n(M),d=m(4213),se=m.n(d),Be=(Re=>(Re[Re.nameIndex=0]="nameIndex",Re[Re.actionButton=1]="actionButton",Re[Re.buildDay=2]="buildDay",Re[Re.duration=3]="duration",Re))(Be||{}),_=(Re=>(Re[Re.StartToStart=0]="StartToStart",Re[Re.StartToEnd=1]="StartToEnd",Re[Re.EndToStart=2]="EndToStart",Re[Re.EndToEnd=3]="EndToEnd",Re))(_||{});const K="/static/SampleTemplate.xlsx",H=(Re,Ne,q,ie)=>[{field:"templateName",cls:"temp-name-column",minWidth:"300px",text:"Template Name"},{text:"Date Created",field:"dateCreated",minWidth:"200px",type:"date",renderer:({value:ot})=>ot!=null?`${g()(ot).format(te.SH)}`:""},{text:"Build Days",field:"buildDays",minWidth:"140px",editor:{type:"numberfield",required:!0,min:1},renderer:({value:ot})=>ot!=null?Math.round(ot):""},{type:"action",exportable:!1,text:"",actions:ve(Re,Ne,q,ie)}],Se=`<div>
  <div class='no-template-message'>
    <div>
      <h3>No Templates Available</h3>
      <span>Click 'Create New Template' to get started</span>
    </div>
  </div>
  </div>`,ve=(Re,Ne,q,ie)=>[{visible:!0,cls:"b-fa b-fa-edit schedule-template-button-edit",onClick:({record:Jt})=>{ie(Jt.data)}},{visible:!0,renderer:({record:Jt})=>`<i class="downloadTemplate b-fa b-fa-download schedule-template-button ${Jt&&Jt.data.buildDays==0?"disable-download-button":""}"/>`},{cls:"b-fa b-fa-remove schedule-template-delete schedule-template-button",visible:!0,onClick:({record:Jt})=>{Re(Jt.data.id),Ne(!0)}}],ye={addNewAtEnd:!1},Ce=async(Re,Ne)=>{const q=new(Ae()).Workbook,ie=q.addWorksheet("Schedule Template");ie.columns=[{header:"Construction Phase",key:"Construction_Phase",width:30},{header:"Task Sequence #",key:"Task_Sequence",width:30,style:{alignment:{horizontal:"center",vertical:"middle"}}},{header:"Task Description",key:"Task_Description",width:35},{header:"Predecessor Sequence #",key:"Predecessor_Sequence",width:35},{header:"Build Day",key:"Build_Day",width:15},{header:"Duration",key:"Duration",width:15}],ie.getRow(1).eachCell(ft=>{ft.font={name:"Calibri",size:14,bold:!0},ft.alignment={horizontal:"center",vertical:"middle"}}),Re.forEach(ft=>{ie.addRow(ft)});const ot=await q.xlsx.writeBuffer(),qe=new Blob([ot],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});se()(qe,`${Ne}.xlsx`)},Ke=new Date(g()(new Date).format(te.MK)+" 00:00:00"),Je=[{unit:"year",renderer:Re=>"BUILD DAY"},{unit:"day",dateFormat:"DD",increment:1,originalDateFormat:"DD",renderer:Re=>g()(Re).isBefore(Ke)?"":Vt(Re)}],jt={id:"initial",rowHeight:24,tickWidth:100,tickHeight:100,shiftUnit:"day",shiftIncrement:1,defaultSpan:1,mainUnit:"day",timeResolution:{unit:"day",increment:1},headers:Je,mainHeaderLevel:1,columnLinesFor:1},wt={id:"mid",tickWidth:40,tickHeight:75,mainUnit:"day",shiftIncrement:1,defaultSpan:12,timeResolution:{unit:"day",increment:1},headers:Je,mainHeaderLevel:1,columnLinesFor:1},Ft={id:"max",tickWidth:12,tickHeight:50,mainUnit:"day",shiftIncrement:1,defaultSpan:12,timeResolution:{unit:"day",increment:1},headers:Je,mainHeaderLevel:1,columnLinesFor:1},Ut=(Re,Ne,q)=>{const ie={name:Ne=="phase"?"New Phase":"New Task",buildDay:1,startDate:rn(1),duration:1,isParent:Ne=="phase",expanded:!0,constraintType:"startnoearlierthan"};Ne=="subtask"?Re.insertChild(ie,Re.nextSibling):Re?Re.parent.insertChild(ie,Re.nextSibling):q&&q.current?.instance.taskStore.add(ie)},jn=(Re,Ne,q,ie)=>[{type:"name",text:"Phase/Task",autoHeight:!0,minWidth:"360px",cls:"grid-name-field",finalizeCellEdit:({value:ft})=>ft.trim().length==0?"This field is required.":!0},{type:"action",exportable:!1,cls:"grid-action-field",text:"",actions:[{cls:"b-fa b-fa-plus grid-updated-add add-new-task-button",visible:({record:ft})=>ft._data.isParent,onClick:({record:ft})=>{Ut(ft,"subtask",void 0)}},{cls:"b-fa b-fa-ellipsis-v grid-updated-add task-menu-button",visible:({record:ft})=>!ft._data.isParent,onClick:ft=>{ie(ft?.record),Re(ft.target?.getBoundingClientRect().top),Ne(ft.target?.getBoundingClientRect().left),q(!0)}}],headerRenderer:()=>'<button class="addnewPhase b-blue b-raised b-button">Add New Phase</button>',minWidth:"150px"},{text:"Build Day",field:"startDate",minWidth:"80px",editor:{type:"numberfield",required:!0,min:1},renderer:({value:ft})=>Vt(ft)},{text:"Duration",field:"duration",minWidth:"80px",editor:{type:"numberfield",decimalPrecision:0,required:!0,min:1},renderer:({value:ft})=>ft!=null?Math.round(ft):""}],rn=Re=>g()(Ke).add(Re-1,"days").toDate(),Vt=Re=>g()(Re,"DD-MM-YYYY").diff(g()(Ke,"DD-MM-YYYY"),"days")+1,$t=Re=>{const Ne=[];return Re.forEach(q=>{const ie=Ne.findIndex(qe=>qe.name===q.constructionPhase),ot="parent_"+(Ne.length+1).toString();!q.name&&q.isParent?Ne.push({parentId:0,expanded:!0,isParent:!0,manuallyScheduled:!1,name:q.constructionPhase,sequence:Ne.length+1,id:ot,buildDay:q.buildDay,startDate:q.startDate,duration:q.duration,children:[]}):ie!==-1?Ne[ie].children?.push({...q,parentId:ot}):Ne.push({parentId:0,expanded:!0,isParent:!0,manuallyScheduled:!1,name:q.constructionPhase,sequence:Ne.length+1,id:ot,children:[{...q,parentId:ot}]})}),Ne.forEach(q=>{if(q.children&&q.children.length>0){const ie=Math.min(...q.children.map(ot=>ot.buildDay?ot.buildDay:1));q.buildDay=ie,q.startDate=rn(ie)}}),Ne},It={features:{headerMenu:!1},columns:{data:{lag:{editor:{allowedUnits:"day",required:!0}}}}},Et={editorConfig:{title:"Task Information",centered:!0},items:{generalTab:{items:{percentDone:!1,effort:!1,divider:!1,name:{type:"text",name:"name",label:"Task Name",value:"",required:!0},buildDay:{name:"buildDay",label:"Build Day",type:"number",required:!0,min:1},phase:{type:"combo",items:[],name:"parentId",valueField:"value",displayField:"text",label:"Phase"},startDate:!1,duration:{name:"duration",type:"number",decimalPrecision:0,label:"Duration",value:"",min:1,required:!0},endDate:!1}},notesTab:!1,resourcesTab:!1,advancedTab:!1,predecessorsTab:{items:{grid:It}},successorsTab:{items:{grid:It}}}},Bt=(Re,Ne,q)=>{const ie=Re.filter(qe=>(qe._data.toEvent?._data?qe._data.toEvent._data.id:qe._data.toEvent)==Ne.id),ot=[];return ie.forEach(qe=>{qe._data.fromEvent&&qe._data.toEvent&&ot.push(q.filter(ft=>!ft._data.isParent).findIndex(ft=>ft._data.id==q.find(Jt=>Jt._data.id==(qe._data.fromEvent?._data?qe._data.fromEvent._data.id:qe._data.fromEvent))?._data.id)+1)}),ot},nn=(Re,Ne)=>{let q=[];return Re.forEach(ie=>{q.push({fromSequence:Ne.find(ot=>ot.id==(ie._data.from?ie._data.from:ie._data.fromEvent?._data.id))?.Task_Sequence,toSequence:Ne.find(ot=>ot.id==(ie._data.to?ie._data.to:ie._data.toEvent?._data.id))?.Task_Sequence,type:ie._data.type,lag:ie._data.lag})}),q},Yt=Re=>{const Ne=Re?.current?.instance.tasks.filter(qe=>!qe.children||qe.children.length==0),q=Re?.current?.instance.dependencies;let ie=[];Ne?.forEach(qe=>{const ft=qe._data,Jt=ft.isParent,Ht=ie.filter(Ts=>Ts.Task_Sequence!=0).length+1,Cs=Bt(q,ft,Ne);ie.push({id:ft.id,Construction_Phase:Jt?ft.name:qe._parent._data.name,Predecessor_Sequence:Jt?"":Cs.toString(),Successor_Sequence:"",Task_Sequence:Jt?0:Ht,Task_Description:Jt?"":ft.name,Build_Day:Jt?1:Vt(ft.startDate),Duration:Jt?1:ft.duration})});const ot=nn(q,ie);return{tasks:ie,dependencies:ot}},et=Re=>{const Ne=Re.taskRecord??Re.record._data,q=Ne.name??"Task",ie=Vt(Ne.startDate?Ne.startDate:new Date).toString(),ot=(Ne.duration?Ne.duration:1).toString(),qe=`Build Day: ${ie}`,ft=`Duration: ${ot}`;return`<dl>
          <dt><b>${e.MZC.encodeHtml(q)}</b></dt>
          <dt>${e.MZC.encodeHtml(qe)}</dt>
          <dt>${e.MZC.encodeHtml(ft)}</dt>
          </dl>
          `},kt=(Re,Ne)=>{const q=Ne.activeTarget.elementData.dependency._data,ie=q?.fromEvent?._data?q.fromEvent._data.name:Re.current?.instance.tasks.find(Jt=>Jt.id==q?.fromEvent)?.name,ot=q?.toEvent?._data?q.toEvent._data.name:Re.current?.instance.tasks.find(Jt=>Jt.id==q?.toEvent)?.name,qe=`From: ${ie}`,ft=`To: ${ot}`;return`<dl>
          <dt>${e.MZC.encodeHtml(qe)}</dt>
          <dt>${e.MZC.encodeHtml(ft)}</dt>
          </dl>
          `},de={textContent:!1,template:et},Ie=!1,_e=!1,Ve={tooltipTemplate:et},Gt={left:{field:"name"}},wn={editorConfig:{items:{activeField:!1}}},Kt={viewEndDay:100,viewStartDay:4},Fn=Re=>new Date(Math.max.apply(null,Re.map(q=>{let ie=g()(q.startDate).add("days",q.duration?q.duration:1).toDate();return Number(ie)})))},32571:(ze,xe,m)=>{"use strict";m.d(xe,{F:()=>te});var e=m(50318),ae=m.n(e),ce=m(32468),g=m(18484);const te=()=>{const{company:M}=(0,g.P)(),{data:Ae,isLoading:d,isFetching:se,error:Be}=(0,ce.bQ)(void 0,{skip:!M}),_=(0,e.useRef)([]),K=Ae??_.current,H=K.some(ve=>ve.companyId===M?.id),Se=K.find(ve=>ve.isDefault);return{linkedAccounts:K,defaultLinkedAccount:Se,hasLinkedAccounts:K.length>0,isActive:H,isFetching:se,isLoading:d,error:Be}}},32468:(ze,xe,m)=>{"use strict";m.d(xe,{MJ:()=>M,aM:()=>g,bQ:()=>te,vc:()=>Ae});var e=m(22923),ae=m(48361),ce=m(9402);const g=(0,e.xP)({baseQuery:(0,ae.S)({baseUrl:"/companies"}),reducerPath:"linkedAccounts",tagTypes:["LinkedAccounts"],endpoints:d=>({getLinkedAccounts:d.query({query:()=>({url:"/linked",method:"GET"}),transformResponse:se=>(0,ce.bn)(se),providesTags:["LinkedAccounts"]}),getLinkableAccounts:d.query({query:()=>({url:"/linkable"})}),updateLinkedAccounts:d.mutation({query:se=>({url:"/linked",method:"POST",data:{accounts:se}}),invalidatesTags:["LinkedAccounts"]})})}),{useGetLinkedAccountsQuery:te,useGetLinkableAccountsQuery:M,useUpdateLinkedAccountsMutation:Ae}=g},34012:(ze,xe,m)=>{"use strict";m.d(xe,{Y:()=>Be});var e=m(74848),ae=m(50318),ce=m.n(ae),g=m(52162),te=m(11641),M=m(18484),Ae=m(36529),d=m(4004),se=m(32571);const Be=({searchTerm:_,communityId:K="ALL",filteredLabels:H,showErrorMessage:Se=!0,shouldRefetch:ve=!0,showArchived:ye=!1,shouldLink:Ce=!1,skip:Ke=!1})=>{const{company:Je,companyLoading:jt}=(0,M.P)(),{isFetching:wt,isActive:Ft}=(0,se.F)(),{showError:Ut}=(0,d.d)(),{data:jn,isLoading:rn,isFetching:Vt,error:$t,refetch:It}=(0,Ae.su)({search:_,companyId:Je?.id,labels:H,communityId:K,showArchived:ye,linked:Ce&&Ft},{skip:Ke||!Je?.id||jt||Ce&&wt,refetchOnMountOrArgChange:ve?2:!1});(0,ae.useEffect)(()=>{if($t&&Se){const Yt=(0,e.jsx)("a",{href:"http://mybldr.com/help ",children:(0,e.jsx)(te.A,{children:(0,e.jsx)(g.A,{fontSize:"small"})})});Ut({message:"There was an error retrieving your projects. Please refresh your page in a couple of minutes. If the error continues, please visit MyBLDR help.",action:Yt})}},[$t,Se,Ut]);const Et=(0,ae.useMemo)(()=>[],[]),Bt=jn??Et,nn=Array.from(new Set(jn?.map(Yt=>Yt.onlineJobId).filter(Yt=>typeof Yt=="string")))||[];return{projectList:Bt,jobIdList:nn,isLoading:rn,isFetching:Vt,error:$t,refetch:It}}},36529:(ze,xe,m)=>{"use strict";m.d(xe,{AQ:()=>Ae,Nq:()=>g,P3:()=>d,SU:()=>se,VY:()=>Be,h:()=>M,l:()=>_,su:()=>te,zt:()=>K});var e=m(22923),ae=m(48361),ce=m(9402);const g=(0,e.xP)({baseQuery:(0,ae.S)({baseUrl:"/api"}),reducerPath:"projects",keepUnusedDataFor:1,tagTypes:["Projects","Labels"],endpoints:H=>({getProjects:H.query({query:({search:Se,companyId:ve,labels:ye,communityId:Ce,showArchived:Ke,linked:Je=!1})=>{let jt=`/company/${ve}/projects/search`;if(Se||ye||Ce||Ke!==void 0){jt+="?";const wt=[];Se&&wt.push(`search_term=${Se}`),ye&&wt.push(`labels=${ye||[]}`),Ce&&wt.push(`community_id=${Ce}`),Ke!==void 0&&wt.push(`show_archived=${Ke}`),Je&&wt.push("linked=true"),jt+=wt.join("&")}return{url:jt}},transformResponse:Se=>(0,ce.bn)(Se),providesTags:["Projects"]}),getProjectsByAddress:H.query({query:({companyId:Se,address:ve})=>{let ye=`/company/${Se}/projects/address_check`;return ye+=`?street_one=${ve?.streetOne}&city=${ve?.city}&state=${ve?.state}&zip=${ve?.zip}`,{url:ye}},transformResponse:Se=>(0,ce.bn)(Se),providesTags:["Projects"]}),getLabels:H.query({query:({companyId:Se,hasLinkedAccount:ve})=>({url:`/company/${Se}/project_labels${ve?"?linked=True":""}`}),providesTags:["Labels"]}),createProject:H.mutation({query:({name:Se,street:ve,city:ye,state:Ce,zip:Ke,labels:Je,companyId:jt,quoteData:wt,communityId:Ft,jobId:Ut})=>({url:`/companies/${jt}/create_project`,method:"POST",data:{name:Se,address:{street_one:ve,city:ye,state:Ce,zip:Ke},labels:Je,quote_data:wt,community_id:Ft,job_id:Ut}}),transformResponse:Se=>(0,ce.bn)(Se),invalidatesTags:["Projects","Labels"]}),copyQuote:H.mutation({query:({name:Se,companyId:ve,quoteData:ye})=>({url:`/companies/${ve}/add_quote_from_master_set`,method:"POST",data:{name:Se,quote_data:ye}}),transformResponse:Se=>(0,ce.bn)(Se)}),canMoveOrMergeProject:H.query({query:({companyId:Se,projectId:ve,projectName:ye,containsPreviewLink:Ce,action:Ke})=>({url:`/company/${Se}/project/${ve}/project_can_move_or_merge?projectName=${encodeURIComponent(ye)}&containsPreviewLink=${Ce}&action=${Ke}`}),transformResponse:Se=>(0,ce.bn)(Se)}),moveProject:H.mutation({query:({externalId:Se,dstCompanyData:ve,srcCompanyData:ye})=>({url:`/project/${Se}/move_project`,method:"POST",data:{dstCompanyData:ve,srcCompanyData:ye}}),invalidatesTags:(Se,ve)=>Se?["Projects"]:[]}),mergeProjects:H.mutation({query:({dstProjectExternalId:Se,srcProjectExternalId:ve,erpSystem:ye,accountNumber:Ce,onlineJobId:Ke})=>({url:"/project/merge",method:"POST",data:{dstProjectExternalId:Se,srcProjectExternalId:ve,erpSystem:ye,accountNumber:Ce,onlineJobId:Ke}}),invalidatesTags:(Se,ve)=>Se?["Projects"]:[]})})}),{useGetProjectsQuery:te,useGetLabelsQuery:M,useCreateProjectMutation:Ae,useLazyGetProjectsByAddressQuery:d,useCopyQuoteMutation:se,useCanMoveOrMergeProjectQuery:Be,useMoveProjectMutation:_,useMergeProjectsMutation:K}=g},94261:(ze,xe,m)=>{"use strict";m.d(xe,{e1:()=>kt,uv:()=>Vt,aP:()=>jn,_C:()=>rn,lX:()=>$t,cU:()=>Se,Vc:()=>Ke,DX:()=>Yt,K7:()=>et,tW:()=>_,OU:()=>ve,Oo:()=>Je,Ok:()=>ye,RX:()=>Et,yr:()=>H,sp:()=>nn,Mv:()=>Be,eL:()=>Ce,pR:()=>K});var e=m(28072),ae=m(9755),ce=m(41e3),g=m.n(ce),te=m(88835),M=m(35403);class Ae extends ae.dmw{static get fields(){return[{name:"phase"},{name:"assignedTo"},{name:"taskStatus"},{name:"includeHolidays"},{name:"includeWeekends"}]}}class d extends ae.Bo7{async isValidDependency(Ie,_e){return ve(Ie._data)||ve(_e._data)?!1:super.isValidDependency(Ie._data.id,_e._data.id)}}var se=m(2543);const Be=de=>{_(),e.n1E.mask({text:de,mode:"dark-blur"},document.body)},_=()=>{e.n1E.unmask(document.body)},K=de=>({cls:"b-fa b-fa-ellipsis-v grid-updated-add task-menu-button",visible:({record:Ie})=>!ve(Ie._data),onClick:Ie=>{new ae.zDc({forElement:Ie.target,cls:"custom-popup-menus",autoShow:!1,closable:!1,closeAction:"destroy",style:"flex-direction: column",align:{align:"t-b",anchor:!0},items:{edit:{type:"button",text:"Edit",icon:"b-fa-edit",onClick:()=>de.current.instance.editTask(Ie.record)},delete:{type:"button",text:"Delete",icon:"b-fa-trash",onClick:async()=>{await e.E1Z.confirm({title:"Delete",message:"Are you sure you want to delete this task?",okButton:"Yes",cancelButton:"No"})===e.E1Z.okButton&&de.current?.instance.taskStore.remove([Ie.record._data.id])}}}}).show()}});function H(de){let Ie="";return de.assignmentRecords.forEach(_e=>{let Ve=_e._data.resource._data;Ie==""?Ie=Ve.name!==null&&Ve.name!==""?Ve.name:Ve.email:Ie=Ie+", "+(Ve.name!==null&&Ve.name!==""?Ve.name:Ve.email)}),Ie}function Se(de){let Ie={weekDays:{0:!1,1:!1,2:!1,3:!1,4:!1,5:!1,6:!1},holidays:[]};return Ie.weekDays=de.calendars[3].originalData.intervals[0],Ie.holidays=de.timeRanges.map(_e=>({description:_e.name,date:_e.startDate})),de.timeRanges.forEach(_e=>{let Ve={description:_e.name,date:_e.startDate};Ie.holidays.push(Ve)}),Ie}const ve=de=>!!(!de.parentId||de.parentId==0||de.parentId.toString().includes("generated")),ye=async de=>{function Ie(_e){return _e.taskType==="TODO"&&_e.parentId===0}if(Ie(de.context.startRecord.originalData)||de.context.insertBefore&&Ie(de.context.insertBefore.originalData)||de.context.insertBefore&&de.context.parent.originalData.parentId==0&&de.context.startRecord.originalData.parentId==0)return!1},Ce={editorConfig:{title:"Task Information",centered:!0,bbar:{items:{deleteButton:{type:"button",text:"Delete",style:{fontSize:14,fontWeight:600,backgroundColor:"var(--light-error-dark)",color:"white",marginRight:"auto"},weight:1},unscheduleButton:{type:"button",text:"Unschedule",weight:2,style:{color:"var(--light-warning-contrast)",fontSize:14,backgroundColor:"var(--light-secondary-light)"}},cancelButton:{style:{backgroundColor:"var(--light-secondary-main)",color:"white",fontSize:14,fontWeight:600},weight:3},saveButton:{type:"button",text:"Save",style:{backgroundColor:"var(--light-info-main)",color:"white"},weight:4}}}},items:{generalTab:{items:{effort:!1,divider:!1,name:{type:"text",name:"name",label:"Task Name",value:"",required:!0,weight:1},phase:{type:"combo",items:[],name:"parentId",valueField:"value",displayField:"text",label:"Phase",value:"",weight:2},startDate:{name:"startDate",label:"Start Date",weight:3},duration:{name:"duration",type:"number",label:"Duration",value:"",decimalPrecision:0,min:1,required:!0,weight:4},endDate:!1,taskStatus:{type:"combo",items:[],label:"Status",value:"",weight:5},percentDone:{type:"number",decimalPrecision:0,min:0,required:!0}}},notesTab:!0,resourcesTab:{showUnits:!1,items:{grid:{features:{headerMenu:!1},columns:{data:{resource:{text:"ASSIGNEE",editor:{type:"combo",filterOperator:"includes"}}}}}}},advancedTab:{items:{calendarField:!1,schedulingModeField:!1,effortDrivenField:!1,constraintTypeField:!1,constraintDateField:!1,rollupField:!1,divider:!1,inactiveField:!1,ignoreResourceCalendarField:!1,manuallyScheduledField:!1,includeHolidays:{type:"checkbox",name:"includeHolidays",label:"INCLUDE HOLIDAYS",labelPosition:"before",value:!1},includeWeekends:{type:"checkbox",name:"includeWeekends",label:"INCLUDE WEEKENDS",labelPosition:"before",value:!1}}},predecessorsTab:{items:{grid:{features:{headerMenu:!1}}}},successorsTab:{items:{grid:{features:{headerMenu:!1}}}}}},Ke=de=>{let Ie=new Date,_e=new Date;return de.length>0&&(Ie=new Date(Math.min.apply(null,de.filter(Ve=>Ve.startDate!=null).map(Ve=>Number(new Date(Ve.startDate))))),_e=new Date(Math.max.apply(null,de.filter(Ve=>Ve.endDate!=null).map(Ve=>Number(new Date(Ve.endDate)))))),{minDate:Ie,maxDate:_e}},Je=de=>de.taskType=="TODO";function jt(de,Ie){let _e=Ie.getDay();var Ve=[];return Ve.push(de.weekDays[0]),Ve.push(de.weekDays[1]),Ve.push(de.weekDays[2]),Ve.push(de.weekDays[3]),Ve.push(de.weekDays[4]),Ve.push(de.weekDays[5]),Ve.push(de.weekDays[6]),Ve[_e]==!0}function wt(de,Ie,_e,Ve){return!!(!Ve&&de&&jt(de,Ie)||!_e&&de&&de.holidays.findIndex(wn=>{let Kt=new Date(wn.date);return Kt.setHours(0,0,0,0),Ie.setHours(0,0,0,0),moment(Kt).isSame(moment(Ie))})>=0)}function Ft(de,Ie){if(jt(de,Ie)==!0)return{description:"It is a non working day",date:Ie};var _e=de.holidays.find(Ve=>{let Gt=new Date(Ve.date);return Gt.setHours(0,0,0,0),Ie.setHours(0,0,0,0),moment(Gt).isSame(moment(Ie))});return _e}async function Ut(de,Ie,_e,Ve,Gt){if(await e.E1Z.confirm({title:"This To-Do task will be unschedule",message:"Are you sure you want to unschedule this Task? <br>Do you wish to continue? ",okButton:"Yes",cancelButton:"Cancel"})===e.E1Z.okButton){const Kt={start_date:null,end_date:null};return Ie&&Ie.map(async Re=>{(Re.from===de||Re.fromEvent===de||Re.to===de||Re.toEvent===de)&&await Ve(Re.id,Gt?.id)}),await _e(de,Kt)}}const jn=(de,Ie,_e,Ve,Gt,wn,Kt,Fn)=>{const Re=de.editor,Ne=Re._widgetMap,q=de.taskRecord._data;de.taskRecord.originalData.taskType==="TODO"?(Re.height=670,Re.title="To-Do Information",Ne.unscheduleButton.hidden=!1,Ne.duration.hidden=!0,Ne.name.label="TO-DO NAME",Ne.startDate.label="DUE DATE"):(Re.height=720,Re.title="Task Information",Ne.unscheduleButton.hidden=!0,Ne.duration.hidden=!1,Ne.name.label="TASK NAME",Ne.startDate.label="START DATE"),Re.autoClose=!1;const ie=Ie.timeRanges.map(Ht=>new Date(Ht.startDate)),ot=Se(Ie);Ne.startDate.picker.disableWeekends=!de?.taskEdit?.record._data.includeWeekends,Ne.startDate.picker.nonWorkingDays=ot.weekDays,Ne.startDate.picker.disabledDates=de?.taskEdit?.record._data.includeHolidays?[]:ie,Ne.unscheduleButton.onAction=async()=>{const Ht=await Ut(de?.taskEdit?.record?.originalData?.id,Ie.dependencies,_e,Ve,Gt);Ht?.data?(Fn.current.instance.project.load(),Re.close(),Be("Todo Unscheduled successfully"),(0,se.delay)(()=>{_()},1500)):Be(Ht?.error)};let qe=Ie.tasks.filter(Ht=>Ht._data.parentId.toString().includes("generated")).map(Ht=>({value:Ht._data.id,text:Ht._data.name}));Ne.phase.items=qe,Ne.phase.value=qe.find(Ht=>Ht.value==q?.parentId);let ft=de.taskRecord.originalData.taskType==="TODO"?Kt.filter(Ht=>Ht.is_todo_status):Kt;Ne.taskStatus.items=ft.map(Ht=>({value:Ht.id,text:Ht.status})),Ne.taskStatus.onChange=()=>{},q.taskStatus!==""&&(Ne.taskStatus.value=q.taskStatus),Ne.taskStatus.onChange=Ht=>{Ie.tasks.map(Cs=>{if(Cs.id==q.id){Cs.taskStatus=Ht.value;let Ts=Yt(Ht.value,Ht.oldValue);Cs.percentDone=Ts}})},Ne.percentDone.onChange=Ht=>{if(!Ht.userAction)return;let Cs=et(Ht.value,q.taskType);Ie.tasks.map(Ts=>{Ts.id==q.id&&(Ts.taskStatus=Cs,Ne.taskStatus.value=Cs)})},Ne.startDate.value=q.startDate,Je(de.taskRecord.originalData)?Ne.duration.editable=!1:Ne.duration.editable=!0,Ne.includeWeekends.value=q.includeWeekends,Ne.includeHolidays.value=q.includeHolidays,Ne.startDate.onAction=Ht=>{Ht.value==null&&(Ht.valid=!0,Ht.value=Ht.oldValue),Ie.startDate>Ht.value&&(Ie.startDate=g()(Ht.value).subtract(1,"days").toDate())}},rn=[{text:"ASSIGNEE",width:250,field:"assignedTo",editor:{type:"combo",filterOperator:"includes",value:"",items:[]}}],Vt=(de,Ie,_e)=>{Be("Updating..."),de?Ie=="subtask"?de.insertChild({name:"New Task",duration:1,startDate:de._data.startDate,constraintType:"startnoearlierthan"},de.nextSibling):de.parent.insertChild({name:Ie=="phase"?"New Phase":"New Task",duration:de._data.duration,startDate:de._data.startDate,expanded:!0,constraintType:"startnoearlierthan"},de.nextSibling):_e.current?.instance.taskStore.add({name:"New Phase",duration:1,startDate:g()(g()(new Date).format(te.MK)+" 00:00:00").toDate(),expanded:!0,constraintType:"startnoearlierthan"})},$t=async de=>await e.E1Z.confirm({title:`This ${de?"phase":"task"} will be deleted`,message:`Are you sure you want to delete this ${de?"phase":"task"}? <br>Do you wish to continue? `,okButton:"Yes",cancelButton:"Cancel"}),It=new Date(g()(new Date).format(te.MK)+" 00:00:00"),Et=(de,Ie,_e)=>{const{csrftoken:Ve}=(0,M.t)();return new ae.NNt({taskStore:{autoTree:!0,useRawData:!1},dependencyStore:{useRawData:!0},dependencyStoreClass:d,taskModelClass:Ae,transport:{load:{url:`/scheduler/company/${Ie}/project/${de}/gantt`,headers:{"X-CSRFToken":Ve,"X-Paradigm-Access-Token":_e}},sync:{url:`/scheduler/company/${Ie}/project/${de}/gantt/v2`,headers:{"X-CSRFToken":Ve,"X-Paradigm-Access-Token":_e}}},autoSync:!0,autoLoad:!0,validateResponse:!0,writeAllFields:!0})};var Bt=(de=>(de[de.StartToStart=0]="StartToStart",de[de.StartToEnd=1]="StartToEnd",de[de.EndToStart=2]="EndToStart",de[de.EndToEnd=3]="EndToEnd",de))(Bt||{});const nn=(de,Ie)=>{if(de.store._id=="dependencies"&&de.action=="update"&&de.records.forEach(_e=>{let Ve=new Date;const Gt=_e._data.lag,wn=Ie.ganttRef.current?.instance.taskStore.getById(_e._data.to??(_e._data.toEvent._data?_e._data.toEvent._data.id:_e._data.toEvent)),Kt=Ie.ganttRef.current?.instance.taskStore.getById(_e._data.from??(_e._data.fromEvent._data?_e._data.fromEvent._data.id:_e._data.fromEvent));if(Kt){switch(_e._data.type){case 0:Ve=g()(Kt.startDate).add(Gt,"days").toDate();break;case 1:Ve=g()(Kt.startDate).add(Gt-1,"days").toDate();break;case 2:Ve=g()(Kt.endDate).add(Gt,"days").toDate();break;case 3:Ve=g()(Kt.endDate).add(Gt-1,"days").toDate();break;default:break}wn.set({constraintDate:Ve})}}),de.record){const{minDate:_e,maxDate:Ve}=Ke(Ie.projectModel.tasks),Gt=new Date(de.source.project.startDate),wn=new Date(de.source.project.endDate);g()(Gt).isAfter(g()(_e))&&(de.source.project.startDate=de.record._data.startDate),g()(wn).isBefore(g()(Ve))&&(de.source.project.endDate=de.record._data.endDate)}Ie.setApplyByDropdownEnabled(Ie.ganttRef.current.instance.tasks.length>0)},Yt=(de,Ie)=>{let _e=0;switch(de){case 2:_e=0;break;case 3:Ie==1?_e=99:_e=1;break;case 1:_e=100;break}return _e},et=(de,Ie="TASK")=>{let _e=2;return de==0&&(_e=2),de>0&&de<100&&(Ie=="TODO"?_e=2:_e=3),de==100&&(_e=1),_e};var kt=(de=>(de[de.Open=0]="Open",de[de.Completed=1]="Completed",de[de.NotStarted=2]="NotStarted",de[de.InProgress=3]="InProgress",de))(kt||{})},7609:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>Be});var e=m(32915),ae=m(45959),ce=m(50318),g=m(28729);const te=_=>_.toLowerCase().split(" ").map((K,H)=>H===0?K:K.charAt(0).toUpperCase()+K.slice(1)).join(""),M=({permissions:_,action:K,tool:H,companyId:Se,projectId:ve,extent:ye})=>_.some(Ce=>{const Ke=Ce.action===K,Je=te(Ce.tool)===H,jt=Ce.extent===ye,wt=Ce.fieldsToIgnore?.includes("companyId")||Ce.companyId===String(Se),Ft=Ce.fieldsToIgnore?.includes("projectId")||Ce.projectId===ve;return Ke&&Je&&wt&&Ft&&jt});var Ae=m(63183),d=m(15816);const Be=()=>{const{isFlagEnabled:_}=(0,e.u)(),{hasPermission:K,allRoles:H}=(0,ae.Sk)(),{isLoggedIn:Se}=(0,Ae.A)(),{data:ve,isLoading:ye,isFetching:Ce,isSuccess:Ke,error:Je}=(0,d.X)(void 0,{skip:!Se}),jt=ve?.permissions,wt=ve?.companies,Ft=_(g.SX.USER_LEVEL_PERMISSIONS);return{userHasPermission:(0,ce.useCallback)(({tool:jn,action:rn,companyId:Vt,projectId:$t,extent:It=g.J8.TABLE,permanentlyDisable:Et})=>{const Bt={action:rn,tool:jn,companyId:Vt,projectId:$t,permanentlyDisable:Et};return Et?!1:Ft?M({permissions:jt??[],...Bt,extent:It}):K(Bt)},[Ft,K,jt]),permissions:ve?.permissions,allRoles:H,data:jt,companies:wt,isUserPermissionsLoading:ye,isUserPermissionsFetching:Ce,userPermissionsFetched:Ke,error:Je}}},15816:(ze,xe,m)=>{"use strict";m.d(xe,{Q:()=>g,X:()=>te});var e=m(22923),ae=m(48361),ce=m(9402);const g=(0,e.xP)({baseQuery:(0,ae.S)({baseUrl:"/"}),reducerPath:"userPermissions",keepUnusedDataFor:0,endpoints:M=>({getUserPermissions:M.query({query:()=>({url:"api/user/userpermissions"}),transformResponse:Ae=>(0,ce.bn)(Ae)})})}),{useGetUserPermissionsQuery:te}=g},63183:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>g,c:()=>ce});var e=m(50318),ae=m.n(e);const ce=(0,e.createContext)({isLoggedIn:!1,onSignOut:async()=>{},waiting:!1,userDataWaiting:!0,user:void 0,permissions:{},hasPermission:()=>!1,permissionsLoading:!1,updateUser:async()=>{},refreshUserData:async()=>{},token:void 0,setTokenWithExpiry:()=>{},accessToken:null,refreshToken:async()=>null}),g=()=>(0,e.useContext)(ce)},18484:(ze,xe,m)=>{"use strict";m.d(xe,{P:()=>te,z:()=>g});var e=m(50318),ae=m.n(e);const ce={company:null,companyLoading:!1,fetchCompany:(M,Ae)=>Promise.resolve()},g=ae().createContext(ce),te=()=>ae().useContext(g)},32915:(ze,xe,m)=>{"use strict";m.d(xe,{c:()=>ce,u:()=>g});var e=m(50318),ae=m.n(e);const ce=ae().createContext({featureFlags:[],error:null,isLoading:!1,isFlagEnabled:te=>!1,fetched:!1}),g=()=>ae().useContext(ce)},45959:(ze,xe,m)=>{"use strict";m.d(xe,{KV:()=>te,Sk:()=>M,wy:()=>g});var e=m(50318),ae=m.n(e);const ce={fetchProjectPermissions:Ae=>{},projectPermissions:[],userPermissions:{},permissionsLoading:!0,userPermissionsLoading:!0,fetchUserPermissions:()=>{},hasPermission:()=>!1,getRoleFromPermissions:()=>"",userHighestRole:"",userPermissionsFetched:!1,allRoles:new Set,canCreateProject:Ae=>!1,canEditProject:(Ae,d)=>!1};var g=(Ae=>(Ae.OSR="OSR",Ae.CompanyManager="Company Manager",Ae.CompanyCrew="Company Crew",Ae.Subs="Subs",Ae.Homebuyer="Homebuyer",Ae.BFSComponentDesign="BFS Component Design",Ae.BFS3pQuoteAdmin="BFS 3P Quote Admin",Ae.MarketManager="Market Manager",Ae.BIMCoordinator="BIM Coordinator",Ae))(g||{});const te=(0,e.createContext)(ce),M=()=>(0,e.useContext)(te)},26142:(ze,xe,m)=>{"use strict";m.d(xe,{B:()=>te,v:()=>g});var e=m(50318),ae=m.n(e);const ce={project:null,createLoading:!1,isSubs:!1,clearSelectedProject:()=>{},selectProject:()=>{},fetchProject:M=>{},setArchivingProject:M=>{},projectLoading:!1,archivingProject:!1},g=ae().createContext(ce),te=()=>ae().useContext(g)},4004:(ze,xe,m)=>{"use strict";m.d(xe,{$:()=>g,d:()=>ce});var e=m(50318),ae=m.n(e);const ce=()=>ae().useContext(g),g=ae().createContext({showToast:()=>"",showSuccess:()=>"",showError:()=>"",showRefreshAppToast:()=>"",showLoadingToast:()=>"",closeToast:()=>({})})},36316:(ze,xe,m)=>{"use strict";m.d(xe,{ho:()=>e.A,ts:()=>ce.A,HO:()=>d,AG:()=>se.A,Pe:()=>H.P,DZ:()=>ye});var e=m(60162),ae=m(68804),ce=m(97223),g=m(92990),te=m(4004),M=m(66251),Ae=m(18484);function d(){const{showError:Vt}=(0,te.d)(),{company:$t}=(0,Ae.P)();return{fetchDeliveryPhotos:async(Et,Bt,nn,Yt,et=10,kt,de=!1)=>{const Ie=`/api/company/${$t.id}/projects/${Et}/orders/${Bt}/delivery_photos`;let _e=!1,Ve=0,Gt=1;for(;Ve<Gt&&!_e;)try{Ve++;const wn=await M.Ay.get(Ie);console.info(`Making a request to /delivery_photos on attempt ${Ve}`);const{deliveries:Kt,retry_limit:Fn}=wn.data;Gt=Fn;let Re=[],Ne=0;if(kt){const qe=Kt.find(ft=>ft.deliveryId===kt);Re=qe?.photos||[],Ne=qe?.numPhotos||0,console.info(`Expecting ${Ne} photos for order ${Bt}`)}else Re=Kt.reduce((qe,ft)=>qe.concat(ft.photos),[]),Ne=Kt.reduce((qe,ft)=>qe+ft.numPhotos,0);let q=!1;Ne===0&&(q=!0),Re.length>0&&(q=!0);const ie={orderId:Bt,photos:Re,numPhotos:Ne,firstLoadComplete:q},ot=[...nn,ie];Yt(de?[ie]:ot),_e=Re.length>=Ne,_e||await new Promise(qe=>setTimeout(qe,et))}catch{break}}}}var se=m(47263),Be=m(17978);const _=()=>{const{showSuccess:Vt,showError:$t}=useToast(),[It]=useCreateInvoiceFileMutation(),Et=async(et,kt)=>{try{return await api.put(kt,et,{headers:{"Content-Type":et.type,"x-ms-version":"2019-12-12","x-ms-blob-type":"BlockBlob"}})}catch(de){throw console.log(de),$t({title:`Failed to Upload File: ${et.name}}`,message:"There was an error uploading the file. Please try again."}),de}};return{uploadInvoiceAttachment:async(et,kt)=>{try{const de=await api.post(`/budgeting/invoice/${kt}/files/create`,{filename:et.name,file_type_id:9},{headers:{"Content-Type":"multipart/form-data"}}),{upload_url:Ie,file_id:_e}=de.data,Ve=await Et(et,Ie);return Vt({title:"Upload Successful",message:`The file ${et.name} has been successfully uploaded.`}),{data:{fileData:{file_name:Ve.config.data.name,url:Ve.config.url,file_id:_e,file_type:Ve.config.data.type},orderData:de.data}}}catch(de){let Ie=de?.response?.data?.includes("already exists")?`The file ${et.name} already exists.`:`There was an error uploading the file ${et.name}. Please try again.`;$t({title:"Upload Failed",message:Ie})}},uploadInvoiceAttachmentV2:async(et,kt,de)=>{const Ie=await It({uid:kt,projectId:de,fileName:et.name});return"error"in Ie||!Ie.data.uploadUrl?($t({title:"Upload Failed",message:getErrorMessageFromResponseError(Ie,"There was an error uploading the file. Please try again or refresh the page.")}),!1):(await Et(et,Ie.data.uploadUrl),!0)},uploadFileToUploadURL:Et,deleteInvoiceAttachment:async(et,kt)=>{try{await api.delete(`/budgeting/invoice_file/${et}/${kt}/delete`),Vt({title:"Attachment Removed",message:`The file "${kt}" has been successfully removed.`})}catch(de){$t({title:"Deletion Unsuccessful",message:`We encountered a problem removing "${kt}". Please try again.`}),console.error(de)}}}},K=null;var H=m(64268),Se=m(21281),ve=m(50318);function ye(Vt){const[$t,It]=(0,ve.useState)([]),[Et,Bt]=(0,ve.useState)({}),[nn,Yt]=(0,ve.useState)([]),[et,kt]=(0,ve.useState)(!0),[de,Ie]=(0,ve.useState)(null),[_e,Ve]=(0,ve.useState)(),[Gt,wn]=(0,ve.useState)(),[Kt,Fn]=(0,ve.useState)(!1),Re=(0,ve.useCallback)(async()=>{try{kt(!0);const q=await M.Ay.get(`/api/projects/${Vt}/assignments`);It(q.data.assignments),Yt(q.data.crew_assignments),wn(q.data.role_based_data),Ve(q.data.roles),Fn(q.data.is_portal_access_enabled),Bt(q.data.tools)}catch(q){Ie(q)}finally{kt(!1)}},[Vt]);return{assignments:$t,crewAssignments:nn,tools:Et,isLoading:et,error:de,fetchAssignments:Re,getUpdatedAssignments:async()=>{try{const q=await M.Ay.get(`/api/projects/${Vt}/assignments`);It(q.data.assignments),Yt(q.data.crew_assignments),wn(q.data.role_based_data),Ve(q.data.roles)}catch(q){Ie(q)}},roles:_e,roleBasedData:Gt,isPortalAccessEnabled:Kt}}var Ce=m(90972),Ke=m(74848),Je=m(13561),jt=m(12565),wt=m(9402);function Ft(){const Vt=useDispatch(),{showError:$t}=useToast(),{company:It}=useCompany(),Et=useRef(It?.id),Bt=useSelector(Ie=>Ie.project.projectList),nn=useSelector(Ie=>Ie.project.fetchingProjectList),Yt=useStore(),et=useCallback(async(Ie=!0)=>{Et.current=It?.id,Vt(setFetchingProjectList(Ie));try{const _e=await api.get("/api/projects");if(Et.current!==It?.id)return;Vt(setProjectList(camelizeKeys(_e?.data||[]))),Vt(setFetchingProjectList(!1))}catch(_e){const Ve=jsx("a",{href:"/help ",children:jsx(IconButton,{children:jsx(HelpIcon,{fontSize:"small"})})});$t({message:"There was an error retrieving your projects. Please refresh your page in a couple of minutes. If the error continues, please visit MyBLDR help.",action:Ve}),console.error("Failed to fetch projects",_e),setFetchingProjectList(!1)}},[Vt,Yt,$t]),kt=useMemo(()=>new Set(Bt.map(Ie=>Ie.projectName)),[Bt]);return{projectList:Bt,fetchingProjectList:nn,fetchProjectList:et,isProjectNameUnique:Ie=>!kt.has(Ie)}}var Ut=m(47333),jn=m(31007),rn=m(93234)},60162:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>K,O:()=>_});var e=m(18484),ae=m(45959),ce=m(50318),g=m.n(ce),te=m(39055),M=m.n(te),Ae=m(28729),d=m(29433),se=m(7609),Be=m(30583),_=(H=>(H.PROJECT="project",H.BFS="bfs",H.NONE="none",H.BUILDER_TOOLS="companies",H))(_||{});function K(){const{company:H}=(0,e.P)(),{userHighestRole:Se,permissionsLoading:ve,allRoles:ye}=(0,ae.Sk)(),Ce=(0,te.useNavigate)(),{userHasPermission:Ke,data:Je}=(0,se.A)(),jt=(0,te.useMatch)("/projects/*"),wt=(0,te.useMatch)("/bfs/*"),Ft=(0,te.useMatch)("/companies/*"),Ut=(0,Be.EL)(ye),jn=Se===ae.wy.CompanyManager,rn=()=>jt?"project":wt?"bfs":Ft?"companies":"none",Vt=Ke({tool:Ae.w5.ORDERS,action:Ae.a2.VIEW_ORDERS,companyId:H?.id,projectId:void 0}),$t=Ke({tool:Ae.w5.PROJECTS,action:Ae.a2.VIEW_PROJECTS_DASHBOARD,companyId:H?.id,projectId:void 0}),It=Je?.some(et=>et.canViewBfsFocusState),Et=Je?.some(et=>et.canViewBuilderFocusState),Bt=(0,ce.useCallback)(et=>et==="project"?!0:et==="bfs"?It?!0:!!Ut:et==="companies"?Et?!0:!!Ut:!1,[Ut,It,Et]),nn=rn(),Yt=(0,ce.useCallback)(et=>{if(!(et===nn||!Bt(et))){if(et==="bfs"&&H?.id){let kt=`/bfs/${H.id}`;Ut?kt="/bfs/select_customer":(H.isPoCustomer||Vt)&&H.erpSystem!==d.v.AS400?kt+="/orders":kt+="/statements",Ce(kt)}et==="companies"&&H?.id&&Ce(Ut||$t?`/companies/${H?.id}/projects`:`/companies/${H?.id}/catalog`)}},[Bt,nn,H?.id,Ce,Ut,jn]);return{appFocus:nn,canUseFocus:Bt,switchFocus:Yt}}},68804:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>te});var e=m(4004),ae=m(50318),ce=m.n(ae),g=m(66251);function te(M,Ae){const[d,se]=(0,ae.useState)(!0),[Be,_]=(0,ae.useState)(null),[K,H]=(0,ae.useState)(null),{showSuccess:Se,showError:ve}=(0,e.d)(),[ye,Ce]=(0,ae.useState)([]),[Ke,Je]=(0,ae.useState)(),[jt,wt]=(0,ae.useState)(),[Ft,Ut]=(0,ae.useState)(!1),jn=async()=>{se(!0);try{const It=Ae?`?project_id=${Ae}`:"",Et=await g.Ay.get(`/api/companies/${M}/crew_permissions${It}`);return _(Et?.data?.crew_assignments),H(Et?.data?.tools),Ce(Et?.data?.roles),Je(Et?.data?.role_based_data),wt(Et?.data?.user_level_permissions),Ut(Et?.data?.is_portal_access_enabled),Et?.data}catch(It){console.error("An error occurred:",It)}finally{se(!1)}},rn=async()=>{try{const It=await g.Ay.get(`/api/companies/${M}/crew_permissions`);_(It?.data?.crew_assignments),Ce(It?.data?.roles),Je(It?.data?.role_based_data)}catch(It){console.error("An error occurred:",It)}finally{se(!1)}};return{isLoading:d,getUpdatedAssignments:rn,fetchCrewAssignmentsAndTools:jn,assignments:Be,tools:K,addRoleWithPermissions:async(It,Et,Bt)=>{if(se(!0),!It||It.trim()===""){ve({message:"Role name is undefined"}),se(!1);return}try{(await g.Ay.post("/api/role/permissions",{name:It,permission_ids:Et,company:Bt.id})).status===201&&Se({message:"Successfully created"})}catch{ve({title:"Custom role cannot be created",message:"We're sorry! All role names must be unique. Please try creating your role again with a different name, and contact Customer Support if the problem persists or you feel it is in error."})}finally{se(!1)}await rn()},updateRoleWithPermissions:async(It,Et,Bt)=>{se(!0);try{const nn={id:Bt,name:It,permission_ids:Et};try{const Yt=await g.Ay.put(`/api/role/permissions/${Bt}`,{id:Bt,name:It,permission_ids:Et})}catch{ve({title:"Custom role cannot be updated",message:"We're sorry! All role names must be unique."})}finally{se(!1)}}finally{se(!1),await rn()}},roles:ye,roleBasedData:Ke,userPermissions:jt,isPortalAccessEnabled:Ft}}},97223:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>g});var e=m(50318),ae=m(66251);const ce=async te=>(await ae.Ay.get(`/api/get_crew_summary/${te}`))?.data?.company;function g(te,M){const[Ae,d]=(0,e.useState)(!1),[se,Be]=(0,e.useState)(),_="/api/user/assignments",K="/api/roles",H=async()=>{d(!0);try{if(!te)throw new Error("Project id is not defined");const Ke=await ce(te);d(!1),Be(Ke)}catch{d(!1)}},Se=async(Ke,Je,jt)=>{d(!0);try{const wt=await ae.Ay.put(`${_}/${jt}`,{full_name:`${Je.firstName} ${Je.lastName}`,email:Je.email,phone:Je.phoneNumber,role_id:Ke,project_id:te||void 0,company_id:M}),{users_added:Ft,error:Ut}=wt?.data;return await H(),d(!1),{userAdded:Ft,error:Ut}}catch(wt){return d(!1),{userAdded:null,error:wt}}},ve=async(Ke,Je,jt={})=>{const{suppressEmail:wt=!1}=jt;d(!0);try{const Ft=await ae.Ay.post(_,{email:Je.email,full_name:Je.firstName||Je.lastName?`${Je.firstName} ${Je.lastName}`:"",phone:Je.phoneNumber,role_id:Ke,project_id:te||void 0,company_id:M,suppress_email:wt}),{user_added:Ut,error:jn}=Ft?.data;return await H(),d(!1),{userAdded:Ut,error:jn}}catch(Ft){return d(!1),{userAdded:null,error:Ft}}},ye=async Ke=>{d(!0);try{const Je=await ae.Ay.delete(`${K}/${Ke}/`),{status:jt}=Je;if(jt===204)return{roleDeleted:!0,errors:{}};if(jt===418)return{roleDeleted:!1,errors:{message:"You cannot delete role with users assigned to it."}}}catch(Je){return d(!1),{roleDeleted:!1,errors:Je,status:Je.response.status}}},Ce=async(Ke,Je,jt)=>{d(!0);try{const wt={project_id:te,company_id:M,user_id_to_remove:Je},Ft=await ae.Ay.delete(`${_}/${jt}`,{data:JSON.stringify(wt),headers:{"Content-Type":"application/json"}}),{status:Ut}=Ft;return await H(),d(!1),{userRemoved:Ut===204,error:null}}catch(wt){return d(!1),{userRemoved:!1,error:wt}}};return(0,e.useEffect)(()=>{te&&!se&&H()},[te]),{company:se,loading:Ae,fetchCompanyCrewInfo:H,addCrew:ve,updateCrew:Se,deleteRole:ye,removeCrew:Ce}}},92990:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>K});var e=m(66251),ae=m(46568);const ce=(0,ae.Ay)(null),g=(0,ae.Ay)(null),te=(0,ae.Ay)(!1),M=(0,ae.Ay)(!1),Ae=H=>{ce.set(H)},d=H=>{g.set(H)},se=H=>{te.set(H)},Be=H=>{M.set(H)},_=H=>{let Se=0;return H?.map(ye=>({id:Se+=1,name:ye.name,address:ye.address,accountNumber:ye.accountNumber,contact:ye.contact?.name,creditLocation:ye.creditLocation,market:ye.market,system:ye.erpSystem,erpSystem:ye.erpSystem}))};function K(){const H=ce.use(),Se=g.use(),ve=te.use(),ye=M.use();return{customersList:H,searchCustomers:async Ke=>{if(Ke.length<3){Be(!0);return}Be(!1),se(!0),Ae(null);try{const Je=await e.Ay.get(`/companies/search/${Ke}`);se(!1),Ae(_(Je?.data))}catch{se(!1)}},fetchingCustomersList:ve,selectedCustomerView:Se,setSelectedCustomerView:d,showSearchError:ye}}},47263:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(63183),ae=m(50318),ce=m.n(ae),g=m(66251),te=m(78446);function M(){const[Ae,d]=(0,ae.useState)(!1),[se]=(0,ae.useState)(),{isLoggedIn:Be}=(0,e.A)(),_=(0,ae.useCallback)(async K=>{if(!Be)return null;d(!0);try{const H=new te.O(navigator.userAgent),{browser:Se,os:ve,device:ye}=H.getResult();console.log(Se,ve,ye);const Ce={...K,user_agent:navigator.userAgent,event_meta:{...K.event_meta,browser:Se.name,browser_version:Se.version,os:ve.name,os_version:ve.version,device:ye.type||"desktop"}},Ke=await g.Ay.post("/api/create_event",JSON.stringify(Ce),{headers:{"Content-Type":"application/json"}});return d(!1),{error:!1,response:Ke}}catch(H){return console.error(H),d(!1),{error:!0,errorMessage:H}}},[]);return{event:se,loading:Ae,createEvent:_}}},64268:(ze,xe,m)=>{"use strict";m.d(xe,{P:()=>ce});var e=m(50318),ae=m.n(e);const ce=g=>{const te=(0,e.useRef)(g);te.current=g,(0,e.useEffect)(()=>{const M=({data:Ae})=>{te.current(Ae)};return window.addEventListener("message",M),()=>window.removeEventListener("message",M)},[])}},21281:(ze,xe,m)=>{"use strict";m.d(xe,{s:()=>Be});var e=m(4004),ae=m(50318),ce=m.n(ae),g=m(39055),te=m.n(g),M=m(45959),Ae=m(7609),d=m(60162),se=m(18484);const Be=(_,K=[],H="/select_project",Se,ve)=>{const{company:ye}=(0,se.P)(),{allRoles:Ce}=(0,M.Sk)(),[Ke,Je]=(0,ae.useState)(!1),jt=(0,g.useNavigate)(),{appFocus:wt,canUseFocus:Ft}=(0,d.A)(),{showError:Ut}=(0,e.d)(),{userHasPermission:jn,userPermissionsFetched:rn}=(0,Ae.A)(),Vt=()=>{Ut({message:"Sorry, you do not have permission to view that page. Please contact your administrator if you need access."})},$t=(0,ae.useRef)(Se??Vt);$t.current=Se??Vt;const It=(0,ae.useRef)(H);It.current=H;const Et=rn&&Ce.size>0,Bt=Et&&_?jn(_):!0,nn=(0,ae.useMemo)(()=>Et?Ft(wt):!0,[wt,Ft,Et]),Yt=!ve||ve?.length===0?!0:!!ye,et=(0,ae.useMemo)(()=>!ve||ve?.length===0?!0:ve.includes(ye?.erpSystem),[ve,ye]),kt=K.length===0?!0:K.every(de=>!!de);return(0,ae.useEffect)(()=>{kt&&Et&&Yt&&(nn&&Bt&&et?Je(!0):(!Bt||!nn||!et)&&($t.current&&$t.current(),jt(It.current)))},[Bt,rn,jt,kt,nn,Ce,et,Yt]),{canViewPage:Ke}}},97096:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>te});var e=m(66251),ae=m(4004),ce=m(26142),g=m(34012);function te(){const{showError:M}=(0,ae.d)(),{refetch:Ae,isLoading:d}=(0,g.Y)({searchTerm:"",showErrorMessage:!1,shouldRefetch:!1}),{fetchProject:se}=(0,ce.B)();return{updateProject:async(K,H)=>{try{await e.Ay.patch(`/api/projects/${K}`,H);try{Ae()}catch{console.log("Failed refreshing projects after updating")}await se(K)}catch(Se){Se?.response?.status===409?M({title:"Project cannot be updated",message:"We're sorry! All project names must be unique. Please try updating your project again with a different name, and contact Customer Support if the problem persists or you feel it is in error."}):M({title:"Project cannot be updated",message:"An error occurred while updating the project. Please try again."})}},deleteFile:async(K,H,Se,ve)=>{await e.Ay.delete(`/api/projects/${ve}/files`,{data:{file_name:H,project_external_id:Se}})},isLoading:d}}},90972:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>M});var e=m(39055),ae=m.n(e),ce=m(50318),g=m.n(ce),te=m(4004);function M(){const{projectId:Ae}=(0,e.useParams)(),{showError:d}=(0,te.d)(),se=(0,e.useNavigate)();(0,ce.useEffect)(()=>{(Ae==="null"||Ae===null)&&(d({message:"An unexpected error has occurred. Please try again"}),se("/select_project"))},[Ae,se,d])}},47333:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>te});var e=m(50318),ae=m.n(e),ce=m(39055),g=m.n(ce);function te(){const{search:M}=(0,ce.useLocation)();return ae().useMemo(()=>new URLSearchParams(M),[M])}},51986:(ze,xe,m)=>{"use strict";m.d(xe,{P:()=>d});var e=m(41e3),ae=m.n(e),ce=m(50318),g=m.n(ce),te=m(66251),M=m(18484),Ae=m(63183);function d(se){const[Be,_]=(0,ce.useState)(!1),{company:K}=(0,M.P)(),{isLoggedIn:H}=(0,Ae.A)(),Se=async()=>{_(!0);try{const q=await te.Ay.get("/scheduler/task/0/"+se);return _(!1),{data:q.data,error:""}}catch(q){return console.error("Failed to fetch tasks",q),_(!1),{data:void 0,error:"Failed to fetch tasks"}}},ve=async(q=null)=>{_(!0);try{const ie=await te.Ay.get(`/scheduler/project/${q||se}/phase`);return _(!1),{data:ie.data,error:""}}catch(ie){return console.error("Failed to fetch phases",ie),_(!1),{data:void 0,error:"Failed to fetch phases"}}},ye=async()=>{_(!0);try{const q=await te.Ay.get("/scheduler/todo?project_id="+se);return _(!1),{data:q.data,error:""}}catch(q){return console.error("Failed to fetch todo tasks",q),_(!1),{data:void 0,error:"Failed to fetch todo tasks"}}},Ce=async q=>{_(!0);try{const ie=await te.Ay.get("/scheduler/task?ids="+q.toString());return _(!1),{data:ie.data,error:""}}catch(ie){return console.error("Failed to fetch tasks",ie),_(!1),{data:void 0,error:"Failed to fetch tasks"}}},Ke=async()=>{if(H){_(!0);try{const q=await te.Ay.get("/scheduler/task_status");let ie=[];return q.data.forEach(ot=>{ie.push(ot.status)}),_(!1),{data:q.data,error:""}}catch(q){return console.error("Failed to fetch task status",q),_(!1),{data:void 0,error:"Failed to fetch task status"}}}},Je=async()=>{_(!0);try{const q=await te.Ay.get("/scheduler/task_color");return _(!1),{data:q.data,error:""}}catch(q){return console.error("Failed to fetch task colors",q),_(!1),{data:void 0,error:"Failed to fetch task colors"}}},jt=async q=>{_(!0);try{const ie=await te.Ay.post("/scheduler/task/0/"+se,q);return _(!1),{data:ie.data,error:"Task added successfuly"}}catch(ie){return console.error("Failed to add task",ie),{data:void 0,error:ie.response.data?ie.response.data:"Task cannot be added"}}},wt=async q=>{_(!0);try{const ie=await te.Ay.delete("/scheduler/task/0/"+se,{data:q});return _(!1),{data:ie.data,error:"Task added successfully"}}catch(ie){return console.error("Failed to delete task",ie),_(!1),{data:void 0,error:"Failed to delete task"}}},Ft=async(q,ie,ot=null)=>{_(!0);try{ie.start_date&&ie.start_date.toString().toLowerCase().includes("invalid date")&&delete ie.start_date,ie.end_date&&ie.end_date.toString().toLowerCase().includes("invalid date")&&delete ie.end_date,ie.assigned_to&&(ie.assigned_to.trim()==="Not Assigned"||ie.assigned_to.trim()==="")&&(ie.assigned_to=null);const qe=await te.Ay.put("/scheduler/task/"+q+`/${ot||se}`,ie);return _(!1),{data:qe.data,error:""}}catch(qe){return console.error("Failed to update task",qe),_(!1),{data:void 0,error:qe.response.data?qe.response.data.message?qe.response.data.message:qe.response.data:"Task cannot be updated"}}},Ut=async q=>{_(!0);try{const ie=await te.Ay.get("/scheduler/resource-assignments?ids="+q?.toString());return _(!1),{data:ie.data,error:""}}catch(ie){return console.error("Failed to fetch resources",ie),_(!1),{data:void 0,error:"Failed to fetch resources"}}},jn=async q=>{_(!0);try{const ie=await te.Ay.put("/scheduler/task_order",q);return _(!1),{data:ie.data,error:""}}catch(ie){return console.error("Failed to update task",ie),_(!1),{data:void 0,error:ie.response.data?ie.response.data:"Failed to update task"}}},rn=async q=>{_(!0);try{const ie=await te.Ay.get(`/scheduler/company/${q}/projects/${se}`);return _(!1),{data:ie.data,error:""}}catch(ie){return console.error("Failed to fetch tasks",ie),_(!1),{data:void 0,error:"Failed to fetch tasks"}}},Vt=async q=>{_(!0);try{const ie=await te.Ay.get(`/scheduler/company/${q}/templates`);return _(!1),{data:ie.data,error:""}}catch(ie){return console.error("Failed to fetch tasks",ie),_(!1),{data:void 0,error:"Failed to fetch tasks"}}},$t=async q=>{_(!0);try{const ie=await te.Ay.post(`/scheduler/company/${K?.id}/import-tasks`,q);return _(!1),{data:ie.data,error:"Template applied successfully"}}catch(ie){return console.error("Failed to apply template",ie),{data:void 0,error:ie.response.data.message}}},It=async q=>{_(!0);try{const ie=await te.Ay.post("/scheduler/import_task",q);return _(!1),{data:ie.data,error:"Template applied successfully"}}catch(ie){return console.error("Failed to apply template",ie),{data:void 0,error:ie.response.data.message}}},Et=async()=>{_(!0);try{const q=await te.Ay.get("/scheduler/dependency?project_id="+se);return _(!1),{data:q.data,error:""}}catch(q){return console.error("Failed to fetch dependencies",q),_(!1),{data:void 0,error:"Failed to fetch dependencies"}}},Bt=async q=>{_(!0);try{return{data:(await te.Ay.post("/scheduler/dependency",q)).data,error:"Task added successfully"}}catch(ie){return console.error("Failed to add task",ie),{data:void 0,error:"Task cannot be added"}}},nn=async q=>{_(!0);try{return{data:(await te.Ay.put("/scheduler/dependency",q)).data,error:"Task added successfully"}}catch(ie){return console.error("Failed to add task",ie),{data:void 0,error:"Task cannot be added"}}},Yt=async(q,ie,ot)=>{_(!0);try{const qe=await te.Ay.get(`/scheduler/companies/${q?.id}/deliveries?start_date=${ie}&end_date=${ot}`);return _(!1),{data:qe.data,error:""}}catch(qe){return console.error("Failed to fetch deliveries",qe),_(!1),{data:void 0,error:"Failed to fetch deliveries"}}},et=async(q,ie)=>{_(!0);try{return{data:(await te.Ay.delete("/scheduler/dependency?ids="+q.toString())).data,error:"Dependency deleted successfully"}}catch(ot){return console.error("Failed to delete dependecy",ot),{data:void 0,error:"Dependecy cannot be deleted"}}},kt=async()=>{if(H){_(!0);try{const q=await te.Ay.get("/scheduler/calendar");return _(!1),{data:q.data,error:""}}catch(q){return console.error("Failed to fetch Non working days",q),_(!1),{data:void 0,error:"Failed to fetch Non working days"}}}};function de(q,ie,ot,qe){let ft=ie.getDay();var Jt=[];return!!(!qe&&q&&(Jt.push(q.weekDays[0]),Jt.push(q.weekDays[1]),Jt.push(q.weekDays[2]),Jt.push(q.weekDays[3]),Jt.push(q.weekDays[4]),Jt.push(q.weekDays[5]),Jt.push(q.weekDays[6]),Jt[ft]==!0)||!ot&&q&&q.holidays.findIndex(Cs=>{let Ts=new Date(Cs.date);return Ts.setHours(0,0,0,0),ie.setHours(0,0,0,0),ae()(Ts).isSame(ae()(ie))})>=0)}function Ie(q,ie){if(_e(q,ie)==!0)return{description:"It is a non working day",date:ie};var ot=q.holidays.find(qe=>{let ft=new Date(qe.date);return ft.setHours(0,0,0,0),ie.setHours(0,0,0,0),ae()(ft).isSame(ae()(ie))});return ot}function _e(q,ie){let ot=ie.getDay();var qe=[];return qe.push(q.weekDays[0]),qe.push(q.weekDays[1]),qe.push(q.weekDays[2]),qe.push(q.weekDays[3]),qe.push(q.weekDays[4]),qe.push(q.weekDays[5]),qe.push(q.weekDays[6]),qe[ot]==!0}async function Ve(q){_(!0);try{const ie=await te.Ay.get("/scheduler/user_config?project_id="+se+"&company_id="+q);return _(!1),{data:ie.data,error:""}}catch(ie){return console.error("Failed to fetch config",ie),_(!1),{data:void 0,error:"Failed to fetch config"}}}return{loading:Be,fetchTasksList:Se,fetchTasksListMultiple:Ce,fetchTaskStatus:Ke,fetchTaskColors:Je,addNewTask:jt,deleteTask:wt,updateTask:Ft,updateTaskSequence:jn,fetchScheduledItemsProjectList:rn,applyTemplateWithProjects:$t,applyTemplateWithTemplates:It,fetchDependencies:Et,addDependency:Bt,deleteDependency:et,updateDependency:nn,fetchScheduledItemsTemplates:Vt,getDeliveries:Yt,fetchNonWorkingDays:kt,isNonWorkingDay:de,getHolidayDetails:Ie,fetchTodoList:ye,fetchPhaseList:ve,fetchResourceAssignments:Ut,getConfig:Ve,updateConfig:async(q,ie)=>{_(!0);try{const ot=await te.Ay.post("/scheduler/user_config?project_id="+se+"&company_id="+q,ie);return _(!1),{data:ot.data,error:""}}catch(ot){return console.error("Failed to update config",ot),_(!1),{data:void 0,error:ot.response.data?ot.response.data.message?ot.response.data.message:ot.response.data:"Config cannot be updated"}}},fetchScheduleTemplatesForProfile:async q=>{_(!0);try{const ie=await te.Ay.get(`/scheduler/template_manager?company_id=${q}`);return _(!1),{data:ie.data,error:""}}catch{return _(!1),{data:void 0,error:"Failed to fetch templates"}}},deleteTemplate:async q=>{_(!0);try{const ie=await te.Ay.delete(`/scheduler/template_manager?id=${q}`);return _(!1),{data:ie.data,error:""}}catch{return _(!1),{data:void 0,error:"Failed to delete template"}}},createScheduleTemplate:async q=>{_(!0);try{const ie=await te.Ay.post("/scheduler/template_manager",q,{headers:{"Content-Type":"multipart/form-data"}});return _(!1),{data:ie.data,error:""}}catch(ie){return _(!1),console.error("Failed to create template",ie),{data:void 0,error:ie.response.status==400?ie.response.data.error:"Template cannot be created"}}},getSchedulerTemplateTask:async q=>{_(!0);try{const ie=await te.Ay.get(`/scheduler/template_manager/${q}`);return _(!1),{data:ie.data,error:""}}catch(ie){return _(!1),{data:void 0,status:ie.response.status,error:ie.response.status==400?ie.response.data.message:"Failed to fetch template"}}},updateScheduledTemplate:async(q,ie,ot)=>{_(!0);try{const qe=await te.Ay.put(`/scheduler/template_manager/${ie}/company/${ot}`,q);return _(!1),{data:qe.data,error:""}}catch(qe){return console.error("Failed to update template",qe),_(!1),{data:void 0,error:qe.response.data?qe.response.data.error:"Failed to update template"}}}}}},31007:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>K});var e=m(50318),ae=m(66251),ce=m(26142),g=m(4004),te=m(41628),M=m(97096),Ae=m(70551),d=m(42634),se=m(13561),Be=m(17197);const _=()=>{const ye=(0,se.wA)();return{refreshQuoteFiles:(0,e.useCallback)(()=>{ye(Be.w3.util.invalidateTags(["QuoteFiles"]))},[ye])}};function K(){const{deleteFile:ye}=(0,M.A)(),{showError:Ce,showSuccess:Ke}=(0,g.d)(),{project:Je}=(0,ce.B)(),{refreshFiles:jt}=(0,Ae.e)(Je?.id),{refreshQuoteFiles:wt}=_(),[Ft,Ut]=(0,e.useState)(!1),[jn,rn]=(0,e.useState)({}),[Vt,$t]=(0,e.useState)([]),It=async(et,kt,de,Ie,_e)=>{if(!et||!Je?.id)return;let Ve=!1;if(et.forEach(Re=>{if(!Re){Ve=!0,Ce({title:"Invalid File",message:"File is null and cannot be uploaded."});return}const Ne=(0,te.KT)(Re.name);Ne.error&&(Ve=!0,Ce({title:Ne.title,message:Ne.message}))}),Ve)return;Ut(!0),$t(et);const Gt={};et.forEach((Re,Ne)=>{Gt[Ne]=0}),rn(Gt),Ke({message:"File processing might take a few minutes. Please check back soon."});const wn=await Bt(et,Je.id,kt,de,Ie,_e);let Kt=!1;const Fn=wn.map((Re,Ne)=>nn(Re.file,Re.uploadUrl,Re.fileId,Re.projectId,Ne).then(q=>(Kt=!0,q)).catch(q=>{}));await Promise.all(Fn),Kt&&(_e===d.c.QUOTE?wt():jt(3e3)),Ut(!1),$t([])},Et=async(et,kt,de,Ie,_e,Ve)=>{try{return await ve(et,kt,de,Ie,_e,Ve)}catch(Gt){return Ce({title:"File cannot be uploaded.",message:H(Gt,et)}),null}},Bt=async(et,kt,de,Ie,_e,Ve)=>{const Gt=et.map(Kt=>Et(Kt,kt,de,Ie,_e,Ve));return(await Promise.allSettled(Gt)).reduce((Kt,Fn)=>(Fn.status==="fulfilled"&&Fn.value&&Kt.push(Fn.value),Kt),[])},nn=async(et,kt,de,Ie,_e)=>{try{const Ve={"Content-Type":et.type,"x-ms-version":"2019-12-12","x-ms-blob-type":"BlockBlob"};return await ae.v3.put(kt,et,{headers:Ve,onUploadProgress:wn=>{const Kt=wn.loaded/wn.total*100;rn(Fn=>({...Fn,[_e]:Kt}))}})}catch(Ve){throw await ye(de,et.name,Je?.projectExternalId,Ie),Ce({title:`Failed to Upload File: ${et.name}}`,message:H(Ve,et.name)}),Ve}};return{uploading:Ft,progress:Object.values(jn).reduce((kt,de)=>kt+de,0)/Vt.length,uploadFiles:It}}const H=(ye,Ce)=>{let Ke="";switch(ye.response?.status){case 504:Ke="Unable to contact server. Please try again later.";break;case 503:case 422:Ke=ye.response.data;break;default:Ke=`${Ce.name} was not uploaded. Please try again.`;break}return Ke},Se=async(ye,Ce,Ke,Je,jt,wt)=>{const Ft={filename:ye.name,fileType:ye.type,projectId:Ce,folderId:Ke,isSystemFolder:Je||!1,entityId:jt,entityType:wt};return await ae.Ay.post(`/api/projects/${Ce}/files`,Ft)},ve=async(ye,Ce,Ke,Je,jt,wt)=>{const Ft=await Se(ye,Ce,Ke,Je,jt,wt),Ut=Ft.data.upload_url,jn=Ft.data.project_id;return{fileId:Ft.data.file_id,uploadUrl:Ut,projectId:jn,file:ye}}},93234:(ze,xe,m)=>{"use strict";m.d(xe,{A:()=>g});var e=m(50318),ae=m.n(e);function ce(){const{innerWidth:te,innerHeight:M}=window;return{width:te,height:M}}function g(){const[te,M]=(0,e.useState)(ce());return(0,e.useEffect)(()=>{function Ae(){M(ce())}return window.addEventListener("resize",Ae),()=>window.removeEventListener("resize",Ae)},[]),te}},30583:(ze,xe,m)=>{"use strict";m.d(xe,{Cy:()=>g,EE:()=>d,EL:()=>ce,MI:()=>M,gx:()=>Ae,pX:()=>se,qE:()=>te});var e=m(45959);const ae={CREATE:"create",VIEW:"view",EDIT:"edit",DELETE:"delete"},ce=Be=>se(Be,[e.wy.OSR,e.wy.BFSComponentDesign,e.wy.BFS3pQuoteAdmin]),g=Be=>Be.size>0&&Array.from(Be).every(_=>_===e.wy.Subs),te=Be=>se(Be,[e.wy.OSR]),M=Be=>se(Be,[e.wy.Homebuyer]),Ae=Be=>se(Be,[e.wy.CompanyManager]),d=Be=>se(Be,[e.wy.BFS3pQuoteAdmin]),se=(Be=new Set,_)=>_.some(K=>Be.has(K))},48361:(ze,xe,m)=>{"use strict";m.d(xe,{S:()=>ae});var e=m(66251);const ae=({baseUrl:ce}={baseUrl:""})=>async({url:g,method:te,data:M,params:Ae,headers:d})=>{try{return{data:(await(0,e.Ay)({url:ce+g,method:te,data:M,params:Ae,headers:d})).data}}catch(se){const Be=se;return{error:{status:Be.response?.status,data:Be.response?.data||Be.message}}}}},12565:(ze,xe,m)=>{"use strict";m.d(xe,{Ay:()=>M});var e=m(30038);const ae={projectList:[],fetchingProjectList:!1},ce=(0,e.Z0)({name:"project",initialState:ae,reducers:{setProjectList:(Ae,d)=>{Ae.projectList=d.payload},setFetchingProjectList:(Ae,d)=>{Ae.fetchingProjectList=d.payload}}}),{setProjectList:g,setFetchingProjectList:te}=ce.actions,M=ce.reducer},88835:(ze,xe,m)=>{"use strict";m.d(xe,{MK:()=>Ae,OY:()=>g,SH:()=>ce,hw:()=>M,pv:()=>_});var e=m(41e3),ae=m.n(e);const ce="MM/DD/YYYY",g="YYYY-MM-DD",te="MM/dd/yyyy HH:mm:ss",M="YYYY-MM-DD HH:mm:ss",Ae="YYYY-MM-DD",d="YYYY-MM-DD HH:mm:ss",se=(K,H)=>{let Se=H.split(":")[0],ve=H.split(":")[1];return new Date(K.setHours(Number.parseInt(Se),Number.parseInt(ve),0,0))},Be=K=>moment(K).format(M),_=K=>ae()(K).format("MM/DD/YYYY HH:mm:ss")},28729:(ze,xe,m)=>{"use strict";m.d(xe,{H1:()=>te,J8:()=>ae,SX:()=>e,a2:()=>g,w5:()=>ce});var e=(M=>(M.BUDGET="UseNewBudgetPermissions",M.DIGITAL_TOOLS="DigitalTools",M.LINKED_FOLDERS="UseCrewLinkedFolders",M.MATERIALS="UseNewMaterialsPermissions",M.COMPANY_CREWS="CompanyFocusCrewsPage",M.COMPANY_SCHEDULE="CompanyLevelBuilderSchedule",M.CUSTOM_ROLES="UseCustomRoles",M.BFS_BIDS="UseBFSBids",M.PROFILE="CompanyFocusProfilePage",M.BFS_DASHBOARD="UseBFSDashboard",M.QUICK_BOOKS="QuickBooksPage",M.SCHEDULE_TEMPLATE="ScheduleTemplatesPage",M.SELF_SERVICE_COST_CODES="SelfServiceCostCodes",M.QUICK_BOOKS_PROJECT_EDIT="UseQuickbooksProjectSelect",M.HOME_BUYER="UseHomeBuyer",M.MARKET_MANAGER_CATALOG="UseMarketManagerCatalog",M.EDIT_BID_FEDERATED_MODULE="EditFrameFederatedModule",M.BID_DASHBOARD_FEDERATED_MODULE="BidDashboardFederatedModule",M.DEFAULT_TREND_MATERIALS_LIST_VIEW="DefaultTrendMaterialsToListView",M.SPEC_SHEETS="ProfileSpecSheets",M.USER_LEVEL_PERMISSIONS="UseCustomUserLevelPermissions",M.OIDC_LOGS="OidcLogs",M.HIDE_AS400_INVOICE="HideAS400Invoice",M.PROJECT_SYSTEM_LABELS="ProjectSystemLabels",M.TAX_DETAILS="TaxDetails",M.USE_MATERIALS_QUOTES="UseMaterialsQuotes",M.USE_PENDO_HELP_CENTER_TARGET="UsePendoHelpCenterTarget",M.CUSTOMER_SEARCH_FEDERATED_MODULE="CustomerSearchFederatedModule",M.USE_VENDOR_MANAGEMENT="UseVendorManagement",M.STATEMENTS_FEDERATED_MODULE="StatementsFederatedModule",M.ORDERS_DELIVERIES_FEDERATED_MODULE="OrdersDeliveriesFederatedModule",M.EMPLOYEE_DASHBOARD_FEDERATED_MODULE="EmployeeDashboardFederatedModule",M.SETTINGS_FEDERATED_MODULE="SettingsFederatedModule",M.USE_PRELIMINARY_BUDGET_PAGE="UsePreliminaryBudgetPage",M.USE_NEW_QUOTE_REQUEST="UseNewQuoteRequest",M.THIRD_PARTY_QUOTES="ThirdPartyQuotes",M.USE_COPY_QUOTE_EXISTING_PROJECT="UseCopyQuoteExistingProject",M.SUNSET_BFS="SunsetBfs",M.USE_REQUEST_TAKE_OFF_UI="UseRequestTakeOffUI",M.USE_REVENUE_PAGE="UseRevenuePage",M.USE_PROFIT_AND_LOSS_PAGE="UseProfitAndLossPage",M.USE_EXPENSES_V2="UseExpensesV2",M.USE_SPECS_MANAGER="UseSpecsManager",M.USE_BFS_PURCHASE_ORDERS="UseBFSPurchaseOrders",M.USE_NOTIFICATIONS_PAGE="UseNotificationsPage",M.COMMUNITIES="CommunitiesIntro",M.PUBLISH_MODEL_FILES="PublishModelFiles",M.USE_LINKED_ACCOUNTS="UseLinkedAccounts",M.USE_MOVE_PROJECT="UseMoveProject",M.USE_PARTIAL_PACK_ORDER="UsePartialPackOrders",M.USE_V2_HEADER="UseV2Header",M.DISABLE_DIGITAL_TOOLS_OPPORTUNITY="DisableDigitalToolsOpportunity",M.USE_ASYNC_ORDERS="UseAsyncOrders",M))(e||{}),ae=(M=>(M.TABLE="TABLE",M.CUSTOM="CUSTOM",M))(ae||{}),ce=(M=>(M.PROJECTS="projects",M.CATALOG="catalog",M.SCHEDULE="schedule",M.CREWS="crews",M.PROFILE="profile",M.DIGITAL="digitalTools",M.DOCUMENTS="documents",M.CONFIGURE="configure",M.BUILD="build",M.MATERIALS="materials",M.BUDGET="budget",M.DASHBOARD="dashboard",M.ORDERS="orders",M.STATEMENTS="statements",M.SETTINGS="settings",M.CUSTOMERS="customers",M.BIDS="bids",M.DELIVERIES="deliveries",M))(ce||{}),g=(M=>(M.VIEW_FILES="viewFiles",M.EDIT_FILES="editFiles",M.MANAGE_FOLDERS="manageFolders",M.MARKUP_FILES="markupFiles",M.UPLOAD_FILES="uploadFiles",M.DELETE_FILES="deleteFiles",M.VIEW_MODELING_FILES="viewModelingFiles",M.VIEW_CUSTOMERS="view",M.EDIT_PROFILE="edit",M.VIEW_STATEMENTS="view",M.VIEW_BFS_INVOICES="viewInvoices",M.EDIT_BFS_PERMISSIONS="editBfsPermissions",M.INVITE_OR_EDIT_CREW="inviteOrEditCrew",M.VIEW_BUDGET="view",M.CREATE_BUDGET="create",M.EDIT_INVOICE="edit",M.DELETE_INVOICE="delete",M.MAP_QUICKBOOKS_PROJECT="mapQuickbooksProject",M.MANAGE_MANUAL_EXPENSES="manageManualExpenses",M.SEND_TO_QUICKBOOKS="sendToQuickbooks",M.CREATE_SCHEDULE_TEMPLATES="createScheduleTemplates",M.VIEW_CONFIGURE="view",M.PURCHASE_CONFIGURE="purchase",M.CREATE_PROJECT="create",M.EDIT_PROJECT="edit",M.MOVE_PROJECTS="moveProjects",M.PURCHASE="purchase",M.VIEW_MATERIALS="view",M.VIEW_BID_ORDERS_AND_DELIVERIES="viewBidOrdersAndDeliveries",M.REQUEST_BID="requestBid",M.PURCHASE_BIDS="purchaseBidPack",M.EDIT_BID="editBid",M.REMOVE_TASK="delete",M.VIEW_PHASES_AND_TASKS="viewPhasesAndTasks",M.EDIT_TASKS="editPhasesAndTasks",M.CREATE_PHASES="createPhasesAndTasks",M.EDIT_PHASES="editPhasesAndTasks",M.VIEW_DIGITAL_TOOLS="view",M.PURCHASE_DIGITAL_TOOLS="purchase",M.VIEW_BIDS="view",M.VIEW_BFS_DASHBOARD="view",M.VIEW_PROJECTS_DASHBOARD="view",M.VIEW_CREWS="view",M.VIEW_COMPANY_SCHEDULE="view",M.EDIT_MARKET_MANAGER_TOOLS="editMarketManagerTools",M.VIEW_CATALOG="view",M.VIEW_ORDERS="view",M.VIEW_BUILD="view",M.USER_LEVEL_PERMISSIONS="UseCustomUserLevelPermissions",M.CREATE_ROLE="create",M.EDIT_ROLE="edit",M.DELETE_ROLE="deleteRoles",M.EDIT_MYBLDR_AND_BFS_PERMISSIONS="editBfsPermissions",M.MANAGE_NOTIFICATIONS="manageNotifications",M.USE_SKU_REPLACEMENT="useSkuReplacement",M))(g||{}),te=(M=>(M.OPEN="open",M.OPEN_WITH_DATA="open_with_data",M.VIEW="view",M.DOWNLOAD="download",M.ESCAPE="escape",M))(te||{})},9402:(ze,xe,m)=>{"use strict";m.d(xe,{S1:()=>g,bn:()=>ce,up:()=>te});var e=m(2543),ae=m.n(e);const ce=M=>Array.isArray(M)?M.map(Ae=>ce(Ae)):M!=null&&M.constructor===Object?Object.keys(M).reduce((Ae,d)=>({...Ae,[(0,e.camelCase)(d)]:ce(M[d])}),{}):M,g=M=>{const d=M.split("@")[0].split(".");if(d.length>1){let se=d[0];se=se.charAt(0).toUpperCase()+se.slice(1);let Be=d[1];return Be=Be.charAt(0).toUpperCase()+Be.slice(1),`${se} ${Be}`}else return d[0]},te=M=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(+M)},92039:(ze,xe,m)=>{"use strict";m.d(xe,{Fc:()=>d,Mi:()=>K,Rh:()=>M,qm:()=>te,rw:()=>_});const e=null,ae="openid profile com.mybldr offline_access com.bldr.customerportal.identity com.bldr.customerportal.api",ce=null,g=()=>{e.forEach(H=>ce.removeItem(H))};var te=(H=>(H.PATH_TO_RETURN_TO="pathToReturnTo",H.LOGIN_HINT="loginHint",H))(te||{}),M=(H=>(H.mostRecentlySelectedCompany="mostRecentlySelectedCompany",H.budgetSidebar="budget-sidebar",H.crewsSidebar="crews-sidebar",H.specificationsSidebar="specifications-sidebar",H))(M||{});const Ae=["/force_sign_out","/magic_link","/process_jwt","/paradigm"],d=()=>{Ae.every(H=>!document.location.pathname.startsWith(H))&&document.location.pathname!=="/"&&sessionStorage.setItem("pathToReturnTo",document.location.pathname+document.location.search)},se=()=>JSON.parse(ce.getItem("oidc.default")||"{}"),Be=()=>{const H=se();return ae.split(" ").every(Se=>H?.tokens?.scope?.includes(Se))},_={ACCESS_TOKEN:"paradigmAccessToken",EXPIRES_ON:"paradigmAccessTokenExpiresOn"},K=()=>(localStorage.removeItem(_.ACCESS_TOKEN),localStorage.removeItem(_.EXPIRES_ON),window.location.replace("/error_forward?error=401&no_session"),Promise.reject(new Error("User logged out due to authentication failure.")))},35403:(ze,xe,m)=>{"use strict";m.d(xe,{t:()=>e});const e=()=>{const g=document.cookie.split(";").map(M=>M.trim().split("="));let te={};return g.forEach(M=>{const Ae=M[0],d=M[1];te[Ae]=d}),te},ae=e()?.csrftoken},29433:(ze,xe,m)=>{"use strict";m.d(xe,{s:()=>ae,v:()=>e});var e=(ce=>(ce.ONLINE="ONLINE",ce.TREND="TREND",ce.AS400="AS400",ce.SAPS4HANA="SAPS4HANA",ce))(e||{}),ae=(ce=>(ce[ce.ONLINE=20]="ONLINE",ce[ce.TREND=30]="TREND",ce[ce.AS400=5]="AS400",ce[ce.SAPS4HANA=80]="SAPS4HANA",ce))(ae||{})},41628:(ze,xe,m)=>{"use strict";m.d(xe,{KT:()=>te,XO:()=>ce,n8:()=>ae,nG:()=>e,zx:()=>g});const e=217;function ae(M){return M.length>=e}function ce(M){return["/",":","\\","*","?",'"',"<",">","|"].some(d=>M.includes(d))}function g(M){return["pdf","jpg","jpeg","png","xls","xlsx","docx","ppt","pptx","tif","tiff"].some(d=>M?.toLowerCase().endsWith(d))}function te(M){const Ae={message:"",title:"",error:!1};return ae(M)?(Ae.title=`File (${M}) cannot be uploaded.`,Ae.message=`File name exceeds ${e} character limit.
Please try shortening the file name and upload again.`,Ae.error=!0):ce(M)&&(Ae.title=`File (${M}) cannot be uploaded.`,Ae.message='MyBLDR does not support files with special characters such as  / : \\ * ? " < > | in their name. Please rename your file and upload again.',Ae.error=!0),Ae}},43532:(ze,xe,m)=>{"use strict";var e=m(85072),ae=m.n(e),ce=m(97825),g=m.n(ce),te=m(77659),M=m.n(te),Ae=m(55056),d=m.n(Ae),se=m(10540),Be=m.n(se),_=m(41113),K=m.n(_),H=m(55591),Se={};Se.styleTagTransform=K(),Se.setAttributes=d(),Se.insert=M().bind(null,"head"),Se.domAPI=g(),Se.insertStyleElement=Be();var ve=ae()(H.A,Se),ye=H.A&&H.A.locals?H.A.locals:void 0},17422:ze=>{"use strict";ze.exports="data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAABTsAAsAAAAAIpAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAADsAAABUIIslek9TLzIAAAFEAAAAPgAAAFZRiV32Y21hcAAAAYQAAAEJAAAD5p42+VxnbHlmAAACkAAADtIAABckI4l972hlYWQAABFkAAAAKwAAADYsvIjpaGhlYQAAEZAAAAAdAAAAJA+RCL1obXR4AAARsAAAABcAAAC8Q2YAAGxvY2EAABHIAAAAYAAAAGB7CIGGbWF4cAAAEigAAAAfAAAAIAFAAI9uYW1lAAASSAAAASUAAAIK1cf1oHBvc3QAABNwAAABfAAAAnXdFqh1eJxjYGRgYOBiMGCwY2BycfMJYeDLSSzJY5BiYGGAAJA8MpsxJzM9kYEDxgPKsYBpDiBmg4gCACY7BUgAeJxjYGR7yDiBgZWBgaWQ5RkDA8MvCM0cwxDOeI6BgYmBlZkBKwhIc01hcPjI+FGPHcRdyA4RZgQRADaGCyYAAHic7dPXbcMwAEXRK1vuvffem749XAbKV3bjBA6fXsaIgMMLEWoQJaAEFKNnlELyQ4K27zib5PNF6vl8yld+TKr5kH0+cUw0xv00Hwvx2DResUyFKrV4XoMmLdp06NKjz4AhI8ZMmDJjzoIlK9Zs2LJjz4EjJ85cuHLjziPe/0UWL17mf2tqKLz/9jK9f8tXpGCoRdPKhtS0RqFkWvVQNtSKoVYNtWaoddPXEBqG2jQ9XWgZattQO4baNdSeofYNdWCoQ0MdGerYUCeGOjXUmaHODXVhqEtDXRnq2lA3hro11J2h7g31YKhHQz0Z6tlQL4Z6NdSbod4N9WGoT9MfHF6GmhnZLxyDcRMAAAB4nJ1YC1hU17U+a5/HMA4iA3NmVBDmoQwP5TFnHlFeA4gYiUFRQINoSCBAyK3G2yi+0aipYtFcHYo2xsb4NiY3+VrNxSaX5uvt495ozNdoYoxmem2/L8HGpLc+InB279pnhlGr5mvL4eyz99nrrL32eu1/DQcc/okdYgdHOA6MQKp4r9gx0EcMHMezOalVasW5BM7NcXoSb9fFgE6KtSSBxWz1FYDPG+vMBGcKb9cebu2VS5s2aaTkCvRSf6C7Y+Ppibm5E09v7IDs2/3uZQtbD0zIyppwoHXh/93ukmyYgdePNRp65p5v+3v/9otQl2O7wP34cT88p8Md2YxpYLQZoRcy6FlSBRnwnGAe6BPMSCZo+7NJVqS0cE4uHendzhSnbPH6TDqL1+Nme5LZXkCHnGyoH0kne30WH+gswhm3q+pt/mTas9NLS64GnjmSlTPw0wVQT/ewRaBgxtydy3cuUB9/6SW+vb5yRvr+t0eOfPKJZ/9t3+4tL7xj32Xd3thCxi+ge6ifdsAN+l5+wi5HQ/cCoeull1AszS7CUfEcJzK7sKWJAdJhCd0sPM4+EY7QDm5ov08hXRQXE5bf6PV5Q5+IjW7X7Nku92Ask4l2hCRRD6TPqISiCJeQna3SCFwrhrNzXHzo4yFevBwxpzxk8WCIIfkvVEKVy32SbT8n68gzgaslpaiO2zIGIyuSb7RNf9HSuN26y/7OC1tgEmpiyA6aD4qcgTOiLThwGG0eB694FI8NHLLN6OBlRVaMxNAFS4JdXUG6mW8PwpKuYLCLXKGbu8iwYNdgO06Sn3Th+/vyZAxs8Ro30DjHe9gy8Fywi24OMm7Qyzh3MTZVOMYhLBnoC+J79lpTUyQmorjhnMwlcQ5uPEYGpDjsOkkH49BjQLQBqs3jFtFdJNlksYmoQFDArLh8Xh+Qd6Ghcsb6FUuehDi+U/lqD71K/qiegeV1imcwjl7ExwiSrf4BZyCujV6cVcFo6VX+G9IcPyFjJnUufbU/jzrL1X99as36reXl8K32nFaOr+E8jWJEcJ55DpMVfSMe95/AJaOsGBH2GJCNpiRQbK4C8BjdmQA22QY2j03Em13i2YHqtNLU1NI04Yj2HJgA6fQc6VPNpA/D+Ryks554NnVy2mB72uRUfPLsqR4N0LOBQKArwJYO+5W2fgZX8oC1HR6HjNaQTVIG2FPwnTcXXGZZfNB7TE6pTKZUwaw91XWLAoFFGcnB5PHjsckgBjbWutrL+0h5Y1xw3DRGDumsnXb3MJwXrJIN5U7m0rgJ3yG5w4he5ckFG4pmNEkOm0/xOO4r4yL87wqtQM+hiJIVp+6iG2wPBKD35ElGkDx+UfC2v1mFG1o+M3AjNFty8biKMXwzyxnZLds8wYD2BxmCPHAldPOeLsy/0BugftYhVYFAhO8SqQ0j3oK7dHJZnI/jxmUS4onlxskSF8thmvNZjIrRZwEPxr0lBuLRuz3oy/FOHCsxwOPYh2M+e9u3J5pgPYz9gp6G7C9m0A11F9ddqKMfV+4sbq45/YspOysXvT+3pdFdYNg2fHbW8Dz301MqDVuGrz0Fuh0YMW8mddrpqzST7rV9BcvqPoNvadRndWp0p8HvbiqrFj5yFQ/vNFSXDpxpLEFWp+DcrF3FT1afWshFcmCfeAMjEvO65i0Y6XijQfSRPWx3TV/Df7Km3E1l+kLt56s/rwVzuRusNMhudznkwdLaS+QNdeal2jDPP4l9qHc98vTYZOSkxzD+njBWVWjFPKgipx6DkWvXQiW8OYcewVHE5yukinDMcfGgc0opDltYKDxIGBedkzc6jSfE7tlvESCDFUw0Hx0opS+U0lHCxNottbNWSxX9zZVvEhKWUSyBpaXwBc2a98M6UqPeXAs/GDon8Ax7hsthO8cM5HU7Ad0UvRR9lHmtyQKZ4MAe814X5h9MSUkQmhf96eVJ6p90OjIiqSIjvykvr2l5U55O/fPQKD+jIomYpNyGJQ25uQ2kIikRfAmuBHCPsWqkSDEqgZ5KDI2sifS/R43MbZg0idFHbCPNxXxZws1ACVE6hAhOdJwRkJLFBLPZpRGYJ50pko6XzMkgmSx40ljik6AQcKhFnLcQE6rF7PXFe1Ocoj0T3AXgSgJTDIhHRfHlYZKuSzc6uievOJGXY+i5GJkkTp7UM3y0LqATDbtFcbdBxO7o4T25JYlEjoH0uynUh8rapkxp62QN70svSF+hT4gGPlovlmcm/ComLi7mV4kTykV9NFWjE/QrwgQ4uIcAP0rQF4VZYRP2o3PhHHzfPMJj9Ir+uzKUlrH49ntT18AVvj1sc3YGjUT/Mt2Dxawa8ArcA7bCQIpvfwAYu22vEG/No/5RvPdA7g+AelLrPwzy+LtkLPhnpIxH14m4EYq8eeMHbPEPNm6G7Nv9B4jcFPZ8bJj0SEjP3MPgQdKTqqEoy2v6G32P/Y6dxOv04AxnoAeq+GILvUavtYCBXm+BaIhuodcfrN5B/V2EYMCPh+SxavjGyPwV0x4CJgUPGT0mQaODGBACIJZGsMXwAD0LGXx7l3CdAcKMIKI+f5CepWeD0BvyU/GcdBxPF8SwejC6LGZmAURFdsSWKR5HyHld2kbdIZO1Ixx+bnnzU7n5+blPNV9jnUDWhP2tC68tbN3PVIldsQPxSAcSpjOav7Q05uXn5zW2LLvDXn9B6syscPy9iDLEMmSrJz6nYuWMipukjM0AH8JkGS+XFyMRkzSCH7KD/hwm172SAyZYumHlefr5AddrtA0O0TnwaVZxcRY9Bfukn9Gf05N1r9DV9MoBsJ1f+ZrqUvtPHizJAntWybv7hmqLt6QLuK6ZS9Fqi1jO5rDoWPZXXII5Tgajg53cIXCjDCGIcYrRIY2n6+mXOa/W0bdhau3ryiEYe2FV/5oeaIYK/5w5frCyll6/cYO8DiNhw6t1MBWmznt91QX62UF1N7l0eHBZTRGpKaqpKVIPF9UcIzmReud9TSY75+K899GHbBu6wjoR7RKKZVYiYxSPf5/2wJT5e3NAhmUbVn5KLx1Ujg0+BGvpAIh0DezInTkzF37KVocxrKU3r1+XLtAe2lO3l66kfQfB/unKY+q8N375Ru8bc4pJXfEcESU95q+p8ZNZRTWH1d9FzvUdYXk5rLkcdkEisoKKVHQW/b3GEx6tPaYcoJfOr9wAbSBnv1IHpep0OExr4LPMkpJM+j7sly7UHkOzXjoAZljHCGiyegtNlwljM0v+c19ET9Pvst09a2Mtgcf5/ZSzYO5h1156+eyydfAsxGa9XAuF6vzjh6CssLq6ECysperXX0sX5h5ZdpZe3guxsGIPEtHk/aqXX1hVqP5HYVVVISkrrNqvXorIc+5Ou91Hnr/LcD2afi6eX7UBloOcs7cOpqgGaNfs1g7bNbs9z6wASaylN69d0/TFTIz6Ws8+oGV3mE2612wRTHKcVUbhjKadebloMc+dyXgMVtVK6BwMB/+mVW09igdRBWaRtNQX59d/VD//xdQ0TCiYNj1KT9sq6Wdu5WTbqk3qDXyDaLa1fv621LS01G3z61sD6lH8lAxDLicV921s6Bf92JOYvzNYCL1khbqBXEFUzC521N5NyzNaQIWhjyFyDoBIVrAjmv2UEaLlI+c6zw1jmVIPLLLZZUTj6GxGHW+mq1tgHXR2D85p4Q934+jLbtjVLcyCdS10NVzpHqxp4Q/hK7WopY/NRGx9HGsPGdFjOjcpjBnGYMVqY/4eqT5khWEHWUup2A/pTw7pdWgsWft7ETUERL96nRg0HNFPmCYba6pylECaExX89A9WLUOVB4oKLu/o1oqSYHCgLzBUlAz8hNFDRpeSU1XT+LRmDUgPaKbYdHDn9suF/tu13nHJij0N97LfS0QmqONuyONk7zvUI6Qa0pF9f2+oABL92AT6e0U//z9YqAiWtJLU1JK0gS+1aacwamiNqK067u9ZQ8f1d4qLodMzz3uL89Z68V/Hnr++hXWUuHgw8dfi972PeTyPefu3aNNucemQ74qFuIaJnVkOu4Q+yjuwmmC1FqZpl1i4uzoPxjkpPf3Xv545tl26Rr+dOvUd+omqJzch9dOeU7f10Y64nMcKK137DccIZq2WdXtdZjbEoLSzHwiMtrjYLDxpHQW8gjMX6XFYAE2zSWVD04EGYSs9MbO6sEo20BMEAB4mpvSypsKjZ4Stgzb+c3A9/MQT2+vrBy+qvyFxLUtLlSRF/Ri2wjfZ2dus2Q8lXx4608/jnqK5OOap6NY2PSjYYnECCjiEeLJll/pbmqfeIK+ps3+MxrlEhqmTPipVP7kqlF4VhpEb6r+Q7YOJg38kJ9SHBf3NBl6+9YchfbUjb5ahLSzUM3kPHmwFAsZ5rpai0S7E5xWzZ1j+fW7zsUWP2g5NXTw52ySCTrgG0+lbw60l2Y/CB185CoA8NK+tbRKxfjy6pm5hzQRRR+cMqv1Jbiw6STivtEvt3DRcy0QEh92JlUGo2PG4tSKHl00YD6xc8CK+YPYyy3io2lN8BcSjKRzrIV6ypOAobqxViJPaT9M9Hy5szY33mp7OX/Zu89L/7Ww5vqY2Y8b0pKgoiUhG5cPDPzq8qTV/WkzUOIvXVVA96kmjcBrr3HrYC/Wn+fYP6Z7T1rqy3zknbvqma/FvVk96fNXGkuaXrdHW5JGSxZT/2I/O73v+yNWafMdzc5NdxYurHs6h86e01sLKLz9EBrg+x36rxAaED7hRnAMx7Vzu+9wabh3zG8XLQjx0ablUJzmxdErxYT3kzQSd0SSafVqF5PXgpp0OyYJ1EyNHpGUZmvK575ySzd85JSqF7IBzSAbMM04+MbE58xF3/njXOGecSaermlw2y9PsSQdytLJVr8t+wg+rR8cZYoeNxVIzNdk3Bngi8U5LAlgTFoQnzJCa5EsCgYhCaGL+qPj7TdhG31p9tej3R04N//PXxNwJvyUqwaJqRPJY98TJ5TPndmflRAkAhBfe46sfKW5wizSge08Xb7Ca/GUVs55trngkKkrUS2WPzKttaaqq+idmahugkY+W6fN0I6i3gPt/x88U4wAAeJxjYGRgYADiGU9YXsXz23xl4GZnAIFH7fO+IdMc/WBxDgYmEAUASbMKwAB4nGNgZGBgZwABjj4Ghv//OfoZGBlQgT4ARicDZAAAAHicY2BgYGAfxJijD8Fmu4EqBwCSpgKpAAAAAAAADgBoAH4AzADgAQIBQgFsAZgB7gIuAooC0AL8A2IDjAOoA+AEMASwBNoFCAVaBcAGCAYuBnAGrAb2B04HigfSCCoIcAiGCJwIyAkkCVYJiAmsCfIKIApWCsQLknicY2BkYGDQZ2hmYGcAASYg5gJCBob/YD4DABqrAdAAeJxdkE1qg0AYhl8Tk9AIoVDaVSmzahcF87PMARLIMoFAl0ZHY1BHdBJIT9AT9AQ9RQ9Qeqy+yteNMzDzfM+88w0K4BY/cNAMB6N2bUaPPBLukybCLvleeAAPj8JD+hfhMV7hC3u4wxs7OO4NzQSZcI/8Ltwnfwi75E/hAR7wJTyk/xYeY49fYQ/PztM+jbTZ7LY6OWdBJdX/pqs6NYWa+zMxa13oKrA6Uoerqi/JwtpYxZXJ1coUVmeZUWVlTjq0/tHacjmdxuL90OR8O0UEDYMNdtiSEpz5XQGqzlm30kzUdAYFFOb8R7NOZk0q2lwAyz1i7oAr1xoXvrOgtYhZx8wY5KRV269JZ5yGpmzPTjQhvY9je6vEElPOuJP3mWKnP5M3V+YAAAB4nG2ReVPbMBDF/ULi2EkDBFqO3gdHLxUzDB9IkdexBllydRD49ihO3Ckz7B/a31utZnafkkGyiXnyclxhgB0MMUKKMTLkmGCKV5hhF3vYxxwHOMRrvMERjnGCU7zFO7zHB3zEJ3zGF3zFN5zhHBe4xHf8wE/8wm8w/MEVimTYKv44XR9MSCsUjVoeHE3vjQoNsSZ4mmxZmVWPjSz7jlou6/0qKOWEJdKMtCe793/hQfqxa6XWZHMXFl56RS4TvPXSaDeoy0zUUZB109KstDK8lHo5q6Qi1hcOnqkImubPS6aqRq7mlnaEWabub4iYblba3SRmgldS0+FWdhNtt04F14JUaqkl7tcpOpJtErvNt3Bd9HRT5JWxK25Ldjvp6br4hzfFiIdSmlzTg2fSUzNrLd1LE1ynxq4OVaVoKLjzJ60UPtj1RKzHzsbjly6inVnFBS2MucviPncU7Rr7lfTxRepDs1A2j3ZHRc7PuzFYSfE3ZOd4kjwBy227hA=="},87698:ze=>{"use strict";ze.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII="},40500:ze=>{"use strict";ze.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg=="},12608:ze=>{"use strict";ze.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFJJREFUeAHtzjkSgCAQRNFmQYUZ7n9dKUvru0TmvPAn3br0QfgdZ5xx6x+rQn23GqTYnq1FDcnuzZIO2WmedVqIRVxgGKEyjNgYRjKGkZ1hFIZ3I70LyM0VtU8AAAAASUVORK5CYII="},87026:ze=>{"use strict";ze.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAMAAADJ7yrpAAAAKlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKE86IAAAADXRSTlMABBEmRGprlJW72e77tTkTKwAAAFNJREFUeAHtzjkSgCAUBNHPgsoy97+ulGXRqJE5L+xkxoYt2UdsLb5bqFINz+aLuuLn5rIu2RkO3fZpWENimNgiw6iBYRTPMLJjGFxQZ1hxxb/xBI1qC8k39CdKAAAAAElFTkSuQmCC"},80542:()=>{}}]);})();
