# Server Configuration
PORT=3001
NODE_ENV=development

# Database Configuration
# For local development, use docker-compose.yml PostgreSQL instance
# Using port 5433 to avoid conflicts with other PostgreSQL installations
DATABASE_URL="postgresql://mindflow:mindflow_dev_password@localhost:5433/mindflow_dev?schema=public"

# ============================================================================
# CLOUD DATABASE CONFIGURATION
# ============================================================================
# For production, update with your cloud database URL:

# Railway PostgreSQL:
# DATABASE_URL="postgresql://postgres:password@containers-us-west-XXX.railway.app:5432/railway"

# AWS RDS PostgreSQL:
# DATABASE_URL="postgresql://admin:password@mydb.XXX.us-west-2.rds.amazonaws.com:5432/mindflow?schema=public&sslmode=require"

# Supabase:
# DATABASE_URL="postgresql://postgres.XXX:password@aws-0-us-west-1.pooler.supabase.com:6543/postgres?pgbouncer=true"

# Neon (Serverless):
# DATABASE_URL="postgresql://neondb_owner:password@ep-XXX.us-west-2.aws.neon.tech/neondb?sslmode=require"

# Database Connection Pool Configuration
# Maximum number of database connections in the pool
# Recommended range:
#   - Development: 5-10
#   - Railway/Hobby: 10-20 (limited by plan)
#   - AWS RDS db.t3.micro: 20-30
#   - AWS RDS db.t3.small: 40-60
#   - Production: 50-100 (based on instance size)
# Default: 10
DATABASE_CONNECTION_LIMIT=10

# Connection Pool Timeout (in seconds)
# How long to wait for a connection from the pool
# Default: 10 seconds
# DATABASE_POOL_TIMEOUT=10

# ============================================================================
# SCALING CONSIDERATIONS
# ============================================================================
# When scaling to production, consider:
#
# 1. DATABASE CONNECTION LIMITS:
#    - Most cloud databases have connection limits
#    - Railway free tier: ~10 connections
#    - AWS RDS db.t3.micro: ~60 connections
#    - Use connection pooling (PgBouncer) for high-traffic apps
#
# 2. SSL/TLS:
#    - Always use sslmode=require in production
#    - Example: DATABASE_URL="...?sslmode=require"
#
# 3. READ REPLICAS:
#    - For read-heavy workloads, consider read replicas
#    - Set DATABASE_READ_REPLICA_URL for read operations
#    # DATABASE_READ_REPLICA_URL="postgresql://user:pass@read-replica-host:5432/db"
#
# 4. ENVIRONMENT-SPECIFIC CONFIG:
#    - Development: Local Docker, 10 connections
#    - Staging: Railway/Heroku, 20 connections
#    - Production: AWS RDS, 50+ connections with PgBouncer
#
# 5. PRISMA-SPECIFIC:
#    - Add connection_limit to URL: ?connection_limit=10
#    - Add pool_timeout: ?pool_timeout=10
#    - Example: DATABASE_URL="...?connection_limit=20&pool_timeout=10"

# CORS Configuration
# ⚠️  CRITICAL SECURITY: ALLOWED_ORIGINS is REQUIRED in production
# Comma-separated list of allowed origins (no wildcards!)
# For development: http://localhost:5173,http://localhost:5174 (Vite may use alternate ports)
# For production: https://yourdomain.com,https://www.yourdomain.com
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:5174

# Legacy frontend URL (deprecated - use ALLOWED_ORIGINS instead)
# FRONTEND_URL=http://localhost:5173

# JWT Configuration
# ⚠️  CRITICAL SECURITY: JWT_SECRET is REQUIRED in production
# Generate a secure secret with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# Minimum length: 32 characters
# Example: 7f3e9a2b8c1d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f
JWT_SECRET=your-secret-key-here-change-in-production
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# AWS S3 Configuration (for document storage - Phase 2+)
# AWS_S3_BUCKET=mindflow-documents
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# AWS_REGION=us-west-2

# SendGrid Configuration (for email notifications - Phase 4)
# SENDGRID_API_KEY=your-sendgrid-key
# SENDGRID_FROM_EMAIL=noreply@mindflow.com

# Random Lengths API (for commodity pricing - Phase 1)
# RL_API_KEY=your-random-lengths-api-key
# RL_API_URL=https://api.randomlengths.com

# Portal Sync Configuration (for Python agent integration)
# Service-to-service authentication token for portal sync endpoints
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# This token must match PORTAL_SYNC_SECRET in your STO Agents service
PORTAL_SYNC_SECRET=your-32-character-secret-here

# Seed Data Configuration (DEVELOPMENT ONLY)
# ⚠️  SECURITY: Seed script will NOT run in production
# Password for test users created by seed script (admin@mindflow.com, estimator@mindflow.com, etc.)
# If not set, defaults to 'DevPassword123!'
SEED_USER_PASSWORD=DevPassword123!

# ⚠️  WARNING: Set to 'true' to force seed script to run even with existing data
# This will DELETE ALL existing plans, customers, and users!
# Only use when you intentionally want to reset the database to seed data.
# SEED_FORCE=true
